%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.629662e+003; foe(n+1)=4.488008e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.136127e+003; foe(n+1)=2.908721e+003; krok(n+1)=5.234410e-004; ng(n+1)=4.538919e+003;
n=2; farx(n+1)=1.129009e+003; foe(n+1)=7.690275e+002; krok(n+1)=3.400118e-003; ng(n+1)=2.444854e+003;
n=3; farx(n+1)=1.182041e+003; foe(n+1)=4.936518e+002; krok(n+1)=3.276027e-004; ng(n+1)=5.365591e+003;
n=4; farx(n+1)=4.448126e+002; foe(n+1)=4.015941e+002; krok(n+1)=7.883344e-003; ng(n+1)=4.624791e+002;
n=5; farx(n+1)=2.425944e+002; foe(n+1)=3.010932e+002; krok(n+1)=2.015675e-004; ng(n+1)=4.417459e+003;
n=6; farx(n+1)=2.358417e+002; foe(n+1)=2.953174e+002; krok(n+1)=9.791917e-004; ng(n+1)=1.072941e+003;
n=7; farx(n+1)=2.205820e+002; foe(n+1)=2.850660e+002; krok(n+1)=1.949092e-003; ng(n+1)=5.300960e+002;
n=8; farx(n+1)=2.161982e+002; foe(n+1)=2.840896e+002; krok(n+1)=2.385047e-004; ng(n+1)=1.099168e+003;
n=9; farx(n+1)=1.290743e+002; foe(n+1)=2.585136e+002; krok(n+1)=3.816075e-003; ng(n+1)=1.080727e+003;
n=10; farx(n+1)=6.704090e+001; foe(n+1)=2.294234e+002; krok(n+1)=1.060430e-003; ng(n+1)=2.659795e+003;
n=11; farx(n+1)=6.054723e+001; foe(n+1)=2.264026e+002; krok(n+1)=6.738910e-005; ng(n+1)=2.260203e+003;
n=12; farx(n+1)=4.857356e+001; foe(n+1)=2.200785e+002; krok(n+1)=6.647718e-004; ng(n+1)=2.879487e+003;
n=13; farx(n+1)=3.552686e+001; foe(n+1)=2.131398e+002; krok(n+1)=3.771986e-004; ng(n+1)=4.069341e+003;
n=14; farx(n+1)=2.196982e+001; foe(n+1)=1.853693e+002; krok(n+1)=6.935224e-004; ng(n+1)=7.449241e+003;
n=15; farx(n+1)=2.103097e+001; foe(n+1)=1.840612e+002; krok(n+1)=2.109655e-005; ng(n+1)=9.228586e+003;
n=16; farx(n+1)=1.970573e+001; foe(n+1)=1.827984e+002; krok(n+1)=1.983052e-003; ng(n+1)=1.156574e+004;
n=17; farx(n+1)=1.859673e+001; foe(n+1)=1.803261e+002; krok(n+1)=4.861206e-004; ng(n+1)=1.025025e+004;
n=18; farx(n+1)=1.324851e+001; foe(n+1)=1.141379e+002; krok(n+1)=7.883579e-003; ng(n+1)=7.197734e+003;
n=19; farx(n+1)=1.355316e+001; foe(n+1)=1.133571e+002; krok(n+1)=2.219549e-005; ng(n+1)=4.276422e+003;
n=20; farx(n+1)=1.456858e+001; foe(n+1)=1.077750e+002; krok(n+1)=6.516379e-003; ng(n+1)=4.771043e+003;
n=21; farx(n+1)=1.445267e+001; foe(n+1)=1.056444e+002; krok(n+1)=2.887783e-004; ng(n+1)=4.245452e+003;
n=22; farx(n+1)=1.470738e+001; foe(n+1)=9.750961e+001; krok(n+1)=6.586506e-004; ng(n+1)=5.580102e+003;
n=23; farx(n+1)=1.303668e+001; foe(n+1)=8.996244e+001; krok(n+1)=1.986798e-003; ng(n+1)=4.348695e+003;
n=24; farx(n+1)=1.240103e+001; foe(n+1)=7.302725e+001; krok(n+1)=5.829556e-003; ng(n+1)=4.169635e+003;
n=25; farx(n+1)=1.188873e+001; foe(n+1)=6.905184e+001; krok(n+1)=1.786211e-003; ng(n+1)=2.405525e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.140979e+001; foe(n+1)=6.094055e+001; krok(n+1)=1.416371e-005; ng(n+1)=4.497962e+003;
n=27; farx(n+1)=9.617125e+000; foe(n+1)=4.817577e+001; krok(n+1)=1.231773e-004; ng(n+1)=1.690233e+003;
n=28; farx(n+1)=9.733738e+000; foe(n+1)=4.627655e+001; krok(n+1)=9.776439e-005; ng(n+1)=1.748548e+003;
n=29; farx(n+1)=9.266366e+000; foe(n+1)=3.815868e+001; krok(n+1)=7.389767e-005; ng(n+1)=2.338504e+003;
n=30; farx(n+1)=8.272071e+000; foe(n+1)=2.871924e+001; krok(n+1)=1.402097e-003; ng(n+1)=1.204173e+003;
n=31; farx(n+1)=7.783200e+000; foe(n+1)=2.385669e+001; krok(n+1)=8.158254e-004; ng(n+1)=2.790358e+003;
n=32; farx(n+1)=6.216461e+000; foe(n+1)=1.690669e+001; krok(n+1)=4.498755e-003; ng(n+1)=1.722944e+003;
n=33; farx(n+1)=5.703033e+000; foe(n+1)=1.457660e+001; krok(n+1)=1.564230e-003; ng(n+1)=1.296303e+003;
n=34; farx(n+1)=5.388146e+000; foe(n+1)=1.330104e+001; krok(n+1)=4.863834e-004; ng(n+1)=1.292963e+003;
n=35; farx(n+1)=5.308297e+000; foe(n+1)=1.243294e+001; krok(n+1)=2.778799e-003; ng(n+1)=6.337643e+002;
n=36; farx(n+1)=4.667789e+000; foe(n+1)=1.060575e+001; krok(n+1)=1.177574e-002; ng(n+1)=7.666605e+002;
n=37; farx(n+1)=4.411295e+000; foe(n+1)=9.187048e+000; krok(n+1)=5.711090e-003; ng(n+1)=9.086749e+002;
n=38; farx(n+1)=3.955544e+000; foe(n+1)=7.916238e+000; krok(n+1)=1.844475e-002; ng(n+1)=3.110961e+002;
n=39; farx(n+1)=3.842355e+000; foe(n+1)=7.565512e+000; krok(n+1)=1.563831e-003; ng(n+1)=9.283580e+002;
n=40; farx(n+1)=3.546424e+000; foe(n+1)=7.091383e+000; krok(n+1)=1.778267e-002; ng(n+1)=3.955428e+002;
n=41; farx(n+1)=3.236523e+000; foe(n+1)=6.728204e+000; krok(n+1)=1.908037e-003; ng(n+1)=7.606390e+002;
n=42; farx(n+1)=2.836226e+000; foe(n+1)=6.101904e+000; krok(n+1)=5.197906e-003; ng(n+1)=4.796125e+002;
n=43; farx(n+1)=2.573802e+000; foe(n+1)=5.651086e+000; krok(n+1)=1.869617e-002; ng(n+1)=3.136643e+002;
n=44; farx(n+1)=2.298437e+000; foe(n+1)=5.111614e+000; krok(n+1)=1.285062e-002; ng(n+1)=4.850408e+002;
n=45; farx(n+1)=1.980964e+000; foe(n+1)=4.600196e+000; krok(n+1)=9.584210e-003; ng(n+1)=2.408129e+002;
n=46; farx(n+1)=1.912914e+000; foe(n+1)=4.501119e+000; krok(n+1)=1.119612e-003; ng(n+1)=2.179918e+002;
n=47; farx(n+1)=1.853520e+000; foe(n+1)=4.374573e+000; krok(n+1)=5.711090e-003; ng(n+1)=4.146911e+002;
n=48; farx(n+1)=1.665226e+000; foe(n+1)=3.964294e+000; krok(n+1)=3.550149e-002; ng(n+1)=3.100688e+002;
n=49; farx(n+1)=1.568445e+000; foe(n+1)=3.669537e+000; krok(n+1)=1.282881e-002; ng(n+1)=5.204735e+002;
n=50; farx(n+1)=1.526325e+000; foe(n+1)=3.553966e+000; krok(n+1)=1.278106e-002; ng(n+1)=6.727892e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.518380e+000; foe(n+1)=3.450221e+000; krok(n+1)=1.272730e-005; ng(n+1)=4.697967e+002;
n=52; farx(n+1)=1.519676e+000; foe(n+1)=3.421012e+000; krok(n+1)=1.245057e-005; ng(n+1)=2.466393e+002;
n=53; farx(n+1)=1.504721e+000; foe(n+1)=3.354694e+000; krok(n+1)=1.054119e-004; ng(n+1)=1.477468e+002;
n=54; farx(n+1)=1.501536e+000; foe(n+1)=3.244656e+000; krok(n+1)=1.915864e-004; ng(n+1)=1.100826e+002;
n=55; farx(n+1)=1.492724e+000; foe(n+1)=3.206166e+000; krok(n+1)=5.057659e-004; ng(n+1)=5.691025e+001;
n=56; farx(n+1)=1.482081e+000; foe(n+1)=3.050050e+000; krok(n+1)=5.548179e-003; ng(n+1)=3.477583e+001;
n=57; farx(n+1)=1.474796e+000; foe(n+1)=2.874514e+000; krok(n+1)=5.557598e-003; ng(n+1)=2.559198e+002;
n=58; farx(n+1)=1.441298e+000; foe(n+1)=2.627067e+000; krok(n+1)=1.394241e-002; ng(n+1)=7.564431e+002;
n=59; farx(n+1)=1.420322e+000; foe(n+1)=2.257150e+000; krok(n+1)=1.547432e-002; ng(n+1)=6.308150e+002;
n=60; farx(n+1)=1.414850e+000; foe(n+1)=2.145605e+000; krok(n+1)=5.655154e-003; ng(n+1)=5.255921e+002;
n=61; farx(n+1)=1.440645e+000; foe(n+1)=2.015327e+000; krok(n+1)=1.333847e-002; ng(n+1)=3.872478e+002;
n=62; farx(n+1)=1.432546e+000; foe(n+1)=1.968827e+000; krok(n+1)=5.172508e-003; ng(n+1)=1.753537e+002;
n=63; farx(n+1)=1.419363e+000; foe(n+1)=1.935351e+000; krok(n+1)=3.902711e-003; ng(n+1)=2.789708e+002;
n=64; farx(n+1)=1.333534e+000; foe(n+1)=1.844890e+000; krok(n+1)=7.445763e-002; ng(n+1)=1.279639e+002;
n=65; farx(n+1)=1.287061e+000; foe(n+1)=1.801353e+000; krok(n+1)=1.879492e-002; ng(n+1)=2.083247e+002;
n=66; farx(n+1)=1.269149e+000; foe(n+1)=1.790097e+000; krok(n+1)=4.522618e-003; ng(n+1)=1.236023e+002;
n=67; farx(n+1)=1.198476e+000; foe(n+1)=1.734100e+000; krok(n+1)=2.085811e-002; ng(n+1)=1.372644e+002;
n=68; farx(n+1)=1.169053e+000; foe(n+1)=1.701544e+000; krok(n+1)=1.254988e-002; ng(n+1)=9.998066e+001;
n=69; farx(n+1)=1.148875e+000; foe(n+1)=1.669751e+000; krok(n+1)=9.100900e-003; ng(n+1)=1.777690e+002;
n=70; farx(n+1)=1.123621e+000; foe(n+1)=1.639489e+000; krok(n+1)=1.127471e-002; ng(n+1)=2.408155e+002;
n=71; farx(n+1)=1.073989e+000; foe(n+1)=1.567410e+000; krok(n+1)=7.514923e-002; ng(n+1)=9.601019e+001;
n=72; farx(n+1)=1.061263e+000; foe(n+1)=1.542750e+000; krok(n+1)=9.251671e-003; ng(n+1)=2.598403e+002;
n=73; farx(n+1)=1.032698e+000; foe(n+1)=1.490325e+000; krok(n+1)=3.411686e-002; ng(n+1)=2.935292e+002;
n=74; farx(n+1)=1.016381e+000; foe(n+1)=1.450375e+000; krok(n+1)=1.000726e-002; ng(n+1)=3.413457e+002;
n=75; farx(n+1)=1.004095e+000; foe(n+1)=1.400559e+000; krok(n+1)=3.863769e-002; ng(n+1)=1.200764e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.002643e+000; foe(n+1)=1.388334e+000; krok(n+1)=5.013524e-006; ng(n+1)=2.090641e+002;
n=77; farx(n+1)=1.002042e+000; foe(n+1)=1.385923e+000; krok(n+1)=8.546025e-006; ng(n+1)=9.959225e+001;
n=78; farx(n+1)=1.000996e+000; foe(n+1)=1.381764e+000; krok(n+1)=3.990378e-005; ng(n+1)=5.120419e+001;
n=79; farx(n+1)=1.003736e+000; foe(n+1)=1.368995e+000; krok(n+1)=3.831728e-004; ng(n+1)=2.257457e+001;
n=80; farx(n+1)=1.005864e+000; foe(n+1)=1.358607e+000; krok(n+1)=7.394073e-004; ng(n+1)=2.058133e+001;
n=81; farx(n+1)=1.008848e+000; foe(n+1)=1.347761e+000; krok(n+1)=5.193328e-004; ng(n+1)=2.754154e+001;
n=82; farx(n+1)=1.009549e+000; foe(n+1)=1.341264e+000; krok(n+1)=3.792794e-003; ng(n+1)=1.724910e+001;
n=83; farx(n+1)=1.010023e+000; foe(n+1)=1.324535e+000; krok(n+1)=5.368339e-003; ng(n+1)=2.359936e+001;
n=84; farx(n+1)=1.013336e+000; foe(n+1)=1.301768e+000; krok(n+1)=1.278285e-002; ng(n+1)=6.331993e+001;
n=85; farx(n+1)=1.025774e+000; foe(n+1)=1.281132e+000; krok(n+1)=1.553457e-002; ng(n+1)=1.591382e+002;
n=86; farx(n+1)=1.033004e+000; foe(n+1)=1.261848e+000; krok(n+1)=2.107682e-002; ng(n+1)=2.533096e+002;
n=87; farx(n+1)=1.021516e+000; foe(n+1)=1.244862e+000; krok(n+1)=3.243320e-002; ng(n+1)=8.237518e+001;
n=88; farx(n+1)=9.959012e-001; foe(n+1)=1.193687e+000; krok(n+1)=8.268560e-002; ng(n+1)=8.717020e+001;
n=89; farx(n+1)=9.834832e-001; foe(n+1)=1.173451e+000; krok(n+1)=1.142218e-002; ng(n+1)=1.810249e+002;
n=90; farx(n+1)=9.730981e-001; foe(n+1)=1.149621e+000; krok(n+1)=6.970444e-003; ng(n+1)=1.677413e+002;
n=91; farx(n+1)=9.671268e-001; foe(n+1)=1.133400e+000; krok(n+1)=7.632150e-003; ng(n+1)=1.208183e+002;
n=92; farx(n+1)=9.680394e-001; foe(n+1)=1.110609e+000; krok(n+1)=2.727640e-002; ng(n+1)=1.112306e+002;
n=93; farx(n+1)=9.703566e-001; foe(n+1)=1.104058e+000; krok(n+1)=1.636186e-002; ng(n+1)=1.020342e+002;
n=94; farx(n+1)=9.798375e-001; foe(n+1)=1.075949e+000; krok(n+1)=6.504518e-002; ng(n+1)=1.103246e+002;
n=95; farx(n+1)=9.737648e-001; foe(n+1)=1.030830e+000; krok(n+1)=9.118713e-002; ng(n+1)=1.110282e+002;
n=96; farx(n+1)=9.776697e-001; foe(n+1)=1.014978e+000; krok(n+1)=4.633705e-002; ng(n+1)=1.035168e+002;
n=97; farx(n+1)=9.754288e-001; foe(n+1)=1.002957e+000; krok(n+1)=2.428721e-002; ng(n+1)=1.729198e+002;
n=98; farx(n+1)=9.779322e-001; foe(n+1)=9.979077e-001; krok(n+1)=1.590914e-002; ng(n+1)=1.413378e+002;
n=99; farx(n+1)=9.848449e-001; foe(n+1)=9.708221e-001; krok(n+1)=1.016482e-001; ng(n+1)=1.209499e+002;
n=100; farx(n+1)=9.676918e-001; foe(n+1)=9.450843e-001; krok(n+1)=9.137743e-002; ng(n+1)=9.177169e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
