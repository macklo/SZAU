%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.042426e+003; foe(n+1)=3.994841e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.030148e+003; foe(n+1)=2.935372e+003; krok(n+1)=5.127695e-004; ng(n+1)=3.283359e+003;
n=2; farx(n+1)=1.205408e+003; foe(n+1)=8.964341e+002; krok(n+1)=3.765398e-003; ng(n+1)=1.466285e+003;
n=3; farx(n+1)=1.320983e+003; foe(n+1)=6.287166e+002; krok(n+1)=2.390962e-004; ng(n+1)=4.815669e+003;
n=4; farx(n+1)=1.666899e+003; foe(n+1)=5.266785e+002; krok(n+1)=8.500296e-004; ng(n+1)=3.880038e+003;
n=5; farx(n+1)=8.621065e+002; foe(n+1)=4.045014e+002; krok(n+1)=9.576149e-003; ng(n+1)=4.919548e+002;
n=6; farx(n+1)=6.838653e+002; foe(n+1)=3.751159e+002; krok(n+1)=9.851676e-004; ng(n+1)=8.720601e+002;
n=7; farx(n+1)=5.703857e+002; foe(n+1)=3.622664e+002; krok(n+1)=8.446781e-004; ng(n+1)=8.637649e+002;
n=8; farx(n+1)=4.579772e+002; foe(n+1)=3.372118e+002; krok(n+1)=1.651908e-003; ng(n+1)=7.841826e+002;
n=9; farx(n+1)=3.898882e+002; foe(n+1)=3.287035e+002; krok(n+1)=1.207035e-002; ng(n+1)=2.313275e+002;
n=10; farx(n+1)=3.422702e+002; foe(n+1)=3.096583e+002; krok(n+1)=2.580064e-002; ng(n+1)=4.011529e+002;
n=11; farx(n+1)=3.233511e+002; foe(n+1)=3.042927e+002; krok(n+1)=7.947193e-003; ng(n+1)=2.593156e+002;
n=12; farx(n+1)=2.906905e+002; foe(n+1)=2.971734e+002; krok(n+1)=5.852382e-003; ng(n+1)=2.178207e+002;
n=13; farx(n+1)=2.682206e+002; foe(n+1)=2.908089e+002; krok(n+1)=9.793864e-003; ng(n+1)=4.225554e+002;
n=14; farx(n+1)=2.579083e+002; foe(n+1)=2.886397e+002; krok(n+1)=1.063821e-003; ng(n+1)=7.183979e+002;
n=15; farx(n+1)=2.350581e+002; foe(n+1)=2.852921e+002; krok(n+1)=5.390749e-003; ng(n+1)=8.177671e+002;
n=16; farx(n+1)=2.234442e+002; foe(n+1)=2.837058e+002; krok(n+1)=3.889626e-003; ng(n+1)=1.266475e+003;
n=17; farx(n+1)=2.112628e+002; foe(n+1)=2.809325e+002; krok(n+1)=1.288703e-002; ng(n+1)=1.226045e+003;
n=18; farx(n+1)=2.147211e+002; foe(n+1)=2.763345e+002; krok(n+1)=2.113019e-002; ng(n+1)=1.252911e+003;
n=19; farx(n+1)=2.040492e+002; foe(n+1)=2.685528e+002; krok(n+1)=7.585588e-003; ng(n+1)=1.245652e+003;
n=20; farx(n+1)=1.837940e+002; foe(n+1)=2.629603e+002; krok(n+1)=1.726831e-002; ng(n+1)=1.154966e+003;
n=21; farx(n+1)=1.526862e+002; foe(n+1)=2.543918e+002; krok(n+1)=1.571605e-002; ng(n+1)=1.616566e+003;
n=22; farx(n+1)=9.333717e+001; foe(n+1)=2.174817e+002; krok(n+1)=2.049366e-002; ng(n+1)=2.925415e+003;
n=23; farx(n+1)=7.775547e+001; foe(n+1)=2.072830e+002; krok(n+1)=4.866267e-003; ng(n+1)=2.315083e+003;
n=24; farx(n+1)=7.426135e+001; foe(n+1)=2.050814e+002; krok(n+1)=8.155298e-003; ng(n+1)=1.953290e+003;
n=25; farx(n+1)=6.572571e+001; foe(n+1)=1.980830e+002; krok(n+1)=3.050527e-002; ng(n+1)=1.482289e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=6.610369e+001; foe(n+1)=1.927644e+002; krok(n+1)=5.338808e-006; ng(n+1)=3.034540e+003;
n=27; farx(n+1)=6.942925e+001; foe(n+1)=1.852168e+002; krok(n+1)=2.578785e-004; ng(n+1)=6.469626e+002;
n=28; farx(n+1)=6.162176e+001; foe(n+1)=1.797405e+002; krok(n+1)=1.189563e-004; ng(n+1)=1.028895e+003;
n=29; farx(n+1)=4.940104e+001; foe(n+1)=1.634728e+002; krok(n+1)=1.133097e-004; ng(n+1)=1.398278e+003;
n=30; farx(n+1)=2.866220e+001; foe(n+1)=1.356927e+002; krok(n+1)=7.663457e-004; ng(n+1)=2.236932e+003;
n=31; farx(n+1)=1.955219e+001; foe(n+1)=1.178984e+002; krok(n+1)=5.353910e-005; ng(n+1)=6.424015e+003;
n=32; farx(n+1)=1.809500e+001; foe(n+1)=1.152965e+002; krok(n+1)=9.675577e-005; ng(n+1)=6.663544e+003;
n=33; farx(n+1)=1.697015e+001; foe(n+1)=1.139158e+002; krok(n+1)=2.992546e-004; ng(n+1)=5.060271e+003;
n=34; farx(n+1)=1.592905e+001; foe(n+1)=1.114907e+002; krok(n+1)=1.043660e-003; ng(n+1)=8.107352e+003;
n=35; farx(n+1)=1.478697e+001; foe(n+1)=9.218787e+001; krok(n+1)=1.427772e-003; ng(n+1)=8.201406e+003;
n=36; farx(n+1)=1.473388e+001; foe(n+1)=9.031465e+001; krok(n+1)=2.923979e-004; ng(n+1)=5.857051e+003;
n=37; farx(n+1)=1.407943e+001; foe(n+1)=8.313292e+001; krok(n+1)=1.428969e-002; ng(n+1)=5.513572e+003;
n=38; farx(n+1)=1.403816e+001; foe(n+1)=8.072382e+001; krok(n+1)=8.300976e-003; ng(n+1)=4.601900e+003;
n=39; farx(n+1)=1.357861e+001; foe(n+1)=7.485606e+001; krok(n+1)=2.502130e-002; ng(n+1)=5.807075e+003;
n=40; farx(n+1)=1.001898e+001; foe(n+1)=6.369235e+001; krok(n+1)=3.104538e-002; ng(n+1)=7.786114e+003;
n=41; farx(n+1)=9.524353e+000; foe(n+1)=5.613317e+001; krok(n+1)=1.726361e-002; ng(n+1)=2.090500e+003;
n=42; farx(n+1)=1.004218e+001; foe(n+1)=5.241080e+001; krok(n+1)=8.704305e-003; ng(n+1)=1.443867e+003;
n=43; farx(n+1)=1.072656e+001; foe(n+1)=4.885170e+001; krok(n+1)=2.069473e-002; ng(n+1)=3.263755e+003;
n=44; farx(n+1)=1.002072e+001; foe(n+1)=4.184414e+001; krok(n+1)=2.679765e-002; ng(n+1)=3.039330e+003;
n=45; farx(n+1)=1.022314e+001; foe(n+1)=3.561849e+001; krok(n+1)=2.317569e-001; ng(n+1)=2.110574e+003;
n=46; farx(n+1)=9.331345e+000; foe(n+1)=3.502323e+001; krok(n+1)=6.900644e-002; ng(n+1)=1.050126e+003;
n=47; farx(n+1)=5.980873e+000; foe(n+1)=3.009739e+001; krok(n+1)=1.903039e-001; ng(n+1)=1.566073e+003;
n=48; farx(n+1)=5.383878e+000; foe(n+1)=2.801816e+001; krok(n+1)=1.297328e-001; ng(n+1)=1.418186e+003;
n=49; farx(n+1)=5.228016e+000; foe(n+1)=2.678525e+001; krok(n+1)=1.479692e-001; ng(n+1)=9.800396e+002;
n=50; farx(n+1)=5.252073e+000; foe(n+1)=2.204926e+001; krok(n+1)=5.690454e-001; ng(n+1)=1.762918e+003;
%odnowa zmiennej metryki
n=51; farx(n+1)=5.235028e+000; foe(n+1)=2.181057e+001; krok(n+1)=1.556381e-006; ng(n+1)=1.359886e+003;
n=52; farx(n+1)=5.211403e+000; foe(n+1)=2.174181e+001; krok(n+1)=3.061523e-005; ng(n+1)=1.955917e+002;
n=53; farx(n+1)=5.141450e+000; foe(n+1)=1.952093e+001; krok(n+1)=4.220039e-004; ng(n+1)=2.482107e+002;
n=54; farx(n+1)=5.193055e+000; foe(n+1)=1.938419e+001; krok(n+1)=2.983290e-005; ng(n+1)=4.730359e+002;
n=55; farx(n+1)=5.202680e+000; foe(n+1)=1.913202e+001; krok(n+1)=6.369581e-004; ng(n+1)=3.180983e+002;
n=56; farx(n+1)=5.318021e+000; foe(n+1)=1.765804e+001; krok(n+1)=2.105249e-003; ng(n+1)=3.475012e+002;
n=57; farx(n+1)=4.752975e+000; foe(n+1)=1.627355e+001; krok(n+1)=1.969225e-003; ng(n+1)=3.373212e+002;
n=58; farx(n+1)=4.176866e+000; foe(n+1)=1.431708e+001; krok(n+1)=4.026836e-003; ng(n+1)=7.141160e+002;
n=59; farx(n+1)=4.052531e+000; foe(n+1)=1.376954e+001; krok(n+1)=1.071180e-002; ng(n+1)=1.640893e+003;
n=60; farx(n+1)=3.833926e+000; foe(n+1)=1.233637e+001; krok(n+1)=1.506159e-002; ng(n+1)=1.212302e+003;
n=61; farx(n+1)=3.788671e+000; foe(n+1)=1.195637e+001; krok(n+1)=2.518078e-003; ng(n+1)=1.666336e+003;
n=62; farx(n+1)=3.780564e+000; foe(n+1)=1.180937e+001; krok(n+1)=2.636366e-003; ng(n+1)=8.061161e+002;
n=63; farx(n+1)=3.773137e+000; foe(n+1)=1.115000e+001; krok(n+1)=4.382471e-002; ng(n+1)=9.072349e+002;
n=64; farx(n+1)=3.304157e+000; foe(n+1)=1.015345e+001; krok(n+1)=4.382471e-002; ng(n+1)=1.143880e+003;
n=65; farx(n+1)=3.270495e+000; foe(n+1)=1.001166e+001; krok(n+1)=2.502768e-002; ng(n+1)=8.438471e+002;
n=66; farx(n+1)=2.981378e+000; foe(n+1)=9.220461e+000; krok(n+1)=8.589342e-002; ng(n+1)=6.506672e+002;
n=67; farx(n+1)=2.923743e+000; foe(n+1)=8.922003e+000; krok(n+1)=7.964480e-002; ng(n+1)=3.534019e+002;
n=68; farx(n+1)=2.785104e+000; foe(n+1)=8.027375e+000; krok(n+1)=3.655097e-001; ng(n+1)=3.067065e+002;
n=69; farx(n+1)=2.644238e+000; foe(n+1)=7.289587e+000; krok(n+1)=1.717868e-001; ng(n+1)=5.095731e+002;
n=70; farx(n+1)=2.619526e+000; foe(n+1)=6.245105e+000; krok(n+1)=3.619199e-001; ng(n+1)=2.585560e+002;
n=71; farx(n+1)=2.545566e+000; foe(n+1)=6.018938e+000; krok(n+1)=1.951976e-001; ng(n+1)=5.532205e+002;
n=72; farx(n+1)=2.511325e+000; foe(n+1)=5.864357e+000; krok(n+1)=2.250273e-001; ng(n+1)=3.663868e+002;
n=73; farx(n+1)=2.517833e+000; foe(n+1)=5.606015e+000; krok(n+1)=4.837349e-001; ng(n+1)=1.330626e+002;
n=74; farx(n+1)=2.503974e+000; foe(n+1)=5.447531e+000; krok(n+1)=4.063898e-001; ng(n+1)=1.309415e+002;
n=75; farx(n+1)=2.442923e+000; foe(n+1)=5.296152e+000; krok(n+1)=3.202323e-001; ng(n+1)=5.048204e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.442497e+000; foe(n+1)=5.287252e+000; krok(n+1)=3.787925e-006; ng(n+1)=1.581514e+002;
n=77; farx(n+1)=2.439333e+000; foe(n+1)=5.274196e+000; krok(n+1)=5.751510e-006; ng(n+1)=1.457991e+002;
n=78; farx(n+1)=2.426872e+000; foe(n+1)=5.240207e+000; krok(n+1)=1.684609e-004; ng(n+1)=4.504779e+001;
n=79; farx(n+1)=2.383407e+000; foe(n+1)=5.146433e+000; krok(n+1)=1.620874e-004; ng(n+1)=7.774897e+001;
n=80; farx(n+1)=2.348223e+000; foe(n+1)=5.037386e+000; krok(n+1)=2.282102e-003; ng(n+1)=1.339032e+002;
n=81; farx(n+1)=2.325846e+000; foe(n+1)=4.906532e+000; krok(n+1)=7.859971e-003; ng(n+1)=6.482942e+002;
n=82; farx(n+1)=2.313408e+000; foe(n+1)=4.854898e+000; krok(n+1)=4.633998e-003; ng(n+1)=4.581114e+002;
n=83; farx(n+1)=2.275289e+000; foe(n+1)=4.759917e+000; krok(n+1)=3.778589e-003; ng(n+1)=2.076287e+002;
n=84; farx(n+1)=2.247614e+000; foe(n+1)=4.726092e+000; krok(n+1)=3.965892e-003; ng(n+1)=3.080570e+002;
n=85; farx(n+1)=2.236745e+000; foe(n+1)=4.714578e+000; krok(n+1)=1.033570e-002; ng(n+1)=3.422739e+002;
n=86; farx(n+1)=2.191148e+000; foe(n+1)=4.649394e+000; krok(n+1)=1.650423e-002; ng(n+1)=4.903685e+002;
n=87; farx(n+1)=2.127070e+000; foe(n+1)=4.486100e+000; krok(n+1)=7.802292e-002; ng(n+1)=4.259314e+002;
n=88; farx(n+1)=2.094766e+000; foe(n+1)=4.386960e+000; krok(n+1)=2.356822e-002; ng(n+1)=3.715470e+002;
n=89; farx(n+1)=2.089765e+000; foe(n+1)=4.301624e+000; krok(n+1)=4.545636e-002; ng(n+1)=2.805446e+002;
n=90; farx(n+1)=2.111604e+000; foe(n+1)=4.226117e+000; krok(n+1)=6.247411e-002; ng(n+1)=6.983393e+002;
n=91; farx(n+1)=2.083540e+000; foe(n+1)=4.123104e+000; krok(n+1)=1.346529e-001; ng(n+1)=6.471288e+002;
n=92; farx(n+1)=2.049404e+000; foe(n+1)=3.748259e+000; krok(n+1)=2.214681e-001; ng(n+1)=3.403643e+002;
n=93; farx(n+1)=2.014056e+000; foe(n+1)=3.633547e+000; krok(n+1)=1.331836e-001; ng(n+1)=2.403224e+002;
n=94; farx(n+1)=2.008800e+000; foe(n+1)=3.437397e+000; krok(n+1)=2.317569e-001; ng(n+1)=7.424282e+002;
n=95; farx(n+1)=2.035248e+000; foe(n+1)=3.320646e+000; krok(n+1)=1.573255e-001; ng(n+1)=8.222259e+002;
n=96; farx(n+1)=2.047156e+000; foe(n+1)=3.189981e+000; krok(n+1)=2.553603e-001; ng(n+1)=2.760322e+002;
n=97; farx(n+1)=2.032107e+000; foe(n+1)=3.118117e+000; krok(n+1)=1.150658e-001; ng(n+1)=6.335208e+002;
n=98; farx(n+1)=1.999256e+000; foe(n+1)=2.997989e+000; krok(n+1)=2.589664e-001; ng(n+1)=1.818029e+002;
n=99; farx(n+1)=1.983498e+000; foe(n+1)=2.921030e+000; krok(n+1)=1.775417e-001; ng(n+1)=9.714522e+002;
n=100; farx(n+1)=1.952810e+000; foe(n+1)=2.804013e+000; krok(n+1)=1.895930e-001; ng(n+1)=9.640171e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
