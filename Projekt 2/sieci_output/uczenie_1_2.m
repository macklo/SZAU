%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.062785e+003; foe(n+1)=4.041249e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.088480e+003; foe(n+1)=3.039919e+003; krok(n+1)=5.053235e-004; ng(n+1)=1.616345e+003;
n=2; farx(n+1)=9.929848e+002; foe(n+1)=8.802573e+002; krok(n+1)=3.426151e-002; ng(n+1)=2.253472e+002;
n=3; farx(n+1)=1.039250e+003; foe(n+1)=7.490810e+002; krok(n+1)=2.838391e-004; ng(n+1)=1.851928e+003;
n=4; farx(n+1)=9.500636e+002; foe(n+1)=5.988358e+002; krok(n+1)=1.863415e-003; ng(n+1)=1.643711e+003;
n=5; farx(n+1)=6.515030e+002; foe(n+1)=5.790215e+002; krok(n+1)=5.104106e-002; ng(n+1)=9.792257e+002;
n=6; farx(n+1)=3.807631e+002; foe(n+1)=4.313189e+002; krok(n+1)=6.762233e-001; ng(n+1)=1.113732e+003;
n=7; farx(n+1)=3.790554e+002; foe(n+1)=4.052044e+002; krok(n+1)=1.251552e-001; ng(n+1)=6.637392e+002;
n=8; farx(n+1)=3.811088e+002; foe(n+1)=3.567214e+002; krok(n+1)=1.241815e-001; ng(n+1)=3.443540e+002;
n=9; farx(n+1)=3.722159e+002; foe(n+1)=3.509094e+002; krok(n+1)=6.404647e-001; ng(n+1)=2.040267e+002;
n=10; farx(n+1)=3.562573e+002; foe(n+1)=3.427933e+002; krok(n+1)=4.044487e-001; ng(n+1)=1.145341e+002;
n=11; farx(n+1)=3.376860e+002; foe(n+1)=3.343214e+002; krok(n+1)=2.615134e+000; ng(n+1)=1.597845e+002;
n=12; farx(n+1)=3.371845e+002; foe(n+1)=3.233186e+002; krok(n+1)=4.965827e+000; ng(n+1)=5.532681e+001;
n=13; farx(n+1)=3.463744e+002; foe(n+1)=3.187743e+002; krok(n+1)=5.202472e-001; ng(n+1)=1.604596e+002;
n=14; farx(n+1)=3.635259e+002; foe(n+1)=3.111971e+002; krok(n+1)=7.215816e-001; ng(n+1)=1.418232e+002;
n=15; farx(n+1)=3.474785e+002; foe(n+1)=3.081058e+002; krok(n+1)=5.695627e-001; ng(n+1)=9.530537e+001;
n=16; farx(n+1)=3.537346e+002; foe(n+1)=3.076657e+002; krok(n+1)=8.027177e-001; ng(n+1)=1.035601e+001;
n=17; farx(n+1)=3.545633e+002; foe(n+1)=3.075425e+002; krok(n+1)=2.127187e+000; ng(n+1)=1.011861e+001;
n=18; farx(n+1)=3.452295e+002; foe(n+1)=3.071505e+002; krok(n+1)=1.031405e+001; ng(n+1)=1.221865e+001;
n=19; farx(n+1)=3.415757e+002; foe(n+1)=3.058389e+002; krok(n+1)=1.462039e+000; ng(n+1)=2.489017e+001;
n=20; farx(n+1)=3.417334e+002; foe(n+1)=3.057233e+002; krok(n+1)=1.261335e-001; ng(n+1)=3.419132e+001;
n=21; farx(n+1)=3.484908e+002; foe(n+1)=3.049000e+002; krok(n+1)=4.187571e-001; ng(n+1)=3.004102e+001;
n=22; farx(n+1)=3.470477e+002; foe(n+1)=3.043975e+002; krok(n+1)=6.187597e+000; ng(n+1)=1.655991e+001;
n=23; farx(n+1)=2.790389e+002; foe(n+1)=2.970875e+002; krok(n+1)=3.170493e+000; ng(n+1)=3.321086e+001;
n=24; farx(n+1)=2.637138e+002; foe(n+1)=2.968031e+002; krok(n+1)=5.119766e-003; ng(n+1)=4.889289e+002;
n=25; farx(n+1)=1.022307e+002; foe(n+1)=2.725299e+002; krok(n+1)=5.516699e-001; ng(n+1)=6.014666e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.024594e+001; foe(n+1)=2.264271e+002; krok(n+1)=8.559513e-005; ng(n+1)=2.197858e+003;
n=27; farx(n+1)=4.681571e+001; foe(n+1)=2.098992e+002; krok(n+1)=4.822659e-004; ng(n+1)=3.738997e+002;
n=28; farx(n+1)=3.384314e+001; foe(n+1)=1.870545e+002; krok(n+1)=1.043848e-003; ng(n+1)=3.575506e+002;
n=29; farx(n+1)=2.790936e+001; foe(n+1)=1.710936e+002; krok(n+1)=1.568736e-003; ng(n+1)=4.350201e+002;
n=30; farx(n+1)=2.386080e+001; foe(n+1)=1.551198e+002; krok(n+1)=6.446820e-004; ng(n+1)=3.955358e+002;
n=31; farx(n+1)=2.257052e+001; foe(n+1)=1.506159e+002; krok(n+1)=5.769389e-004; ng(n+1)=8.234228e+002;
n=32; farx(n+1)=2.516534e+001; foe(n+1)=1.443066e+002; krok(n+1)=7.532950e-004; ng(n+1)=1.410985e+003;
n=33; farx(n+1)=2.844621e+001; foe(n+1)=1.409496e+002; krok(n+1)=9.656284e-002; ng(n+1)=1.208621e+003;
n=34; farx(n+1)=2.852709e+001; foe(n+1)=1.343135e+002; krok(n+1)=1.981558e-001; ng(n+1)=1.502363e+003;
n=35; farx(n+1)=2.248657e+001; foe(n+1)=1.263453e+002; krok(n+1)=3.556863e-001; ng(n+1)=7.707054e+002;
n=36; farx(n+1)=1.779344e+001; foe(n+1)=1.181450e+002; krok(n+1)=1.525089e+000; ng(n+1)=3.549919e+002;
n=37; farx(n+1)=1.775138e+001; foe(n+1)=1.178362e+002; krok(n+1)=6.087640e-002; ng(n+1)=2.453825e+002;
n=38; farx(n+1)=1.802236e+001; foe(n+1)=1.139967e+002; krok(n+1)=8.276012e-002; ng(n+1)=7.257800e+002;
n=39; farx(n+1)=1.420541e+001; foe(n+1)=1.003094e+002; krok(n+1)=2.991990e+000; ng(n+1)=4.488598e+002;
n=40; farx(n+1)=1.042439e+001; foe(n+1)=9.398028e+001; krok(n+1)=5.551324e-001; ng(n+1)=8.473320e+002;
n=41; farx(n+1)=1.041706e+001; foe(n+1)=9.384264e+001; krok(n+1)=1.139839e-002; ng(n+1)=7.259051e+002;
n=42; farx(n+1)=1.090296e+001; foe(n+1)=9.058434e+001; krok(n+1)=5.491644e-001; ng(n+1)=4.070789e+002;
n=43; farx(n+1)=1.099762e+001; foe(n+1)=8.946474e+001; krok(n+1)=7.783923e-001; ng(n+1)=1.057605e+003;
n=44; farx(n+1)=1.082344e+001; foe(n+1)=8.795743e+001; krok(n+1)=5.108389e-001; ng(n+1)=1.833124e+003;
n=45; farx(n+1)=1.009900e+001; foe(n+1)=8.668683e+001; krok(n+1)=1.120145e+000; ng(n+1)=5.460846e+002;
n=46; farx(n+1)=1.021976e+001; foe(n+1)=8.468714e+001; krok(n+1)=1.905690e+000; ng(n+1)=3.284260e+002;
n=47; farx(n+1)=9.932320e+000; foe(n+1)=8.400003e+001; krok(n+1)=1.177790e+000; ng(n+1)=3.350514e+002;
n=48; farx(n+1)=9.995039e+000; foe(n+1)=8.359647e+001; krok(n+1)=1.075645e+000; ng(n+1)=3.199236e+002;
n=49; farx(n+1)=1.007927e+001; foe(n+1)=8.347285e+001; krok(n+1)=4.456675e-001; ng(n+1)=2.110758e+002;
n=50; farx(n+1)=9.981311e+000; foe(n+1)=8.330382e+001; krok(n+1)=2.156576e+000; ng(n+1)=1.915380e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.000177e+001; foe(n+1)=8.326361e+001; krok(n+1)=6.116772e-006; ng(n+1)=1.853089e+002;
n=52; farx(n+1)=9.964207e+000; foe(n+1)=8.319789e+001; krok(n+1)=1.231075e-005; ng(n+1)=1.509325e+002;
n=53; farx(n+1)=9.960793e+000; foe(n+1)=8.316917e+001; krok(n+1)=1.275185e-004; ng(n+1)=3.772336e+001;
n=54; farx(n+1)=9.988149e+000; foe(n+1)=8.313984e+001; krok(n+1)=3.862984e-005; ng(n+1)=7.118360e+001;
n=55; farx(n+1)=9.925169e+000; foe(n+1)=8.312119e+001; krok(n+1)=2.821941e-004; ng(n+1)=4.510472e+001;
n=56; farx(n+1)=1.003366e+001; foe(n+1)=8.305884e+001; krok(n+1)=2.021294e-003; ng(n+1)=6.935557e+001;
n=57; farx(n+1)=1.003243e+001; foe(n+1)=8.305827e+001; krok(n+1)=4.954706e-002; ng(n+1)=6.966949e+001;
n=58; farx(n+1)=1.002287e+001; foe(n+1)=8.304811e+001; krok(n+1)=8.922448e-001; ng(n+1)=6.036587e+001;
n=59; farx(n+1)=1.001078e+001; foe(n+1)=8.304659e+001; krok(n+1)=1.784434e+000; ng(n+1)=2.198872e+001;
n=60; farx(n+1)=1.000609e+001; foe(n+1)=8.304649e+001; krok(n+1)=1.420334e+000; ng(n+1)=5.855588e+000;
n=61; farx(n+1)=1.000542e+001; foe(n+1)=8.304648e+001; krok(n+1)=2.794466e+000; ng(n+1)=6.632160e-001;
n=62; farx(n+1)=1.000480e+001; foe(n+1)=8.304647e+001; krok(n+1)=4.770361e+000; ng(n+1)=1.030388e+000;
n=63; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.056270e+000; ng(n+1)=9.970754e-002;
n=64; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.076812e-007; ng(n+1)=1.762352e-002;
n=65; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=5.929494e-006; ng(n+1)=1.762352e-002;
n=66; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=8.288181e-006; ng(n+1)=1.762342e-002;
n=67; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=8.199957e-006; ng(n+1)=1.762327e-002;
n=68; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.697799e-006; ng(n+1)=1.762313e-002;
n=69; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.657636e-005; ng(n+1)=1.762308e-002;
n=70; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.095376e-005; ng(n+1)=1.762279e-002;
n=71; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=7.150304e-006; ng(n+1)=1.762259e-002;
n=72; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=9.960744e-006; ng(n+1)=1.762247e-002;
n=73; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.568290e-005; ng(n+1)=1.762229e-002;
n=74; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.075314e-005; ng(n+1)=1.762184e-002;
n=75; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=8.943311e-006; ng(n+1)=1.762165e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.474229e-006; ng(n+1)=1.762149e-002;
n=77; farx(n+1)=1.000503e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.130389e-005; ng(n+1)=5.167815e-003;
n=78; farx(n+1)=1.000504e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.070960e-004; ng(n+1)=1.789627e-003;
n=79; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=9.645318e-004; ng(n+1)=1.408118e-003;
n=80; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.741184e-004; ng(n+1)=5.472557e-004;
n=81; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.726887e-005; ng(n+1)=2.669717e-004;
n=82; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.209447e-005; ng(n+1)=2.669198e-004;
n=83; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.590126e-005; ng(n+1)=2.669650e-004;
n=84; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.584690e-005; ng(n+1)=2.669603e-004;
n=85; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=8.885405e-010; ng(n+1)=2.669561e-004;
n=86; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.908931e-009; ng(n+1)=2.669561e-004;
n=87; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.228319e-010; ng(n+1)=2.669561e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
