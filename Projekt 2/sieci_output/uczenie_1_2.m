%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.037926e+003; foe(n+1)=4.011164e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.041625e+003; foe(n+1)=3.036217e+003; krok(n+1)=4.966995e-004; ng(n+1)=1.849885e+003;
n=2; farx(n+1)=1.166258e+003; foe(n+1)=1.094599e+003; krok(n+1)=1.256280e-002; ng(n+1)=2.269139e+002;
n=3; farx(n+1)=1.181188e+003; foe(n+1)=1.065584e+003; krok(n+1)=4.883258e-006; ng(n+1)=5.682729e+003;
n=4; farx(n+1)=2.888158e+003; foe(n+1)=8.720765e+002; krok(n+1)=1.016331e-003; ng(n+1)=6.135863e+003;
n=5; farx(n+1)=2.873245e+003; foe(n+1)=8.294019e+002; krok(n+1)=1.607674e-003; ng(n+1)=2.461584e+003;
n=6; farx(n+1)=3.062335e+003; foe(n+1)=8.176750e+002; krok(n+1)=2.013779e-002; ng(n+1)=2.207252e+003;
n=7; farx(n+1)=6.003746e+002; foe(n+1)=5.578887e+002; krok(n+1)=9.599621e-002; ng(n+1)=2.042960e+003;
n=8; farx(n+1)=4.131170e+002; foe(n+1)=5.205289e+002; krok(n+1)=1.405854e-002; ng(n+1)=6.224444e+003;
n=9; farx(n+1)=2.624299e+002; foe(n+1)=3.834388e+002; krok(n+1)=3.106282e-001; ng(n+1)=8.416677e+003;
n=10; farx(n+1)=2.059167e+002; foe(n+1)=3.384939e+002; krok(n+1)=2.803005e-001; ng(n+1)=2.001844e+003;
n=11; farx(n+1)=2.842355e+001; foe(n+1)=1.576353e+002; krok(n+1)=1.057221e-001; ng(n+1)=1.594432e+003;
n=12; farx(n+1)=2.256663e+001; foe(n+1)=1.275984e+002; krok(n+1)=1.809649e-001; ng(n+1)=1.832595e+003;
n=13; farx(n+1)=1.610365e+001; foe(n+1)=1.142570e+002; krok(n+1)=1.945981e-001; ng(n+1)=1.093241e+003;
n=14; farx(n+1)=1.339431e+001; foe(n+1)=1.050100e+002; krok(n+1)=9.362720e-001; ng(n+1)=5.099552e+002;
n=15; farx(n+1)=9.726844e+000; foe(n+1)=9.256599e+001; krok(n+1)=2.392207e+000; ng(n+1)=8.807381e+002;
n=16; farx(n+1)=9.041418e+000; foe(n+1)=8.799339e+001; krok(n+1)=6.809733e-001; ng(n+1)=2.110610e+003;
n=17; farx(n+1)=8.591620e+000; foe(n+1)=8.664067e+001; krok(n+1)=8.341234e-001; ng(n+1)=3.612520e+002;
n=18; farx(n+1)=8.898576e+000; foe(n+1)=8.581213e+001; krok(n+1)=8.961161e-001; ng(n+1)=3.144438e+002;
n=19; farx(n+1)=9.466887e+000; foe(n+1)=8.468877e+001; krok(n+1)=2.544580e+000; ng(n+1)=4.398233e+002;
n=20; farx(n+1)=9.315267e+000; foe(n+1)=8.424990e+001; krok(n+1)=1.025225e+000; ng(n+1)=2.532736e+002;
n=21; farx(n+1)=9.309231e+000; foe(n+1)=8.395249e+001; krok(n+1)=1.106940e+000; ng(n+1)=1.322659e+002;
n=22; farx(n+1)=9.515613e+000; foe(n+1)=8.354169e+001; krok(n+1)=2.184510e+000; ng(n+1)=2.123733e+002;
n=23; farx(n+1)=9.277532e+000; foe(n+1)=8.320225e+001; krok(n+1)=1.296088e+000; ng(n+1)=1.269900e+002;
n=24; farx(n+1)=9.142049e+000; foe(n+1)=8.304761e+001; krok(n+1)=1.126364e+000; ng(n+1)=3.221008e+002;
n=25; farx(n+1)=9.109865e+000; foe(n+1)=8.301124e+001; krok(n+1)=9.526777e-001; ng(n+1)=7.042708e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.117677e+000; foe(n+1)=8.300960e+001; krok(n+1)=3.667070e-006; ng(n+1)=4.108149e+001;
n=27; farx(n+1)=9.120950e+000; foe(n+1)=8.300807e+001; krok(n+1)=1.635753e-005; ng(n+1)=1.711270e+001;
n=28; farx(n+1)=9.125711e+000; foe(n+1)=8.300789e+001; krok(n+1)=1.691914e-004; ng(n+1)=2.398611e+000;
n=29; farx(n+1)=9.104436e+000; foe(n+1)=8.300666e+001; krok(n+1)=2.500228e-003; ng(n+1)=1.534962e+000;
n=30; farx(n+1)=9.108913e+000; foe(n+1)=8.300568e+001; krok(n+1)=2.602503e-002; ng(n+1)=5.679680e-001;
n=31; farx(n+1)=9.115043e+000; foe(n+1)=8.300565e+001; krok(n+1)=8.053672e-003; ng(n+1)=1.695126e+000;
n=32; farx(n+1)=9.135104e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.553141e-001; ng(n+1)=1.787488e+000;
n=33; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=9.769152e-001; ng(n+1)=1.052765e+000;
n=34; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=3.762559e-005; ng(n+1)=7.814800e-003;
n=35; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.559360e-005; ng(n+1)=7.814507e-003;
n=36; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=5.586175e-008; ng(n+1)=7.814385e-003;
n=37; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.725370e-005; ng(n+1)=7.814385e-003;
n=38; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=6.943298e-006; ng(n+1)=7.814250e-003;
n=39; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.513469e-010; ng(n+1)=7.814196e-003;
n=40; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.204721e-010; ng(n+1)=7.814196e-003;
n=41; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=6.611582e-010; ng(n+1)=7.814196e-003;
n=42; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=4.331760e-011; ng(n+1)=7.814196e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=43; farx(n+1)=9.134816e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.926265e-006; ng(n+1)=7.814196e-003;
n=44; farx(n+1)=9.134816e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.190752e-005; ng(n+1)=1.119944e-003;
n=45; farx(n+1)=9.134809e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.721185e-003; ng(n+1)=3.669001e-004;
n=46; farx(n+1)=9.134807e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.317769e-004; ng(n+1)=9.522343e-004;
n=47; farx(n+1)=9.134807e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.694130e-005; ng(n+1)=1.831001e-004;
n=48; farx(n+1)=9.134807e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.041187e-005; ng(n+1)=1.829692e-004;
n=49; farx(n+1)=9.134807e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.756058e-008; ng(n+1)=1.829473e-004;
n=50; farx(n+1)=9.134807e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.621459e-008; ng(n+1)=1.829473e-004;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.134807e+000; foe(n+1)=8.300561e+001; krok(n+1)=8.598292e-013; ng(n+1)=1.829472e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
