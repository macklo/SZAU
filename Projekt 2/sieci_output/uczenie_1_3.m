%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.882125e+003; foe(n+1)=4.877368e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.929902e+003; foe(n+1)=3.921698e+003; krok(n+1)=3.348253e-004; ng(n+1)=1.931584e+003;
n=2; farx(n+1)=7.670033e+002; foe(n+1)=7.522497e+002; krok(n+1)=1.902655e-002; ng(n+1)=2.931179e+002;
n=3; farx(n+1)=7.523753e+002; foe(n+1)=6.863319e+002; krok(n+1)=3.229906e-004; ng(n+1)=8.300490e+002;
n=4; farx(n+1)=6.270451e+002; foe(n+1)=5.463452e+002; krok(n+1)=2.002393e-003; ng(n+1)=1.082130e+003;
n=5; farx(n+1)=5.683735e+002; foe(n+1)=5.412576e+002; krok(n+1)=5.197516e-002; ng(n+1)=4.943783e+002;
n=6; farx(n+1)=5.543920e+002; foe(n+1)=5.244521e+002; krok(n+1)=6.332220e-002; ng(n+1)=4.689528e+002;
n=7; farx(n+1)=5.069800e+002; foe(n+1)=4.808553e+002; krok(n+1)=7.197563e-002; ng(n+1)=4.278603e+002;
n=8; farx(n+1)=5.208113e+002; foe(n+1)=4.462649e+002; krok(n+1)=2.527804e-002; ng(n+1)=6.898568e+002;
n=9; farx(n+1)=5.713751e+002; foe(n+1)=4.285867e+002; krok(n+1)=3.427774e-001; ng(n+1)=4.453045e+002;
n=10; farx(n+1)=5.121878e+002; foe(n+1)=4.156070e+002; krok(n+1)=1.561751e+000; ng(n+1)=3.286821e+002;
n=11; farx(n+1)=4.808140e+002; foe(n+1)=4.074391e+002; krok(n+1)=1.657803e+000; ng(n+1)=1.610990e+002;
n=12; farx(n+1)=5.077480e+002; foe(n+1)=4.053393e+002; krok(n+1)=1.397233e+000; ng(n+1)=7.736731e+001;
n=13; farx(n+1)=4.809549e+002; foe(n+1)=4.033024e+002; krok(n+1)=3.529274e+000; ng(n+1)=5.719671e+001;
n=14; farx(n+1)=2.726075e+002; foe(n+1)=3.817162e+002; krok(n+1)=1.325646e+001; ng(n+1)=2.192006e+001;
n=15; farx(n+1)=2.344612e+002; foe(n+1)=3.806931e+002; krok(n+1)=2.855545e-003; ng(n+1)=1.005122e+003;
n=16; farx(n+1)=1.372987e+002; foe(n+1)=3.682087e+002; krok(n+1)=3.655097e-001; ng(n+1)=1.363665e+003;
n=17; farx(n+1)=1.132409e+002; foe(n+1)=3.652793e+002; krok(n+1)=2.527804e-002; ng(n+1)=2.541372e+003;
n=18; farx(n+1)=9.939936e+001; foe(n+1)=3.349478e+002; krok(n+1)=5.312625e-001; ng(n+1)=3.106059e+003;
n=19; farx(n+1)=1.004322e+002; foe(n+1)=3.014052e+002; krok(n+1)=1.738735e-001; ng(n+1)=4.546660e+003;
n=20; farx(n+1)=1.079095e+002; foe(n+1)=2.788778e+002; krok(n+1)=1.339554e-001; ng(n+1)=4.473053e+003;
n=21; farx(n+1)=8.923665e+001; foe(n+1)=2.379597e+002; krok(n+1)=1.630613e-001; ng(n+1)=2.268644e+003;
n=22; farx(n+1)=7.762957e+001; foe(n+1)=2.029964e+002; krok(n+1)=2.320583e-001; ng(n+1)=1.317849e+003;
n=23; farx(n+1)=7.167277e+001; foe(n+1)=1.951532e+002; krok(n+1)=1.041001e-001; ng(n+1)=1.665040e+003;
n=24; farx(n+1)=4.049294e+001; foe(n+1)=1.566289e+002; krok(n+1)=8.620454e-001; ng(n+1)=4.047971e+003;
n=25; farx(n+1)=3.461837e+001; foe(n+1)=1.306581e+002; krok(n+1)=1.841052e+000; ng(n+1)=4.102691e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.401754e+001; foe(n+1)=1.290961e+002; krok(n+1)=1.190105e-006; ng(n+1)=2.642742e+003;
n=27; farx(n+1)=3.110609e+001; foe(n+1)=1.247564e+002; krok(n+1)=5.234435e-005; ng(n+1)=5.408473e+002;
n=28; farx(n+1)=2.530348e+001; foe(n+1)=1.175745e+002; krok(n+1)=4.338408e-004; ng(n+1)=1.053659e+003;
n=29; farx(n+1)=2.207151e+001; foe(n+1)=1.134024e+002; krok(n+1)=3.812868e-004; ng(n+1)=8.836760e+002;
n=30; farx(n+1)=2.374692e+001; foe(n+1)=1.063578e+002; krok(n+1)=2.028593e-003; ng(n+1)=1.972751e+003;
n=31; farx(n+1)=2.324689e+001; foe(n+1)=1.037721e+002; krok(n+1)=8.252536e-003; ng(n+1)=2.824581e+003;
n=32; farx(n+1)=1.568783e+001; foe(n+1)=9.447432e+001; krok(n+1)=1.846634e-001; ng(n+1)=2.246172e+003;
n=33; farx(n+1)=1.399079e+001; foe(n+1)=9.117872e+001; krok(n+1)=1.031837e+000; ng(n+1)=2.892687e+003;
n=34; farx(n+1)=1.376096e+001; foe(n+1)=9.050504e+001; krok(n+1)=8.298877e-002; ng(n+1)=2.086160e+003;
n=35; farx(n+1)=1.341054e+001; foe(n+1)=8.868494e+001; krok(n+1)=1.400181e-001; ng(n+1)=1.769805e+003;
n=36; farx(n+1)=1.286646e+001; foe(n+1)=8.555483e+001; krok(n+1)=1.092255e+000; ng(n+1)=8.253902e+002;
n=37; farx(n+1)=1.125553e+001; foe(n+1)=8.266769e+001; krok(n+1)=8.334333e-001; ng(n+1)=1.315524e+003;
n=38; farx(n+1)=1.151396e+001; foe(n+1)=8.195159e+001; krok(n+1)=1.230557e+000; ng(n+1)=2.454237e+002;
n=39; farx(n+1)=1.150393e+001; foe(n+1)=8.168528e+001; krok(n+1)=5.766634e-001; ng(n+1)=4.979656e+002;
n=40; farx(n+1)=1.141618e+001; foe(n+1)=8.161151e+001; krok(n+1)=6.888628e-001; ng(n+1)=1.461780e+002;
n=41; farx(n+1)=1.140108e+001; foe(n+1)=8.158850e+001; krok(n+1)=9.540683e-001; ng(n+1)=2.073086e+002;
n=42; farx(n+1)=1.134576e+001; foe(n+1)=8.158056e+001; krok(n+1)=8.377184e-001; ng(n+1)=2.361280e+001;
n=43; farx(n+1)=1.135503e+001; foe(n+1)=8.157887e+001; krok(n+1)=8.847528e-001; ng(n+1)=8.243096e+000;
n=44; farx(n+1)=1.132486e+001; foe(n+1)=8.157815e+001; krok(n+1)=1.919180e+000; ng(n+1)=4.224886e+000;
n=45; farx(n+1)=1.131595e+001; foe(n+1)=8.157672e+001; krok(n+1)=5.563951e+000; ng(n+1)=2.670330e+000;
n=46; farx(n+1)=1.131280e+001; foe(n+1)=8.157501e+001; krok(n+1)=2.018136e+000; ng(n+1)=3.534754e+001;
n=47; farx(n+1)=1.130510e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.145447e+000; ng(n+1)=1.150822e+001;
n=48; farx(n+1)=1.130432e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.104103e+000; ng(n+1)=1.099757e+000;
n=49; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.073054e+000; ng(n+1)=1.424487e-001;
n=50; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.104000e-005; ng(n+1)=1.239375e-003;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.130424e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.801229e-006; ng(n+1)=1.239361e-003;
n=52; farx(n+1)=1.130424e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.949585e-005; ng(n+1)=5.255143e-004;
n=53; farx(n+1)=1.130424e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.430061e-005; ng(n+1)=5.076796e-004;
n=54; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=4.279756e-005; ng(n+1)=5.069448e-004;
n=55; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=3.516207e-008; ng(n+1)=5.178607e-004;
n=56; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.357034e-007; ng(n+1)=5.178606e-004;
n=57; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=6.273258e-007; ng(n+1)=5.178606e-004;
n=58; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.718686e-006; ng(n+1)=5.178603e-004;
n=59; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.511523e-008; ng(n+1)=5.178591e-004;
n=60; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=4.179450e-008; ng(n+1)=5.178590e-004;
n=61; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.100139e-008; ng(n+1)=5.178590e-004;
n=62; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.337424e-006; ng(n+1)=5.178589e-004;
n=63; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=3.343560e-007; ng(n+1)=5.178581e-004;
n=64; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=8.801111e-008; ng(n+1)=5.178580e-004;
n=65; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.272056e-008; ng(n+1)=5.178580e-004;
n=66; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.346005e-007; ng(n+1)=5.178579e-004;
n=67; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=5.073086e-009; ng(n+1)=5.178579e-004;
n=68; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=5.692926e-006; ng(n+1)=5.178579e-004;
n=69; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.272696e-006; ng(n+1)=5.178346e-004;
n=70; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.305714e-007; ng(n+1)=5.178335e-004;
n=71; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=8.902316e-010; ng(n+1)=5.178335e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
