%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.046503e+003; foe(n+1)=4.046172e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.044210e+003; foe(n+1)=3.044809e+003; krok(n+1)=5.011162e-004; ng(n+1)=1.482562e+003;
n=2; farx(n+1)=3.043975e+003; foe(n+1)=3.044161e+003; krok(n+1)=6.180497e-004; ng(n+1)=5.705649e+001;
n=3; farx(n+1)=6.665826e+002; foe(n+1)=6.704723e+002; krok(n+1)=1.416892e-001; ng(n+1)=2.776578e+001;
n=4; farx(n+1)=6.667771e+002; foe(n+1)=6.700897e+002; krok(n+1)=1.005509e-006; ng(n+1)=1.726219e+003;
n=5; farx(n+1)=7.624269e+002; foe(n+1)=6.686247e+002; krok(n+1)=1.660195e-002; ng(n+1)=1.748876e+003;
n=6; farx(n+1)=4.517997e+002; foe(n+1)=5.456620e+002; krok(n+1)=7.461831e-001; ng(n+1)=1.600970e+003;
n=7; farx(n+1)=2.987556e+002; foe(n+1)=3.871420e+002; krok(n+1)=5.242823e-003; ng(n+1)=1.578362e+003;
n=8; farx(n+1)=2.760337e+002; foe(n+1)=3.261945e+002; krok(n+1)=1.361947e+000; ng(n+1)=6.196360e+002;
n=9; farx(n+1)=2.720321e+002; foe(n+1)=3.245761e+002; krok(n+1)=6.423218e-002; ng(n+1)=4.445329e+002;
n=10; farx(n+1)=2.218241e+002; foe(n+1)=2.803161e+002; krok(n+1)=6.762233e-001; ng(n+1)=4.299300e+002;
n=11; farx(n+1)=2.078456e+002; foe(n+1)=2.764153e+002; krok(n+1)=6.480438e-001; ng(n+1)=1.415605e+002;
n=12; farx(n+1)=2.092845e+002; foe(n+1)=2.734895e+002; krok(n+1)=8.295027e-001; ng(n+1)=1.762373e+002;
n=13; farx(n+1)=1.738394e+002; foe(n+1)=2.640446e+002; krok(n+1)=3.108763e+000; ng(n+1)=1.250359e+002;
n=14; farx(n+1)=1.242775e+002; foe(n+1)=2.545079e+002; krok(n+1)=6.871474e-001; ng(n+1)=5.724757e+002;
n=15; farx(n+1)=7.994149e+001; foe(n+1)=2.285706e+002; krok(n+1)=4.063898e-001; ng(n+1)=8.277587e+002;
n=16; farx(n+1)=7.089895e+001; foe(n+1)=2.038641e+002; krok(n+1)=2.272257e-001; ng(n+1)=5.626322e+002;
n=17; farx(n+1)=4.812070e+001; foe(n+1)=1.789571e+002; krok(n+1)=6.477968e-001; ng(n+1)=1.298326e+003;
n=18; farx(n+1)=4.608078e+001; foe(n+1)=1.652039e+002; krok(n+1)=1.136129e-001; ng(n+1)=3.711317e+002;
n=19; farx(n+1)=3.831611e+001; foe(n+1)=1.569889e+002; krok(n+1)=2.987477e-001; ng(n+1)=6.621876e+002;
n=20; farx(n+1)=3.462450e+001; foe(n+1)=1.417356e+002; krok(n+1)=8.536620e-001; ng(n+1)=2.505542e+002;
n=21; farx(n+1)=3.028481e+001; foe(n+1)=1.354636e+002; krok(n+1)=1.120145e+000; ng(n+1)=6.079448e+002;
n=22; farx(n+1)=3.240055e+001; foe(n+1)=1.288137e+002; krok(n+1)=1.476581e+000; ng(n+1)=7.973234e+002;
n=23; farx(n+1)=3.172226e+001; foe(n+1)=1.258227e+002; krok(n+1)=5.810114e-001; ng(n+1)=5.275768e+002;
n=24; farx(n+1)=3.158683e+001; foe(n+1)=1.238771e+002; krok(n+1)=5.312625e-001; ng(n+1)=2.109630e+002;
n=25; farx(n+1)=3.111889e+001; foe(n+1)=1.235085e+002; krok(n+1)=3.691454e-001; ng(n+1)=4.463728e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.107687e+001; foe(n+1)=1.234271e+002; krok(n+1)=3.577324e-005; ng(n+1)=1.126925e+002;
n=27; farx(n+1)=3.135376e+001; foe(n+1)=1.233137e+002; krok(n+1)=3.395536e-005; ng(n+1)=1.124043e+002;
n=28; farx(n+1)=3.167458e+001; foe(n+1)=1.223633e+002; krok(n+1)=6.847610e-004; ng(n+1)=8.449483e+001;
n=29; farx(n+1)=3.096393e+001; foe(n+1)=1.214392e+002; krok(n+1)=7.383609e-004; ng(n+1)=7.270214e+001;
n=30; farx(n+1)=3.180262e+001; foe(n+1)=1.212172e+002; krok(n+1)=5.792131e-003; ng(n+1)=3.462891e+001;
n=31; farx(n+1)=3.180855e+001; foe(n+1)=1.212005e+002; krok(n+1)=7.007869e-003; ng(n+1)=6.091712e+001;
n=32; farx(n+1)=3.235003e+001; foe(n+1)=1.208255e+002; krok(n+1)=2.748589e+000; ng(n+1)=6.280178e+001;
n=33; farx(n+1)=1.242524e+001; foe(n+1)=9.620857e+001; krok(n+1)=1.644274e+001; ng(n+1)=1.118199e+002;
n=34; farx(n+1)=1.226593e+001; foe(n+1)=9.620170e+001; krok(n+1)=2.574102e-004; ng(n+1)=8.600199e+002;
n=35; farx(n+1)=9.838706e+000; foe(n+1)=9.166474e+001; krok(n+1)=1.508366e+000; ng(n+1)=8.639841e+002;
n=36; farx(n+1)=8.849033e+000; foe(n+1)=8.889439e+001; krok(n+1)=1.142810e+000; ng(n+1)=4.675469e+002;
n=37; farx(n+1)=7.917846e+000; foe(n+1)=8.523651e+001; krok(n+1)=3.854790e-001; ng(n+1)=1.303024e+003;
n=38; farx(n+1)=8.988439e+000; foe(n+1)=8.354047e+001; krok(n+1)=9.740223e-001; ng(n+1)=3.376699e+002;
n=39; farx(n+1)=9.186549e+000; foe(n+1)=8.327708e+001; krok(n+1)=5.520515e-001; ng(n+1)=3.205926e+002;
n=40; farx(n+1)=9.242708e+000; foe(n+1)=8.319665e+001; krok(n+1)=3.170262e-001; ng(n+1)=2.152660e+002;
n=41; farx(n+1)=9.354532e+000; foe(n+1)=8.308608e+001; krok(n+1)=8.159604e-001; ng(n+1)=1.150754e+002;
n=42; farx(n+1)=9.559185e+000; foe(n+1)=8.305192e+001; krok(n+1)=7.638023e-001; ng(n+1)=1.199055e+002;
n=43; farx(n+1)=9.588898e+000; foe(n+1)=8.303671e+001; krok(n+1)=1.569476e+000; ng(n+1)=1.763357e+001;
n=44; farx(n+1)=9.497914e+000; foe(n+1)=8.302569e+001; krok(n+1)=1.110293e+000; ng(n+1)=3.295065e+001;
n=45; farx(n+1)=9.418045e+000; foe(n+1)=8.301376e+001; krok(n+1)=9.017844e+000; ng(n+1)=3.193930e+001;
n=46; farx(n+1)=9.287264e+000; foe(n+1)=8.300845e+001; krok(n+1)=1.072007e+000; ng(n+1)=1.452264e+001;
n=47; farx(n+1)=9.191940e+000; foe(n+1)=8.300643e+001; krok(n+1)=1.216781e+000; ng(n+1)=1.322505e+001;
n=48; farx(n+1)=9.149134e+000; foe(n+1)=8.300577e+001; krok(n+1)=1.420334e+000; ng(n+1)=1.153236e+001;
n=49; farx(n+1)=9.137538e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.236644e+000; ng(n+1)=6.106585e+000;
n=50; farx(n+1)=9.134773e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.206369e+000; ng(n+1)=9.240084e-001;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.134761e+000; foe(n+1)=8.300561e+001; krok(n+1)=3.727126e-006; ng(n+1)=7.745947e-002;
n=52; farx(n+1)=9.134766e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.253024e-005; ng(n+1)=4.308251e-002;
n=53; farx(n+1)=9.134803e+000; foe(n+1)=8.300561e+001; krok(n+1)=8.161495e-005; ng(n+1)=2.335041e-002;
n=54; farx(n+1)=9.134766e+000; foe(n+1)=8.300561e+001; krok(n+1)=3.303815e-003; ng(n+1)=2.340288e-003;
n=55; farx(n+1)=9.134792e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.230843e-002; ng(n+1)=4.718807e-004;
n=56; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=9.439199e-003; ng(n+1)=4.248420e-004;
n=57; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.215525e-005; ng(n+1)=1.742681e-004;
n=58; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.994719e-005; ng(n+1)=1.742645e-004;
n=59; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.430061e-005; ng(n+1)=1.742593e-004;
n=60; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=9.573735e-006; ng(n+1)=1.742568e-004;
n=61; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.518562e-005; ng(n+1)=1.742551e-004;
n=62; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.244059e-006; ng(n+1)=1.742508e-004;
n=63; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=9.041299e-006; ng(n+1)=1.742505e-004;
n=64; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=4.133289e-006; ng(n+1)=1.742489e-004;
n=65; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=4.099979e-006; ng(n+1)=1.742482e-004;
n=66; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.233885e-006; ng(n+1)=1.742475e-004;
n=67; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=3.547574e-009; ng(n+1)=1.742473e-004;
n=68; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=7.868501e-008; ng(n+1)=1.742473e-004;
n=69; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=4.222034e-011; ng(n+1)=1.742473e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=70; farx(n+1)=9.134785e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.766627e-012; ng(n+1)=1.742473e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
