%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.935921e+003; foe(n+1)=3.988810e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.929406e+003; foe(n+1)=2.981746e+003; krok(n+1)=4.988661e-004; ng(n+1)=1.883013e+003;
n=2; farx(n+1)=9.188148e+002; foe(n+1)=9.941226e+002; krok(n+1)=5.000456e-003; ng(n+1)=6.081303e+002;
n=3; farx(n+1)=9.694428e+002; foe(n+1)=8.825011e+002; krok(n+1)=4.037383e-005; ng(n+1)=4.214671e+003;
n=4; farx(n+1)=2.230505e+003; foe(n+1)=7.956489e+002; krok(n+1)=3.868579e-003; ng(n+1)=4.074133e+003;
n=5; farx(n+1)=2.585392e+003; foe(n+1)=7.863585e+002; krok(n+1)=2.118327e-003; ng(n+1)=2.013232e+003;
n=6; farx(n+1)=2.651798e+003; foe(n+1)=7.676262e+002; krok(n+1)=1.378623e-002; ng(n+1)=1.719619e+003;
n=7; farx(n+1)=1.039089e+003; foe(n+1)=5.877675e+002; krok(n+1)=3.136529e-001; ng(n+1)=1.669363e+003;
n=8; farx(n+1)=6.328334e+002; foe(n+1)=5.155468e+002; krok(n+1)=2.811708e-002; ng(n+1)=1.468454e+003;
n=9; farx(n+1)=3.007585e+002; foe(n+1)=4.092827e+002; krok(n+1)=2.176811e-001; ng(n+1)=2.692060e+003;
n=10; farx(n+1)=3.237889e+002; foe(n+1)=3.820115e+002; krok(n+1)=5.861088e-001; ng(n+1)=7.414017e+002;
n=11; farx(n+1)=1.111961e+002; foe(n+1)=3.291928e+002; krok(n+1)=1.569476e+000; ng(n+1)=5.256464e+002;
n=12; farx(n+1)=5.129992e+001; foe(n+1)=2.281202e+002; krok(n+1)=8.975140e-001; ng(n+1)=9.329999e+002;
n=13; farx(n+1)=4.854422e+001; foe(n+1)=2.254609e+002; krok(n+1)=5.985461e-002; ng(n+1)=1.145320e+003;
n=14; farx(n+1)=2.755060e+001; foe(n+1)=1.794475e+002; krok(n+1)=2.073757e-001; ng(n+1)=2.873492e+003;
n=15; farx(n+1)=2.585458e+001; foe(n+1)=1.588579e+002; krok(n+1)=4.584756e-001; ng(n+1)=7.027396e+002;
n=16; farx(n+1)=2.961741e+001; foe(n+1)=1.336348e+002; krok(n+1)=1.030870e+000; ng(n+1)=8.559508e+002;
n=17; farx(n+1)=2.865904e+001; foe(n+1)=1.256153e+002; krok(n+1)=1.104103e+000; ng(n+1)=1.639656e+003;
n=18; farx(n+1)=2.654633e+001; foe(n+1)=1.215952e+002; krok(n+1)=4.033988e-001; ng(n+1)=1.217766e+003;
n=19; farx(n+1)=2.712714e+001; foe(n+1)=1.173909e+002; krok(n+1)=2.018136e+000; ng(n+1)=4.511084e+002;
n=20; farx(n+1)=2.677486e+001; foe(n+1)=1.142262e+002; krok(n+1)=3.996376e+000; ng(n+1)=2.922479e+002;
n=21; farx(n+1)=1.937666e+001; foe(n+1)=1.090523e+002; krok(n+1)=5.079754e-001; ng(n+1)=5.263944e+002;
n=22; farx(n+1)=1.425917e+001; foe(n+1)=1.053943e+002; krok(n+1)=5.107206e-001; ng(n+1)=6.844181e+002;
n=23; farx(n+1)=1.487329e+001; foe(n+1)=1.003594e+002; krok(n+1)=4.090511e-001; ng(n+1)=7.037191e+002;
n=24; farx(n+1)=1.214942e+001; foe(n+1)=9.570090e+001; krok(n+1)=5.520515e-001; ng(n+1)=7.557024e+002;
n=25; farx(n+1)=1.194069e+001; foe(n+1)=9.343866e+001; krok(n+1)=1.119298e+000; ng(n+1)=1.011720e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.202962e+001; foe(n+1)=9.334522e+001; krok(n+1)=2.671200e-005; ng(n+1)=1.376569e+002;
n=27; farx(n+1)=1.147390e+001; foe(n+1)=9.300408e+001; krok(n+1)=7.219457e-005; ng(n+1)=1.657266e+002;
n=28; farx(n+1)=1.130559e+001; foe(n+1)=9.245757e+001; krok(n+1)=9.874235e-005; ng(n+1)=1.732427e+002;
n=29; farx(n+1)=1.081140e+001; foe(n+1)=8.927312e+001; krok(n+1)=1.635770e-003; ng(n+1)=9.353944e+001;
n=30; farx(n+1)=1.119889e+001; foe(n+1)=8.880171e+001; krok(n+1)=7.431661e-003; ng(n+1)=7.307607e+002;
n=31; farx(n+1)=1.080988e+001; foe(n+1)=8.867462e+001; krok(n+1)=1.260621e-002; ng(n+1)=8.233454e+002;
n=32; farx(n+1)=1.046751e+001; foe(n+1)=8.758290e+001; krok(n+1)=4.171530e-002; ng(n+1)=9.952454e+002;
n=33; farx(n+1)=9.869936e+000; foe(n+1)=8.425744e+001; krok(n+1)=1.659005e+000; ng(n+1)=1.027218e+003;
n=34; farx(n+1)=1.008293e+001; foe(n+1)=8.357750e+001; krok(n+1)=4.953016e-001; ng(n+1)=3.670815e+002;
n=35; farx(n+1)=1.003864e+001; foe(n+1)=8.354110e+001; krok(n+1)=5.051878e-002; ng(n+1)=2.327601e+002;
n=36; farx(n+1)=9.998551e+000; foe(n+1)=8.330272e+001; krok(n+1)=1.655202e-001; ng(n+1)=2.783435e+002;
n=37; farx(n+1)=9.873016e+000; foe(n+1)=8.326700e+001; krok(n+1)=1.146189e-001; ng(n+1)=1.830385e+002;
n=38; farx(n+1)=9.985129e+000; foe(n+1)=8.311784e+001; krok(n+1)=1.454604e+000; ng(n+1)=1.196302e+002;
n=39; farx(n+1)=9.972696e+000; foe(n+1)=8.306866e+001; krok(n+1)=3.072232e-001; ng(n+1)=8.927679e+001;
n=40; farx(n+1)=9.976811e+000; foe(n+1)=8.305346e+001; krok(n+1)=4.556164e-001; ng(n+1)=5.787595e+001;
n=41; farx(n+1)=1.001358e+001; foe(n+1)=8.304821e+001; krok(n+1)=5.183452e-001; ng(n+1)=2.711466e+001;
n=42; farx(n+1)=1.001069e+001; foe(n+1)=8.304697e+001; krok(n+1)=9.270274e-001; ng(n+1)=2.928726e+001;
n=43; farx(n+1)=1.000332e+001; foe(n+1)=8.304652e+001; krok(n+1)=9.775646e-001; ng(n+1)=8.833812e+000;
n=44; farx(n+1)=1.000449e+001; foe(n+1)=8.304647e+001; krok(n+1)=1.872544e+000; ng(n+1)=4.402163e+000;
n=45; farx(n+1)=1.000466e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.505130e+000; ng(n+1)=3.075624e-001;
n=46; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.310660e+000; ng(n+1)=1.846584e-001;
n=47; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=5.760506e-005; ng(n+1)=1.603886e-002;
n=48; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=6.997602e-007; ng(n+1)=1.603802e-002;
n=49; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.919345e-010; ng(n+1)=1.603801e-002;
n=50; farx(n+1)=1.000504e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.423860e-001; ng(n+1)=1.603801e-002;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.000504e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.223696e-006; ng(n+1)=7.492527e-003;
n=52; farx(n+1)=1.000504e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.405480e-005; ng(n+1)=3.942169e-003;
n=53; farx(n+1)=1.000504e+001; foe(n+1)=8.304646e+001; krok(n+1)=9.172421e-005; ng(n+1)=4.889694e-003;
n=54; farx(n+1)=1.000504e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.578785e-004; ng(n+1)=9.360129e-004;
n=55; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=9.582317e-004; ng(n+1)=7.416040e-004;
n=56; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=7.150304e-006; ng(n+1)=2.397853e-004;
n=57; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=9.952471e-006; ng(n+1)=2.397098e-004;
n=58; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.197415e-005; ng(n+1)=2.397047e-004;
n=59; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.430061e-005; ng(n+1)=2.397017e-004;
n=60; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.496279e-005; ng(n+1)=2.396983e-004;
n=61; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.290795e-005; ng(n+1)=2.396947e-004;
n=62; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.003293e-010; ng(n+1)=2.396868e-004;
n=63; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=8.212040e-006; ng(n+1)=2.396868e-004;
n=64; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.478455e-006; ng(n+1)=2.397731e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=65; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.558915e-011; ng(n+1)=2.397706e-004;
n=66; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.199261e-009; ng(n+1)=2.397682e-004;
n=67; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.423805e-004; ng(n+1)=2.397678e-004;
n=68; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.247399e-004; ng(n+1)=4.465669e-004;
n=69; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.213736e-006; ng(n+1)=4.111290e-004;
n=70; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.639991e-005; ng(n+1)=4.110444e-004;
n=71; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.810840e-005; ng(n+1)=4.109848e-004;
n=72; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.363469e-005; ng(n+1)=4.109980e-004;
n=73; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.718339e-010; ng(n+1)=4.109923e-004;
n=74; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.567766e-008; ng(n+1)=4.109923e-004;
n=75; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.164203e-010; ng(n+1)=4.109923e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=6.216534e-013; ng(n+1)=4.109923e-004;
n=77; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.621284e-005; ng(n+1)=4.109923e-004;
n=78; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.124859e-005; ng(n+1)=3.331546e-004;
n=79; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.448771e-006; ng(n+1)=2.840693e-004;
n=80; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.155324e-005; ng(n+1)=2.829779e-004;
n=81; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=9.718124e-007; ng(n+1)=2.920317e-004;
n=82; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.453926e-005; ng(n+1)=2.918657e-004;
n=83; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.720017e-005; ng(n+1)=2.909226e-004;
n=84; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.784303e-005; ng(n+1)=2.909119e-004;
n=85; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.404406e-009; ng(n+1)=2.909042e-004;
n=86; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=6.642837e-010; ng(n+1)=2.909042e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=87; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.461631e-013; ng(n+1)=2.909041e-004;
n=88; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.342943e-012; ng(n+1)=2.909041e-004;
n=89; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.044632e-011; ng(n+1)=2.909041e-004;
n=90; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.611579e-012; ng(n+1)=2.909041e-004;
n=91; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.832194e-012; ng(n+1)=2.909041e-004;
 % z造 kierunek w metodzie zm - odnowa 
 % z造 kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
