%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.102619e+003; foe(n+1)=4.065770e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.949887e+003; foe(n+1)=2.962662e+003; krok(n+1)=4.957630e-004; ng(n+1)=3.605485e+003;
n=2; farx(n+1)=1.136275e+003; foe(n+1)=1.070273e+003; krok(n+1)=3.799123e-003; ng(n+1)=1.604613e+003;
n=3; farx(n+1)=1.223360e+003; foe(n+1)=9.053310e+002; krok(n+1)=9.675577e-005; ng(n+1)=6.237035e+003;
n=4; farx(n+1)=2.126702e+003; foe(n+1)=6.756872e+002; krok(n+1)=2.373838e-003; ng(n+1)=7.336659e+003;
n=5; farx(n+1)=2.464597e+003; foe(n+1)=6.328419e+002; krok(n+1)=2.232051e-003; ng(n+1)=1.739096e+003;
n=6; farx(n+1)=9.070310e+002; foe(n+1)=3.937439e+002; krok(n+1)=1.748904e-002; ng(n+1)=9.380232e+002;
n=7; farx(n+1)=8.036693e+002; foe(n+1)=3.819081e+002; krok(n+1)=2.914486e-004; ng(n+1)=8.840997e+002;
n=8; farx(n+1)=7.181474e+002; foe(n+1)=3.665923e+002; krok(n+1)=3.373181e-003; ng(n+1)=3.105911e+002;
n=9; farx(n+1)=6.643509e+002; foe(n+1)=3.607915e+002; krok(n+1)=1.389400e-003; ng(n+1)=6.439738e+002;
n=10; farx(n+1)=6.268249e+002; foe(n+1)=3.535268e+002; krok(n+1)=3.739948e-003; ng(n+1)=8.174127e+002;
n=11; farx(n+1)=5.054990e+002; foe(n+1)=3.258976e+002; krok(n+1)=1.571523e-002; ng(n+1)=7.492716e+002;
n=12; farx(n+1)=3.997019e+002; foe(n+1)=3.051062e+002; krok(n+1)=2.900817e-003; ng(n+1)=8.972154e+002;
n=13; farx(n+1)=3.524444e+002; foe(n+1)=2.946824e+002; krok(n+1)=1.986798e-003; ng(n+1)=1.505509e+003;
n=14; farx(n+1)=3.277751e+002; foe(n+1)=2.899413e+002; krok(n+1)=8.790130e-004; ng(n+1)=2.220271e+003;
n=15; farx(n+1)=2.557107e+002; foe(n+1)=2.604310e+002; krok(n+1)=1.488559e-002; ng(n+1)=2.573482e+003;
n=16; farx(n+1)=2.505554e+002; foe(n+1)=2.588452e+002; krok(n+1)=1.078966e-004; ng(n+1)=2.857883e+003;
n=17; farx(n+1)=2.448335e+002; foe(n+1)=2.562798e+002; krok(n+1)=1.463096e-003; ng(n+1)=4.650977e+003;
n=18; farx(n+1)=2.346078e+002; foe(n+1)=2.440024e+002; krok(n+1)=6.607631e-003; ng(n+1)=2.694762e+003;
n=19; farx(n+1)=2.289488e+002; foe(n+1)=2.366185e+002; krok(n+1)=7.937301e-004; ng(n+1)=3.607714e+003;
n=20; farx(n+1)=2.113217e+002; foe(n+1)=2.335043e+002; krok(n+1)=4.892037e-003; ng(n+1)=3.794319e+003;
n=21; farx(n+1)=1.262810e+002; foe(n+1)=2.107691e+002; krok(n+1)=1.096481e-001; ng(n+1)=5.297584e+003;
n=22; farx(n+1)=8.792597e+001; foe(n+1)=1.323175e+002; krok(n+1)=2.537821e-002; ng(n+1)=3.548044e+003;
n=23; farx(n+1)=8.761320e+001; foe(n+1)=1.304632e+002; krok(n+1)=1.387045e-003; ng(n+1)=2.620736e+003;
n=24; farx(n+1)=3.285385e+001; foe(n+1)=6.406823e+001; krok(n+1)=5.483245e-002; ng(n+1)=2.659780e+003;
n=25; farx(n+1)=2.790235e+001; foe(n+1)=5.455954e+001; krok(n+1)=2.145173e-003; ng(n+1)=2.525492e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.763252e+001; foe(n+1)=5.408352e+001; krok(n+1)=1.171829e-005; ng(n+1)=6.585257e+002;
n=27; farx(n+1)=2.710447e+001; foe(n+1)=5.288639e+001; krok(n+1)=9.773946e-005; ng(n+1)=3.816142e+002;
n=28; farx(n+1)=2.474811e+001; foe(n+1)=5.004950e+001; krok(n+1)=4.927090e-004; ng(n+1)=2.463371e+002;
n=29; farx(n+1)=2.733168e+001; foe(n+1)=4.740515e+001; krok(n+1)=3.301872e-004; ng(n+1)=6.069163e+002;
n=30; farx(n+1)=2.860626e+001; foe(n+1)=4.525397e+001; krok(n+1)=9.516502e-004; ng(n+1)=1.167328e+003;
n=31; farx(n+1)=2.820301e+001; foe(n+1)=4.204757e+001; krok(n+1)=1.006709e-003; ng(n+1)=2.052680e+003;
n=32; farx(n+1)=3.059960e+001; foe(n+1)=3.939505e+001; krok(n+1)=3.816075e-003; ng(n+1)=2.405938e+003;
n=33; farx(n+1)=2.833453e+001; foe(n+1)=3.666636e+001; krok(n+1)=2.621411e-003; ng(n+1)=1.267779e+003;
n=34; farx(n+1)=2.769645e+001; foe(n+1)=3.550642e+001; krok(n+1)=1.308315e-003; ng(n+1)=1.143332e+003;
n=35; farx(n+1)=2.824060e+001; foe(n+1)=3.415076e+001; krok(n+1)=1.961876e-002; ng(n+1)=1.088143e+003;
n=36; farx(n+1)=2.618512e+001; foe(n+1)=2.973590e+001; krok(n+1)=3.800897e-002; ng(n+1)=1.031525e+003;
n=37; farx(n+1)=2.892507e+001; foe(n+1)=2.824633e+001; krok(n+1)=1.450364e-002; ng(n+1)=5.987865e+002;
n=38; farx(n+1)=3.277971e+001; foe(n+1)=2.484611e+001; krok(n+1)=3.403861e-002; ng(n+1)=5.738283e+002;
n=39; farx(n+1)=2.588015e+001; foe(n+1)=2.250540e+001; krok(n+1)=3.497807e-002; ng(n+1)=3.020385e+002;
n=40; farx(n+1)=2.409796e+001; foe(n+1)=2.181873e+001; krok(n+1)=5.482403e-002; ng(n+1)=8.462616e+002;
n=41; farx(n+1)=2.337320e+001; foe(n+1)=1.959950e+001; krok(n+1)=1.081188e-001; ng(n+1)=3.931267e+002;
n=42; farx(n+1)=2.625673e+001; foe(n+1)=1.793528e+001; krok(n+1)=1.465586e-001; ng(n+1)=2.049992e+002;
n=43; farx(n+1)=1.905776e+001; foe(n+1)=1.561096e+001; krok(n+1)=1.569501e-001; ng(n+1)=1.719916e+002;
n=44; farx(n+1)=1.730996e+001; foe(n+1)=1.434100e+001; krok(n+1)=2.357265e-001; ng(n+1)=1.936449e+002;
n=45; farx(n+1)=1.707737e+001; foe(n+1)=1.392147e+001; krok(n+1)=1.310933e-001; ng(n+1)=4.412511e+002;
n=46; farx(n+1)=1.581906e+001; foe(n+1)=1.289403e+001; krok(n+1)=6.639102e-001; ng(n+1)=2.861629e+002;
n=47; farx(n+1)=1.658792e+001; foe(n+1)=1.260569e+001; krok(n+1)=1.414327e-001; ng(n+1)=1.486080e+002;
n=48; farx(n+1)=1.527346e+001; foe(n+1)=1.215857e+001; krok(n+1)=5.520515e-001; ng(n+1)=9.224769e+001;
n=49; farx(n+1)=1.382459e+001; foe(n+1)=1.125197e+001; krok(n+1)=7.970783e-001; ng(n+1)=1.227624e+002;
n=50; farx(n+1)=1.349564e+001; foe(n+1)=1.111220e+001; krok(n+1)=5.382558e-002; ng(n+1)=2.507761e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.348700e+001; foe(n+1)=1.109819e+001; krok(n+1)=1.390431e-005; ng(n+1)=1.112423e+002;
n=52; farx(n+1)=1.368550e+001; foe(n+1)=1.097497e+001; krok(n+1)=2.178332e-004; ng(n+1)=8.895143e+001;
n=53; farx(n+1)=1.369965e+001; foe(n+1)=1.091226e+001; krok(n+1)=3.050122e-004; ng(n+1)=5.502302e+001;
n=54; farx(n+1)=1.357069e+001; foe(n+1)=1.085694e+001; krok(n+1)=5.465324e-004; ng(n+1)=6.923792e+001;
n=55; farx(n+1)=1.367111e+001; foe(n+1)=1.068641e+001; krok(n+1)=2.926191e-003; ng(n+1)=1.650551e+002;
n=56; farx(n+1)=1.383286e+001; foe(n+1)=1.043786e+001; krok(n+1)=1.908037e-003; ng(n+1)=1.027939e+002;
n=57; farx(n+1)=1.274078e+001; foe(n+1)=1.010021e+001; krok(n+1)=2.404573e-003; ng(n+1)=1.298256e+002;
n=58; farx(n+1)=1.278715e+001; foe(n+1)=9.854390e+000; krok(n+1)=3.698907e-003; ng(n+1)=1.030143e+002;
n=59; farx(n+1)=1.285947e+001; foe(n+1)=9.819872e+000; krok(n+1)=5.346341e-003; ng(n+1)=2.692801e+002;
n=60; farx(n+1)=1.242407e+001; foe(n+1)=9.749101e+000; krok(n+1)=3.582758e-002; ng(n+1)=1.288805e+002;
n=61; farx(n+1)=1.141577e+001; foe(n+1)=9.368043e+000; krok(n+1)=7.406706e-002; ng(n+1)=1.296272e+002;
n=62; farx(n+1)=1.102085e+001; foe(n+1)=9.221782e+000; krok(n+1)=6.485153e-003; ng(n+1)=1.526579e+002;
n=63; farx(n+1)=9.384012e+000; foe(n+1)=8.786609e+000; krok(n+1)=1.221144e-001; ng(n+1)=1.554828e+002;
n=64; farx(n+1)=8.563882e+000; foe(n+1)=8.450027e+000; krok(n+1)=3.586741e-002; ng(n+1)=2.501097e+002;
n=65; farx(n+1)=6.707318e+000; foe(n+1)=7.881008e+000; krok(n+1)=1.440814e-001; ng(n+1)=6.045796e+002;
n=66; farx(n+1)=5.263876e+000; foe(n+1)=6.828942e+000; krok(n+1)=1.361691e-001; ng(n+1)=3.282279e+002;
n=67; farx(n+1)=4.446208e+000; foe(n+1)=6.438494e+000; krok(n+1)=2.064051e-001; ng(n+1)=2.114564e+002;
n=68; farx(n+1)=4.180245e+000; foe(n+1)=6.067001e+000; krok(n+1)=1.191056e-001; ng(n+1)=4.128395e+001;
n=69; farx(n+1)=4.217064e+000; foe(n+1)=5.950658e+000; krok(n+1)=6.601690e-002; ng(n+1)=2.058594e+002;
n=70; farx(n+1)=4.338358e+000; foe(n+1)=5.791508e+000; krok(n+1)=1.478545e-001; ng(n+1)=6.909533e+001;
n=71; farx(n+1)=4.293034e+000; foe(n+1)=5.510395e+000; krok(n+1)=8.043035e-001; ng(n+1)=2.683712e+002;
n=72; farx(n+1)=4.226095e+000; foe(n+1)=5.422038e+000; krok(n+1)=3.170262e-001; ng(n+1)=1.675174e+002;
n=73; farx(n+1)=3.826517e+000; foe(n+1)=5.223177e+000; krok(n+1)=6.455021e-001; ng(n+1)=5.243138e+001;
n=74; farx(n+1)=3.672253e+000; foe(n+1)=5.035939e+000; krok(n+1)=2.230786e-001; ng(n+1)=3.084640e+002;
n=75; farx(n+1)=3.511835e+000; foe(n+1)=4.770004e+000; krok(n+1)=1.021441e+000; ng(n+1)=1.181917e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=3.509693e+000; foe(n+1)=4.753521e+000; krok(n+1)=5.705403e-006; ng(n+1)=1.630192e+002;
n=77; farx(n+1)=3.485611e+000; foe(n+1)=4.731076e+000; krok(n+1)=4.341873e-005; ng(n+1)=7.669271e+001;
n=78; farx(n+1)=3.482758e+000; foe(n+1)=4.723572e+000; krok(n+1)=1.381179e-004; ng(n+1)=2.678474e+001;
n=79; farx(n+1)=3.452919e+000; foe(n+1)=4.694308e+000; krok(n+1)=6.807228e-004; ng(n+1)=2.154165e+001;
n=80; farx(n+1)=3.430126e+000; foe(n+1)=4.623299e+000; krok(n+1)=1.736904e-003; ng(n+1)=2.223331e+001;
n=81; farx(n+1)=3.481383e+000; foe(n+1)=4.572702e+000; krok(n+1)=2.403018e-003; ng(n+1)=2.326981e+001;
n=82; farx(n+1)=3.555400e+000; foe(n+1)=4.499191e+000; krok(n+1)=1.772025e-003; ng(n+1)=6.863637e+001;
n=83; farx(n+1)=3.491055e+000; foe(n+1)=4.471256e+000; krok(n+1)=1.525264e-002; ng(n+1)=1.883479e+002;
n=84; farx(n+1)=3.501316e+000; foe(n+1)=4.456018e+000; krok(n+1)=9.078303e-003; ng(n+1)=2.866171e+002;
n=85; farx(n+1)=3.631300e+000; foe(n+1)=4.417418e+000; krok(n+1)=3.211609e-002; ng(n+1)=3.127596e+002;
n=86; farx(n+1)=3.576333e+000; foe(n+1)=4.357966e+000; krok(n+1)=1.502985e-001; ng(n+1)=2.394280e+002;
n=87; farx(n+1)=3.640962e+000; foe(n+1)=4.210427e+000; krok(n+1)=6.864555e-002; ng(n+1)=2.245018e+002;
n=88; farx(n+1)=3.199011e+000; foe(n+1)=4.039742e+000; krok(n+1)=8.268560e-002; ng(n+1)=7.576268e+001;
n=89; farx(n+1)=3.113296e+000; foe(n+1)=3.973321e+000; krok(n+1)=6.192665e-002; ng(n+1)=6.958879e+001;
n=90; farx(n+1)=2.747261e+000; foe(n+1)=3.809694e+000; krok(n+1)=1.380129e-001; ng(n+1)=1.973466e+002;
n=91; farx(n+1)=2.651375e+000; foe(n+1)=3.743459e+000; krok(n+1)=2.022243e-001; ng(n+1)=1.504339e+002;
n=92; farx(n+1)=2.608545e+000; foe(n+1)=3.645296e+000; krok(n+1)=5.191100e-001; ng(n+1)=1.640619e+002;
n=93; farx(n+1)=2.502634e+000; foe(n+1)=3.582866e+000; krok(n+1)=2.800362e-001; ng(n+1)=3.618334e+002;
n=94; farx(n+1)=2.420580e+000; foe(n+1)=3.460338e+000; krok(n+1)=8.704303e-001; ng(n+1)=1.346743e+002;
n=95; farx(n+1)=2.395320e+000; foe(n+1)=3.373743e+000; krok(n+1)=5.491644e-001; ng(n+1)=1.000744e+002;
n=96; farx(n+1)=2.397041e+000; foe(n+1)=3.333728e+000; krok(n+1)=2.567670e-001; ng(n+1)=2.814276e+002;
n=97; farx(n+1)=2.142472e+000; foe(n+1)=3.212801e+000; krok(n+1)=9.469203e-001; ng(n+1)=1.535784e+002;
n=98; farx(n+1)=1.999821e+000; foe(n+1)=3.118740e+000; krok(n+1)=7.310195e-001; ng(n+1)=1.575537e+002;
n=99; farx(n+1)=1.924302e+000; foe(n+1)=3.070565e+000; krok(n+1)=1.525604e-001; ng(n+1)=3.071261e+002;
n=100; farx(n+1)=1.892117e+000; foe(n+1)=2.984679e+000; krok(n+1)=3.614383e-001; ng(n+1)=3.338615e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
