%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.538922e+003; foe(n+1)=4.774283e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.958128e+003; foe(n+1)=3.029919e+003; krok(n+1)=4.494798e-004; ng(n+1)=6.099585e+003;
n=2; farx(n+1)=1.875213e+003; foe(n+1)=2.470940e+003; krok(n+1)=3.363630e-003; ng(n+1)=1.134038e+003;
n=3; farx(n+1)=5.630728e+003; foe(n+1)=1.305663e+003; krok(n+1)=2.501510e-004; ng(n+1)=1.199754e+004;
n=4; farx(n+1)=5.870246e+003; foe(n+1)=1.139909e+003; krok(n+1)=7.794783e-006; ng(n+1)=1.704245e+004;
n=5; farx(n+1)=5.970987e+003; foe(n+1)=1.043697e+003; krok(n+1)=1.042068e-004; ng(n+1)=9.733440e+003;
n=6; farx(n+1)=1.934346e+003; foe(n+1)=5.555039e+002; krok(n+1)=4.653602e-003; ng(n+1)=8.406032e+003;
n=7; farx(n+1)=1.642321e+003; foe(n+1)=4.588348e+002; krok(n+1)=8.683747e-005; ng(n+1)=8.210468e+003;
n=8; farx(n+1)=1.606687e+003; foe(n+1)=4.519147e+002; krok(n+1)=5.252174e-004; ng(n+1)=2.258251e+003;
n=9; farx(n+1)=1.152398e+003; foe(n+1)=3.972781e+002; krok(n+1)=1.595033e-003; ng(n+1)=2.110182e+003;
n=10; farx(n+1)=1.117255e+003; foe(n+1)=3.827313e+002; krok(n+1)=1.127391e-003; ng(n+1)=2.307668e+003;
n=11; farx(n+1)=9.122692e+002; foe(n+1)=3.565793e+002; krok(n+1)=2.804162e-003; ng(n+1)=1.076529e+003;
n=12; farx(n+1)=8.324028e+002; foe(n+1)=3.449845e+002; krok(n+1)=1.130654e-003; ng(n+1)=2.849585e+003;
n=13; farx(n+1)=2.373067e+002; foe(n+1)=2.350549e+002; krok(n+1)=9.344559e-003; ng(n+1)=1.407746e+003;
n=14; farx(n+1)=2.298631e+002; foe(n+1)=2.339939e+002; krok(n+1)=8.887598e-006; ng(n+1)=1.577913e+004;
n=15; farx(n+1)=2.117418e+002; foe(n+1)=2.298024e+002; krok(n+1)=3.870231e-004; ng(n+1)=2.297611e+004;
n=16; farx(n+1)=1.330220e+002; foe(n+1)=1.846742e+002; krok(n+1)=3.303815e-003; ng(n+1)=9.655603e+003;
n=17; farx(n+1)=1.260626e+002; foe(n+1)=1.816342e+002; krok(n+1)=9.579321e-005; ng(n+1)=9.176837e+003;
n=18; farx(n+1)=1.012782e+002; foe(n+1)=1.413734e+002; krok(n+1)=1.427772e-003; ng(n+1)=5.478537e+003;
n=19; farx(n+1)=9.943550e+001; foe(n+1)=1.387634e+002; krok(n+1)=6.756687e-005; ng(n+1)=1.763667e+004;
n=20; farx(n+1)=1.004709e+002; foe(n+1)=1.382652e+002; krok(n+1)=4.526501e-004; ng(n+1)=1.858625e+004;
n=21; farx(n+1)=7.454088e+001; foe(n+1)=1.282045e+002; krok(n+1)=6.815891e-003; ng(n+1)=2.119536e+004;
n=22; farx(n+1)=7.359734e+001; foe(n+1)=1.277120e+002; krok(n+1)=4.396667e-005; ng(n+1)=4.523126e+004;
n=23; farx(n+1)=5.674822e+001; foe(n+1)=1.139449e+002; krok(n+1)=1.216567e-003; ng(n+1)=4.128737e+004;
n=24; farx(n+1)=4.589094e+001; foe(n+1)=1.029252e+002; krok(n+1)=5.214412e-003; ng(n+1)=3.090693e+004;
n=25; farx(n+1)=4.264251e+001; foe(n+1)=9.899358e+001; krok(n+1)=5.361410e-004; ng(n+1)=4.013482e+004;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.218115e+001; foe(n+1)=9.278434e+001; krok(n+1)=3.072913e-008; ng(n+1)=4.063157e+004;
n=27; farx(n+1)=4.252452e+001; foe(n+1)=8.247345e+001; krok(n+1)=1.251494e-006; ng(n+1)=1.221518e+004;
n=28; farx(n+1)=4.469030e+001; foe(n+1)=7.795633e+001; krok(n+1)=8.112714e-006; ng(n+1)=1.199395e+004;
n=29; farx(n+1)=4.466499e+001; foe(n+1)=7.711646e+001; krok(n+1)=6.755832e-006; ng(n+1)=1.438230e+003;
n=30; farx(n+1)=4.568470e+001; foe(n+1)=7.268552e+001; krok(n+1)=2.639619e-005; ng(n+1)=2.858429e+003;
n=31; farx(n+1)=4.055043e+001; foe(n+1)=6.504779e+001; krok(n+1)=3.473499e-004; ng(n+1)=5.028162e+003;
n=32; farx(n+1)=3.730179e+001; foe(n+1)=6.113535e+001; krok(n+1)=3.127269e-004; ng(n+1)=1.944496e+004;
n=33; farx(n+1)=2.868157e+001; foe(n+1)=5.233973e+001; krok(n+1)=5.064437e-004; ng(n+1)=1.446668e+004;
n=34; farx(n+1)=2.640976e+001; foe(n+1)=5.079311e+001; krok(n+1)=1.093891e-003; ng(n+1)=1.979355e+003;
n=35; farx(n+1)=2.015918e+001; foe(n+1)=4.709925e+001; krok(n+1)=9.824964e-004; ng(n+1)=9.518017e+003;
n=36; farx(n+1)=1.843226e+001; foe(n+1)=3.915694e+001; krok(n+1)=8.689037e-004; ng(n+1)=2.367216e+004;
n=37; farx(n+1)=1.399622e+001; foe(n+1)=3.490189e+001; krok(n+1)=3.778589e-003; ng(n+1)=1.450640e+003;
n=38; farx(n+1)=1.529880e+001; foe(n+1)=3.208845e+001; krok(n+1)=9.589643e-004; ng(n+1)=5.985221e+003;
n=39; farx(n+1)=1.395157e+001; foe(n+1)=3.037025e+001; krok(n+1)=1.317301e-003; ng(n+1)=1.831265e+003;
n=40; farx(n+1)=1.306858e+001; foe(n+1)=2.896224e+001; krok(n+1)=1.570905e-003; ng(n+1)=2.058726e+003;
n=41; farx(n+1)=1.304122e+001; foe(n+1)=2.726323e+001; krok(n+1)=7.000907e-003; ng(n+1)=6.998233e+003;
n=42; farx(n+1)=1.201978e+001; foe(n+1)=2.479473e+001; krok(n+1)=5.200687e-003; ng(n+1)=5.305980e+003;
n=43; farx(n+1)=9.472772e+000; foe(n+1)=2.176228e+001; krok(n+1)=6.283621e-003; ng(n+1)=5.833238e+003;
n=44; farx(n+1)=8.007002e+000; foe(n+1)=2.023255e+001; krok(n+1)=4.267031e-003; ng(n+1)=4.705123e+003;
n=45; farx(n+1)=7.144732e+000; foe(n+1)=1.931558e+001; krok(n+1)=4.653602e-003; ng(n+1)=4.501665e+003;
n=46; farx(n+1)=6.636284e+000; foe(n+1)=1.662624e+001; krok(n+1)=1.470844e-002; ng(n+1)=3.982786e+003;
n=47; farx(n+1)=6.081192e+000; foe(n+1)=1.411719e+001; krok(n+1)=2.128042e-002; ng(n+1)=3.422247e+003;
n=48; farx(n+1)=4.226894e+000; foe(n+1)=1.197451e+001; krok(n+1)=1.343762e-002; ng(n+1)=5.766265e+003;
n=49; farx(n+1)=4.255563e+000; foe(n+1)=9.901241e+000; krok(n+1)=2.152696e-002; ng(n+1)=2.597428e+003;
n=50; farx(n+1)=4.182005e+000; foe(n+1)=8.898256e+000; krok(n+1)=3.369650e-002; ng(n+1)=1.115859e+003;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.155140e+000; foe(n+1)=8.485393e+000; krok(n+1)=3.136099e-007; ng(n+1)=3.315513e+003;
n=52; farx(n+1)=4.153685e+000; foe(n+1)=8.344666e+000; krok(n+1)=7.325937e-006; ng(n+1)=6.283521e+002;
n=53; farx(n+1)=3.939073e+000; foe(n+1)=7.104731e+000; krok(n+1)=1.752601e-004; ng(n+1)=4.008909e+002;
n=54; farx(n+1)=3.955861e+000; foe(n+1)=7.041035e+000; krok(n+1)=3.070301e-005; ng(n+1)=3.764210e+002;
n=55; farx(n+1)=3.985259e+000; foe(n+1)=6.678205e+000; krok(n+1)=6.359070e-004; ng(n+1)=3.815717e+002;
n=56; farx(n+1)=3.490489e+000; foe(n+1)=6.081970e+000; krok(n+1)=1.153579e-002; ng(n+1)=6.258357e+002;
n=57; farx(n+1)=3.404083e+000; foe(n+1)=5.921453e+000; krok(n+1)=1.338974e-003; ng(n+1)=3.298614e+002;
n=58; farx(n+1)=3.228879e+000; foe(n+1)=5.611175e+000; krok(n+1)=8.956895e-003; ng(n+1)=3.436341e+002;
n=59; farx(n+1)=3.022316e+000; foe(n+1)=5.386038e+000; krok(n+1)=4.624718e-003; ng(n+1)=1.541580e+003;
n=60; farx(n+1)=2.725101e+000; foe(n+1)=5.209637e+000; krok(n+1)=7.702766e-003; ng(n+1)=6.140724e+002;
n=61; farx(n+1)=2.633427e+000; foe(n+1)=5.114708e+000; krok(n+1)=9.439199e-003; ng(n+1)=8.431308e+002;
n=62; farx(n+1)=2.548459e+000; foe(n+1)=5.031258e+000; krok(n+1)=4.871925e-003; ng(n+1)=1.767855e+003;
n=63; farx(n+1)=2.440148e+000; foe(n+1)=4.909778e+000; krok(n+1)=7.883344e-003; ng(n+1)=5.465303e+002;
n=64; farx(n+1)=2.293388e+000; foe(n+1)=4.731198e+000; krok(n+1)=8.362796e-003; ng(n+1)=5.493031e+002;
n=65; farx(n+1)=2.161913e+000; foe(n+1)=4.634286e+000; krok(n+1)=2.243330e-002; ng(n+1)=1.525903e+003;
n=66; farx(n+1)=2.141418e+000; foe(n+1)=4.528311e+000; krok(n+1)=3.266584e-002; ng(n+1)=7.418968e+002;
n=67; farx(n+1)=2.054335e+000; foe(n+1)=4.386002e+000; krok(n+1)=1.025657e-002; ng(n+1)=1.316877e+003;
n=68; farx(n+1)=2.012642e+000; foe(n+1)=4.289442e+000; krok(n+1)=1.284535e-002; ng(n+1)=2.173471e+003;
n=69; farx(n+1)=1.999143e+000; foe(n+1)=4.212361e+000; krok(n+1)=1.131031e-002; ng(n+1)=7.971728e+002;
n=70; farx(n+1)=1.860825e+000; foe(n+1)=3.995473e+000; krok(n+1)=3.329590e-002; ng(n+1)=1.365081e+003;
n=71; farx(n+1)=1.702191e+000; foe(n+1)=3.737841e+000; krok(n+1)=2.667694e-002; ng(n+1)=6.329170e+002;
n=72; farx(n+1)=1.537199e+000; foe(n+1)=3.495269e+000; krok(n+1)=3.890307e-002; ng(n+1)=3.499691e+002;
n=73; farx(n+1)=1.396140e+000; foe(n+1)=3.133832e+000; krok(n+1)=4.050274e-002; ng(n+1)=6.149557e+002;
n=74; farx(n+1)=1.359538e+000; foe(n+1)=3.004897e+000; krok(n+1)=2.191235e-002; ng(n+1)=1.320223e+003;
n=75; farx(n+1)=1.354028e+000; foe(n+1)=2.976478e+000; krok(n+1)=9.889238e-003; ng(n+1)=1.362954e+003;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.353479e+000; foe(n+1)=2.966699e+000; krok(n+1)=1.016200e-007; ng(n+1)=8.743686e+002;
n=77; farx(n+1)=1.353322e+000; foe(n+1)=2.956019e+000; krok(n+1)=1.872020e-006; ng(n+1)=2.451427e+002;
n=78; farx(n+1)=1.354935e+000; foe(n+1)=2.952713e+000; krok(n+1)=1.195078e-005; ng(n+1)=7.883269e+001;
n=79; farx(n+1)=1.364255e+000; foe(n+1)=2.815995e+000; krok(n+1)=8.410247e-004; ng(n+1)=5.661315e+001;
n=80; farx(n+1)=1.367523e+000; foe(n+1)=2.781795e+000; krok(n+1)=2.285820e-004; ng(n+1)=3.876477e+002;
n=81; farx(n+1)=1.416393e+000; foe(n+1)=2.657394e+000; krok(n+1)=1.170971e-003; ng(n+1)=4.860439e+002;
n=82; farx(n+1)=1.411164e+000; foe(n+1)=2.583039e+000; krok(n+1)=2.621411e-003; ng(n+1)=6.361315e+002;
n=83; farx(n+1)=1.392644e+000; foe(n+1)=2.489385e+000; krok(n+1)=1.291963e-003; ng(n+1)=5.234528e+002;
n=84; farx(n+1)=1.382765e+000; foe(n+1)=2.413295e+000; krok(n+1)=2.957764e-003; ng(n+1)=1.531856e+003;
n=85; farx(n+1)=1.406948e+000; foe(n+1)=2.360605e+000; krok(n+1)=5.767896e-003; ng(n+1)=5.365314e+002;
n=86; farx(n+1)=1.471932e+000; foe(n+1)=2.310851e+000; krok(n+1)=1.631060e-002; ng(n+1)=5.227571e+002;
n=87; farx(n+1)=1.456227e+000; foe(n+1)=2.277689e+000; krok(n+1)=4.498477e-003; ng(n+1)=9.873209e+002;
n=88; farx(n+1)=1.451632e+000; foe(n+1)=2.192400e+000; krok(n+1)=1.305321e-002; ng(n+1)=1.870770e+003;
n=89; farx(n+1)=1.502699e+000; foe(n+1)=2.075160e+000; krok(n+1)=1.355378e-002; ng(n+1)=2.109573e+003;
n=90; farx(n+1)=1.509796e+000; foe(n+1)=2.062582e+000; krok(n+1)=4.727372e-003; ng(n+1)=1.179309e+002;
n=91; farx(n+1)=1.498199e+000; foe(n+1)=2.037286e+000; krok(n+1)=2.173419e-002; ng(n+1)=4.040918e+002;
n=92; farx(n+1)=1.472183e+000; foe(n+1)=1.997432e+000; krok(n+1)=1.495979e-002; ng(n+1)=1.052756e+003;
n=93; farx(n+1)=1.440925e+000; foe(n+1)=1.949836e+000; krok(n+1)=5.285294e-002; ng(n+1)=6.053330e+002;
n=94; farx(n+1)=1.411539e+000; foe(n+1)=1.881896e+000; krok(n+1)=2.165649e-002; ng(n+1)=9.768610e+002;
n=95; farx(n+1)=1.365768e+000; foe(n+1)=1.836212e+000; krok(n+1)=2.191235e-002; ng(n+1)=8.022253e+002;
n=96; farx(n+1)=1.339500e+000; foe(n+1)=1.796393e+000; krok(n+1)=1.664870e-002; ng(n+1)=7.554550e+002;
n=97; farx(n+1)=1.323443e+000; foe(n+1)=1.689864e+000; krok(n+1)=1.909506e-001; ng(n+1)=1.042921e+003;
n=98; farx(n+1)=1.328807e+000; foe(n+1)=1.665154e+000; krok(n+1)=3.050527e-002; ng(n+1)=8.968631e+002;
n=99; farx(n+1)=1.325235e+000; foe(n+1)=1.614585e+000; krok(n+1)=1.196783e-001; ng(n+1)=4.681203e+002;
n=100; farx(n+1)=1.325316e+000; foe(n+1)=1.591263e+000; krok(n+1)=2.378798e-002; ng(n+1)=1.178387e+003;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
