%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.967260e+003; foe(n+1)=3.993608e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.786834e+003; foe(n+1)=2.849916e+003; krok(n+1)=5.081655e-004; ng(n+1)=3.206684e+003;
n=2; farx(n+1)=1.119892e+003; foe(n+1)=1.189890e+003; krok(n+1)=2.038825e-003; ng(n+1)=2.189946e+003;
n=3; farx(n+1)=1.387662e+003; foe(n+1)=8.707869e+002; krok(n+1)=1.197267e-004; ng(n+1)=8.362019e+003;
n=4; farx(n+1)=2.650365e+003; foe(n+1)=6.041182e+002; krok(n+1)=8.500296e-004; ng(n+1)=9.492486e+003;
n=5; farx(n+1)=2.332654e+003; foe(n+1)=5.342507e+002; krok(n+1)=3.218320e-003; ng(n+1)=1.228522e+003;
n=6; farx(n+1)=1.261372e+003; foe(n+1)=4.607330e+002; krok(n+1)=3.343359e-003; ng(n+1)=6.456246e+002;
n=7; farx(n+1)=1.119517e+003; foe(n+1)=4.437913e+002; krok(n+1)=6.369581e-004; ng(n+1)=1.548146e+003;
n=8; farx(n+1)=7.695353e+002; foe(n+1)=4.038580e+002; krok(n+1)=3.595838e-003; ng(n+1)=8.335432e+002;
n=9; farx(n+1)=5.755948e+002; foe(n+1)=3.786726e+002; krok(n+1)=3.340601e-003; ng(n+1)=1.844177e+003;
n=10; farx(n+1)=4.022263e+002; foe(n+1)=3.337235e+002; krok(n+1)=2.855545e-003; ng(n+1)=2.241038e+003;
n=11; farx(n+1)=3.914489e+002; foe(n+1)=3.321098e+002; krok(n+1)=2.466737e-005; ng(n+1)=2.976438e+003;
n=12; farx(n+1)=3.620563e+002; foe(n+1)=3.246654e+002; krok(n+1)=4.597934e-003; ng(n+1)=4.107034e+003;
n=13; farx(n+1)=3.230841e+002; foe(n+1)=3.063087e+002; krok(n+1)=4.929920e-003; ng(n+1)=2.977594e+003;
n=14; farx(n+1)=3.326021e+002; foe(n+1)=2.984529e+002; krok(n+1)=9.809942e-004; ng(n+1)=7.016467e+002;
n=15; farx(n+1)=3.415425e+002; foe(n+1)=2.946643e+002; krok(n+1)=1.588254e-003; ng(n+1)=1.473481e+003;
n=16; farx(n+1)=3.721300e+002; foe(n+1)=2.861425e+002; krok(n+1)=2.480280e-003; ng(n+1)=1.866039e+003;
n=17; farx(n+1)=3.341983e+002; foe(n+1)=2.803573e+002; krok(n+1)=9.943215e-004; ng(n+1)=1.425971e+003;
n=18; farx(n+1)=3.334451e+002; foe(n+1)=2.784232e+002; krok(n+1)=3.023969e-003; ng(n+1)=2.217183e+003;
n=19; farx(n+1)=3.301609e+002; foe(n+1)=2.747087e+002; krok(n+1)=4.788074e-003; ng(n+1)=1.918068e+003;
n=20; farx(n+1)=1.850898e+002; foe(n+1)=2.196591e+002; krok(n+1)=2.629130e-002; ng(n+1)=1.490095e+003;
n=21; farx(n+1)=1.339067e+002; foe(n+1)=2.020149e+002; krok(n+1)=1.040194e-003; ng(n+1)=2.222396e+003;
n=22; farx(n+1)=1.289814e+002; foe(n+1)=1.840133e+002; krok(n+1)=8.005168e-004; ng(n+1)=1.625505e+003;
n=23; farx(n+1)=1.290577e+002; foe(n+1)=1.839325e+002; krok(n+1)=1.497176e-004; ng(n+1)=1.101193e+004;
n=24; farx(n+1)=1.298267e+002; foe(n+1)=1.827014e+002; krok(n+1)=2.493753e-004; ng(n+1)=5.983012e+003;
n=25; farx(n+1)=1.373790e+002; foe(n+1)=1.657178e+002; krok(n+1)=1.521910e-002; ng(n+1)=3.378111e+004;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.373789e+002; foe(n+1)=1.644499e+002; krok(n+1)=8.925337e-009; ng(n+1)=3.297747e+004;
n=27; farx(n+1)=2.010856e+002; foe(n+1)=1.040735e+002; krok(n+1)=2.600485e-004; ng(n+1)=1.432642e+003;
n=28; farx(n+1)=2.063565e+002; foe(n+1)=9.674572e+001; krok(n+1)=1.400833e-005; ng(n+1)=5.308702e+004;
n=29; farx(n+1)=1.972599e+002; foe(n+1)=9.268272e+001; krok(n+1)=1.110172e-004; ng(n+1)=3.662539e+004;
n=30; farx(n+1)=1.845328e+002; foe(n+1)=8.944396e+001; krok(n+1)=3.290674e-005; ng(n+1)=2.920048e+004;
n=31; farx(n+1)=1.388463e+002; foe(n+1)=8.402337e+001; krok(n+1)=2.125074e-004; ng(n+1)=2.163510e+004;
n=32; farx(n+1)=9.301382e+001; foe(n+1)=7.794586e+001; krok(n+1)=7.964429e-005; ng(n+1)=4.021144e+003;
n=33; farx(n+1)=6.937737e+001; foe(n+1)=7.240069e+001; krok(n+1)=4.279756e-005; ng(n+1)=4.917993e+004;
n=34; farx(n+1)=4.579105e+001; foe(n+1)=6.582982e+001; krok(n+1)=1.078226e-003; ng(n+1)=1.433274e+004;
n=35; farx(n+1)=4.302767e+001; foe(n+1)=6.396598e+001; krok(n+1)=3.033479e-004; ng(n+1)=2.156949e+004;
n=36; farx(n+1)=3.856780e+001; foe(n+1)=5.986874e+001; krok(n+1)=1.078226e-003; ng(n+1)=2.262887e+004;
n=37; farx(n+1)=3.770454e+001; foe(n+1)=5.723841e+001; krok(n+1)=2.486933e-004; ng(n+1)=4.180273e+004;
n=38; farx(n+1)=3.491866e+001; foe(n+1)=5.530868e+001; krok(n+1)=1.402081e-003; ng(n+1)=5.080723e+003;
n=39; farx(n+1)=2.652104e+001; foe(n+1)=5.079110e+001; krok(n+1)=1.675019e-003; ng(n+1)=2.404127e+004;
n=40; farx(n+1)=2.321133e+001; foe(n+1)=4.791808e+001; krok(n+1)=8.799720e-003; ng(n+1)=2.307731e+004;
n=41; farx(n+1)=2.322309e+001; foe(n+1)=4.719661e+001; krok(n+1)=2.156451e-003; ng(n+1)=8.337604e+003;
n=42; farx(n+1)=2.295230e+001; foe(n+1)=4.512286e+001; krok(n+1)=1.778972e-002; ng(n+1)=1.382399e+004;
n=43; farx(n+1)=2.222088e+001; foe(n+1)=4.389984e+001; krok(n+1)=3.176507e-003; ng(n+1)=2.539674e+004;
n=44; farx(n+1)=2.395350e+001; foe(n+1)=4.283305e+001; krok(n+1)=1.576669e-002; ng(n+1)=1.889849e+004;
n=45; farx(n+1)=2.553205e+001; foe(n+1)=4.178033e+001; krok(n+1)=3.864513e-002; ng(n+1)=4.916345e+003;
n=46; farx(n+1)=2.418349e+001; foe(n+1)=4.005482e+001; krok(n+1)=3.585307e-002; ng(n+1)=7.031612e+003;
n=47; farx(n+1)=2.275103e+001; foe(n+1)=3.847189e+001; krok(n+1)=2.896961e-002; ng(n+1)=3.736212e+003;
n=48; farx(n+1)=2.203227e+001; foe(n+1)=3.729437e+001; krok(n+1)=5.097164e-002; ng(n+1)=6.817767e+002;
n=49; farx(n+1)=2.056480e+001; foe(n+1)=3.523268e+001; krok(n+1)=8.477531e-002; ng(n+1)=9.242401e+003;
n=50; farx(n+1)=2.061144e+001; foe(n+1)=3.395684e+001; krok(n+1)=1.963396e-002; ng(n+1)=4.353066e+003;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.061927e+001; foe(n+1)=3.389654e+001; krok(n+1)=7.885513e-008; ng(n+1)=2.913627e+003;
n=52; farx(n+1)=1.954145e+001; foe(n+1)=3.222407e+001; krok(n+1)=2.247378e-004; ng(n+1)=3.256024e+002;
n=53; farx(n+1)=1.808350e+001; foe(n+1)=3.083185e+001; krok(n+1)=6.508340e-005; ng(n+1)=5.170931e+003;
n=54; farx(n+1)=1.421672e+001; foe(n+1)=2.951127e+001; krok(n+1)=1.433605e-004; ng(n+1)=6.383231e+003;
n=55; farx(n+1)=1.303540e+001; foe(n+1)=2.873329e+001; krok(n+1)=1.404483e-004; ng(n+1)=6.225092e+003;
n=56; farx(n+1)=1.300549e+001; foe(n+1)=2.765246e+001; krok(n+1)=1.279942e-003; ng(n+1)=6.455017e+003;
n=57; farx(n+1)=1.231352e+001; foe(n+1)=2.527077e+001; krok(n+1)=1.146661e-003; ng(n+1)=5.756584e+003;
n=58; farx(n+1)=9.222613e+000; foe(n+1)=2.231079e+001; krok(n+1)=4.399860e-003; ng(n+1)=2.291162e+003;
n=59; farx(n+1)=7.176675e+000; foe(n+1)=2.019636e+001; krok(n+1)=1.812955e-003; ng(n+1)=2.553786e+003;
n=60; farx(n+1)=5.435915e+000; foe(n+1)=1.848138e+001; krok(n+1)=7.385876e-003; ng(n+1)=1.305766e+003;
n=61; farx(n+1)=4.874009e+000; foe(n+1)=1.678690e+001; krok(n+1)=8.323975e-003; ng(n+1)=8.746667e+002;
n=62; farx(n+1)=4.710219e+000; foe(n+1)=1.606648e+001; krok(n+1)=6.818297e-003; ng(n+1)=1.382115e+003;
n=63; farx(n+1)=4.527302e+000; foe(n+1)=1.536550e+001; krok(n+1)=1.740861e-002; ng(n+1)=5.485399e+002;
n=64; farx(n+1)=4.408218e+000; foe(n+1)=1.444963e+001; krok(n+1)=1.920518e-002; ng(n+1)=5.297793e+002;
n=65; farx(n+1)=4.505170e+000; foe(n+1)=1.395304e+001; krok(n+1)=3.201476e-003; ng(n+1)=9.770786e+002;
n=66; farx(n+1)=4.602607e+000; foe(n+1)=1.357927e+001; krok(n+1)=4.372259e-003; ng(n+1)=4.018766e+002;
n=67; farx(n+1)=4.612618e+000; foe(n+1)=1.291755e+001; krok(n+1)=2.757245e-002; ng(n+1)=5.357004e+002;
n=68; farx(n+1)=4.236526e+000; foe(n+1)=1.116154e+001; krok(n+1)=8.452076e-002; ng(n+1)=5.671236e+002;
n=69; farx(n+1)=3.990285e+000; foe(n+1)=1.037893e+001; krok(n+1)=2.085765e-002; ng(n+1)=2.898823e+002;
n=70; farx(n+1)=4.025306e+000; foe(n+1)=9.167259e+000; krok(n+1)=5.359529e-002; ng(n+1)=6.518733e+002;
n=71; farx(n+1)=4.021501e+000; foe(n+1)=8.665022e+000; krok(n+1)=1.204927e-001; ng(n+1)=9.744248e+002;
n=72; farx(n+1)=4.126784e+000; foe(n+1)=8.310394e+000; krok(n+1)=7.171165e-002; ng(n+1)=9.466637e+002;
n=73; farx(n+1)=4.214147e+000; foe(n+1)=8.122539e+000; krok(n+1)=1.183650e-001; ng(n+1)=2.767359e+002;
n=74; farx(n+1)=3.941820e+000; foe(n+1)=7.784501e+000; krok(n+1)=2.670983e-001; ng(n+1)=1.919793e+002;
n=75; farx(n+1)=4.007772e+000; foe(n+1)=7.501609e+000; krok(n+1)=2.876382e-001; ng(n+1)=2.479719e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=4.009218e+000; foe(n+1)=7.489945e+000; krok(n+1)=3.076170e-005; ng(n+1)=6.965459e+001;
n=77; farx(n+1)=4.012356e+000; foe(n+1)=7.485395e+000; krok(n+1)=6.971762e-006; ng(n+1)=8.638611e+001;
n=78; farx(n+1)=3.994486e+000; foe(n+1)=7.452083e+000; krok(n+1)=2.773554e-004; ng(n+1)=4.867920e+001;
n=79; farx(n+1)=3.950876e+000; foe(n+1)=7.398415e+000; krok(n+1)=1.205178e-004; ng(n+1)=7.770592e+001;
n=80; farx(n+1)=3.953862e+000; foe(n+1)=7.242911e+000; krok(n+1)=2.433134e-003; ng(n+1)=3.578897e+001;
n=81; farx(n+1)=3.880631e+000; foe(n+1)=6.964787e+000; krok(n+1)=9.542392e-003; ng(n+1)=5.117304e+001;
n=82; farx(n+1)=3.826411e+000; foe(n+1)=6.858950e+000; krok(n+1)=1.635770e-003; ng(n+1)=2.161196e+002;
n=83; farx(n+1)=3.782034e+000; foe(n+1)=6.784840e+000; krok(n+1)=5.557598e-003; ng(n+1)=2.162060e+002;
n=84; farx(n+1)=3.672586e+000; foe(n+1)=6.680238e+000; krok(n+1)=1.000726e-002; ng(n+1)=2.205545e+002;
n=85; farx(n+1)=3.272923e+000; foe(n+1)=6.369893e+000; krok(n+1)=5.440189e-002; ng(n+1)=3.481725e+002;
n=86; farx(n+1)=3.162100e+000; foe(n+1)=6.167238e+000; krok(n+1)=3.225080e-003; ng(n+1)=4.063804e+002;
n=87; farx(n+1)=3.045604e+000; foe(n+1)=6.046979e+000; krok(n+1)=3.881913e-002; ng(n+1)=3.505838e+002;
n=88; farx(n+1)=2.929654e+000; foe(n+1)=5.878475e+000; krok(n+1)=9.899545e-003; ng(n+1)=1.512061e+002;
n=89; farx(n+1)=2.650828e+000; foe(n+1)=5.395272e+000; krok(n+1)=7.424903e-002; ng(n+1)=3.524424e+002;
n=90; farx(n+1)=2.549630e+000; foe(n+1)=5.279473e+000; krok(n+1)=3.871130e-002; ng(n+1)=2.078543e+002;
n=91; farx(n+1)=2.529460e+000; foe(n+1)=5.240547e+000; krok(n+1)=2.160287e-002; ng(n+1)=1.998410e+002;
n=92; farx(n+1)=2.405499e+000; foe(n+1)=4.763963e+000; krok(n+1)=1.158784e-001; ng(n+1)=8.540312e+001;
n=93; farx(n+1)=2.277490e+000; foe(n+1)=4.505504e+000; krok(n+1)=9.513510e-002; ng(n+1)=4.917556e+002;
n=94; farx(n+1)=2.322764e+000; foe(n+1)=4.410745e+000; krok(n+1)=7.563795e-002; ng(n+1)=3.301957e+002;
n=95; farx(n+1)=2.297359e+000; foe(n+1)=4.224996e+000; krok(n+1)=8.662598e-002; ng(n+1)=1.214521e+002;
n=96; farx(n+1)=2.236612e+000; foe(n+1)=4.156235e+000; krok(n+1)=4.438543e-002; ng(n+1)=2.820343e+002;
n=97; farx(n+1)=2.040061e+000; foe(n+1)=3.983391e+000; krok(n+1)=3.011048e-001; ng(n+1)=7.474319e+001;
n=98; farx(n+1)=1.990621e+000; foe(n+1)=3.936896e+000; krok(n+1)=6.402713e-002; ng(n+1)=9.292365e+001;
n=99; farx(n+1)=1.887363e+000; foe(n+1)=3.785973e+000; krok(n+1)=2.343012e-001; ng(n+1)=2.327619e+002;
n=100; farx(n+1)=1.793689e+000; foe(n+1)=3.516813e+000; krok(n+1)=3.372291e-001; ng(n+1)=2.971862e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
