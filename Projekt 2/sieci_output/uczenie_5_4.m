%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.575216e+003; foe(n+1)=4.568391e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.987910e+003; foe(n+1)=2.918560e+003; krok(n+1)=5.126539e-004; ng(n+1)=2.794536e+003;
n=2; farx(n+1)=9.173889e+002; foe(n+1)=8.097937e+002; krok(n+1)=3.485222e-003; ng(n+1)=1.488447e+003;
n=3; farx(n+1)=9.100942e+002; foe(n+1)=5.542683e+002; krok(n+1)=2.178264e-004; ng(n+1)=4.875659e+003;
n=4; farx(n+1)=1.085188e+003; foe(n+1)=4.716182e+002; krok(n+1)=7.496833e-004; ng(n+1)=3.794800e+003;
n=5; farx(n+1)=6.148548e+002; foe(n+1)=3.857881e+002; krok(n+1)=6.050128e-003; ng(n+1)=3.938279e+002;
n=6; farx(n+1)=4.359320e+002; foe(n+1)=3.419286e+002; krok(n+1)=9.761580e-004; ng(n+1)=1.433973e+003;
n=7; farx(n+1)=3.292990e+002; foe(n+1)=3.169075e+002; krok(n+1)=1.772228e-003; ng(n+1)=7.930517e+002;
n=8; farx(n+1)=3.143914e+002; foe(n+1)=3.104985e+002; krok(n+1)=3.113587e-003; ng(n+1)=9.009929e+002;
n=9; farx(n+1)=2.851043e+002; foe(n+1)=3.057401e+002; krok(n+1)=4.776032e-003; ng(n+1)=5.948860e+002;
n=10; farx(n+1)=1.889024e+002; foe(n+1)=2.883007e+002; krok(n+1)=6.550277e-003; ng(n+1)=3.211849e+002;
n=11; farx(n+1)=1.787018e+002; foe(n+1)=2.847008e+002; krok(n+1)=1.072587e-003; ng(n+1)=6.984369e+002;
n=12; farx(n+1)=1.646381e+002; foe(n+1)=2.790695e+002; krok(n+1)=9.915259e-004; ng(n+1)=8.266600e+002;
n=13; farx(n+1)=9.533720e+001; foe(n+1)=2.490770e+002; krok(n+1)=1.321526e-002; ng(n+1)=7.273495e+002;
n=14; farx(n+1)=5.151594e+001; foe(n+1)=2.048268e+002; krok(n+1)=1.758026e-003; ng(n+1)=1.297494e+003;
n=15; farx(n+1)=4.703576e+001; foe(n+1)=1.983706e+002; krok(n+1)=1.376014e-004; ng(n+1)=1.745897e+003;
n=16; farx(n+1)=4.069400e+001; foe(n+1)=1.895728e+002; krok(n+1)=1.386777e-004; ng(n+1)=4.338436e+003;
n=17; farx(n+1)=3.767767e+001; foe(n+1)=1.844308e+002; krok(n+1)=3.816075e-003; ng(n+1)=2.482032e+003;
n=18; farx(n+1)=4.031042e+001; foe(n+1)=1.783137e+002; krok(n+1)=5.637357e-003; ng(n+1)=9.485115e+002;
n=19; farx(n+1)=3.878959e+001; foe(n+1)=1.086191e+002; krok(n+1)=2.199458e-003; ng(n+1)=1.270193e+003;
n=20; farx(n+1)=3.879410e+001; foe(n+1)=1.086101e+002; krok(n+1)=5.305537e-009; ng(n+1)=3.029378e+003;
n=21; farx(n+1)=3.813457e+001; foe(n+1)=1.074333e+002; krok(n+1)=9.289576e-004; ng(n+1)=2.911601e+003;
n=22; farx(n+1)=3.820015e+001; foe(n+1)=1.047014e+002; krok(n+1)=2.472310e-003; ng(n+1)=4.428733e+003;
n=23; farx(n+1)=3.541597e+001; foe(n+1)=9.548324e+001; krok(n+1)=7.481826e-003; ng(n+1)=3.987299e+003;
n=24; farx(n+1)=3.409874e+001; foe(n+1)=9.175446e+001; krok(n+1)=2.531421e-003; ng(n+1)=5.624531e+003;
n=25; farx(n+1)=3.503575e+001; foe(n+1)=8.794122e+001; krok(n+1)=1.345452e-002; ng(n+1)=2.741894e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.554708e+001; foe(n+1)=7.704935e+001; krok(n+1)=2.286087e-005; ng(n+1)=2.925118e+003;
n=27; farx(n+1)=2.374989e+001; foe(n+1)=7.422966e+001; krok(n+1)=2.170937e-005; ng(n+1)=1.031102e+003;
n=28; farx(n+1)=2.098675e+001; foe(n+1)=7.181242e+001; krok(n+1)=1.771309e-005; ng(n+1)=1.565158e+003;
n=29; farx(n+1)=1.352963e+001; foe(n+1)=6.055286e+001; krok(n+1)=3.987583e-004; ng(n+1)=6.533316e+002;
n=30; farx(n+1)=1.084384e+001; foe(n+1)=4.648059e+001; krok(n+1)=6.710424e-004; ng(n+1)=1.380383e+003;
n=31; farx(n+1)=8.271738e+000; foe(n+1)=2.698583e+001; krok(n+1)=1.116161e-003; ng(n+1)=9.733318e+002;
n=32; farx(n+1)=7.317335e+000; foe(n+1)=2.381017e+001; krok(n+1)=6.488063e-004; ng(n+1)=5.919259e+002;
n=33; farx(n+1)=7.079444e+000; foe(n+1)=2.167026e+001; krok(n+1)=1.486486e-003; ng(n+1)=2.659786e+003;
n=34; farx(n+1)=7.175868e+000; foe(n+1)=2.103992e+001; krok(n+1)=2.716773e-003; ng(n+1)=1.307956e+003;
n=35; farx(n+1)=5.777197e+000; foe(n+1)=1.802998e+001; krok(n+1)=3.926338e-003; ng(n+1)=7.039547e+002;
n=36; farx(n+1)=5.723418e+000; foe(n+1)=1.719009e+001; krok(n+1)=1.153579e-002; ng(n+1)=1.114065e+003;
n=37; farx(n+1)=5.600929e+000; foe(n+1)=1.611183e+001; krok(n+1)=2.183177e-002; ng(n+1)=3.297196e+002;
n=38; farx(n+1)=5.693689e+000; foe(n+1)=1.532532e+001; krok(n+1)=1.664795e-002; ng(n+1)=5.987683e+002;
n=39; farx(n+1)=5.752095e+000; foe(n+1)=1.459002e+001; krok(n+1)=1.095618e-002; ng(n+1)=4.946015e+002;
n=40; farx(n+1)=5.557997e+000; foe(n+1)=1.399508e+001; krok(n+1)=1.064021e-002; ng(n+1)=7.445383e+002;
n=41; farx(n+1)=5.479651e+000; foe(n+1)=1.374854e+001; krok(n+1)=1.571994e-002; ng(n+1)=4.478844e+002;
n=42; farx(n+1)=5.430327e+000; foe(n+1)=1.347029e+001; krok(n+1)=2.337492e-002; ng(n+1)=4.604496e+002;
n=43; farx(n+1)=5.395869e+000; foe(n+1)=1.319568e+001; krok(n+1)=6.458581e-002; ng(n+1)=3.645200e+002;
n=44; farx(n+1)=5.152605e+000; foe(n+1)=1.207664e+001; krok(n+1)=8.571529e-002; ng(n+1)=4.433114e+002;
n=45; farx(n+1)=5.166433e+000; foe(n+1)=1.196373e+001; krok(n+1)=1.401574e-002; ng(n+1)=4.224513e+002;
n=46; farx(n+1)=4.944017e+000; foe(n+1)=1.154806e+001; krok(n+1)=1.722157e-001; ng(n+1)=2.581945e+002;
n=47; farx(n+1)=4.654800e+000; foe(n+1)=1.100341e+001; krok(n+1)=2.143812e-001; ng(n+1)=2.958911e+002;
n=48; farx(n+1)=4.455066e+000; foe(n+1)=1.037700e+001; krok(n+1)=3.319551e-001; ng(n+1)=2.824775e+002;
n=49; farx(n+1)=4.363017e+000; foe(n+1)=9.855502e+000; krok(n+1)=3.118032e-001; ng(n+1)=1.219609e+002;
n=50; farx(n+1)=4.381457e+000; foe(n+1)=9.615514e+000; krok(n+1)=8.191626e-002; ng(n+1)=5.749382e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.378157e+000; foe(n+1)=9.532159e+000; krok(n+1)=4.376932e-006; ng(n+1)=4.259070e+002;
n=52; farx(n+1)=4.379365e+000; foe(n+1)=9.386080e+000; krok(n+1)=3.716215e-004; ng(n+1)=7.842034e+001;
n=53; farx(n+1)=4.361322e+000; foe(n+1)=9.269746e+000; krok(n+1)=2.171980e-004; ng(n+1)=8.261602e+001;
n=54; farx(n+1)=4.425684e+000; foe(n+1)=9.115271e+000; krok(n+1)=2.463545e-004; ng(n+1)=9.787987e+001;
n=55; farx(n+1)=4.583824e+000; foe(n+1)=8.950872e+000; krok(n+1)=2.344633e-003; ng(n+1)=5.124301e+001;
n=56; farx(n+1)=4.703347e+000; foe(n+1)=8.722381e+000; krok(n+1)=2.013418e-003; ng(n+1)=4.016986e+001;
n=57; farx(n+1)=4.580756e+000; foe(n+1)=8.539905e+000; krok(n+1)=3.400118e-003; ng(n+1)=1.160924e+002;
n=58; farx(n+1)=4.567631e+000; foe(n+1)=8.426725e+000; krok(n+1)=4.541426e-003; ng(n+1)=7.401195e+001;
n=59; farx(n+1)=4.537701e+000; foe(n+1)=8.063479e+000; krok(n+1)=1.615205e-002; ng(n+1)=1.223808e+002;
n=60; farx(n+1)=4.385785e+000; foe(n+1)=7.901034e+000; krok(n+1)=7.144846e-003; ng(n+1)=1.181324e+002;
n=61; farx(n+1)=4.442405e+000; foe(n+1)=7.740112e+000; krok(n+1)=1.987953e-002; ng(n+1)=2.205731e+002;
n=62; farx(n+1)=4.478256e+000; foe(n+1)=7.689174e+000; krok(n+1)=8.023134e-003; ng(n+1)=2.681917e+002;
n=63; farx(n+1)=4.292321e+000; foe(n+1)=7.300199e+000; krok(n+1)=7.959957e-002; ng(n+1)=9.814845e+001;
n=64; farx(n+1)=4.082816e+000; foe(n+1)=7.120973e+000; krok(n+1)=2.051314e-002; ng(n+1)=1.600179e+002;
n=65; farx(n+1)=3.989637e+000; foe(n+1)=6.903038e+000; krok(n+1)=3.979978e-002; ng(n+1)=8.382778e+001;
n=66; farx(n+1)=3.929629e+000; foe(n+1)=6.851179e+000; krok(n+1)=5.908701e-002; ng(n+1)=1.017911e+002;
n=67; farx(n+1)=3.302955e+000; foe(n+1)=6.457186e+000; krok(n+1)=7.729026e-002; ng(n+1)=2.010813e+002;
n=68; farx(n+1)=3.174433e+000; foe(n+1)=6.369569e+000; krok(n+1)=6.385486e-002; ng(n+1)=2.828946e+002;
n=69; farx(n+1)=3.008734e+000; foe(n+1)=5.987633e+000; krok(n+1)=2.031949e-001; ng(n+1)=2.204979e+002;
n=70; farx(n+1)=2.727270e+000; foe(n+1)=5.667083e+000; krok(n+1)=1.855710e-001; ng(n+1)=2.078184e+002;
n=71; farx(n+1)=2.658053e+000; foe(n+1)=5.410943e+000; krok(n+1)=2.833785e-001; ng(n+1)=1.249318e+002;
n=72; farx(n+1)=2.524406e+000; foe(n+1)=5.057097e+000; krok(n+1)=1.943277e-001; ng(n+1)=6.683665e+001;
n=73; farx(n+1)=2.487064e+000; foe(n+1)=4.854939e+000; krok(n+1)=1.047220e-001; ng(n+1)=6.811655e+001;
n=74; farx(n+1)=2.355537e+000; foe(n+1)=4.400692e+000; krok(n+1)=7.926233e-001; ng(n+1)=1.456950e+002;
n=75; farx(n+1)=2.261473e+000; foe(n+1)=4.155457e+000; krok(n+1)=2.520608e-001; ng(n+1)=1.554274e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.234378e+000; foe(n+1)=4.076344e+000; krok(n+1)=5.755042e-005; ng(n+1)=1.135734e+002;
n=77; farx(n+1)=2.230770e+000; foe(n+1)=4.061173e+000; krok(n+1)=2.102242e-005; ng(n+1)=8.665494e+001;
n=78; farx(n+1)=2.221911e+000; foe(n+1)=4.037662e+000; krok(n+1)=3.812868e-004; ng(n+1)=2.979998e+001;
n=79; farx(n+1)=2.144008e+000; foe(n+1)=3.927154e+000; krok(n+1)=2.501815e-003; ng(n+1)=2.326806e+001;
n=80; farx(n+1)=2.102210e+000; foe(n+1)=3.892809e+000; krok(n+1)=1.635770e-003; ng(n+1)=2.841133e+001;
n=81; farx(n+1)=2.103612e+000; foe(n+1)=3.874128e+000; krok(n+1)=2.289488e-003; ng(n+1)=4.617038e+001;
n=82; farx(n+1)=2.015360e+000; foe(n+1)=3.791254e+000; krok(n+1)=1.622219e-002; ng(n+1)=4.562245e+001;
n=83; farx(n+1)=1.968451e+000; foe(n+1)=3.705863e+000; krok(n+1)=7.947193e-003; ng(n+1)=5.968943e+001;
n=84; farx(n+1)=1.934867e+000; foe(n+1)=3.659002e+000; krok(n+1)=1.208515e-002; ng(n+1)=1.021129e+002;
n=85; farx(n+1)=1.878337e+000; foe(n+1)=3.544513e+000; krok(n+1)=3.742693e-002; ng(n+1)=1.402983e+002;
n=86; farx(n+1)=1.829440e+000; foe(n+1)=3.485306e+000; krok(n+1)=9.249437e-003; ng(n+1)=1.338209e+002;
n=87; farx(n+1)=1.832365e+000; foe(n+1)=3.448191e+000; krok(n+1)=3.640360e-002; ng(n+1)=1.085896e+002;
n=88; farx(n+1)=1.712798e+000; foe(n+1)=3.253024e+000; krok(n+1)=1.433103e-001; ng(n+1)=7.967978e+001;
n=89; farx(n+1)=1.687505e+000; foe(n+1)=3.138805e+000; krok(n+1)=3.252259e-002; ng(n+1)=1.081126e+002;
n=90; farx(n+1)=1.611673e+000; foe(n+1)=3.016374e+000; krok(n+1)=6.679426e-002; ng(n+1)=1.367308e+002;
n=91; farx(n+1)=1.575820e+000; foe(n+1)=2.906882e+000; krok(n+1)=1.533108e-001; ng(n+1)=1.919744e+002;
n=92; farx(n+1)=1.519157e+000; foe(n+1)=2.854814e+000; krok(n+1)=1.111619e-001; ng(n+1)=1.294781e+002;
n=93; farx(n+1)=1.454829e+000; foe(n+1)=2.777285e+000; krok(n+1)=7.431643e-002; ng(n+1)=9.444614e+001;
n=94; farx(n+1)=1.426281e+000; foe(n+1)=2.660645e+000; krok(n+1)=2.016994e-001; ng(n+1)=1.308034e+002;
n=95; farx(n+1)=1.416127e+000; foe(n+1)=2.603426e+000; krok(n+1)=4.904612e-002; ng(n+1)=2.315819e+002;
n=96; farx(n+1)=1.361319e+000; foe(n+1)=2.501435e+000; krok(n+1)=9.137743e-002; ng(n+1)=1.229532e+002;
n=97; farx(n+1)=1.340044e+000; foe(n+1)=2.427707e+000; krok(n+1)=1.072012e-001; ng(n+1)=1.287385e+002;
n=98; farx(n+1)=1.345009e+000; foe(n+1)=2.309996e+000; krok(n+1)=3.333343e-001; ng(n+1)=1.131497e+002;
n=99; farx(n+1)=1.297640e+000; foe(n+1)=2.256014e+000; krok(n+1)=2.155114e-001; ng(n+1)=5.682111e+001;
n=100; farx(n+1)=1.256330e+000; foe(n+1)=2.178792e+000; krok(n+1)=3.307424e-001; ng(n+1)=1.276872e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
