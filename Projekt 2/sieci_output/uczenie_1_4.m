%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.005197e+003; foe(n+1)=3.997916e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.039604e+003; foe(n+1)=3.037296e+003; krok(n+1)=5.014459e-004; ng(n+1)=1.654928e+003;
n=2; farx(n+1)=8.010363e+002; foe(n+1)=7.809177e+002; krok(n+1)=1.664870e-002; ng(n+1)=1.918949e+002;
n=3; farx(n+1)=8.045286e+002; foe(n+1)=7.684004e+002; krok(n+1)=6.608572e-006; ng(n+1)=3.083804e+003;
n=4; farx(n+1)=1.622939e+003; foe(n+1)=7.428285e+002; krok(n+1)=4.776032e-003; ng(n+1)=3.226319e+003;
n=5; farx(n+1)=1.886362e+003; foe(n+1)=7.317950e+002; krok(n+1)=2.598758e-002; ng(n+1)=1.948224e+003;
n=6; farx(n+1)=1.868689e+003; foe(n+1)=7.298293e+002; krok(n+1)=2.419456e-003; ng(n+1)=1.796186e+003;
n=7; farx(n+1)=3.283849e+002; foe(n+1)=4.639905e+002; krok(n+1)=6.197318e-001; ng(n+1)=1.808923e+003;
n=8; farx(n+1)=2.412954e+002; foe(n+1)=4.391983e+002; krok(n+1)=4.904612e-002; ng(n+1)=2.258612e+003;
n=9; farx(n+1)=1.407368e+002; foe(n+1)=3.226560e+002; krok(n+1)=1.300618e-001; ng(n+1)=1.957868e+003;
n=10; farx(n+1)=1.107687e+002; foe(n+1)=2.856078e+002; krok(n+1)=8.707243e-001; ng(n+1)=2.479179e+003;
n=11; farx(n+1)=1.072162e+002; foe(n+1)=2.689069e+002; krok(n+1)=1.715220e+000; ng(n+1)=2.129413e+002;
n=12; farx(n+1)=1.267872e+002; foe(n+1)=2.480596e+002; krok(n+1)=1.691553e+000; ng(n+1)=6.412975e+002;
n=13; farx(n+1)=1.160802e+002; foe(n+1)=2.305189e+002; krok(n+1)=2.740611e-001; ng(n+1)=3.160465e+002;
n=14; farx(n+1)=1.101062e+002; foe(n+1)=2.265744e+002; krok(n+1)=6.900644e-002; ng(n+1)=4.898695e+002;
n=15; farx(n+1)=3.221981e+001; foe(n+1)=1.437372e+002; krok(n+1)=3.904377e-001; ng(n+1)=4.921182e+002;
n=16; farx(n+1)=2.108263e+001; foe(n+1)=1.290200e+002; krok(n+1)=7.011953e-001; ng(n+1)=8.498834e+002;
n=17; farx(n+1)=1.837191e+001; foe(n+1)=1.162762e+002; krok(n+1)=4.366686e-001; ng(n+1)=6.809195e+002;
n=18; farx(n+1)=1.729534e+001; foe(n+1)=1.126265e+002; krok(n+1)=6.077026e-001; ng(n+1)=1.854752e+002;
n=19; farx(n+1)=1.075188e+001; foe(n+1)=9.898209e+001; krok(n+1)=8.457767e-001; ng(n+1)=7.898936e+002;
n=20; farx(n+1)=9.940715e+000; foe(n+1)=9.645794e+001; krok(n+1)=3.862514e-001; ng(n+1)=1.058861e+003;
n=21; farx(n+1)=9.445377e+000; foe(n+1)=9.424207e+001; krok(n+1)=4.063898e-001; ng(n+1)=1.729840e+002;
n=22; farx(n+1)=9.915118e+000; foe(n+1)=9.142034e+001; krok(n+1)=2.522670e-001; ng(n+1)=6.996396e+002;
n=23; farx(n+1)=9.784674e+000; foe(n+1)=8.862883e+001; krok(n+1)=1.214234e+000; ng(n+1)=8.122613e+002;
n=24; farx(n+1)=9.277224e+000; foe(n+1)=8.694998e+001; krok(n+1)=6.809733e-001; ng(n+1)=5.789927e+002;
n=25; farx(n+1)=9.309564e+000; foe(n+1)=8.485501e+001; krok(n+1)=1.187855e+000; ng(n+1)=6.347316e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.378681e+000; foe(n+1)=8.474931e+001; krok(n+1)=6.157404e-006; ng(n+1)=3.063045e+002;
n=27; farx(n+1)=9.264423e+000; foe(n+1)=8.465562e+001; krok(n+1)=2.254192e-005; ng(n+1)=1.406730e+002;
n=28; farx(n+1)=9.166630e+000; foe(n+1)=8.458699e+001; krok(n+1)=2.989017e-004; ng(n+1)=3.640698e+001;
n=29; farx(n+1)=9.297409e+000; foe(n+1)=8.389744e+001; krok(n+1)=2.914669e-003; ng(n+1)=3.449306e+001;
n=30; farx(n+1)=9.343719e+000; foe(n+1)=8.352927e+001; krok(n+1)=7.162643e-003; ng(n+1)=2.198518e+002;
n=31; farx(n+1)=9.270769e+000; foe(n+1)=8.350986e+001; krok(n+1)=9.659422e-003; ng(n+1)=4.383603e+002;
n=32; farx(n+1)=9.676071e+000; foe(n+1)=8.339141e+001; krok(n+1)=2.476948e-002; ng(n+1)=4.981340e+002;
n=33; farx(n+1)=9.408075e+000; foe(n+1)=8.310440e+001; krok(n+1)=1.255601e+000; ng(n+1)=4.234725e+002;
n=34; farx(n+1)=9.468168e+000; foe(n+1)=8.302545e+001; krok(n+1)=1.056270e+000; ng(n+1)=1.055723e+002;
n=35; farx(n+1)=9.342026e+000; foe(n+1)=8.301274e+001; krok(n+1)=1.120145e+000; ng(n+1)=5.244810e+001;
n=36; farx(n+1)=9.238648e+000; foe(n+1)=8.300728e+001; krok(n+1)=1.361947e+000; ng(n+1)=3.010631e+001;
n=37; farx(n+1)=9.160456e+000; foe(n+1)=8.300577e+001; krok(n+1)=2.240289e+000; ng(n+1)=1.393158e+001;
n=38; farx(n+1)=9.134090e+000; foe(n+1)=8.300561e+001; krok(n+1)=9.730681e-001; ng(n+1)=2.632120e+000;
n=39; farx(n+1)=9.134606e+000; foe(n+1)=8.300561e+001; krok(n+1)=9.727120e-001; ng(n+1)=7.147005e-001;
n=40; farx(n+1)=9.134746e+000; foe(n+1)=8.300561e+001; krok(n+1)=7.725027e-001; ng(n+1)=5.362670e-001;
n=41; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=8.256204e-001; ng(n+1)=2.076639e-002;
n=42; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=5.224312e-009; ng(n+1)=2.763730e-003;
n=43; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.434220e-009; ng(n+1)=2.763730e-003;
n=44; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=3.343560e-007; ng(n+1)=2.763730e-003;
n=45; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.356002e-007; ng(n+1)=2.763728e-003;
n=46; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.519406e-006; ng(n+1)=2.763728e-003;
n=47; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=9.657895e-009; ng(n+1)=2.763724e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=48; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=4.693127e-006; ng(n+1)=2.763724e-003;
n=49; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.294740e-005; ng(n+1)=2.346744e-003;
n=50; farx(n+1)=9.134822e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.360048e-004; ng(n+1)=7.483358e-004;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.134822e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.777520e-005; ng(n+1)=4.109715e-004;
n=52; farx(n+1)=9.134821e+000; foe(n+1)=8.300561e+001; krok(n+1)=5.229146e-005; ng(n+1)=9.810239e-004;
n=53; farx(n+1)=9.134820e+000; foe(n+1)=8.300561e+001; krok(n+1)=5.378705e-005; ng(n+1)=1.021661e-003;
n=54; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=6.847610e-004; ng(n+1)=5.752981e-004;
n=55; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=5.008451e-005; ng(n+1)=2.484798e-004;
n=56; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=5.632711e-006; ng(n+1)=2.483574e-004;
n=57; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.130389e-005; ng(n+1)=2.483579e-004;
n=58; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.407210e-008; ng(n+1)=2.483516e-004;
n=59; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=1.306078e-009; ng(n+1)=2.483516e-004;
n=60; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=2.287085e-011; ng(n+1)=2.483516e-004;
n=61; farx(n+1)=9.134817e+000; foe(n+1)=8.300561e+001; krok(n+1)=3.435602e-011; ng(n+1)=2.483516e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
