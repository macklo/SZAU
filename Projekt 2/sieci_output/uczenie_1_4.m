%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.838287e+003; foe(n+1)=4.866771e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.874763e+003; foe(n+1)=3.906418e+003; krok(n+1)=3.325065e-004; ng(n+1)=2.164402e+003;
n=2; farx(n+1)=8.050763e+002; foe(n+1)=8.009465e+002; krok(n+1)=1.017451e-002; ng(n+1)=5.388948e+002;
n=3; farx(n+1)=7.478787e+002; foe(n+1)=6.341286e+002; krok(n+1)=5.704577e-004; ng(n+1)=1.195168e+003;
n=4; farx(n+1)=6.133729e+002; foe(n+1)=5.082975e+002; krok(n+1)=1.106947e-003; ng(n+1)=1.078767e+003;
n=5; farx(n+1)=5.372946e+002; foe(n+1)=4.991168e+002; krok(n+1)=1.339882e-002; ng(n+1)=3.621544e+002;
n=6; farx(n+1)=5.251949e+002; foe(n+1)=4.838289e+002; krok(n+1)=1.483527e-001; ng(n+1)=3.593532e+002;
n=7; farx(n+1)=5.127909e+002; foe(n+1)=4.755863e+002; krok(n+1)=3.201356e-002; ng(n+1)=3.366531e+002;
n=8; farx(n+1)=4.819528e+002; foe(n+1)=4.514077e+002; krok(n+1)=1.963396e-002; ng(n+1)=3.707165e+002;
n=9; farx(n+1)=4.679478e+002; foe(n+1)=4.267707e+002; krok(n+1)=5.223159e-001; ng(n+1)=8.251142e+002;
n=10; farx(n+1)=4.903417e+002; foe(n+1)=4.112365e+002; krok(n+1)=8.576098e-001; ng(n+1)=3.710946e+002;
n=11; farx(n+1)=4.866769e+002; foe(n+1)=4.026273e+002; krok(n+1)=1.238762e+000; ng(n+1)=1.842212e+002;
n=12; farx(n+1)=4.685840e+002; foe(n+1)=4.013553e+002; krok(n+1)=1.214233e+000; ng(n+1)=9.217571e+001;
n=13; farx(n+1)=4.504814e+002; foe(n+1)=3.981666e+002; krok(n+1)=5.544063e+000; ng(n+1)=9.831942e+001;
n=14; farx(n+1)=3.248933e+002; foe(n+1)=3.823261e+002; krok(n+1)=3.138952e+000; ng(n+1)=9.671306e+001;
n=15; farx(n+1)=2.274656e+002; foe(n+1)=3.749147e+002; krok(n+1)=1.036878e-001; ng(n+1)=5.229298e+002;
n=16; farx(n+1)=1.032964e+002; foe(n+1)=3.521755e+002; krok(n+1)=1.545508e-001; ng(n+1)=1.315461e+003;
n=17; farx(n+1)=9.877681e+001; foe(n+1)=3.515261e+002; krok(n+1)=9.150227e-003; ng(n+1)=2.424774e+003;
n=18; farx(n+1)=1.016175e+002; foe(n+1)=2.961348e+002; krok(n+1)=8.457767e-001; ng(n+1)=2.741498e+003;
n=19; farx(n+1)=1.032917e+002; foe(n+1)=2.796675e+002; krok(n+1)=5.205007e-002; ng(n+1)=3.682268e+003;
n=20; farx(n+1)=9.285454e+001; foe(n+1)=2.393016e+002; krok(n+1)=4.787134e-001; ng(n+1)=3.485556e+003;
n=21; farx(n+1)=8.435992e+001; foe(n+1)=2.046035e+002; krok(n+1)=1.717868e-001; ng(n+1)=1.166941e+003;
n=22; farx(n+1)=7.405043e+001; foe(n+1)=1.936778e+002; krok(n+1)=1.668612e-001; ng(n+1)=3.703860e+003;
n=23; farx(n+1)=5.111690e+001; foe(n+1)=1.633557e+002; krok(n+1)=5.312625e-001; ng(n+1)=1.602033e+003;
n=24; farx(n+1)=3.501940e+001; foe(n+1)=1.332428e+002; krok(n+1)=1.835160e+000; ng(n+1)=3.893687e+003;
n=25; farx(n+1)=2.253688e+001; foe(n+1)=1.196403e+002; krok(n+1)=1.435731e+000; ng(n+1)=2.631000e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.230145e+001; foe(n+1)=1.188314e+002; krok(n+1)=1.000163e-006; ng(n+1)=1.804270e+003;
n=27; farx(n+1)=2.028116e+001; foe(n+1)=1.124860e+002; krok(n+1)=2.695564e-004; ng(n+1)=3.112495e+002;
n=28; farx(n+1)=2.037256e+001; foe(n+1)=1.111985e+002; krok(n+1)=1.691914e-004; ng(n+1)=1.072583e+003;
n=29; farx(n+1)=1.428643e+001; foe(n+1)=1.018146e+002; krok(n+1)=4.168272e-004; ng(n+1)=3.494569e+002;
n=30; farx(n+1)=1.559941e+001; foe(n+1)=9.970177e+001; krok(n+1)=6.752731e-004; ng(n+1)=2.818437e+003;
n=31; farx(n+1)=1.539708e+001; foe(n+1)=9.548336e+001; krok(n+1)=7.739087e-003; ng(n+1)=3.599903e+003;
n=32; farx(n+1)=1.315357e+001; foe(n+1)=9.234038e+001; krok(n+1)=1.032872e-001; ng(n+1)=2.919931e+003;
n=33; farx(n+1)=1.333771e+001; foe(n+1)=8.992119e+001; krok(n+1)=5.344503e-001; ng(n+1)=3.223186e+003;
n=34; farx(n+1)=1.427042e+001; foe(n+1)=8.825227e+001; krok(n+1)=5.101414e-001; ng(n+1)=2.390162e+003;
n=35; farx(n+1)=1.340538e+001; foe(n+1)=8.596071e+001; krok(n+1)=1.273478e+000; ng(n+1)=1.537884e+003;
n=36; farx(n+1)=1.158320e+001; foe(n+1)=8.368874e+001; krok(n+1)=1.402391e+000; ng(n+1)=7.408069e+002;
n=37; farx(n+1)=1.120238e+001; foe(n+1)=8.262701e+001; krok(n+1)=4.964490e-001; ng(n+1)=1.626823e+002;
n=38; farx(n+1)=1.126015e+001; foe(n+1)=8.210327e+001; krok(n+1)=7.248392e-001; ng(n+1)=5.981212e+002;
n=39; farx(n+1)=1.140683e+001; foe(n+1)=8.167096e+001; krok(n+1)=1.454334e+000; ng(n+1)=1.252283e+002;
n=40; farx(n+1)=1.132953e+001; foe(n+1)=8.158662e+001; krok(n+1)=7.848019e-001; ng(n+1)=2.334793e+002;
n=41; farx(n+1)=1.130596e+001; foe(n+1)=8.157625e+001; krok(n+1)=6.011939e-001; ng(n+1)=4.028135e+001;
n=42; farx(n+1)=1.130068e+001; foe(n+1)=8.157498e+001; krok(n+1)=7.382907e-001; ng(n+1)=3.761837e+000;
n=43; farx(n+1)=1.130956e+001; foe(n+1)=8.157483e+001; krok(n+1)=7.101669e-001; ng(n+1)=1.969694e+001;
n=44; farx(n+1)=1.130634e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.489674e+000; ng(n+1)=2.207002e+000;
n=45; farx(n+1)=1.130428e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.361453e+000; ng(n+1)=1.597523e+000;
n=46; farx(n+1)=1.130435e+001; foe(n+1)=8.157480e+001; krok(n+1)=2.788240e+000; ng(n+1)=5.321626e-001;
n=47; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.098329e+000; ng(n+1)=1.506623e-001;
n=48; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=5.275571e-006; ng(n+1)=2.251333e-003;
n=49; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=6.687119e-007; ng(n+1)=2.251321e-003;
n=50; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=3.736138e-006; ng(n+1)=2.251320e-003;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=6.307179e-006; ng(n+1)=2.251311e-003;
n=52; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=7.231391e-006; ng(n+1)=4.128219e-003;
n=53; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=5.581911e-005; ng(n+1)=1.242820e-003;
n=54; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=8.897543e-006; ng(n+1)=4.097386e-004;
n=55; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.845470e-010; ng(n+1)=4.095545e-004;
n=56; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=6.775887e-010; ng(n+1)=4.095545e-004;
n=57; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=9.514774e-010; ng(n+1)=4.095546e-004;
n=58; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.016742e-008; ng(n+1)=4.095551e-004;
n=59; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=2.099630e-009; ng(n+1)=4.095550e-004;
n=60; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=5.586175e-008; ng(n+1)=4.095548e-004;
n=61; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=6.982719e-009; ng(n+1)=4.095548e-004;
n=62; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=5.570876e-007; ng(n+1)=4.095548e-004;
n=63; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.565125e-005; ng(n+1)=2.846543e-003;
n=64; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=3.986692e-008; ng(n+1)=2.846507e-003;
n=65; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=6.194562e-010; ng(n+1)=2.846507e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=66; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.435714e-006; ng(n+1)=2.846506e-003;
n=67; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=2.181104e-005; ng(n+1)=6.272390e-004;
n=68; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=4.260779e-005; ng(n+1)=1.319094e-004;
n=69; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=4.389451e-007; ng(n+1)=1.272674e-004;
n=70; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=2.926265e-006; ng(n+1)=1.272687e-004;
n=71; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.636252e-005; ng(n+1)=1.272628e-004;
n=72; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=1.214239e-007; ng(n+1)=1.272499e-004;
n=73; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=4.006344e-006; ng(n+1)=1.272498e-004;
n=74; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=6.718817e-008; ng(n+1)=1.272468e-004;
n=75; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=2.793088e-008; ng(n+1)=1.272467e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=4.178527e-011; ng(n+1)=1.272467e-004;
n=77; farx(n+1)=1.130425e+001; foe(n+1)=8.157480e+001; krok(n+1)=2.067690e-011; ng(n+1)=1.272428e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
