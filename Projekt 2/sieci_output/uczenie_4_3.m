%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.971386e+003; foe(n+1)=4.026377e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.780244e+003; foe(n+1)=2.929204e+003; krok(n+1)=4.807698e-004; ng(n+1)=2.873645e+003;
n=2; farx(n+1)=1.005295e+003; foe(n+1)=1.130640e+003; krok(n+1)=2.983929e-003; ng(n+1)=1.610716e+003;
n=3; farx(n+1)=1.108691e+003; foe(n+1)=9.263965e+002; krok(n+1)=7.502023e-005; ng(n+1)=7.160219e+003;
n=4; farx(n+1)=2.062351e+003; foe(n+1)=5.591586e+002; krok(n+1)=1.651908e-003; ng(n+1)=8.314368e+003;
n=5; farx(n+1)=1.484224e+003; foe(n+1)=4.770652e+002; krok(n+1)=3.912002e-003; ng(n+1)=1.041664e+003;
n=6; farx(n+1)=8.555403e+002; foe(n+1)=3.899459e+002; krok(n+1)=1.178943e-003; ng(n+1)=1.051239e+003;
n=7; farx(n+1)=6.043738e+002; foe(n+1)=3.578122e+002; krok(n+1)=1.179900e-003; ng(n+1)=1.002888e+003;
n=8; farx(n+1)=4.890141e+002; foe(n+1)=3.369366e+002; krok(n+1)=6.446985e-003; ng(n+1)=5.280609e+002;
n=9; farx(n+1)=4.522722e+002; foe(n+1)=3.252579e+002; krok(n+1)=8.346822e-003; ng(n+1)=2.407685e+002;
n=10; farx(n+1)=3.727367e+002; foe(n+1)=3.162912e+002; krok(n+1)=2.444561e-003; ng(n+1)=3.105331e+002;
n=11; farx(n+1)=3.241684e+002; foe(n+1)=3.105408e+002; krok(n+1)=1.758026e-003; ng(n+1)=3.921137e+002;
n=12; farx(n+1)=2.608309e+002; foe(n+1)=2.970782e+002; krok(n+1)=6.700076e-003; ng(n+1)=6.032900e+002;
n=13; farx(n+1)=2.426752e+002; foe(n+1)=2.886128e+002; krok(n+1)=5.173682e-003; ng(n+1)=1.588508e+003;
n=14; farx(n+1)=2.357124e+002; foe(n+1)=2.798630e+002; krok(n+1)=1.982937e-002; ng(n+1)=2.385892e+003;
n=15; farx(n+1)=2.476209e+002; foe(n+1)=2.755956e+002; krok(n+1)=2.739044e-003; ng(n+1)=4.078154e+003;
n=16; farx(n+1)=2.475807e+002; foe(n+1)=2.662310e+002; krok(n+1)=1.640862e-002; ng(n+1)=4.117947e+003;
n=17; farx(n+1)=2.426319e+002; foe(n+1)=2.622748e+002; krok(n+1)=3.151553e-003; ng(n+1)=2.956117e+003;
n=18; farx(n+1)=2.263881e+002; foe(n+1)=2.559463e+002; krok(n+1)=1.448480e-002; ng(n+1)=3.172663e+003;
n=19; farx(n+1)=2.076595e+002; foe(n+1)=2.494659e+002; krok(n+1)=3.752448e-003; ng(n+1)=2.282992e+003;
n=20; farx(n+1)=1.790693e+002; foe(n+1)=2.440612e+002; krok(n+1)=5.445782e-003; ng(n+1)=1.839489e+003;
n=21; farx(n+1)=1.634312e+002; foe(n+1)=2.361979e+002; krok(n+1)=1.165759e-002; ng(n+1)=2.986569e+003;
n=22; farx(n+1)=1.596407e+002; foe(n+1)=2.240864e+002; krok(n+1)=6.192369e-003; ng(n+1)=2.744568e+003;
n=23; farx(n+1)=1.276100e+002; foe(n+1)=2.028997e+002; krok(n+1)=1.095618e-002; ng(n+1)=2.037983e+003;
n=24; farx(n+1)=1.197259e+002; foe(n+1)=1.988305e+002; krok(n+1)=2.232764e-004; ng(n+1)=9.224780e+003;
n=25; farx(n+1)=9.750021e+001; foe(n+1)=1.861132e+002; krok(n+1)=5.381741e-003; ng(n+1)=3.233108e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.443385e+001; foe(n+1)=1.842827e+002; krok(n+1)=5.126555e-006; ng(n+1)=2.892418e+003;
n=27; farx(n+1)=6.677187e+001; foe(n+1)=1.238671e+002; krok(n+1)=7.395359e-005; ng(n+1)=4.156688e+003;
n=28; farx(n+1)=6.467254e+001; foe(n+1)=1.156674e+002; krok(n+1)=9.012338e-005; ng(n+1)=2.451135e+003;
n=29; farx(n+1)=5.538937e+001; foe(n+1)=9.405345e+001; krok(n+1)=1.733806e-004; ng(n+1)=1.269358e+003;
n=30; farx(n+1)=4.706055e+001; foe(n+1)=6.701845e+001; krok(n+1)=5.033545e-004; ng(n+1)=1.207483e+003;
n=31; farx(n+1)=4.510359e+001; foe(n+1)=6.532897e+001; krok(n+1)=2.456241e-004; ng(n+1)=2.075026e+003;
n=32; farx(n+1)=2.909454e+001; foe(n+1)=4.776942e+001; krok(n+1)=7.251821e-003; ng(n+1)=2.856777e+003;
n=33; farx(n+1)=2.286895e+001; foe(n+1)=4.147079e+001; krok(n+1)=8.839546e-003; ng(n+1)=7.898430e+002;
n=34; farx(n+1)=1.550210e+001; foe(n+1)=3.268995e+001; krok(n+1)=4.702595e-003; ng(n+1)=1.521493e+003;
n=35; farx(n+1)=1.506285e+001; foe(n+1)=3.190220e+001; krok(n+1)=7.624904e-004; ng(n+1)=5.331337e+002;
n=36; farx(n+1)=1.326600e+001; foe(n+1)=2.915090e+001; krok(n+1)=3.229291e-002; ng(n+1)=1.092455e+003;
n=37; farx(n+1)=1.271441e+001; foe(n+1)=2.765660e+001; krok(n+1)=1.387045e-003; ng(n+1)=2.038679e+003;
n=38; farx(n+1)=1.239093e+001; foe(n+1)=2.718220e+001; krok(n+1)=5.214412e-003; ng(n+1)=2.636376e+003;
n=39; farx(n+1)=1.236367e+001; foe(n+1)=2.379480e+001; krok(n+1)=3.222183e-002; ng(n+1)=2.862270e+003;
n=40; farx(n+1)=1.200908e+001; foe(n+1)=2.190721e+001; krok(n+1)=4.799811e-002; ng(n+1)=1.023679e+003;
n=41; farx(n+1)=1.101992e+001; foe(n+1)=2.057001e+001; krok(n+1)=4.756755e-002; ng(n+1)=5.814878e+002;
n=42; farx(n+1)=1.111686e+001; foe(n+1)=1.943875e+001; krok(n+1)=3.747106e-002; ng(n+1)=5.697317e+002;
n=43; farx(n+1)=8.774192e+000; foe(n+1)=1.611959e+001; krok(n+1)=1.011122e-001; ng(n+1)=4.479092e+002;
n=44; farx(n+1)=8.174059e+000; foe(n+1)=1.549001e+001; krok(n+1)=4.710295e-002; ng(n+1)=2.436089e+002;
n=45; farx(n+1)=8.156336e+000; foe(n+1)=1.478054e+001; krok(n+1)=1.935340e-001; ng(n+1)=2.959078e+002;
n=46; farx(n+1)=7.912508e+000; foe(n+1)=1.417322e+001; krok(n+1)=2.226006e-001; ng(n+1)=2.351439e+002;
n=47; farx(n+1)=7.622995e+000; foe(n+1)=1.376108e+001; krok(n+1)=2.301336e-001; ng(n+1)=5.446030e+002;
n=48; farx(n+1)=6.947426e+000; foe(n+1)=1.321515e+001; krok(n+1)=7.310195e-001; ng(n+1)=4.059393e+002;
n=49; farx(n+1)=6.663316e+000; foe(n+1)=1.291907e+001; krok(n+1)=1.620110e-001; ng(n+1)=4.998713e+002;
n=50; farx(n+1)=4.655883e+000; foe(n+1)=1.057854e+001; krok(n+1)=6.970601e-001; ng(n+1)=5.772076e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.652768e+000; foe(n+1)=1.014075e+001; krok(n+1)=6.202616e-006; ng(n+1)=9.271298e+002;
n=52; farx(n+1)=4.614959e+000; foe(n+1)=1.003780e+001; krok(n+1)=4.073759e-005; ng(n+1)=1.789114e+002;
n=53; farx(n+1)=4.625336e+000; foe(n+1)=9.928916e+000; krok(n+1)=4.342261e-004; ng(n+1)=6.128460e+001;
n=54; farx(n+1)=4.617358e+000; foe(n+1)=9.809754e+000; krok(n+1)=1.191796e-004; ng(n+1)=1.157532e+002;
n=55; farx(n+1)=4.613536e+000; foe(n+1)=9.478269e+000; krok(n+1)=8.055458e-003; ng(n+1)=3.552685e+001;
n=56; farx(n+1)=4.562753e+000; foe(n+1)=9.230729e+000; krok(n+1)=1.635770e-003; ng(n+1)=1.535826e+002;
n=57; farx(n+1)=4.460610e+000; foe(n+1)=8.952094e+000; krok(n+1)=3.094863e-002; ng(n+1)=4.163258e+002;
n=58; farx(n+1)=4.469600e+000; foe(n+1)=8.835205e+000; krok(n+1)=5.557598e-003; ng(n+1)=1.481769e+002;
n=59; farx(n+1)=4.420659e+000; foe(n+1)=8.695643e+000; krok(n+1)=1.382426e-002; ng(n+1)=2.696411e+002;
n=60; farx(n+1)=4.433674e+000; foe(n+1)=8.546692e+000; krok(n+1)=1.857911e-002; ng(n+1)=3.046030e+002;
n=61; farx(n+1)=4.095072e+000; foe(n+1)=7.983533e+000; krok(n+1)=6.601690e-002; ng(n+1)=1.968925e+002;
n=62; farx(n+1)=3.978508e+000; foe(n+1)=7.688271e+000; krok(n+1)=3.516052e-003; ng(n+1)=4.765128e+002;
n=63; farx(n+1)=3.762105e+000; foe(n+1)=7.133882e+000; krok(n+1)=4.828142e-002; ng(n+1)=2.332634e+002;
n=64; farx(n+1)=3.651265e+000; foe(n+1)=6.931458e+000; krok(n+1)=5.411858e-002; ng(n+1)=1.022814e+002;
n=65; farx(n+1)=3.400077e+000; foe(n+1)=6.616111e+000; krok(n+1)=4.838350e-002; ng(n+1)=4.933905e+002;
n=66; farx(n+1)=3.035724e+000; foe(n+1)=6.186389e+000; krok(n+1)=3.791679e-002; ng(n+1)=3.419704e+002;
n=67; farx(n+1)=2.431672e+000; foe(n+1)=5.308279e+000; krok(n+1)=2.745822e-001; ng(n+1)=1.717031e+002;
n=68; farx(n+1)=2.277658e+000; foe(n+1)=4.955509e+000; krok(n+1)=1.158784e-001; ng(n+1)=1.946131e+002;
n=69; farx(n+1)=2.299975e+000; foe(n+1)=4.812801e+000; krok(n+1)=1.392836e-001; ng(n+1)=3.080853e+002;
n=70; farx(n+1)=2.259911e+000; foe(n+1)=4.708717e+000; krok(n+1)=1.101559e-001; ng(n+1)=1.747404e+002;
n=71; farx(n+1)=2.111908e+000; foe(n+1)=4.226798e+000; krok(n+1)=2.418297e-001; ng(n+1)=2.984894e+002;
n=72; farx(n+1)=2.140420e+000; foe(n+1)=3.999762e+000; krok(n+1)=1.093247e-001; ng(n+1)=1.599115e+002;
n=73; farx(n+1)=2.110566e+000; foe(n+1)=3.864965e+000; krok(n+1)=1.475580e-001; ng(n+1)=2.639794e+002;
n=74; farx(n+1)=2.027878e+000; foe(n+1)=3.732131e+000; krok(n+1)=3.923690e-001; ng(n+1)=2.809425e+002;
n=75; farx(n+1)=1.932854e+000; foe(n+1)=3.616752e+000; krok(n+1)=4.872449e-001; ng(n+1)=1.092665e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.924723e+000; foe(n+1)=3.572695e+000; krok(n+1)=1.773994e-005; ng(n+1)=1.656470e+002;
n=77; farx(n+1)=1.922719e+000; foe(n+1)=3.570607e+000; krok(n+1)=7.698578e-006; ng(n+1)=5.412539e+001;
n=78; farx(n+1)=1.927921e+000; foe(n+1)=3.542154e+000; krok(n+1)=2.550371e-004; ng(n+1)=3.737303e+001;
n=79; farx(n+1)=1.944966e+000; foe(n+1)=3.501481e+000; krok(n+1)=1.662532e-004; ng(n+1)=5.193080e+001;
n=80; farx(n+1)=1.944361e+000; foe(n+1)=3.476801e+000; krok(n+1)=2.368463e-003; ng(n+1)=1.397047e+001;
n=81; farx(n+1)=1.917122e+000; foe(n+1)=3.434795e+000; krok(n+1)=4.522618e-003; ng(n+1)=1.936084e+001;
n=82; farx(n+1)=1.896020e+000; foe(n+1)=3.348904e+000; krok(n+1)=1.139839e-002; ng(n+1)=7.809426e+001;
n=83; farx(n+1)=1.845075e+000; foe(n+1)=3.303848e+000; krok(n+1)=1.567500e-002; ng(n+1)=2.263230e+002;
n=84; farx(n+1)=1.863160e+000; foe(n+1)=3.283957e+000; krok(n+1)=2.991958e-002; ng(n+1)=2.271014e+002;
n=85; farx(n+1)=1.860434e+000; foe(n+1)=3.258787e+000; krok(n+1)=2.024365e-002; ng(n+1)=1.831493e+002;
n=86; farx(n+1)=1.925480e+000; foe(n+1)=3.214145e+000; krok(n+1)=2.936823e-002; ng(n+1)=2.179051e+002;
n=87; farx(n+1)=1.949844e+000; foe(n+1)=3.194726e+000; krok(n+1)=7.236188e-002; ng(n+1)=7.289095e+001;
n=88; farx(n+1)=1.961044e+000; foe(n+1)=3.125650e+000; krok(n+1)=8.430727e-002; ng(n+1)=1.105817e+002;
n=89; farx(n+1)=1.949275e+000; foe(n+1)=3.049744e+000; krok(n+1)=2.501951e-002; ng(n+1)=2.424435e+002;
n=90; farx(n+1)=1.855120e+000; foe(n+1)=2.993362e+000; krok(n+1)=1.596372e-002; ng(n+1)=1.136011e+002;
n=91; farx(n+1)=1.745906e+000; foe(n+1)=2.896236e+000; krok(n+1)=1.827549e-001; ng(n+1)=1.899320e+002;
n=92; farx(n+1)=1.713025e+000; foe(n+1)=2.866530e+000; krok(n+1)=2.721013e-002; ng(n+1)=1.595293e+002;
n=93; farx(n+1)=1.578895e+000; foe(n+1)=2.768355e+000; krok(n+1)=1.213694e-001; ng(n+1)=1.362193e+002;
n=94; farx(n+1)=1.570675e+000; foe(n+1)=2.651433e+000; krok(n+1)=4.587901e-001; ng(n+1)=1.837830e+002;
n=95; farx(n+1)=1.572165e+000; foe(n+1)=2.578178e+000; krok(n+1)=1.124683e-001; ng(n+1)=2.747054e+002;
n=96; farx(n+1)=1.535555e+000; foe(n+1)=2.469250e+000; krok(n+1)=2.800362e-001; ng(n+1)=3.937895e+002;
n=97; farx(n+1)=1.510724e+000; foe(n+1)=2.391851e+000; krok(n+1)=1.237945e-001; ng(n+1)=7.810848e+001;
n=98; farx(n+1)=1.478710e+000; foe(n+1)=2.302001e+000; krok(n+1)=2.656312e-001; ng(n+1)=1.012135e+002;
n=99; farx(n+1)=1.411763e+000; foe(n+1)=2.264054e+000; krok(n+1)=1.288873e-001; ng(n+1)=4.569905e+001;
n=100; farx(n+1)=1.310861e+000; foe(n+1)=2.189396e+000; krok(n+1)=9.363811e-002; ng(n+1)=1.892972e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
