%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.625006e+003; foe(n+1)=4.672600e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.997517e+003; foe(n+1)=2.957866e+003; krok(n+1)=5.014459e-004; ng(n+1)=4.616286e+003;
n=2; farx(n+1)=9.236698e+002; foe(n+1)=8.463076e+002; krok(n+1)=3.657312e-003; ng(n+1)=1.899580e+003;
n=3; farx(n+1)=9.870897e+002; foe(n+1)=6.287117e+002; krok(n+1)=1.395032e-004; ng(n+1)=6.191295e+003;
n=4; farx(n+1)=1.245943e+003; foe(n+1)=5.418711e+002; krok(n+1)=3.423805e-004; ng(n+1)=5.872669e+003;
n=5; farx(n+1)=6.342144e+002; foe(n+1)=4.197610e+002; krok(n+1)=1.053841e-002; ng(n+1)=7.239882e+002;
n=6; farx(n+1)=5.352979e+002; foe(n+1)=3.999492e+002; krok(n+1)=3.831728e-004; ng(n+1)=2.542966e+003;
n=7; farx(n+1)=1.360468e+002; foe(n+1)=2.795052e+002; krok(n+1)=1.644128e-003; ng(n+1)=2.832787e+003;
n=8; farx(n+1)=1.156223e+002; foe(n+1)=2.730400e+002; krok(n+1)=8.104372e-005; ng(n+1)=4.488377e+003;
n=9; farx(n+1)=1.057577e+002; foe(n+1)=2.590211e+002; krok(n+1)=6.380132e-003; ng(n+1)=3.798842e+003;
n=10; farx(n+1)=1.146730e+002; foe(n+1)=2.419291e+002; krok(n+1)=4.395065e-004; ng(n+1)=4.694785e+003;
n=11; farx(n+1)=1.192936e+002; foe(n+1)=2.261422e+002; krok(n+1)=6.647718e-004; ng(n+1)=4.930375e+003;
n=12; farx(n+1)=1.056006e+002; foe(n+1)=2.142521e+002; krok(n+1)=1.908037e-003; ng(n+1)=3.353690e+003;
n=13; farx(n+1)=7.964845e+001; foe(n+1)=1.988206e+002; krok(n+1)=2.300371e-003; ng(n+1)=1.868007e+003;
n=14; farx(n+1)=4.453352e+001; foe(n+1)=1.567710e+002; krok(n+1)=2.774090e-003; ng(n+1)=2.266066e+003;
n=15; farx(n+1)=4.254009e+001; foe(n+1)=1.546198e+002; krok(n+1)=2.578785e-004; ng(n+1)=1.313936e+003;
n=16; farx(n+1)=3.973301e+001; foe(n+1)=1.518095e+002; krok(n+1)=7.821151e-004; ng(n+1)=1.377077e+003;
n=17; farx(n+1)=4.191609e+001; foe(n+1)=1.476663e+002; krok(n+1)=3.174920e-003; ng(n+1)=1.025332e+003;
n=18; farx(n+1)=3.765022e+001; foe(n+1)=1.414943e+002; krok(n+1)=3.698907e-003; ng(n+1)=1.320851e+003;
n=19; farx(n+1)=2.573716e+001; foe(n+1)=1.217112e+002; krok(n+1)=5.355898e-003; ng(n+1)=2.278841e+003;
n=20; farx(n+1)=2.521125e+001; foe(n+1)=1.154296e+002; krok(n+1)=1.532691e-003; ng(n+1)=1.275187e+003;
n=21; farx(n+1)=2.587773e+001; foe(n+1)=1.103354e+002; krok(n+1)=3.595838e-003; ng(n+1)=2.136336e+003;
n=22; farx(n+1)=3.067699e+001; foe(n+1)=1.064445e+002; krok(n+1)=1.131031e-002; ng(n+1)=4.167404e+003;
n=23; farx(n+1)=3.792873e+001; foe(n+1)=9.175671e+001; krok(n+1)=8.252113e-003; ng(n+1)=3.155920e+003;
n=24; farx(n+1)=3.404179e+001; foe(n+1)=8.646303e+001; krok(n+1)=4.874376e-003; ng(n+1)=1.084901e+003;
n=25; farx(n+1)=2.906998e+001; foe(n+1)=8.078407e+001; krok(n+1)=4.806865e-003; ng(n+1)=2.607383e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.989794e+001; foe(n+1)=7.565890e+001; krok(n+1)=3.030084e-005; ng(n+1)=1.381050e+003;
n=27; farx(n+1)=2.971869e+001; foe(n+1)=7.206845e+001; krok(n+1)=1.215525e-005; ng(n+1)=2.252203e+003;
n=28; farx(n+1)=2.765719e+001; foe(n+1)=6.704963e+001; krok(n+1)=1.213638e-004; ng(n+1)=9.213885e+002;
n=29; farx(n+1)=3.432892e+001; foe(n+1)=6.046454e+001; krok(n+1)=4.927090e-004; ng(n+1)=1.331880e+003;
n=30; farx(n+1)=2.565436e+001; foe(n+1)=4.528914e+001; krok(n+1)=1.448033e-003; ng(n+1)=1.172605e+003;
n=31; farx(n+1)=2.379369e+001; foe(n+1)=4.083203e+001; krok(n+1)=1.222281e-003; ng(n+1)=5.052431e+003;
n=32; farx(n+1)=1.525057e+001; foe(n+1)=3.216798e+001; krok(n+1)=1.896397e-003; ng(n+1)=4.801879e+003;
n=33; farx(n+1)=1.337236e+001; foe(n+1)=2.846138e+001; krok(n+1)=4.282689e-003; ng(n+1)=3.301431e+002;
n=34; farx(n+1)=1.161706e+001; foe(n+1)=2.601718e+001; krok(n+1)=2.778799e-003; ng(n+1)=7.569137e+002;
n=35; farx(n+1)=1.011144e+001; foe(n+1)=2.372856e+001; krok(n+1)=5.485375e-003; ng(n+1)=5.837732e+002;
n=36; farx(n+1)=8.741291e+000; foe(n+1)=2.204026e+001; krok(n+1)=4.669112e-003; ng(n+1)=4.549350e+002;
n=37; farx(n+1)=8.105468e+000; foe(n+1)=2.070734e+001; krok(n+1)=1.082825e-002; ng(n+1)=1.913434e+002;
n=38; farx(n+1)=7.618945e+000; foe(n+1)=1.999234e+001; krok(n+1)=9.787685e-003; ng(n+1)=3.973250e+002;
n=39; farx(n+1)=6.261883e+000; foe(n+1)=1.859748e+001; krok(n+1)=2.107682e-002; ng(n+1)=6.816573e+002;
n=40; farx(n+1)=5.340361e+000; foe(n+1)=1.699834e+001; krok(n+1)=5.722022e-002; ng(n+1)=1.378319e+003;
n=41; farx(n+1)=4.551538e+000; foe(n+1)=1.545598e+001; krok(n+1)=6.071802e-003; ng(n+1)=1.421539e+003;
n=42; farx(n+1)=4.309639e+000; foe(n+1)=1.481465e+001; krok(n+1)=7.032104e-003; ng(n+1)=3.966092e+002;
n=43; farx(n+1)=4.149888e+000; foe(n+1)=1.390767e+001; krok(n+1)=1.669364e-002; ng(n+1)=7.646175e+002;
n=44; farx(n+1)=3.671618e+000; foe(n+1)=1.257375e+001; krok(n+1)=9.683632e-003; ng(n+1)=9.221543e+002;
n=45; farx(n+1)=3.343125e+000; foe(n+1)=1.194640e+001; krok(n+1)=5.829338e-003; ng(n+1)=1.024352e+003;
n=46; farx(n+1)=3.219062e+000; foe(n+1)=1.140937e+001; krok(n+1)=1.142218e-002; ng(n+1)=1.176650e+003;
n=47; farx(n+1)=3.029944e+000; foe(n+1)=1.018992e+001; krok(n+1)=3.201972e-002; ng(n+1)=1.008617e+003;
n=48; farx(n+1)=2.984634e+000; foe(n+1)=9.937461e+000; krok(n+1)=5.295103e-003; ng(n+1)=3.406144e+002;
n=49; farx(n+1)=2.941557e+000; foe(n+1)=9.577458e+000; krok(n+1)=2.517497e-002; ng(n+1)=8.345424e+002;
n=50; farx(n+1)=2.569595e+000; foe(n+1)=8.799563e+000; krok(n+1)=3.301014e-002; ng(n+1)=8.412544e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.585423e+000; foe(n+1)=8.437952e+000; krok(n+1)=2.548851e-005; ng(n+1)=5.032517e+002;
n=52; farx(n+1)=2.542340e+000; foe(n+1)=8.185275e+000; krok(n+1)=9.479621e-006; ng(n+1)=6.968809e+002;
n=53; farx(n+1)=2.529047e+000; foe(n+1)=8.160731e+000; krok(n+1)=3.514435e-005; ng(n+1)=1.162253e+002;
n=54; farx(n+1)=2.549865e+000; foe(n+1)=7.975346e+000; krok(n+1)=3.276764e-004; ng(n+1)=1.202041e+002;
n=55; farx(n+1)=2.565982e+000; foe(n+1)=7.657731e+000; krok(n+1)=5.324041e-004; ng(n+1)=1.356951e+002;
n=56; farx(n+1)=2.432313e+000; foe(n+1)=7.131538e+000; krok(n+1)=8.029022e-003; ng(n+1)=1.656831e+002;
n=57; farx(n+1)=2.358543e+000; foe(n+1)=6.514899e+000; krok(n+1)=6.970444e-003; ng(n+1)=4.254740e+002;
n=58; farx(n+1)=2.285542e+000; foe(n+1)=6.273522e+000; krok(n+1)=3.023106e-003; ng(n+1)=4.822676e+002;
n=59; farx(n+1)=2.120194e+000; foe(n+1)=5.796986e+000; krok(n+1)=2.340953e-002; ng(n+1)=2.581397e+002;
n=60; farx(n+1)=2.127441e+000; foe(n+1)=5.614518e+000; krok(n+1)=6.256921e-003; ng(n+1)=3.790942e+002;
n=61; farx(n+1)=2.139514e+000; foe(n+1)=5.484368e+000; krok(n+1)=6.026360e-003; ng(n+1)=6.912635e+002;
n=62; farx(n+1)=2.198529e+000; foe(n+1)=5.069475e+000; krok(n+1)=1.360507e-002; ng(n+1)=4.186001e+002;
n=63; farx(n+1)=2.176739e+000; foe(n+1)=4.905528e+000; krok(n+1)=8.073226e-003; ng(n+1)=2.287435e+002;
n=64; farx(n+1)=2.166838e+000; foe(n+1)=4.826447e+000; krok(n+1)=1.153579e-002; ng(n+1)=1.804315e+002;
n=65; farx(n+1)=2.164238e+000; foe(n+1)=4.657859e+000; krok(n+1)=1.126281e-002; ng(n+1)=1.844565e+002;
n=66; farx(n+1)=2.076876e+000; foe(n+1)=4.345706e+000; krok(n+1)=1.761298e-002; ng(n+1)=2.069783e+002;
n=67; farx(n+1)=2.019828e+000; foe(n+1)=4.218490e+000; krok(n+1)=2.277959e-002; ng(n+1)=3.222436e+002;
n=68; farx(n+1)=1.913245e+000; foe(n+1)=3.993222e+000; krok(n+1)=1.634950e-002; ng(n+1)=4.228147e+002;
n=69; farx(n+1)=1.840673e+000; foe(n+1)=3.874049e+000; krok(n+1)=3.002384e-002; ng(n+1)=2.052792e+002;
n=70; farx(n+1)=1.770148e+000; foe(n+1)=3.655873e+000; krok(n+1)=3.556534e-002; ng(n+1)=1.794215e+002;
n=71; farx(n+1)=1.726127e+000; foe(n+1)=3.383186e+000; krok(n+1)=4.904612e-002; ng(n+1)=3.870876e+002;
n=72; farx(n+1)=1.616867e+000; foe(n+1)=3.221803e+000; krok(n+1)=1.096649e-001; ng(n+1)=1.313041e+002;
n=73; farx(n+1)=1.512533e+000; foe(n+1)=2.845703e+000; krok(n+1)=8.512166e-002; ng(n+1)=3.062087e+002;
n=74; farx(n+1)=1.448921e+000; foe(n+1)=2.711901e+000; krok(n+1)=1.261335e-001; ng(n+1)=3.649380e+002;
n=75; farx(n+1)=1.426864e+000; foe(n+1)=2.567369e+000; krok(n+1)=1.643984e-001; ng(n+1)=2.590869e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.422980e+000; foe(n+1)=2.495742e+000; krok(n+1)=5.721688e-006; ng(n+1)=4.137340e+002;
n=77; farx(n+1)=1.413599e+000; foe(n+1)=2.443783e+000; krok(n+1)=1.632874e-005; ng(n+1)=2.333866e+002;
n=78; farx(n+1)=1.411822e+000; foe(n+1)=2.412913e+000; krok(n+1)=6.069150e-005; ng(n+1)=8.619436e+001;
n=79; farx(n+1)=1.408297e+000; foe(n+1)=2.383458e+000; krok(n+1)=6.047525e-005; ng(n+1)=9.552120e+001;
n=80; farx(n+1)=1.385658e+000; foe(n+1)=2.291771e+000; krok(n+1)=3.334617e-003; ng(n+1)=2.734454e+001;
n=81; farx(n+1)=1.377289e+000; foe(n+1)=2.184475e+000; krok(n+1)=1.852419e-003; ng(n+1)=3.704457e+001;
n=82; farx(n+1)=1.369314e+000; foe(n+1)=2.117394e+000; krok(n+1)=2.778799e-003; ng(n+1)=1.826463e+002;
n=83; farx(n+1)=1.370434e+000; foe(n+1)=2.071883e+000; krok(n+1)=1.041670e-002; ng(n+1)=2.628134e+002;
n=84; farx(n+1)=1.365459e+000; foe(n+1)=2.042157e+000; krok(n+1)=4.957342e-003; ng(n+1)=3.092050e+002;
n=85; farx(n+1)=1.351605e+000; foe(n+1)=1.997233e+000; krok(n+1)=9.484553e-003; ng(n+1)=4.510675e+002;
n=86; farx(n+1)=1.338991e+000; foe(n+1)=1.955324e+000; krok(n+1)=1.063635e-002; ng(n+1)=4.102996e+002;
n=87; farx(n+1)=1.319386e+000; foe(n+1)=1.867512e+000; krok(n+1)=1.966568e-002; ng(n+1)=5.610762e+002;
n=88; farx(n+1)=1.308554e+000; foe(n+1)=1.851149e+000; krok(n+1)=4.375565e-003; ng(n+1)=4.359428e+002;
n=89; farx(n+1)=1.301591e+000; foe(n+1)=1.824361e+000; krok(n+1)=4.544795e-002; ng(n+1)=2.598947e+002;
n=90; farx(n+1)=1.291355e+000; foe(n+1)=1.782462e+000; krok(n+1)=8.892157e-002; ng(n+1)=2.184707e+002;
n=91; farx(n+1)=1.275506e+000; foe(n+1)=1.725689e+000; krok(n+1)=4.382471e-002; ng(n+1)=2.082855e+002;
n=92; farx(n+1)=1.299473e+000; foe(n+1)=1.681734e+000; krok(n+1)=7.660919e-002; ng(n+1)=1.899639e+002;
n=93; farx(n+1)=1.312601e+000; foe(n+1)=1.617961e+000; krok(n+1)=3.389322e-002; ng(n+1)=2.410698e+002;
n=94; farx(n+1)=1.301003e+000; foe(n+1)=1.543944e+000; krok(n+1)=8.662598e-002; ng(n+1)=1.980791e+002;
n=95; farx(n+1)=1.299597e+000; foe(n+1)=1.479016e+000; krok(n+1)=1.775417e-001; ng(n+1)=1.021942e+002;
n=96; farx(n+1)=1.227097e+000; foe(n+1)=1.398149e+000; krok(n+1)=8.662598e-002; ng(n+1)=9.082972e+001;
n=97; farx(n+1)=1.178164e+000; foe(n+1)=1.342962e+000; krok(n+1)=3.774616e-002; ng(n+1)=3.570406e+002;
n=98; farx(n+1)=1.192643e+000; foe(n+1)=1.303743e+000; krok(n+1)=8.892157e-002; ng(n+1)=1.610893e+002;
n=99; farx(n+1)=1.167902e+000; foe(n+1)=1.268913e+000; krok(n+1)=1.454886e-001; ng(n+1)=5.977869e+001;
n=100; farx(n+1)=1.150285e+000; foe(n+1)=1.237814e+000; krok(n+1)=7.923274e-002; ng(n+1)=1.547704e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
