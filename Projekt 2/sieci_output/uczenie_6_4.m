%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.774979e+003; foe(n+1)=4.005680e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.721711e+003; foe(n+1)=2.882860e+003; krok(n+1)=4.749570e-004; ng(n+1)=3.708061e+003;
n=2; farx(n+1)=1.060596e+003; foe(n+1)=1.447478e+003; krok(n+1)=1.908037e-003; ng(n+1)=2.181351e+003;
n=3; farx(n+1)=1.154973e+003; foe(n+1)=1.199294e+003; krok(n+1)=5.538211e-005; ng(n+1)=1.115588e+004;
n=4; farx(n+1)=2.911050e+003; foe(n+1)=6.701209e+002; krok(n+1)=1.229105e-003; ng(n+1)=1.392076e+004;
n=5; farx(n+1)=1.194046e+003; foe(n+1)=4.461438e+002; krok(n+1)=4.355153e-003; ng(n+1)=1.459289e+003;
n=6; farx(n+1)=1.128911e+003; foe(n+1)=4.301226e+002; krok(n+1)=2.702675e-004; ng(n+1)=1.827227e+003;
n=7; farx(n+1)=9.778817e+002; foe(n+1)=4.189866e+002; krok(n+1)=3.939441e-004; ng(n+1)=9.395568e+002;
n=8; farx(n+1)=8.195303e+002; foe(n+1)=3.936154e+002; krok(n+1)=3.400118e-003; ng(n+1)=1.235956e+003;
n=9; farx(n+1)=5.385026e+002; foe(n+1)=3.543692e+002; krok(n+1)=3.852167e-003; ng(n+1)=2.555286e+003;
n=10; farx(n+1)=3.283105e+002; foe(n+1)=3.183424e+002; krok(n+1)=2.316999e-003; ng(n+1)=2.374535e+003;
n=11; farx(n+1)=2.977065e+002; foe(n+1)=3.145779e+002; krok(n+1)=5.934596e-004; ng(n+1)=8.872573e+002;
n=12; farx(n+1)=3.198111e+002; foe(n+1)=2.338171e+002; krok(n+1)=1.518330e-002; ng(n+1)=9.519981e+002;
n=13; farx(n+1)=3.234741e+002; foe(n+1)=2.329830e+002; krok(n+1)=4.508384e-005; ng(n+1)=9.968067e+002;
n=14; farx(n+1)=4.474590e+002; foe(n+1)=1.461324e+002; krok(n+1)=5.557598e-003; ng(n+1)=1.069073e+003;
n=15; farx(n+1)=4.531559e+002; foe(n+1)=1.447821e+002; krok(n+1)=4.743595e-005; ng(n+1)=1.971138e+003;
n=16; farx(n+1)=4.439581e+002; foe(n+1)=1.426791e+002; krok(n+1)=4.089425e-004; ng(n+1)=1.251719e+003;
n=17; farx(n+1)=4.377591e+002; foe(n+1)=1.389818e+002; krok(n+1)=5.405350e-004; ng(n+1)=3.447885e+003;
n=18; farx(n+1)=3.412544e+002; foe(n+1)=1.325202e+002; krok(n+1)=9.232346e-004; ng(n+1)=1.089462e+003;
n=19; farx(n+1)=2.190073e+002; foe(n+1)=1.041573e+002; krok(n+1)=3.334617e-003; ng(n+1)=2.174688e+003;
n=20; farx(n+1)=1.892736e+002; foe(n+1)=1.002091e+002; krok(n+1)=1.037622e-003; ng(n+1)=2.609452e+003;
n=21; farx(n+1)=1.696205e+002; foe(n+1)=9.222776e+001; krok(n+1)=3.795826e-003; ng(n+1)=1.759055e+003;
n=22; farx(n+1)=1.218985e+002; foe(n+1)=7.909727e+001; krok(n+1)=2.293321e-003; ng(n+1)=5.904690e+003;
n=23; farx(n+1)=1.120245e+002; foe(n+1)=7.057818e+001; krok(n+1)=1.767909e-002; ng(n+1)=1.857519e+003;
n=24; farx(n+1)=1.092084e+002; foe(n+1)=6.951739e+001; krok(n+1)=1.086709e-002; ng(n+1)=1.483021e+003;
n=25; farx(n+1)=1.021741e+002; foe(n+1)=6.883148e+001; krok(n+1)=1.450364e-002; ng(n+1)=1.210665e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.004140e+002; foe(n+1)=6.283220e+001; krok(n+1)=4.685521e-005; ng(n+1)=1.206155e+003;
n=27; farx(n+1)=9.896639e+001; foe(n+1)=6.061048e+001; krok(n+1)=1.209447e-005; ng(n+1)=1.706363e+003;
n=28; farx(n+1)=3.261258e+001; foe(n+1)=4.158622e+001; krok(n+1)=1.120495e-003; ng(n+1)=5.238440e+002;
n=29; farx(n+1)=3.175319e+001; foe(n+1)=3.887371e+001; krok(n+1)=1.646626e-004; ng(n+1)=1.065943e+003;
n=30; farx(n+1)=2.570627e+001; foe(n+1)=3.367371e+001; krok(n+1)=2.187783e-003; ng(n+1)=2.435637e+003;
n=31; farx(n+1)=2.406155e+001; foe(n+1)=3.189943e+001; krok(n+1)=2.013418e-003; ng(n+1)=1.649818e+003;
n=32; farx(n+1)=1.700276e+001; foe(n+1)=2.847743e+001; krok(n+1)=5.711090e-003; ng(n+1)=1.827453e+003;
n=33; farx(n+1)=1.298924e+001; foe(n+1)=2.576218e+001; krok(n+1)=6.583213e-003; ng(n+1)=2.096619e+003;
n=34; farx(n+1)=9.750124e+000; foe(n+1)=2.266306e+001; krok(n+1)=8.529216e-003; ng(n+1)=7.138243e+002;
n=35; farx(n+1)=7.944574e+000; foe(n+1)=2.134405e+001; krok(n+1)=4.687691e-003; ng(n+1)=9.810641e+002;
n=36; farx(n+1)=6.567746e+000; foe(n+1)=1.963182e+001; krok(n+1)=6.450159e-003; ng(n+1)=9.770422e+002;
n=37; farx(n+1)=5.747793e+000; foe(n+1)=1.758779e+001; krok(n+1)=4.323984e-003; ng(n+1)=1.724462e+003;
n=38; farx(n+1)=5.527191e+000; foe(n+1)=1.639829e+001; krok(n+1)=3.303309e-003; ng(n+1)=1.633043e+003;
n=39; farx(n+1)=5.356538e+000; foe(n+1)=1.581583e+001; krok(n+1)=5.433546e-003; ng(n+1)=1.114035e+003;
n=40; farx(n+1)=5.216871e+000; foe(n+1)=1.554587e+001; krok(n+1)=3.660956e-003; ng(n+1)=7.602831e+002;
n=41; farx(n+1)=4.659215e+000; foe(n+1)=1.477487e+001; krok(n+1)=2.223039e-002; ng(n+1)=1.179617e+003;
n=42; farx(n+1)=4.533517e+000; foe(n+1)=1.411036e+001; krok(n+1)=7.479896e-003; ng(n+1)=1.270648e+003;
n=43; farx(n+1)=3.587444e+000; foe(n+1)=1.184550e+001; krok(n+1)=6.385486e-002; ng(n+1)=7.767281e+002;
n=44; farx(n+1)=3.386837e+000; foe(n+1)=1.053119e+001; krok(n+1)=2.107682e-002; ng(n+1)=1.099860e+003;
n=45; farx(n+1)=3.061107e+000; foe(n+1)=8.873547e+000; krok(n+1)=7.251821e-003; ng(n+1)=8.490955e+002;
n=46; farx(n+1)=3.112455e+000; foe(n+1)=8.389700e+000; krok(n+1)=1.208515e-002; ng(n+1)=4.123943e+002;
n=47; farx(n+1)=2.983383e+000; foe(n+1)=6.996596e+000; krok(n+1)=8.973318e-002; ng(n+1)=3.373153e+002;
n=48; farx(n+1)=2.955601e+000; foe(n+1)=6.681376e+000; krok(n+1)=2.515521e-002; ng(n+1)=3.887177e+002;
n=49; farx(n+1)=2.952697e+000; foe(n+1)=6.256243e+000; krok(n+1)=5.625683e-002; ng(n+1)=1.603884e+002;
n=50; farx(n+1)=2.808926e+000; foe(n+1)=5.781233e+000; krok(n+1)=2.320583e-001; ng(n+1)=2.748914e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.807354e+000; foe(n+1)=5.737764e+000; krok(n+1)=3.175337e-005; ng(n+1)=1.476727e+002;
n=52; farx(n+1)=2.809559e+000; foe(n+1)=5.729599e+000; krok(n+1)=7.835092e-006; ng(n+1)=1.258871e+002;
n=53; farx(n+1)=2.774648e+000; foe(n+1)=5.541359e+000; krok(n+1)=1.045039e-003; ng(n+1)=5.680681e+001;
n=54; farx(n+1)=2.769026e+000; foe(n+1)=5.519492e+000; krok(n+1)=5.665485e-005; ng(n+1)=7.586724e+001;
n=55; farx(n+1)=2.667035e+000; foe(n+1)=5.287480e+000; krok(n+1)=5.904631e-004; ng(n+1)=8.012212e+001;
n=56; farx(n+1)=2.616403e+000; foe(n+1)=5.082942e+000; krok(n+1)=2.414856e-003; ng(n+1)=1.212264e+002;
n=57; farx(n+1)=2.461756e+000; foe(n+1)=4.671492e+000; krok(n+1)=6.832794e-003; ng(n+1)=3.665854e+002;
n=58; farx(n+1)=2.355708e+000; foe(n+1)=4.361381e+000; krok(n+1)=1.350179e-003; ng(n+1)=5.700880e+002;
n=59; farx(n+1)=2.287466e+000; foe(n+1)=4.220121e+000; krok(n+1)=4.221448e-003; ng(n+1)=3.981162e+002;
n=60; farx(n+1)=2.177854e+000; foe(n+1)=3.983627e+000; krok(n+1)=1.033570e-002; ng(n+1)=6.510711e+002;
n=61; farx(n+1)=2.114076e+000; foe(n+1)=3.860402e+000; krok(n+1)=7.251821e-003; ng(n+1)=5.204228e+002;
n=62; farx(n+1)=2.082542e+000; foe(n+1)=3.675303e+000; krok(n+1)=2.541206e-002; ng(n+1)=4.125320e+002;
n=63; farx(n+1)=1.952189e+000; foe(n+1)=3.389375e+000; krok(n+1)=1.763378e-002; ng(n+1)=4.314186e+002;
n=64; farx(n+1)=1.942674e+000; foe(n+1)=3.243776e+000; krok(n+1)=2.331822e-002; ng(n+1)=3.223045e+002;
n=65; farx(n+1)=1.932592e+000; foe(n+1)=3.161733e+000; krok(n+1)=3.638604e-002; ng(n+1)=3.282676e+002;
n=66; farx(n+1)=1.901446e+000; foe(n+1)=3.084724e+000; krok(n+1)=4.568872e-002; ng(n+1)=3.357530e+002;
n=67; farx(n+1)=1.863229e+000; foe(n+1)=2.971048e+000; krok(n+1)=2.051314e-002; ng(n+1)=3.231324e+002;
n=68; farx(n+1)=1.857042e+000; foe(n+1)=2.783221e+000; krok(n+1)=6.105720e-002; ng(n+1)=2.183049e+002;
n=69; farx(n+1)=1.628871e+000; foe(n+1)=2.587499e+000; krok(n+1)=2.250273e-001; ng(n+1)=2.656854e+002;
n=70; farx(n+1)=1.543467e+000; foe(n+1)=2.464508e+000; krok(n+1)=3.612085e-002; ng(n+1)=2.333680e+002;
n=71; farx(n+1)=1.517602e+000; foe(n+1)=2.411296e+000; krok(n+1)=4.254539e-002; ng(n+1)=3.913161e+002;
n=72; farx(n+1)=1.457777e+000; foe(n+1)=2.187326e+000; krok(n+1)=1.102898e-001; ng(n+1)=4.560539e+002;
n=73; farx(n+1)=1.381483e+000; foe(n+1)=2.017536e+000; krok(n+1)=1.036878e-001; ng(n+1)=2.338646e+002;
n=74; farx(n+1)=1.359649e+000; foe(n+1)=1.992798e+000; krok(n+1)=6.170512e-002; ng(n+1)=2.480007e+002;
n=75; farx(n+1)=1.348455e+000; foe(n+1)=1.948481e+000; krok(n+1)=1.297327e-001; ng(n+1)=8.036938e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.347995e+000; foe(n+1)=1.937431e+000; krok(n+1)=2.790540e-006; ng(n+1)=2.434899e+002;
n=77; farx(n+1)=1.348001e+000; foe(n+1)=1.933627e+000; krok(n+1)=8.379583e-006; ng(n+1)=8.514592e+001;
n=78; farx(n+1)=1.348255e+000; foe(n+1)=1.931911e+000; krok(n+1)=1.505759e-004; ng(n+1)=1.482959e+001;
n=79; farx(n+1)=1.347186e+000; foe(n+1)=1.918443e+000; krok(n+1)=2.975925e-004; ng(n+1)=2.963493e+001;
n=80; farx(n+1)=1.340479e+000; foe(n+1)=1.899710e+000; krok(n+1)=1.749592e-003; ng(n+1)=1.528529e+001;
n=81; farx(n+1)=1.340676e+000; foe(n+1)=1.885615e+000; krok(n+1)=1.285062e-002; ng(n+1)=3.497338e+001;
n=82; farx(n+1)=1.339913e+000; foe(n+1)=1.866600e+000; krok(n+1)=3.544455e-003; ng(n+1)=2.624125e+001;
n=83; farx(n+1)=1.333402e+000; foe(n+1)=1.845346e+000; krok(n+1)=2.840497e-003; ng(n+1)=9.602120e+001;
n=84; farx(n+1)=1.332944e+000; foe(n+1)=1.826627e+000; krok(n+1)=8.029022e-003; ng(n+1)=3.314930e+002;
n=85; farx(n+1)=1.330485e+000; foe(n+1)=1.819553e+000; krok(n+1)=6.353015e-003; ng(n+1)=2.796248e+002;
n=86; farx(n+1)=1.342217e+000; foe(n+1)=1.785677e+000; krok(n+1)=3.950757e-002; ng(n+1)=2.902199e+002;
n=87; farx(n+1)=1.347948e+000; foe(n+1)=1.762288e+000; krok(n+1)=1.617035e-002; ng(n+1)=9.656378e+001;
n=88; farx(n+1)=1.342632e+000; foe(n+1)=1.738488e+000; krok(n+1)=1.865725e-002; ng(n+1)=9.422074e+001;
n=89; farx(n+1)=1.322050e+000; foe(n+1)=1.704300e+000; krok(n+1)=2.896961e-002; ng(n+1)=1.119584e+002;
n=90; farx(n+1)=1.303199e+000; foe(n+1)=1.662220e+000; krok(n+1)=5.142836e-002; ng(n+1)=8.902914e+001;
n=91; farx(n+1)=1.268297e+000; foe(n+1)=1.623430e+000; krok(n+1)=1.755320e-001; ng(n+1)=1.041002e+002;
n=92; farx(n+1)=1.250255e+000; foe(n+1)=1.607812e+000; krok(n+1)=4.077788e-002; ng(n+1)=1.733316e+002;
n=93; farx(n+1)=1.203038e+000; foe(n+1)=1.592345e+000; krok(n+1)=7.596282e-002; ng(n+1)=1.118997e+002;
n=94; farx(n+1)=1.177241e+000; foe(n+1)=1.561083e+000; krok(n+1)=5.954236e-002; ng(n+1)=1.558683e+002;
n=95; farx(n+1)=1.187449e+000; foe(n+1)=1.533226e+000; krok(n+1)=6.907323e-002; ng(n+1)=1.681609e+002;
n=96; farx(n+1)=1.177755e+000; foe(n+1)=1.506922e+000; krok(n+1)=1.919189e-001; ng(n+1)=6.390698e+001;
n=97; farx(n+1)=1.187801e+000; foe(n+1)=1.492222e+000; krok(n+1)=5.558094e-002; ng(n+1)=1.232832e+002;
n=98; farx(n+1)=1.200858e+000; foe(n+1)=1.462925e+000; krok(n+1)=1.294730e-001; ng(n+1)=6.056565e+001;
n=99; farx(n+1)=1.189789e+000; foe(n+1)=1.408724e+000; krok(n+1)=2.689113e-001; ng(n+1)=1.293902e+002;
n=100; farx(n+1)=1.187209e+000; foe(n+1)=1.384180e+000; krok(n+1)=1.209337e-001; ng(n+1)=1.774982e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
