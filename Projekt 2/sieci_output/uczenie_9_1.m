%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.096657e+003; foe(n+1)=3.986952e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.997113e+003; foe(n+1)=2.836621e+003; krok(n+1)=5.362933e-004; ng(n+1)=4.312075e+003;
n=2; farx(n+1)=1.355251e+003; foe(n+1)=1.131800e+003; krok(n+1)=1.943015e-003; ng(n+1)=2.885510e+003;
n=3; farx(n+1)=1.770807e+003; foe(n+1)=6.850932e+002; krok(n+1)=2.125792e-004; ng(n+1)=9.456494e+003;
n=4; farx(n+1)=2.388775e+003; foe(n+1)=5.971895e+002; krok(n+1)=4.766449e-004; ng(n+1)=6.821973e+003;
n=5; farx(n+1)=2.078425e+003; foe(n+1)=5.295411e+002; krok(n+1)=3.765398e-003; ng(n+1)=1.152873e+003;
n=6; farx(n+1)=1.079918e+003; foe(n+1)=4.364953e+002; krok(n+1)=6.947618e-003; ng(n+1)=5.891818e+002;
n=7; farx(n+1)=3.621584e+002; foe(n+1)=3.803176e+002; krok(n+1)=9.053002e-004; ng(n+1)=3.284236e+003;
n=8; farx(n+1)=3.787412e+002; foe(n+1)=3.545610e+002; krok(n+1)=1.858436e-004; ng(n+1)=5.462211e+003;
n=9; farx(n+1)=5.014423e+002; foe(n+1)=3.393474e+002; krok(n+1)=6.099924e-003; ng(n+1)=2.347620e+003;
n=10; farx(n+1)=5.162095e+002; foe(n+1)=3.338526e+002; krok(n+1)=1.040544e-003; ng(n+1)=7.592070e+002;
n=11; farx(n+1)=5.869101e+002; foe(n+1)=3.230074e+002; krok(n+1)=1.461502e-003; ng(n+1)=2.287574e+003;
n=12; farx(n+1)=5.819639e+002; foe(n+1)=3.171413e+002; krok(n+1)=5.465324e-004; ng(n+1)=4.978961e+003;
n=13; farx(n+1)=5.971291e+002; foe(n+1)=3.135994e+002; krok(n+1)=1.055362e-003; ng(n+1)=7.140091e+003;
n=14; farx(n+1)=6.093069e+002; foe(n+1)=3.111819e+002; krok(n+1)=6.326141e-004; ng(n+1)=6.604905e+003;
n=15; farx(n+1)=6.209389e+002; foe(n+1)=3.056105e+002; krok(n+1)=6.946998e-004; ng(n+1)=7.269945e+003;
n=16; farx(n+1)=6.232714e+002; foe(n+1)=3.035585e+002; krok(n+1)=1.157695e-004; ng(n+1)=5.350698e+003;
n=17; farx(n+1)=6.122381e+002; foe(n+1)=2.987886e+002; krok(n+1)=9.671447e-004; ng(n+1)=3.864598e+003;
n=18; farx(n+1)=5.375959e+002; foe(n+1)=2.531399e+002; krok(n+1)=1.366096e-003; ng(n+1)=7.352390e+003;
n=19; farx(n+1)=5.365183e+002; foe(n+1)=2.529266e+002; krok(n+1)=1.929081e-005; ng(n+1)=4.816884e+003;
n=20; farx(n+1)=5.346664e+002; foe(n+1)=2.515642e+002; krok(n+1)=6.776689e-005; ng(n+1)=1.197227e+004;
n=21; farx(n+1)=5.176170e+002; foe(n+1)=2.484982e+002; krok(n+1)=2.547833e-003; ng(n+1)=6.671494e+003;
n=22; farx(n+1)=4.885766e+002; foe(n+1)=2.436072e+002; krok(n+1)=2.469223e-003; ng(n+1)=4.689694e+003;
n=23; farx(n+1)=4.164766e+002; foe(n+1)=2.357349e+002; krok(n+1)=1.387045e-003; ng(n+1)=1.281608e+004;
n=24; farx(n+1)=3.744001e+002; foe(n+1)=2.266350e+002; krok(n+1)=2.641497e-003; ng(n+1)=2.050064e+003;
n=25; farx(n+1)=3.309105e+002; foe(n+1)=2.159902e+002; krok(n+1)=2.823736e-003; ng(n+1)=9.280426e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.286674e+002; foe(n+1)=2.104487e+002; krok(n+1)=2.488850e-005; ng(n+1)=2.669918e+003;
n=27; farx(n+1)=3.628062e+002; foe(n+1)=1.903598e+002; krok(n+1)=3.729504e-004; ng(n+1)=9.165290e+002;
n=28; farx(n+1)=3.400761e+002; foe(n+1)=1.645684e+002; krok(n+1)=5.958384e-004; ng(n+1)=1.335802e+003;
n=29; farx(n+1)=2.551545e+002; foe(n+1)=1.433788e+002; krok(n+1)=4.616173e-004; ng(n+1)=2.556348e+003;
n=30; farx(n+1)=4.195664e+001; foe(n+1)=1.020679e+002; krok(n+1)=6.650130e-004; ng(n+1)=8.428758e+003;
n=31; farx(n+1)=3.589403e+001; foe(n+1)=7.292110e+001; krok(n+1)=8.083878e-005; ng(n+1)=1.043231e+004;
n=32; farx(n+1)=3.239632e+001; foe(n+1)=6.419713e+001; krok(n+1)=1.802468e-004; ng(n+1)=8.041297e+003;
n=33; farx(n+1)=3.920588e+001; foe(n+1)=5.304893e+001; krok(n+1)=6.750897e-004; ng(n+1)=6.950806e+003;
n=34; farx(n+1)=4.035949e+001; foe(n+1)=5.152252e+001; krok(n+1)=6.386523e-005; ng(n+1)=2.635730e+003;
n=35; farx(n+1)=3.962016e+001; foe(n+1)=4.045305e+001; krok(n+1)=5.861582e-004; ng(n+1)=6.435151e+003;
n=36; farx(n+1)=2.684803e+001; foe(n+1)=3.455756e+001; krok(n+1)=5.758264e-004; ng(n+1)=3.619382e+003;
n=37; farx(n+1)=1.893778e+001; foe(n+1)=2.862650e+001; krok(n+1)=5.795022e-004; ng(n+1)=6.534595e+003;
n=38; farx(n+1)=1.577904e+001; foe(n+1)=2.436820e+001; krok(n+1)=1.812955e-003; ng(n+1)=4.084503e+003;
n=39; farx(n+1)=1.061659e+001; foe(n+1)=1.866505e+001; krok(n+1)=4.464102e-003; ng(n+1)=1.034060e+003;
n=40; farx(n+1)=6.924413e+000; foe(n+1)=1.420649e+001; krok(n+1)=3.581322e-003; ng(n+1)=1.621470e+003;
n=41; farx(n+1)=6.448303e+000; foe(n+1)=1.312762e+001; krok(n+1)=2.426783e-003; ng(n+1)=1.033177e+003;
n=42; farx(n+1)=6.354204e+000; foe(n+1)=1.266430e+001; krok(n+1)=2.269758e-003; ng(n+1)=1.100645e+003;
n=43; farx(n+1)=5.286922e+000; foe(n+1)=1.132925e+001; krok(n+1)=8.128862e-003; ng(n+1)=6.557310e+002;
n=44; farx(n+1)=4.488582e+000; foe(n+1)=1.036107e+001; krok(n+1)=8.533243e-003; ng(n+1)=9.255419e+002;
n=45; farx(n+1)=4.193869e+000; foe(n+1)=9.809016e+000; krok(n+1)=6.371455e-003; ng(n+1)=5.352558e+002;
n=46; farx(n+1)=3.941515e+000; foe(n+1)=9.228617e+000; krok(n+1)=9.146433e-003; ng(n+1)=7.838463e+002;
n=47; farx(n+1)=3.906265e+000; foe(n+1)=8.930886e+000; krok(n+1)=4.064431e-003; ng(n+1)=7.290541e+002;
n=48; farx(n+1)=3.956747e+000; foe(n+1)=8.508764e+000; krok(n+1)=8.350786e-003; ng(n+1)=1.076057e+003;
n=49; farx(n+1)=3.670828e+000; foe(n+1)=8.043374e+000; krok(n+1)=2.051314e-002; ng(n+1)=5.230573e+002;
n=50; farx(n+1)=3.579020e+000; foe(n+1)=7.638895e+000; krok(n+1)=1.033570e-002; ng(n+1)=5.099144e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=3.558434e+000; foe(n+1)=7.611648e+000; krok(n+1)=9.975945e-006; ng(n+1)=2.635694e+002;
n=52; farx(n+1)=3.539353e+000; foe(n+1)=7.585485e+000; krok(n+1)=8.539569e-006; ng(n+1)=3.145550e+002;
n=53; farx(n+1)=3.540078e+000; foe(n+1)=7.522105e+000; krok(n+1)=5.990465e-005; ng(n+1)=2.000070e+002;
n=54; farx(n+1)=3.492187e+000; foe(n+1)=7.181172e+000; krok(n+1)=7.432430e-004; ng(n+1)=1.345027e+002;
n=55; farx(n+1)=3.446446e+000; foe(n+1)=7.020222e+000; krok(n+1)=4.373979e-004; ng(n+1)=1.285916e+002;
n=56; farx(n+1)=3.325787e+000; foe(n+1)=6.648552e+000; krok(n+1)=4.106680e-003; ng(n+1)=9.737552e+001;
n=57; farx(n+1)=3.184267e+000; foe(n+1)=6.531059e+000; krok(n+1)=2.032662e-003; ng(n+1)=7.223756e+002;
n=58; farx(n+1)=3.030805e+000; foe(n+1)=6.266135e+000; krok(n+1)=1.321526e-002; ng(n+1)=8.282144e+002;
n=59; farx(n+1)=3.041940e+000; foe(n+1)=6.108908e+000; krok(n+1)=1.305012e-002; ng(n+1)=4.941087e+002;
n=60; farx(n+1)=3.007826e+000; foe(n+1)=6.043184e+000; krok(n+1)=5.829556e-003; ng(n+1)=2.743659e+002;
n=61; farx(n+1)=2.876190e+000; foe(n+1)=5.923801e+000; krok(n+1)=1.405854e-002; ng(n+1)=4.535822e+002;
n=62; farx(n+1)=2.802398e+000; foe(n+1)=5.816968e+000; krok(n+1)=9.195867e-003; ng(n+1)=4.816776e+002;
n=63; farx(n+1)=2.726818e+000; foe(n+1)=5.696666e+000; krok(n+1)=1.109636e-002; ng(n+1)=7.996427e+002;
n=64; farx(n+1)=2.615292e+000; foe(n+1)=5.548390e+000; krok(n+1)=1.547817e-002; ng(n+1)=4.360757e+002;
n=65; farx(n+1)=2.496369e+000; foe(n+1)=5.481408e+000; krok(n+1)=1.024683e-002; ng(n+1)=3.879886e+002;
n=66; farx(n+1)=2.169109e+000; foe(n+1)=5.185752e+000; krok(n+1)=1.861441e-002; ng(n+1)=2.325308e+002;
n=67; farx(n+1)=2.034696e+000; foe(n+1)=5.044672e+000; krok(n+1)=8.055458e-003; ng(n+1)=3.990479e+002;
n=68; farx(n+1)=1.946351e+000; foe(n+1)=4.917561e+000; krok(n+1)=3.898185e-003; ng(n+1)=1.052040e+003;
n=69; farx(n+1)=1.756245e+000; foe(n+1)=4.732990e+000; krok(n+1)=1.219985e-002; ng(n+1)=3.152832e+002;
n=70; farx(n+1)=1.700163e+000; foe(n+1)=4.661495e+000; krok(n+1)=3.851383e-003; ng(n+1)=4.805816e+002;
n=71; farx(n+1)=1.633074e+000; foe(n+1)=4.457373e+000; krok(n+1)=3.001959e-002; ng(n+1)=7.384226e+002;
n=72; farx(n+1)=1.567318e+000; foe(n+1)=4.344035e+000; krok(n+1)=1.369522e-003; ng(n+1)=1.660721e+003;
n=73; farx(n+1)=1.498526e+000; foe(n+1)=3.918384e+000; krok(n+1)=8.350786e-003; ng(n+1)=2.338110e+003;
n=74; farx(n+1)=1.501303e+000; foe(n+1)=3.786017e+000; krok(n+1)=5.173682e-003; ng(n+1)=1.521003e+003;
n=75; farx(n+1)=1.431133e+000; foe(n+1)=3.553661e+000; krok(n+1)=1.571994e-002; ng(n+1)=1.165668e+003;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.427097e+000; foe(n+1)=3.471815e+000; krok(n+1)=1.571040e-006; ng(n+1)=1.269797e+003;
n=77; farx(n+1)=1.415527e+000; foe(n+1)=3.429239e+000; krok(n+1)=1.318762e-005; ng(n+1)=3.159841e+002;
n=78; farx(n+1)=1.395186e+000; foe(n+1)=3.265385e+000; krok(n+1)=3.955346e-005; ng(n+1)=3.493895e+002;
n=79; farx(n+1)=1.387465e+000; foe(n+1)=3.106070e+000; krok(n+1)=1.625548e-004; ng(n+1)=1.878439e+002;
n=80; farx(n+1)=1.388726e+000; foe(n+1)=2.872034e+000; krok(n+1)=2.625683e-004; ng(n+1)=1.879824e+002;
n=81; farx(n+1)=1.326733e+000; foe(n+1)=2.655475e+000; krok(n+1)=5.770731e-003; ng(n+1)=3.050536e+002;
n=82; farx(n+1)=1.312384e+000; foe(n+1)=2.586102e+000; krok(n+1)=5.548179e-003; ng(n+1)=5.243994e+002;
n=83; farx(n+1)=1.319276e+000; foe(n+1)=2.532524e+000; krok(n+1)=1.810600e-003; ng(n+1)=5.748133e+002;
n=84; farx(n+1)=1.301939e+000; foe(n+1)=2.452522e+000; krok(n+1)=1.250976e-002; ng(n+1)=7.696257e+002;
n=85; farx(n+1)=1.288041e+000; foe(n+1)=2.362869e+000; krok(n+1)=1.021537e-002; ng(n+1)=5.331438e+002;
n=86; farx(n+1)=1.279330e+000; foe(n+1)=2.316859e+000; krok(n+1)=5.711090e-003; ng(n+1)=4.150561e+002;
n=87; farx(n+1)=1.233990e+000; foe(n+1)=2.210784e+000; krok(n+1)=6.130766e-003; ng(n+1)=4.206588e+002;
n=88; farx(n+1)=1.217457e+000; foe(n+1)=2.154041e+000; krok(n+1)=5.355898e-003; ng(n+1)=7.801277e+002;
n=89; farx(n+1)=1.193494e+000; foe(n+1)=2.037701e+000; krok(n+1)=1.737095e-002; ng(n+1)=3.159322e+002;
n=90; farx(n+1)=1.188538e+000; foe(n+1)=1.836432e+000; krok(n+1)=2.107682e-002; ng(n+1)=8.806729e+002;
n=91; farx(n+1)=1.196119e+000; foe(n+1)=1.789999e+000; krok(n+1)=3.516052e-003; ng(n+1)=3.772165e+002;
n=92; farx(n+1)=1.205849e+000; foe(n+1)=1.768929e+000; krok(n+1)=5.655154e-003; ng(n+1)=8.340810e+001;
n=93; farx(n+1)=1.231369e+000; foe(n+1)=1.729271e+000; krok(n+1)=8.023134e-003; ng(n+1)=4.150722e+002;
n=94; farx(n+1)=1.243630e+000; foe(n+1)=1.706131e+000; krok(n+1)=1.165911e-002; ng(n+1)=3.593808e+002;
n=95; farx(n+1)=1.248871e+000; foe(n+1)=1.646900e+000; krok(n+1)=3.481722e-002; ng(n+1)=2.145776e+002;
n=96; farx(n+1)=1.245537e+000; foe(n+1)=1.616931e+000; krok(n+1)=4.781642e-002; ng(n+1)=3.649853e+002;
n=97; farx(n+1)=1.248089e+000; foe(n+1)=1.575534e+000; krok(n+1)=3.034189e-002; ng(n+1)=8.399432e+002;
n=98; farx(n+1)=1.230578e+000; foe(n+1)=1.526484e+000; krok(n+1)=3.339713e-002; ng(n+1)=1.083052e+002;
n=99; farx(n+1)=1.232638e+000; foe(n+1)=1.418421e+000; krok(n+1)=3.712047e-002; ng(n+1)=2.103660e+002;
n=100; farx(n+1)=1.234507e+000; foe(n+1)=1.394040e+000; krok(n+1)=1.308616e-002; ng(n+1)=5.594462e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
