%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.922028e+003; foe(n+1)=3.985414e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.768716e+003; foe(n+1)=2.881082e+003; krok(n+1)=5.002119e-004; ng(n+1)=3.285208e+003;
n=2; farx(n+1)=9.715197e+002; foe(n+1)=9.419476e+002; krok(n+1)=2.739044e-003; ng(n+1)=1.825419e+003;
n=3; farx(n+1)=1.112057e+003; foe(n+1)=6.554849e+002; krok(n+1)=1.802468e-004; ng(n+1)=5.641746e+003;
n=4; farx(n+1)=1.635788e+003; foe(n+1)=5.373616e+002; krok(n+1)=9.497806e-004; ng(n+1)=5.047054e+003;
n=5; farx(n+1)=1.342630e+003; foe(n+1)=4.656420e+002; krok(n+1)=8.360316e-003; ng(n+1)=7.972700e+002;
n=6; farx(n+1)=1.024605e+003; foe(n+1)=4.299969e+002; krok(n+1)=6.641691e-004; ng(n+1)=1.177382e+003;
n=7; farx(n+1)=4.817969e+002; foe(n+1)=3.725823e+002; krok(n+1)=2.586841e-003; ng(n+1)=1.695150e+003;
n=8; farx(n+1)=4.279433e+002; foe(n+1)=3.646194e+002; krok(n+1)=1.864955e-004; ng(n+1)=2.353034e+003;
n=9; farx(n+1)=3.671137e+002; foe(n+1)=3.556018e+002; krok(n+1)=6.192369e-003; ng(n+1)=1.484709e+003;
n=10; farx(n+1)=3.054570e+002; foe(n+1)=3.382111e+002; krok(n+1)=2.329252e-003; ng(n+1)=7.067635e+002;
n=11; farx(n+1)=2.151924e+002; foe(n+1)=2.956135e+002; krok(n+1)=3.763810e-002; ng(n+1)=7.712721e+002;
n=12; farx(n+1)=2.021902e+002; foe(n+1)=2.797958e+002; krok(n+1)=2.242419e-004; ng(n+1)=2.413861e+003;
n=13; farx(n+1)=1.906538e+002; foe(n+1)=2.755323e+002; krok(n+1)=2.666638e-004; ng(n+1)=1.208378e+003;
n=14; farx(n+1)=1.858871e+002; foe(n+1)=2.682125e+002; krok(n+1)=6.847610e-004; ng(n+1)=1.274260e+003;
n=15; farx(n+1)=1.774566e+002; foe(n+1)=2.618907e+002; krok(n+1)=1.627799e-003; ng(n+1)=9.427913e+002;
n=16; farx(n+1)=1.370405e+002; foe(n+1)=2.515847e+002; krok(n+1)=2.667694e-002; ng(n+1)=9.719621e+002;
n=17; farx(n+1)=1.268110e+002; foe(n+1)=2.480298e+002; krok(n+1)=2.187783e-003; ng(n+1)=2.748571e+003;
n=18; farx(n+1)=1.000046e+002; foe(n+1)=2.394234e+002; krok(n+1)=8.383236e-003; ng(n+1)=3.134008e+003;
n=19; farx(n+1)=3.159046e+001; foe(n+1)=1.937828e+002; krok(n+1)=1.808357e-002; ng(n+1)=2.422854e+003;
n=20; farx(n+1)=2.498738e+001; foe(n+1)=1.891213e+002; krok(n+1)=4.616173e-004; ng(n+1)=1.775398e+003;
n=21; farx(n+1)=2.348514e+001; foe(n+1)=1.874332e+002; krok(n+1)=2.127642e-003; ng(n+1)=2.345194e+003;
n=22; farx(n+1)=2.312718e+001; foe(n+1)=1.857163e+002; krok(n+1)=1.587460e-003; ng(n+1)=2.752238e+003;
n=23; farx(n+1)=2.203419e+001; foe(n+1)=1.782289e+002; krok(n+1)=1.261442e-004; ng(n+1)=7.825137e+003;
n=24; farx(n+1)=2.120095e+001; foe(n+1)=1.677726e+002; krok(n+1)=3.029825e-002; ng(n+1)=1.224769e+003;
n=25; farx(n+1)=2.076074e+001; foe(n+1)=1.643277e+002; krok(n+1)=4.766707e-003; ng(n+1)=2.317694e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.201273e+001; foe(n+1)=1.611623e+002; krok(n+1)=1.251494e-006; ng(n+1)=3.004638e+004;
n=27; farx(n+1)=1.764192e+001; foe(n+1)=1.540485e+002; krok(n+1)=9.429965e-005; ng(n+1)=1.055368e+003;
n=28; farx(n+1)=1.856202e+001; foe(n+1)=1.494183e+002; krok(n+1)=1.602589e-004; ng(n+1)=1.570505e+003;
n=29; farx(n+1)=2.018620e+001; foe(n+1)=1.179429e+002; krok(n+1)=2.162775e-004; ng(n+1)=2.081104e+003;
n=30; farx(n+1)=2.071771e+001; foe(n+1)=7.869238e+001; krok(n+1)=1.156459e-003; ng(n+1)=8.588373e+002;
n=31; farx(n+1)=1.073905e+001; foe(n+1)=5.078423e+001; krok(n+1)=1.532691e-003; ng(n+1)=1.417333e+003;
n=32; farx(n+1)=1.079835e+001; foe(n+1)=4.976640e+001; krok(n+1)=3.870231e-004; ng(n+1)=4.190707e+002;
n=33; farx(n+1)=1.073024e+001; foe(n+1)=4.946787e+001; krok(n+1)=2.263251e-004; ng(n+1)=6.796180e+002;
n=34; farx(n+1)=8.029685e+000; foe(n+1)=4.242058e+001; krok(n+1)=2.617232e-002; ng(n+1)=3.750822e+002;
n=35; farx(n+1)=8.329864e+000; foe(n+1)=3.607138e+001; krok(n+1)=8.076021e-003; ng(n+1)=5.533245e+002;
n=36; farx(n+1)=7.453655e+000; foe(n+1)=3.374945e+001; krok(n+1)=3.616714e-002; ng(n+1)=6.584720e+002;
n=37; farx(n+1)=8.081685e+000; foe(n+1)=3.262659e+001; krok(n+1)=1.000726e-002; ng(n+1)=1.431557e+003;
n=38; farx(n+1)=8.725025e+000; foe(n+1)=3.079772e+001; krok(n+1)=3.011555e-003; ng(n+1)=1.098747e+003;
n=39; farx(n+1)=8.643923e+000; foe(n+1)=2.966133e+001; krok(n+1)=1.979909e-002; ng(n+1)=9.294965e+002;
n=40; farx(n+1)=8.450555e+000; foe(n+1)=2.825991e+001; krok(n+1)=1.706649e-002; ng(n+1)=5.485830e+002;
n=41; farx(n+1)=8.603589e+000; foe(n+1)=2.503549e+001; krok(n+1)=3.650930e-002; ng(n+1)=6.092616e+002;
n=42; farx(n+1)=8.083229e+000; foe(n+1)=2.165581e+001; krok(n+1)=5.908701e-002; ng(n+1)=9.086787e+002;
n=43; farx(n+1)=7.784562e+000; foe(n+1)=1.875141e+001; krok(n+1)=1.421020e-002; ng(n+1)=1.175056e+003;
n=44; farx(n+1)=6.781207e+000; foe(n+1)=1.512224e+001; krok(n+1)=6.260022e-002; ng(n+1)=6.637737e+002;
n=45; farx(n+1)=6.161151e+000; foe(n+1)=1.336934e+001; krok(n+1)=7.092411e-002; ng(n+1)=7.410792e+002;
n=46; farx(n+1)=5.538296e+000; foe(n+1)=1.175393e+001; krok(n+1)=8.764941e-002; ng(n+1)=6.143760e+002;
n=47; farx(n+1)=5.347096e+000; foe(n+1)=1.143180e+001; krok(n+1)=6.700076e-003; ng(n+1)=3.464644e+002;
n=48; farx(n+1)=4.834854e+000; foe(n+1)=1.008020e+001; krok(n+1)=3.990088e-002; ng(n+1)=3.556465e+002;
n=49; farx(n+1)=4.634458e+000; foe(n+1)=9.602879e+000; krok(n+1)=1.052242e-001; ng(n+1)=1.334356e+002;
n=50; farx(n+1)=4.363038e+000; foe(n+1)=8.921719e+000; krok(n+1)=1.674643e-001; ng(n+1)=3.632826e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.366598e+000; foe(n+1)=8.859067e+000; krok(n+1)=1.103022e-005; ng(n+1)=2.896271e+002;
n=52; farx(n+1)=4.382741e+000; foe(n+1)=8.831457e+000; krok(n+1)=5.314479e-005; ng(n+1)=8.959348e+001;
n=53; farx(n+1)=4.395000e+000; foe(n+1)=8.792402e+000; krok(n+1)=7.204982e-005; ng(n+1)=9.459144e+001;
n=54; farx(n+1)=4.352107e+000; foe(n+1)=8.674415e+000; krok(n+1)=4.766449e-004; ng(n+1)=6.634541e+001;
n=55; farx(n+1)=4.277791e+000; foe(n+1)=8.487077e+000; krok(n+1)=1.772228e-003; ng(n+1)=4.887496e+001;
n=56; farx(n+1)=4.255599e+000; foe(n+1)=8.443322e+000; krok(n+1)=9.975011e-004; ng(n+1)=2.770001e+001;
n=57; farx(n+1)=4.061727e+000; foe(n+1)=7.833061e+000; krok(n+1)=1.920518e-002; ng(n+1)=3.748639e+001;
n=58; farx(n+1)=3.875627e+000; foe(n+1)=7.550067e+000; krok(n+1)=1.126281e-002; ng(n+1)=2.161225e+002;
n=59; farx(n+1)=3.566635e+000; foe(n+1)=6.935324e+000; krok(n+1)=1.631045e-002; ng(n+1)=4.108237e+002;
n=60; farx(n+1)=3.451123e+000; foe(n+1)=6.715518e+000; krok(n+1)=3.427028e-003; ng(n+1)=5.270580e+002;
n=61; farx(n+1)=3.205358e+000; foe(n+1)=6.382234e+000; krok(n+1)=5.879413e-003; ng(n+1)=3.923634e+002;
n=62; farx(n+1)=3.121868e+000; foe(n+1)=6.164537e+000; krok(n+1)=1.556427e-002; ng(n+1)=2.433750e+002;
n=63; farx(n+1)=2.965576e+000; foe(n+1)=5.899744e+000; krok(n+1)=8.443488e-003; ng(n+1)=2.471684e+002;
n=64; farx(n+1)=2.761029e+000; foe(n+1)=5.423617e+000; krok(n+1)=1.991516e-001; ng(n+1)=2.245805e+002;
n=65; farx(n+1)=2.700962e+000; foe(n+1)=5.336179e+000; krok(n+1)=1.869617e-002; ng(n+1)=1.603729e+002;
n=66; farx(n+1)=2.681431e+000; foe(n+1)=5.280732e+000; krok(n+1)=1.647425e-002; ng(n+1)=2.111640e+002;
n=67; farx(n+1)=2.659030e+000; foe(n+1)=5.202959e+000; krok(n+1)=3.802441e-002; ng(n+1)=8.874730e+001;
n=68; farx(n+1)=2.605384e+000; foe(n+1)=5.074051e+000; krok(n+1)=4.346837e-002; ng(n+1)=1.552712e+002;
n=69; farx(n+1)=2.547266e+000; foe(n+1)=4.981304e+000; krok(n+1)=6.939329e-002; ng(n+1)=1.651767e+002;
n=70; farx(n+1)=2.517741e+000; foe(n+1)=4.830412e+000; krok(n+1)=1.221956e-001; ng(n+1)=2.858885e+002;
n=71; farx(n+1)=2.581289e+000; foe(n+1)=4.669323e+000; krok(n+1)=1.269153e-001; ng(n+1)=3.399563e+002;
n=72; farx(n+1)=2.595613e+000; foe(n+1)=4.587317e+000; krok(n+1)=1.827549e-001; ng(n+1)=2.148989e+002;
n=73; farx(n+1)=2.529686e+000; foe(n+1)=4.464106e+000; krok(n+1)=4.536903e-001; ng(n+1)=1.631751e+002;
n=74; farx(n+1)=2.547812e+000; foe(n+1)=4.353111e+000; krok(n+1)=2.452016e-001; ng(n+1)=9.669066e+001;
n=75; farx(n+1)=2.445322e+000; foe(n+1)=4.214100e+000; krok(n+1)=4.787134e-001; ng(n+1)=7.077275e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.442176e+000; foe(n+1)=4.198471e+000; krok(n+1)=1.290553e-005; ng(n+1)=1.327778e+002;
n=77; farx(n+1)=2.442220e+000; foe(n+1)=4.192754e+000; krok(n+1)=1.577348e-005; ng(n+1)=6.915639e+001;
n=78; farx(n+1)=2.441137e+000; foe(n+1)=4.173644e+000; krok(n+1)=2.563847e-004; ng(n+1)=3.230983e+001;
n=79; farx(n+1)=2.423859e+000; foe(n+1)=4.119989e+000; krok(n+1)=4.199256e-004; ng(n+1)=3.537917e+001;
n=80; farx(n+1)=2.408094e+000; foe(n+1)=4.088590e+000; krok(n+1)=1.181843e-003; ng(n+1)=3.275933e+001;
n=81; farx(n+1)=2.389915e+000; foe(n+1)=4.036448e+000; krok(n+1)=2.484942e-003; ng(n+1)=3.961378e+001;
n=82; farx(n+1)=2.369476e+000; foe(n+1)=3.986974e+000; krok(n+1)=6.516379e-003; ng(n+1)=1.120716e+002;
n=83; farx(n+1)=2.359722e+000; foe(n+1)=3.946557e+000; krok(n+1)=5.967206e-003; ng(n+1)=2.547679e+002;
n=84; farx(n+1)=2.353823e+000; foe(n+1)=3.919933e+000; krok(n+1)=9.824309e-003; ng(n+1)=2.882505e+002;
n=85; farx(n+1)=2.315686e+000; foe(n+1)=3.882593e+000; krok(n+1)=1.617035e-002; ng(n+1)=2.518971e+002;
n=86; farx(n+1)=2.276096e+000; foe(n+1)=3.825369e+000; krok(n+1)=1.985729e-002; ng(n+1)=2.802769e+002;
n=87; farx(n+1)=2.197846e+000; foe(n+1)=3.719101e+000; krok(n+1)=8.191626e-002; ng(n+1)=2.665021e+002;
n=88; farx(n+1)=2.180245e+000; foe(n+1)=3.658455e+000; krok(n+1)=3.192743e-002; ng(n+1)=2.542324e+002;
n=89; farx(n+1)=2.120949e+000; foe(n+1)=3.600688e+000; krok(n+1)=2.113198e-002; ng(n+1)=2.316235e+002;
n=90; farx(n+1)=2.031412e+000; foe(n+1)=3.486056e+000; krok(n+1)=1.088038e-001; ng(n+1)=3.114301e+002;
n=91; farx(n+1)=1.990157e+000; foe(n+1)=3.430714e+000; krok(n+1)=5.440189e-002; ng(n+1)=1.304274e+002;
n=92; farx(n+1)=1.969319e+000; foe(n+1)=3.349114e+000; krok(n+1)=1.088038e-001; ng(n+1)=1.468118e+002;
n=93; farx(n+1)=1.835200e+000; foe(n+1)=3.076084e+000; krok(n+1)=5.853717e-001; ng(n+1)=1.163585e+002;
n=94; farx(n+1)=1.806917e+000; foe(n+1)=3.016509e+000; krok(n+1)=1.528851e-001; ng(n+1)=2.048928e+002;
n=95; farx(n+1)=1.705659e+000; foe(n+1)=2.864040e+000; krok(n+1)=1.362644e-001; ng(n+1)=2.144150e+002;
n=96; farx(n+1)=1.662773e+000; foe(n+1)=2.751724e+000; krok(n+1)=1.961845e-001; ng(n+1)=2.363742e+002;
n=97; farx(n+1)=1.612410e+000; foe(n+1)=2.695850e+000; krok(n+1)=8.000730e-002; ng(n+1)=1.582488e+002;
n=98; farx(n+1)=1.594258e+000; foe(n+1)=2.623200e+000; krok(n+1)=1.370460e-001; ng(n+1)=2.822416e+002;
n=99; farx(n+1)=1.554572e+000; foe(n+1)=2.538256e+000; krok(n+1)=1.446686e-001; ng(n+1)=1.170610e+002;
n=100; farx(n+1)=1.532075e+000; foe(n+1)=2.479391e+000; krok(n+1)=3.034235e-002; ng(n+1)=1.671072e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
