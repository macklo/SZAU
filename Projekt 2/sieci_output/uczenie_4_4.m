%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.151740e+003; foe(n+1)=4.047823e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.104883e+003; foe(n+1)=2.968676e+003; krok(n+1)=5.263121e-004; ng(n+1)=2.802364e+003;
n=2; farx(n+1)=9.684795e+002; foe(n+1)=7.324901e+002; krok(n+1)=4.851992e-003; ng(n+1)=1.260532e+003;
n=3; farx(n+1)=9.910596e+002; foe(n+1)=5.224496e+002; krok(n+1)=2.494331e-004; ng(n+1)=3.818106e+003;
n=4; farx(n+1)=1.077043e+003; foe(n+1)=4.929580e+002; krok(n+1)=5.580806e-004; ng(n+1)=1.816657e+003;
n=5; farx(n+1)=8.466104e+002; foe(n+1)=4.200307e+002; krok(n+1)=3.625910e-003; ng(n+1)=3.897810e+002;
n=6; farx(n+1)=4.185618e+002; foe(n+1)=3.463334e+002; krok(n+1)=5.557598e-003; ng(n+1)=1.003078e+003;
n=7; farx(n+1)=3.549073e+002; foe(n+1)=3.277738e+002; krok(n+1)=9.208067e-004; ng(n+1)=1.462093e+003;
n=8; farx(n+1)=3.119720e+002; foe(n+1)=3.189102e+002; krok(n+1)=3.308775e-004; ng(n+1)=1.340494e+003;
n=9; farx(n+1)=2.888592e+002; foe(n+1)=3.140492e+002; krok(n+1)=2.100870e-003; ng(n+1)=7.882505e+002;
n=10; farx(n+1)=2.257717e+002; foe(n+1)=3.006298e+002; krok(n+1)=1.064021e-002; ng(n+1)=5.099602e+002;
n=11; farx(n+1)=2.028625e+002; foe(n+1)=2.708438e+002; krok(n+1)=2.547833e-003; ng(n+1)=9.670676e+002;
n=12; farx(n+1)=1.936617e+002; foe(n+1)=2.637429e+002; krok(n+1)=8.605590e-004; ng(n+1)=9.779914e+002;
n=13; farx(n+1)=1.886902e+002; foe(n+1)=2.606785e+002; krok(n+1)=2.474886e-003; ng(n+1)=1.269070e+003;
n=14; farx(n+1)=1.820331e+002; foe(n+1)=2.564276e+002; krok(n+1)=3.516052e-003; ng(n+1)=1.100339e+003;
n=15; farx(n+1)=1.364392e+002; foe(n+1)=2.385246e+002; krok(n+1)=7.088910e-003; ng(n+1)=7.942109e+002;
n=16; farx(n+1)=1.211601e+002; foe(n+1)=2.288158e+002; krok(n+1)=1.841613e-003; ng(n+1)=2.239819e+003;
n=17; farx(n+1)=1.117545e+002; foe(n+1)=2.209145e+002; krok(n+1)=3.475615e-003; ng(n+1)=2.862185e+003;
n=18; farx(n+1)=1.102686e+002; foe(n+1)=2.202415e+002; krok(n+1)=2.289978e-003; ng(n+1)=3.265428e+003;
n=19; farx(n+1)=1.058845e+002; foe(n+1)=2.168582e+002; krok(n+1)=5.817002e-004; ng(n+1)=4.236741e+003;
n=20; farx(n+1)=8.676294e+001; foe(n+1)=2.006726e+002; krok(n+1)=8.751130e-003; ng(n+1)=5.425324e+003;
n=21; farx(n+1)=7.385080e+001; foe(n+1)=1.817925e+002; krok(n+1)=3.059436e-003; ng(n+1)=1.492028e+004;
n=22; farx(n+1)=7.086491e+001; foe(n+1)=1.769892e+002; krok(n+1)=1.923079e-003; ng(n+1)=5.147716e+003;
n=23; farx(n+1)=6.200601e+001; foe(n+1)=1.727492e+002; krok(n+1)=7.152527e-003; ng(n+1)=5.365760e+003;
n=24; farx(n+1)=5.910253e+001; foe(n+1)=1.642282e+002; krok(n+1)=3.022871e-002; ng(n+1)=6.116881e+003;
n=25; farx(n+1)=3.739659e+001; foe(n+1)=1.261892e+002; krok(n+1)=1.865214e-001; ng(n+1)=5.194410e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.630708e+001; foe(n+1)=9.553122e+001; krok(n+1)=1.796068e-005; ng(n+1)=4.475520e+003;
n=27; farx(n+1)=3.606115e+001; foe(n+1)=8.910561e+001; krok(n+1)=2.277170e-005; ng(n+1)=2.130198e+003;
n=28; farx(n+1)=3.393208e+001; foe(n+1)=8.558981e+001; krok(n+1)=3.347436e-004; ng(n+1)=8.827702e+002;
n=29; farx(n+1)=3.274475e+001; foe(n+1)=8.034266e+001; krok(n+1)=3.467612e-004; ng(n+1)=9.357222e+002;
n=30; farx(n+1)=2.936738e+001; foe(n+1)=7.656767e+001; krok(n+1)=1.812955e-003; ng(n+1)=8.460829e+002;
n=31; farx(n+1)=2.850746e+001; foe(n+1)=7.142478e+001; krok(n+1)=1.575776e-003; ng(n+1)=1.040722e+003;
n=32; farx(n+1)=2.463288e+001; foe(n+1)=6.166094e+001; krok(n+1)=3.595838e-003; ng(n+1)=9.218775e+002;
n=33; farx(n+1)=2.417629e+001; foe(n+1)=5.170939e+001; krok(n+1)=2.341941e-003; ng(n+1)=2.390223e+003;
n=34; farx(n+1)=2.136952e+001; foe(n+1)=3.480364e+001; krok(n+1)=5.682045e-003; ng(n+1)=2.016612e+003;
n=35; farx(n+1)=2.108929e+001; foe(n+1)=3.438137e+001; krok(n+1)=1.229105e-003; ng(n+1)=6.357293e+002;
n=36; farx(n+1)=1.949016e+001; foe(n+1)=3.348347e+001; krok(n+1)=7.164989e-003; ng(n+1)=6.577388e+002;
n=37; farx(n+1)=1.859990e+001; foe(n+1)=3.215699e+001; krok(n+1)=1.926189e-002; ng(n+1)=8.178504e+002;
n=38; farx(n+1)=1.674162e+001; foe(n+1)=3.096446e+001; krok(n+1)=2.900728e-002; ng(n+1)=7.102649e+002;
n=39; farx(n+1)=1.486252e+001; foe(n+1)=2.675026e+001; krok(n+1)=9.599621e-002; ng(n+1)=7.597767e+002;
n=40; farx(n+1)=1.443631e+001; foe(n+1)=2.587748e+001; krok(n+1)=1.280182e-002; ng(n+1)=3.047354e+002;
n=41; farx(n+1)=1.122232e+001; foe(n+1)=2.301734e+001; krok(n+1)=1.141951e-001; ng(n+1)=2.051135e+002;
n=42; farx(n+1)=9.793428e+000; foe(n+1)=2.151709e+001; krok(n+1)=3.790730e-002; ng(n+1)=3.458718e+002;
n=43; farx(n+1)=1.013369e+001; foe(n+1)=2.057060e+001; krok(n+1)=2.972664e-002; ng(n+1)=6.198661e+002;
n=44; farx(n+1)=8.828619e+000; foe(n+1)=1.893128e+001; krok(n+1)=2.393567e-001; ng(n+1)=1.676962e+002;
n=45; farx(n+1)=7.467543e+000; foe(n+1)=1.728076e+001; krok(n+1)=5.600723e-001; ng(n+1)=3.497599e+002;
n=46; farx(n+1)=6.587438e+000; foe(n+1)=1.557330e+001; krok(n+1)=4.128102e-001; ng(n+1)=6.212521e+002;
n=47; farx(n+1)=6.313908e+000; foe(n+1)=1.498140e+001; krok(n+1)=4.306047e-001; ng(n+1)=2.018406e+002;
n=48; farx(n+1)=5.963424e+000; foe(n+1)=1.406586e+001; krok(n+1)=8.049667e-001; ng(n+1)=1.310661e+002;
n=49; farx(n+1)=5.713882e+000; foe(n+1)=1.325558e+001; krok(n+1)=9.763190e-001; ng(n+1)=1.207105e+002;
n=50; farx(n+1)=5.442553e+000; foe(n+1)=1.201931e+001; krok(n+1)=6.666685e-001; ng(n+1)=4.017318e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=5.369542e+000; foe(n+1)=1.176328e+001; krok(n+1)=3.625046e-005; ng(n+1)=2.551559e+002;
n=52; farx(n+1)=5.360445e+000; foe(n+1)=1.170448e+001; krok(n+1)=2.769106e-005; ng(n+1)=1.766268e+002;
n=53; farx(n+1)=5.337020e+000; foe(n+1)=1.157739e+001; krok(n+1)=6.196678e-004; ng(n+1)=6.117221e+001;
n=54; farx(n+1)=5.369082e+000; foe(n+1)=1.150649e+001; krok(n+1)=2.917458e-004; ng(n+1)=5.802305e+001;
n=55; farx(n+1)=5.081317e+000; foe(n+1)=1.103245e+001; krok(n+1)=6.100588e-003; ng(n+1)=3.097540e+001;
n=56; farx(n+1)=4.449412e+000; foe(n+1)=1.026548e+001; krok(n+1)=7.144846e-003; ng(n+1)=2.487453e+002;
n=57; farx(n+1)=4.157928e+000; foe(n+1)=9.665281e+000; krok(n+1)=4.445667e-003; ng(n+1)=5.975165e+002;
n=58; farx(n+1)=3.964011e+000; foe(n+1)=9.456619e+000; krok(n+1)=8.350786e-003; ng(n+1)=1.141257e+002;
n=59; farx(n+1)=3.841774e+000; foe(n+1)=9.286959e+000; krok(n+1)=9.096510e-003; ng(n+1)=1.922348e+002;
n=60; farx(n+1)=3.601115e+000; foe(n+1)=8.987461e+000; krok(n+1)=4.781642e-002; ng(n+1)=2.545734e+002;
n=61; farx(n+1)=3.448589e+000; foe(n+1)=8.746928e+000; krok(n+1)=4.725510e-002; ng(n+1)=3.417670e+002;
n=62; farx(n+1)=3.023701e+000; foe(n+1)=8.344288e+000; krok(n+1)=3.432277e-002; ng(n+1)=2.167763e+002;
n=63; farx(n+1)=2.618252e+000; foe(n+1)=7.989307e+000; krok(n+1)=7.000904e-002; ng(n+1)=8.761340e+001;
n=64; farx(n+1)=2.564484e+000; foe(n+1)=7.896330e+000; krok(n+1)=1.596002e-002; ng(n+1)=1.002061e+002;
n=65; farx(n+1)=2.313255e+000; foe(n+1)=7.517910e+000; krok(n+1)=1.534454e-001; ng(n+1)=1.754212e+002;
n=66; farx(n+1)=2.140098e+000; foe(n+1)=7.100904e+000; krok(n+1)=8.892157e-002; ng(n+1)=1.756785e+002;
n=67; farx(n+1)=2.102602e+000; foe(n+1)=6.950508e+000; krok(n+1)=3.039298e-002; ng(n+1)=2.474279e+002;
n=68; farx(n+1)=2.094100e+000; foe(n+1)=6.647410e+000; krok(n+1)=4.215364e-002; ng(n+1)=3.977610e+002;
n=69; farx(n+1)=2.043749e+000; foe(n+1)=6.436254e+000; krok(n+1)=7.240442e-002; ng(n+1)=7.404981e+002;
n=70; farx(n+1)=2.067618e+000; foe(n+1)=6.079819e+000; krok(n+1)=1.775417e-001; ng(n+1)=5.908983e+002;
n=71; farx(n+1)=1.891640e+000; foe(n+1)=5.833366e+000; krok(n+1)=1.540951e-001; ng(n+1)=1.002402e+002;
n=72; farx(n+1)=1.857451e+000; foe(n+1)=5.758869e+000; krok(n+1)=4.002904e-002; ng(n+1)=1.320504e+002;
n=73; farx(n+1)=1.808502e+000; foe(n+1)=5.570685e+000; krok(n+1)=2.695720e-001; ng(n+1)=1.989393e+002;
n=74; farx(n+1)=1.831052e+000; foe(n+1)=5.438561e+000; krok(n+1)=1.477098e-001; ng(n+1)=4.614346e+002;
n=75; farx(n+1)=1.839956e+000; foe(n+1)=5.234363e+000; krok(n+1)=4.452012e-001; ng(n+1)=7.159172e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.837617e+000; foe(n+1)=5.223964e+000; krok(n+1)=4.675854e-006; ng(n+1)=1.505421e+002;
n=77; farx(n+1)=1.831259e+000; foe(n+1)=5.194878e+000; krok(n+1)=4.244958e-005; ng(n+1)=8.897475e+001;
n=78; farx(n+1)=1.827427e+000; foe(n+1)=5.178146e+000; krok(n+1)=2.669060e-005; ng(n+1)=7.290187e+001;
n=79; farx(n+1)=1.813265e+000; foe(n+1)=5.136526e+000; krok(n+1)=1.144090e-003; ng(n+1)=2.231572e+001;
n=80; farx(n+1)=1.795273e+000; foe(n+1)=5.114833e+000; krok(n+1)=1.463096e-003; ng(n+1)=2.790685e+001;
n=81; farx(n+1)=1.769601e+000; foe(n+1)=5.028197e+000; krok(n+1)=1.042905e-002; ng(n+1)=3.414631e+001;
n=82; farx(n+1)=1.762661e+000; foe(n+1)=5.011182e+000; krok(n+1)=6.015953e-004; ng(n+1)=2.716464e+002;
n=83; farx(n+1)=1.730582e+000; foe(n+1)=4.921939e+000; krok(n+1)=9.296334e-003; ng(n+1)=3.634174e+002;
n=84; farx(n+1)=1.713168e+000; foe(n+1)=4.834780e+000; krok(n+1)=4.447430e-003; ng(n+1)=6.591836e+002;
n=85; farx(n+1)=1.702290e+000; foe(n+1)=4.750504e+000; krok(n+1)=1.576669e-002; ng(n+1)=5.998303e+002;
n=86; farx(n+1)=1.692202e+000; foe(n+1)=4.708648e+000; krok(n+1)=7.599313e-003; ng(n+1)=4.047770e+002;
n=87; farx(n+1)=1.646302e+000; foe(n+1)=4.635833e+000; krok(n+1)=3.730542e-002; ng(n+1)=1.012235e+002;
n=88; farx(n+1)=1.648673e+000; foe(n+1)=4.609840e+000; krok(n+1)=2.107682e-002; ng(n+1)=1.015174e+002;
n=89; farx(n+1)=1.641175e+000; foe(n+1)=4.581709e+000; krok(n+1)=1.567500e-002; ng(n+1)=1.560602e+002;
n=90; farx(n+1)=1.622563e+000; foe(n+1)=4.488252e+000; krok(n+1)=6.813219e-002; ng(n+1)=8.415071e+001;
n=91; farx(n+1)=1.600083e+000; foe(n+1)=4.374149e+000; krok(n+1)=1.601162e-001; ng(n+1)=1.587899e+002;
n=92; farx(n+1)=1.587962e+000; foe(n+1)=4.260427e+000; krok(n+1)=2.134155e-001; ng(n+1)=9.698397e+001;
n=93; farx(n+1)=1.558529e+000; foe(n+1)=4.107345e+000; krok(n+1)=3.185792e-001; ng(n+1)=3.415566e+002;
n=94; farx(n+1)=1.541281e+000; foe(n+1)=4.025744e+000; krok(n+1)=2.454949e-001; ng(n+1)=1.438540e+002;
n=95; farx(n+1)=1.528338e+000; foe(n+1)=3.944662e+000; krok(n+1)=2.006794e-001; ng(n+1)=1.229192e+002;
n=96; farx(n+1)=1.479068e+000; foe(n+1)=3.824141e+000; krok(n+1)=6.788102e-001; ng(n+1)=5.505547e+001;
n=97; farx(n+1)=1.464059e+000; foe(n+1)=3.763391e+000; krok(n+1)=9.018109e-002; ng(n+1)=8.924712e+001;
n=98; farx(n+1)=1.452818e+000; foe(n+1)=3.600107e+000; krok(n+1)=5.450576e-001; ng(n+1)=3.639116e+002;
n=99; farx(n+1)=1.468472e+000; foe(n+1)=3.538869e+000; krok(n+1)=1.886278e-001; ng(n+1)=1.483061e+002;
n=100; farx(n+1)=1.479970e+000; foe(n+1)=3.386156e+000; krok(n+1)=4.788369e-001; ng(n+1)=7.911807e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
