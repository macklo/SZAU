%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.057577e+003; foe(n+1)=4.001846e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.932045e+003; foe(n+1)=2.975111e+003; krok(n+1)=4.987505e-004; ng(n+1)=2.271874e+003;
n=2; farx(n+1)=8.803119e+002; foe(n+1)=8.357114e+002; krok(n+1)=5.167850e-003; ng(n+1)=1.078185e+003;
n=3; farx(n+1)=8.678676e+002; foe(n+1)=5.995510e+002; krok(n+1)=1.895397e-004; ng(n+1)=4.322383e+003;
n=4; farx(n+1)=8.686038e+002; foe(n+1)=4.208392e+002; krok(n+1)=1.060430e-003; ng(n+1)=3.669811e+003;
n=5; farx(n+1)=4.807020e+002; foe(n+1)=3.616207e+002; krok(n+1)=7.479896e-003; ng(n+1)=3.686603e+002;
n=6; farx(n+1)=4.614946e+002; foe(n+1)=3.538162e+002; krok(n+1)=2.394037e-003; ng(n+1)=3.127393e+002;
n=7; farx(n+1)=4.425125e+002; foe(n+1)=3.445545e+002; krok(n+1)=2.400181e-003; ng(n+1)=2.736035e+002;
n=8; farx(n+1)=4.217774e+002; foe(n+1)=3.329464e+002; krok(n+1)=1.473291e-002; ng(n+1)=2.187211e+002;
n=9; farx(n+1)=4.067268e+002; foe(n+1)=3.230549e+002; krok(n+1)=1.127002e-002; ng(n+1)=2.256361e+002;
n=10; farx(n+1)=4.017793e+002; foe(n+1)=3.177455e+002; krok(n+1)=5.387784e-002; ng(n+1)=3.036668e+002;
n=11; farx(n+1)=3.892707e+002; foe(n+1)=3.151933e+002; krok(n+1)=2.965791e-002; ng(n+1)=2.041963e+002;
n=12; farx(n+1)=3.895684e+002; foe(n+1)=3.126892e+002; krok(n+1)=2.452306e-002; ng(n+1)=2.025196e+002;
n=13; farx(n+1)=3.860738e+002; foe(n+1)=3.116638e+002; krok(n+1)=1.626130e-002; ng(n+1)=2.226056e+002;
n=14; farx(n+1)=3.660570e+002; foe(n+1)=3.051981e+002; krok(n+1)=6.813219e-002; ng(n+1)=2.382903e+002;
n=15; farx(n+1)=3.372545e+002; foe(n+1)=3.009881e+002; krok(n+1)=8.388517e-002; ng(n+1)=3.466909e+002;
n=16; farx(n+1)=3.042864e+002; foe(n+1)=2.921881e+002; krok(n+1)=7.406706e-002; ng(n+1)=1.649456e+002;
n=17; farx(n+1)=2.825426e+002; foe(n+1)=2.870302e+002; krok(n+1)=3.153693e-002; ng(n+1)=1.624155e+002;
n=18; farx(n+1)=1.738284e+002; foe(n+1)=2.669750e+002; krok(n+1)=8.858725e-001; ng(n+1)=1.727161e+002;
n=19; farx(n+1)=1.416858e+002; foe(n+1)=2.586722e+002; krok(n+1)=2.191235e-002; ng(n+1)=4.881411e+002;
n=20; farx(n+1)=1.339160e+002; foe(n+1)=2.558566e+002; krok(n+1)=3.196395e-002; ng(n+1)=1.176304e+003;
n=21; farx(n+1)=9.435977e+001; foe(n+1)=2.243702e+002; krok(n+1)=5.925364e-001; ng(n+1)=2.845105e+003;
n=22; farx(n+1)=1.143489e+002; foe(n+1)=1.905820e+002; krok(n+1)=1.668612e-001; ng(n+1)=5.546890e+002;
n=23; farx(n+1)=1.192248e+002; foe(n+1)=1.676782e+002; krok(n+1)=1.668612e-001; ng(n+1)=6.395272e+002;
n=24; farx(n+1)=1.014988e+002; foe(n+1)=1.504910e+002; krok(n+1)=7.866273e-002; ng(n+1)=1.123044e+003;
n=25; farx(n+1)=9.472623e+001; foe(n+1)=1.247872e+002; krok(n+1)=3.022871e-002; ng(n+1)=3.336404e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=8.921843e+001; foe(n+1)=1.093314e+002; krok(n+1)=6.631510e-006; ng(n+1)=4.694730e+003;
n=27; farx(n+1)=6.190701e+001; foe(n+1)=8.874751e+001; krok(n+1)=3.109358e-004; ng(n+1)=6.253596e+002;
n=28; farx(n+1)=4.102355e+001; foe(n+1)=5.948478e+001; krok(n+1)=1.179568e-003; ng(n+1)=7.347615e+002;
n=29; farx(n+1)=4.156263e+001; foe(n+1)=5.748636e+001; krok(n+1)=4.863026e-004; ng(n+1)=9.145625e+002;
n=30; farx(n+1)=4.026076e+001; foe(n+1)=5.557919e+001; krok(n+1)=2.038825e-003; ng(n+1)=1.076146e+003;
n=31; farx(n+1)=4.077889e+001; foe(n+1)=5.470156e+001; krok(n+1)=3.830473e-003; ng(n+1)=2.730688e+002;
n=32; farx(n+1)=4.043604e+001; foe(n+1)=5.435902e+001; krok(n+1)=2.001452e-002; ng(n+1)=1.565686e+002;
n=33; farx(n+1)=3.652603e+001; foe(n+1)=5.287570e+001; krok(n+1)=7.700420e-002; ng(n+1)=1.835182e+002;
n=34; farx(n+1)=3.411676e+001; foe(n+1)=5.219006e+001; krok(n+1)=4.226396e-002; ng(n+1)=2.664214e+002;
n=35; farx(n+1)=3.301620e+001; foe(n+1)=5.043964e+001; krok(n+1)=6.002401e-002; ng(n+1)=7.573102e+002;
n=36; farx(n+1)=3.161794e+001; foe(n+1)=4.862257e+001; krok(n+1)=1.937164e-001; ng(n+1)=6.862388e+002;
n=37; farx(n+1)=3.140352e+001; foe(n+1)=4.700510e+001; krok(n+1)=7.104066e-002; ng(n+1)=2.780116e+002;
n=38; farx(n+1)=2.920230e+001; foe(n+1)=4.446510e+001; krok(n+1)=2.012417e-001; ng(n+1)=8.651714e+001;
n=39; farx(n+1)=2.789382e+001; foe(n+1)=4.361068e+001; krok(n+1)=1.752988e-001; ng(n+1)=2.558977e+002;
n=40; farx(n+1)=2.779316e+001; foe(n+1)=4.333576e+001; krok(n+1)=6.864555e-002; ng(n+1)=1.927792e+002;
n=41; farx(n+1)=2.469006e+001; foe(n+1)=4.028733e+001; krok(n+1)=2.745494e-001; ng(n+1)=4.571861e+002;
n=42; farx(n+1)=2.271514e+001; foe(n+1)=3.791731e+001; krok(n+1)=8.067975e-001; ng(n+1)=8.008559e+002;
n=43; farx(n+1)=2.188250e+001; foe(n+1)=3.739758e+001; krok(n+1)=2.393567e-001; ng(n+1)=3.053698e+002;
n=44; farx(n+1)=2.121492e+001; foe(n+1)=3.657180e+001; krok(n+1)=4.339732e-001; ng(n+1)=8.091980e+001;
n=45; farx(n+1)=2.006770e+001; foe(n+1)=3.581339e+001; krok(n+1)=9.809225e-002; ng(n+1)=2.258714e+002;
n=46; farx(n+1)=1.846977e+001; foe(n+1)=3.509878e+001; krok(n+1)=5.727234e-001; ng(n+1)=1.700712e+002;
n=47; farx(n+1)=1.706491e+001; foe(n+1)=3.417694e+001; krok(n+1)=4.887823e-001; ng(n+1)=1.916678e+002;
n=48; farx(n+1)=1.590231e+001; foe(n+1)=3.285812e+001; krok(n+1)=5.810114e-001; ng(n+1)=7.353946e+002;
n=49; farx(n+1)=1.557884e+001; foe(n+1)=3.160845e+001; krok(n+1)=7.271671e-001; ng(n+1)=2.376346e+002;
n=50; farx(n+1)=1.503579e+001; foe(n+1)=3.088309e+001; krok(n+1)=4.099104e-001; ng(n+1)=2.365851e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.501223e+001; foe(n+1)=3.074117e+001; krok(n+1)=1.953303e-005; ng(n+1)=2.229210e+002;
n=52; farx(n+1)=1.431748e+001; foe(n+1)=2.992576e+001; krok(n+1)=1.624345e-004; ng(n+1)=1.694513e+002;
n=53; farx(n+1)=1.375083e+001; foe(n+1)=2.893196e+001; krok(n+1)=6.518015e-004; ng(n+1)=3.162309e+002;
n=54; farx(n+1)=1.364653e+001; foe(n+1)=2.869921e+001; krok(n+1)=4.069498e-004; ng(n+1)=3.989748e+002;
n=55; farx(n+1)=1.318817e+001; foe(n+1)=2.825778e+001; krok(n+1)=1.612540e-003; ng(n+1)=3.393035e+002;
n=56; farx(n+1)=1.271320e+001; foe(n+1)=2.750417e+001; krok(n+1)=4.098218e-003; ng(n+1)=2.697297e+002;
n=57; farx(n+1)=1.218177e+001; foe(n+1)=2.706866e+001; krok(n+1)=3.240245e-003; ng(n+1)=2.837332e+002;
n=58; farx(n+1)=1.201530e+001; foe(n+1)=2.669072e+001; krok(n+1)=5.272732e-003; ng(n+1)=2.055275e+002;
n=59; farx(n+1)=1.200660e+001; foe(n+1)=2.593708e+001; krok(n+1)=2.317569e-001; ng(n+1)=1.760636e+002;
n=60; farx(n+1)=1.143325e+001; foe(n+1)=2.530457e+001; krok(n+1)=2.386882e-002; ng(n+1)=1.965801e+002;
n=61; farx(n+1)=1.136837e+001; foe(n+1)=2.471085e+001; krok(n+1)=5.419562e-001; ng(n+1)=1.594280e+002;
n=62; farx(n+1)=1.134680e+001; foe(n+1)=2.448832e+001; krok(n+1)=1.041001e-001; ng(n+1)=1.065846e+002;
n=63; farx(n+1)=1.098257e+001; foe(n+1)=2.430086e+001; krok(n+1)=2.134155e-001; ng(n+1)=2.364601e+002;
n=64; farx(n+1)=9.943766e+000; foe(n+1)=2.374036e+001; krok(n+1)=8.847528e-001; ng(n+1)=4.186002e+002;
n=65; farx(n+1)=9.822248e+000; foe(n+1)=2.336194e+001; krok(n+1)=4.555491e-001; ng(n+1)=1.841395e+002;
n=66; farx(n+1)=8.749637e+000; foe(n+1)=2.236803e+001; krok(n+1)=1.196555e+000; ng(n+1)=9.727225e+001;
n=67; farx(n+1)=7.815977e+000; foe(n+1)=2.159868e+001; krok(n+1)=4.741921e-001; ng(n+1)=2.247741e+002;
n=68; farx(n+1)=6.806770e+000; foe(n+1)=2.101286e+001; krok(n+1)=7.271671e-001; ng(n+1)=1.543323e+002;
n=69; farx(n+1)=6.624689e+000; foe(n+1)=2.077325e+001; krok(n+1)=2.818076e-001; ng(n+1)=2.211750e+002;
n=70; farx(n+1)=6.079931e+000; foe(n+1)=2.047960e+001; krok(n+1)=4.635137e-001; ng(n+1)=1.795137e+002;
n=71; farx(n+1)=5.735459e+000; foe(n+1)=2.034415e+001; krok(n+1)=5.249576e-001; ng(n+1)=1.055745e+002;
n=72; farx(n+1)=5.641792e+000; foe(n+1)=2.021093e+001; krok(n+1)=1.285695e+000; ng(n+1)=3.320373e+002;
n=73; farx(n+1)=5.584911e+000; foe(n+1)=2.010265e+001; krok(n+1)=1.065517e+000; ng(n+1)=6.982201e+001;
n=74; farx(n+1)=5.423310e+000; foe(n+1)=2.003337e+001; krok(n+1)=3.152950e-001; ng(n+1)=6.981813e+001;
n=75; farx(n+1)=5.479039e+000; foe(n+1)=1.985127e+001; krok(n+1)=2.539807e+000; ng(n+1)=6.750520e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=5.477245e+000; foe(n+1)=1.984302e+001; krok(n+1)=4.158459e-006; ng(n+1)=1.295329e+002;
n=77; farx(n+1)=5.458131e+000; foe(n+1)=1.981924e+001; krok(n+1)=6.047525e-005; ng(n+1)=4.538368e+001;
n=78; farx(n+1)=5.492256e+000; foe(n+1)=1.981092e+001; krok(n+1)=5.192137e-004; ng(n+1)=1.235713e+001;
n=79; farx(n+1)=5.469210e+000; foe(n+1)=1.979141e+001; krok(n+1)=5.080539e-004; ng(n+1)=1.630040e+001;
n=80; farx(n+1)=5.168555e+000; foe(n+1)=1.959770e+001; krok(n+1)=1.952316e-003; ng(n+1)=2.397216e+001;
n=81; farx(n+1)=5.006662e+000; foe(n+1)=1.952824e+001; krok(n+1)=1.153983e-003; ng(n+1)=1.566727e+002;
n=82; farx(n+1)=4.953205e+000; foe(n+1)=1.948596e+001; krok(n+1)=1.448033e-003; ng(n+1)=2.131925e+002;
n=83; farx(n+1)=4.981705e+000; foe(n+1)=1.945245e+001; krok(n+1)=7.533346e-002; ng(n+1)=1.500152e+002;
n=84; farx(n+1)=4.702505e+000; foe(n+1)=1.926781e+001; krok(n+1)=8.413217e-001; ng(n+1)=8.746027e+001;
n=85; farx(n+1)=4.550998e+000; foe(n+1)=1.918748e+001; krok(n+1)=1.817918e-001; ng(n+1)=9.327502e+001;
n=86; farx(n+1)=4.594898e+000; foe(n+1)=1.908150e+001; krok(n+1)=2.155114e-001; ng(n+1)=1.848547e+002;
n=87; farx(n+1)=4.395537e+000; foe(n+1)=1.895863e+001; krok(n+1)=2.442288e-001; ng(n+1)=2.271299e+002;
n=88; farx(n+1)=4.278170e+000; foe(n+1)=1.885880e+001; krok(n+1)=4.461084e-001; ng(n+1)=1.835720e+002;
n=89; farx(n+1)=4.245760e+000; foe(n+1)=1.874948e+001; krok(n+1)=8.088973e-001; ng(n+1)=9.109163e+001;
n=90; farx(n+1)=4.052817e+000; foe(n+1)=1.863531e+001; krok(n+1)=1.270866e+000; ng(n+1)=6.072708e+001;
n=91; farx(n+1)=4.049846e+000; foe(n+1)=1.858423e+001; krok(n+1)=2.894475e-001; ng(n+1)=3.113782e+002;
n=92; farx(n+1)=3.901170e+000; foe(n+1)=1.851495e+001; krok(n+1)=5.403454e-001; ng(n+1)=1.567431e+002;
n=93; farx(n+1)=3.704667e+000; foe(n+1)=1.841746e+001; krok(n+1)=4.322425e-001; ng(n+1)=1.435645e+002;
n=94; farx(n+1)=3.587506e+000; foe(n+1)=1.832511e+001; krok(n+1)=1.386016e+000; ng(n+1)=1.480481e+002;
n=95; farx(n+1)=3.409841e+000; foe(n+1)=1.822142e+001; krok(n+1)=4.126070e-001; ng(n+1)=1.240578e+002;
n=96; farx(n+1)=3.348429e+000; foe(n+1)=1.813040e+001; krok(n+1)=5.431301e-001; ng(n+1)=1.401327e+002;
n=97; farx(n+1)=3.374712e+000; foe(n+1)=1.807850e+001; krok(n+1)=6.428250e-001; ng(n+1)=6.725138e+001;
n=98; farx(n+1)=3.344518e+000; foe(n+1)=1.805841e+001; krok(n+1)=5.107206e-001; ng(n+1)=1.770109e+001;
n=99; farx(n+1)=3.286905e+000; foe(n+1)=1.803437e+001; krok(n+1)=1.153327e+000; ng(n+1)=2.372050e+001;
n=100; farx(n+1)=3.225526e+000; foe(n+1)=1.798420e+001; krok(n+1)=1.422745e+000; ng(n+1)=1.137641e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
