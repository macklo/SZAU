%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.930757e+003; foe(n+1)=3.948213e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.943180e+003; foe(n+1)=2.890348e+003; krok(n+1)=5.216764e-004; ng(n+1)=2.263451e+003;
n=2; farx(n+1)=9.860598e+002; foe(n+1)=6.967852e+002; krok(n+1)=3.568597e-003; ng(n+1)=1.304297e+003;
n=3; farx(n+1)=9.914455e+002; foe(n+1)=4.692248e+002; krok(n+1)=3.831728e-004; ng(n+1)=2.609840e+003;
n=4; farx(n+1)=8.240697e+002; foe(n+1)=4.224005e+002; krok(n+1)=6.607631e-003; ng(n+1)=7.092999e+002;
n=5; farx(n+1)=5.645855e+002; foe(n+1)=3.861515e+002; krok(n+1)=7.558357e-003; ng(n+1)=4.998733e+002;
n=6; farx(n+1)=5.818552e+002; foe(n+1)=3.836581e+002; krok(n+1)=1.093891e-003; ng(n+1)=7.885876e+002;
n=7; farx(n+1)=5.639948e+002; foe(n+1)=3.736960e+002; krok(n+1)=6.374691e-003; ng(n+1)=7.224095e+002;
n=8; farx(n+1)=5.639289e+002; foe(n+1)=3.730664e+002; krok(n+1)=2.118327e-003; ng(n+1)=7.115442e+002;
n=9; farx(n+1)=4.916446e+002; foe(n+1)=3.644262e+002; krok(n+1)=2.928765e-002; ng(n+1)=7.003694e+002;
n=10; farx(n+1)=3.835124e+002; foe(n+1)=3.480230e+002; krok(n+1)=3.301014e-002; ng(n+1)=6.186129e+002;
n=11; farx(n+1)=3.492490e+002; foe(n+1)=3.390821e+002; krok(n+1)=6.421648e-002; ng(n+1)=7.912400e+002;
n=12; farx(n+1)=3.539890e+002; foe(n+1)=3.166360e+002; krok(n+1)=6.428475e-001; ng(n+1)=6.899514e+002;
n=13; farx(n+1)=3.443422e+002; foe(n+1)=3.100511e+002; krok(n+1)=3.183983e-001; ng(n+1)=2.610666e+002;
n=14; farx(n+1)=3.362009e+002; foe(n+1)=3.040357e+002; krok(n+1)=5.714745e-001; ng(n+1)=1.407547e+002;
n=15; farx(n+1)=3.331227e+002; foe(n+1)=2.993148e+002; krok(n+1)=1.985796e+000; ng(n+1)=7.549568e+001;
n=16; farx(n+1)=3.208233e+002; foe(n+1)=2.980195e+002; krok(n+1)=6.301521e-002; ng(n+1)=1.509773e+002;
n=17; farx(n+1)=2.574333e+002; foe(n+1)=2.885325e+002; krok(n+1)=9.983416e-001; ng(n+1)=1.771962e+002;
n=18; farx(n+1)=1.734102e+002; foe(n+1)=2.749937e+002; krok(n+1)=8.377184e-001; ng(n+1)=4.780189e+002;
n=19; farx(n+1)=3.361433e+001; foe(n+1)=1.976442e+002; krok(n+1)=2.132852e-001; ng(n+1)=5.870856e+002;
n=20; farx(n+1)=3.324837e+001; foe(n+1)=1.974098e+002; krok(n+1)=5.972073e-004; ng(n+1)=1.971672e+003;
n=21; farx(n+1)=4.055169e+001; foe(n+1)=1.758874e+002; krok(n+1)=3.450079e-001; ng(n+1)=2.254535e+003;
n=22; farx(n+1)=2.944400e+001; foe(n+1)=1.531899e+002; krok(n+1)=4.033988e-001; ng(n+1)=2.928069e+003;
n=23; farx(n+1)=2.159958e+001; foe(n+1)=1.221139e+002; krok(n+1)=1.570381e-001; ng(n+1)=1.616600e+003;
n=24; farx(n+1)=1.983763e+001; foe(n+1)=1.122708e+002; krok(n+1)=1.143200e-001; ng(n+1)=1.481368e+003;
n=25; farx(n+1)=1.486330e+001; foe(n+1)=8.285842e+001; krok(n+1)=5.636152e-001; ng(n+1)=8.043950e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.436594e+001; foe(n+1)=8.141695e+001; krok(n+1)=4.069022e-005; ng(n+1)=5.062578e+002;
n=27; farx(n+1)=1.501647e+001; foe(n+1)=7.977234e+001; krok(n+1)=4.837788e-005; ng(n+1)=4.818713e+002;
n=28; farx(n+1)=1.453641e+001; foe(n+1)=7.755848e+001; krok(n+1)=4.089425e-004; ng(n+1)=2.176055e+002;
n=29; farx(n+1)=1.564984e+001; foe(n+1)=7.397812e+001; krok(n+1)=1.227122e-003; ng(n+1)=2.355969e+002;
n=30; farx(n+1)=1.664620e+001; foe(n+1)=7.062340e+001; krok(n+1)=8.861138e-004; ng(n+1)=8.713240e+002;
n=31; farx(n+1)=1.895218e+001; foe(n+1)=6.707571e+001; krok(n+1)=1.917929e-003; ng(n+1)=1.492910e+003;
n=32; farx(n+1)=2.039378e+001; foe(n+1)=6.471580e+001; krok(n+1)=2.081087e-003; ng(n+1)=6.529448e+002;
n=33; farx(n+1)=2.135339e+001; foe(n+1)=6.384417e+001; krok(n+1)=6.413861e-003; ng(n+1)=1.147569e+003;
n=34; farx(n+1)=2.066470e+001; foe(n+1)=6.348497e+001; krok(n+1)=7.145002e-003; ng(n+1)=1.122779e+003;
n=35; farx(n+1)=9.854350e+000; foe(n+1)=5.125152e+001; krok(n+1)=7.847380e-001; ng(n+1)=1.648057e+003;
n=36; farx(n+1)=9.037761e+000; foe(n+1)=4.398967e+001; krok(n+1)=2.378798e-002; ng(n+1)=1.761578e+003;
n=37; farx(n+1)=8.867936e+000; foe(n+1)=4.335867e+001; krok(n+1)=1.964993e-003; ng(n+1)=2.104823e+003;
n=38; farx(n+1)=9.034030e+000; foe(n+1)=4.002257e+001; krok(n+1)=8.877087e-002; ng(n+1)=1.241232e+003;
n=39; farx(n+1)=9.012635e+000; foe(n+1)=3.130458e+001; krok(n+1)=3.505976e-001; ng(n+1)=1.173545e+003;
n=40; farx(n+1)=9.729573e+000; foe(n+1)=2.975990e+001; krok(n+1)=1.807191e-001; ng(n+1)=2.469545e+002;
n=41; farx(n+1)=1.016359e+001; foe(n+1)=2.809188e+001; krok(n+1)=3.003510e-001; ng(n+1)=7.869854e+002;
n=42; farx(n+1)=9.637486e+000; foe(n+1)=2.683831e+001; krok(n+1)=6.855549e-001; ng(n+1)=2.777936e+002;
n=43; farx(n+1)=1.003978e+001; foe(n+1)=2.620150e+001; krok(n+1)=2.176811e-001; ng(n+1)=6.441685e+002;
n=44; farx(n+1)=1.001691e+001; foe(n+1)=2.533508e+001; krok(n+1)=1.390988e+000; ng(n+1)=8.501296e+002;
n=45; farx(n+1)=9.801062e+000; foe(n+1)=2.437659e+001; krok(n+1)=1.338969e-001; ng(n+1)=6.608296e+002;
n=46; farx(n+1)=8.647277e+000; foe(n+1)=2.365929e+001; krok(n+1)=1.779286e+000; ng(n+1)=5.314757e+002;
n=47; farx(n+1)=8.634428e+000; foe(n+1)=2.335923e+001; krok(n+1)=9.205345e-001; ng(n+1)=5.402912e+002;
n=48; farx(n+1)=8.787521e+000; foe(n+1)=2.310185e+001; krok(n+1)=3.435737e-001; ng(n+1)=8.751623e+001;
n=49; farx(n+1)=8.969335e+000; foe(n+1)=2.287767e+001; krok(n+1)=9.429061e-001; ng(n+1)=1.295546e+002;
n=50; farx(n+1)=9.241165e+000; foe(n+1)=2.241768e+001; krok(n+1)=5.738785e-001; ng(n+1)=1.166788e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.228165e+000; foe(n+1)=2.240540e+001; krok(n+1)=2.580198e-006; ng(n+1)=1.940678e+002;
n=52; farx(n+1)=9.195757e+000; foe(n+1)=2.238572e+001; krok(n+1)=6.352069e-005; ng(n+1)=5.037138e+001;
n=53; farx(n+1)=9.124017e+000; foe(n+1)=2.234306e+001; krok(n+1)=1.915864e-004; ng(n+1)=4.510336e+001;
n=54; farx(n+1)=9.120124e+000; foe(n+1)=2.215757e+001; krok(n+1)=6.710424e-004; ng(n+1)=5.048121e+001;
n=55; farx(n+1)=9.039764e+000; foe(n+1)=2.203301e+001; krok(n+1)=1.772228e-003; ng(n+1)=6.063997e+001;
n=56; farx(n+1)=9.057788e+000; foe(n+1)=2.163426e+001; krok(n+1)=2.581388e-003; ng(n+1)=9.802359e+001;
n=57; farx(n+1)=8.371032e+000; foe(n+1)=2.147312e+001; krok(n+1)=8.258271e-004; ng(n+1)=1.230006e+002;
n=58; farx(n+1)=7.832339e+000; foe(n+1)=2.134037e+001; krok(n+1)=9.030079e-003; ng(n+1)=4.835939e+002;
n=59; farx(n+1)=7.391962e+000; foe(n+1)=2.125937e+001; krok(n+1)=2.223039e-002; ng(n+1)=4.109835e+002;
n=60; farx(n+1)=6.926552e+000; foe(n+1)=2.114188e+001; krok(n+1)=3.164351e-002; ng(n+1)=5.129113e+002;
n=61; farx(n+1)=7.014469e+000; foe(n+1)=2.111965e+001; krok(n+1)=9.564855e-003; ng(n+1)=5.349446e+002;
n=62; farx(n+1)=6.739672e+000; foe(n+1)=2.096611e+001; krok(n+1)=2.589257e-001; ng(n+1)=5.929604e+002;
n=63; farx(n+1)=6.951507e+000; foe(n+1)=2.055419e+001; krok(n+1)=6.404647e-001; ng(n+1)=3.834931e+002;
n=64; farx(n+1)=7.039303e+000; foe(n+1)=2.029914e+001; krok(n+1)=5.726839e-001; ng(n+1)=5.041219e+002;
n=65; farx(n+1)=7.180769e+000; foe(n+1)=2.015890e+001; krok(n+1)=1.738735e-001; ng(n+1)=2.671996e+002;
n=66; farx(n+1)=7.026567e+000; foe(n+1)=2.005731e+001; krok(n+1)=9.453922e-001; ng(n+1)=1.900564e+002;
n=67; farx(n+1)=6.927592e+000; foe(n+1)=1.998103e+001; krok(n+1)=1.991516e-001; ng(n+1)=2.811825e+002;
n=68; farx(n+1)=6.887145e+000; foe(n+1)=1.992852e+001; krok(n+1)=3.183983e-001; ng(n+1)=2.093422e+002;
n=69; farx(n+1)=6.892701e+000; foe(n+1)=1.986692e+001; krok(n+1)=4.756263e-001; ng(n+1)=5.013406e+001;
n=70; farx(n+1)=6.945857e+000; foe(n+1)=1.983451e+001; krok(n+1)=3.381117e-001; ng(n+1)=4.302619e+001;
n=71; farx(n+1)=6.981524e+000; foe(n+1)=1.982113e+001; krok(n+1)=6.428475e-001; ng(n+1)=4.480783e+001;
n=72; farx(n+1)=6.973224e+000; foe(n+1)=1.981669e+001; krok(n+1)=7.655551e-001; ng(n+1)=3.470580e+001;
n=73; farx(n+1)=6.974184e+000; foe(n+1)=1.981587e+001; krok(n+1)=4.787134e-001; ng(n+1)=5.001370e+001;
n=74; farx(n+1)=6.972129e+000; foe(n+1)=1.981553e+001; krok(n+1)=2.093785e-001; ng(n+1)=3.049900e+001;
n=75; farx(n+1)=6.956914e+000; foe(n+1)=1.981459e+001; krok(n+1)=2.314697e+000; ng(n+1)=2.135617e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=6.956439e+000; foe(n+1)=1.981452e+001; krok(n+1)=1.913452e-006; ng(n+1)=1.596492e+001;
n=77; farx(n+1)=6.957635e+000; foe(n+1)=1.981442e+001; krok(n+1)=3.625441e-005; ng(n+1)=4.041750e+000;
n=78; farx(n+1)=6.959397e+000; foe(n+1)=1.981438e+001; krok(n+1)=2.394830e-005; ng(n+1)=3.451394e+000;
n=79; farx(n+1)=6.963065e+000; foe(n+1)=1.981435e+001; krok(n+1)=8.669030e-005; ng(n+1)=1.622409e+000;
n=80; farx(n+1)=6.965777e+000; foe(n+1)=1.981428e+001; krok(n+1)=1.401071e-004; ng(n+1)=1.843602e+000;
n=81; farx(n+1)=6.966584e+000; foe(n+1)=1.981412e+001; krok(n+1)=2.133311e-003; ng(n+1)=7.856518e-001;
n=82; farx(n+1)=6.964458e+000; foe(n+1)=1.981401e+001; krok(n+1)=3.758726e-003; ng(n+1)=5.372036e-001;
n=83; farx(n+1)=6.966430e+000; foe(n+1)=1.981360e+001; krok(n+1)=5.060913e-003; ng(n+1)=8.736052e-001;
n=84; farx(n+1)=6.967442e+000; foe(n+1)=1.981358e+001; krok(n+1)=3.172883e-002; ng(n+1)=2.698744e-001;
n=85; farx(n+1)=6.962381e+000; foe(n+1)=1.981347e+001; krok(n+1)=6.813219e-002; ng(n+1)=2.892510e-001;
n=86; farx(n+1)=6.963318e+000; foe(n+1)=1.981346e+001; krok(n+1)=3.747106e-002; ng(n+1)=1.030629e+000;
n=87; farx(n+1)=6.960852e+000; foe(n+1)=1.981344e+001; krok(n+1)=5.738785e-001; ng(n+1)=8.675569e-001;
n=88; farx(n+1)=6.963071e+000; foe(n+1)=1.981337e+001; krok(n+1)=4.897206e+000; ng(n+1)=7.685302e-001;
n=89; farx(n+1)=6.965027e+000; foe(n+1)=1.981335e+001; krok(n+1)=1.382584e+000; ng(n+1)=5.081401e+000;
n=90; farx(n+1)=6.964938e+000; foe(n+1)=1.981335e+001; krok(n+1)=9.001093e-001; ng(n+1)=5.913746e-001;
n=91; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=9.876806e-001; ng(n+1)=3.394881e-002;
n=92; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=1.069939e-005; ng(n+1)=2.731424e-003;
n=93; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=1.420880e-005; ng(n+1)=2.731395e-003;
n=94; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=5.690301e-006; ng(n+1)=2.731356e-003;
n=95; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=3.446618e-006; ng(n+1)=2.731340e-003;
n=96; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=1.503673e-008; ng(n+1)=2.731331e-003;
n=97; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=6.760512e-009; ng(n+1)=2.731331e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=98; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=4.203513e-006; ng(n+1)=2.731331e-003;
n=99; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=9.548438e-006; ng(n+1)=3.350639e-003;
n=100; farx(n+1)=6.964943e+000; foe(n+1)=1.981335e+001; krok(n+1)=2.431710e-005; ng(n+1)=1.395053e-003;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
