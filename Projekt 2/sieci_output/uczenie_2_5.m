%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.751194e+003; foe(n+1)=4.873199e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.799907e+003; foe(n+1)=3.898357e+003; krok(n+1)=3.276764e-004; ng(n+1)=2.437606e+003;
n=2; farx(n+1)=7.684581e+002; foe(n+1)=8.326640e+002; krok(n+1)=6.669234e-003; ng(n+1)=8.139485e+002;
n=3; farx(n+1)=7.696140e+002; foe(n+1)=7.129476e+002; krok(n+1)=3.467612e-004; ng(n+1)=1.826556e+003;
n=4; farx(n+1)=6.508817e+002; foe(n+1)=5.665070e+002; krok(n+1)=1.024167e-003; ng(n+1)=1.738421e+003;
n=5; farx(n+1)=4.594779e+002; foe(n+1)=4.770401e+002; krok(n+1)=7.251821e-003; ng(n+1)=5.935026e+002;
n=6; farx(n+1)=4.289413e+002; foe(n+1)=4.597071e+002; krok(n+1)=5.269205e-003; ng(n+1)=6.428897e+002;
n=7; farx(n+1)=4.126998e+002; foe(n+1)=4.558439e+002; krok(n+1)=6.583213e-003; ng(n+1)=5.699771e+002;
n=8; farx(n+1)=3.693842e+002; foe(n+1)=4.247638e+002; krok(n+1)=6.665163e-003; ng(n+1)=5.449655e+002;
n=9; farx(n+1)=2.545710e+002; foe(n+1)=3.892492e+002; krok(n+1)=6.694845e-002; ng(n+1)=5.514843e+002;
n=10; farx(n+1)=2.525001e+002; foe(n+1)=3.869516e+002; krok(n+1)=7.613202e-003; ng(n+1)=9.805134e+002;
n=11; farx(n+1)=1.738363e+002; foe(n+1)=3.349846e+002; krok(n+1)=5.259858e-002; ng(n+1)=9.415862e+002;
n=12; farx(n+1)=1.653270e+002; foe(n+1)=3.318768e+002; krok(n+1)=8.704305e-003; ng(n+1)=1.243436e+003;
n=13; farx(n+1)=1.141540e+002; foe(n+1)=2.772150e+002; krok(n+1)=7.302728e-002; ng(n+1)=1.318460e+003;
n=14; farx(n+1)=8.817308e+001; foe(n+1)=2.405505e+002; krok(n+1)=2.331822e-002; ng(n+1)=4.212630e+003;
n=15; farx(n+1)=5.364912e+001; foe(n+1)=1.412592e+002; krok(n+1)=1.702433e-001; ng(n+1)=8.004722e+003;
n=16; farx(n+1)=4.818484e+001; foe(n+1)=1.200227e+002; krok(n+1)=1.399123e-001; ng(n+1)=1.641657e+003;
n=17; farx(n+1)=4.212123e+001; foe(n+1)=1.060293e+002; krok(n+1)=5.327344e-001; ng(n+1)=1.471332e+003;
n=18; farx(n+1)=3.952786e+001; foe(n+1)=1.001614e+002; krok(n+1)=2.522670e-001; ng(n+1)=1.240388e+003;
n=19; farx(n+1)=3.832371e+001; foe(n+1)=8.903358e+001; krok(n+1)=7.771907e-001; ng(n+1)=9.999974e+002;
n=20; farx(n+1)=4.355565e+001; foe(n+1)=8.078012e+001; krok(n+1)=2.093785e-001; ng(n+1)=3.363639e+003;
n=21; farx(n+1)=2.796203e+001; foe(n+1)=5.961097e+001; krok(n+1)=1.902505e+000; ng(n+1)=1.922903e+003;
n=22; farx(n+1)=1.984438e+001; foe(n+1)=5.238485e+001; krok(n+1)=8.224396e-001; ng(n+1)=8.539657e+002;
n=23; farx(n+1)=1.668654e+001; foe(n+1)=4.664846e+001; krok(n+1)=1.402391e+000; ng(n+1)=7.858474e+002;
n=24; farx(n+1)=1.294858e+001; foe(n+1)=4.240342e+001; krok(n+1)=1.280929e+000; ng(n+1)=4.107270e+002;
n=25; farx(n+1)=1.206990e+001; foe(n+1)=4.183497e+001; krok(n+1)=1.350958e-001; ng(n+1)=2.385891e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.187301e+001; foe(n+1)=4.156597e+001; krok(n+1)=9.579321e-005; ng(n+1)=1.290408e+002;
n=27; farx(n+1)=1.188420e+001; foe(n+1)=4.150192e+001; krok(n+1)=1.331597e-005; ng(n+1)=1.994053e+002;
n=28; farx(n+1)=1.202861e+001; foe(n+1)=3.890872e+001; krok(n+1)=3.442371e-003; ng(n+1)=6.988724e+001;
n=29; farx(n+1)=1.229122e+001; foe(n+1)=3.844528e+001; krok(n+1)=1.201924e-004; ng(n+1)=3.656441e+002;
n=30; farx(n+1)=1.143562e+001; foe(n+1)=3.731153e+001; krok(n+1)=9.349870e-004; ng(n+1)=5.377065e+002;
n=31; farx(n+1)=1.131865e+001; foe(n+1)=3.694964e+001; krok(n+1)=2.419456e-003; ng(n+1)=7.438596e+002;
n=32; farx(n+1)=1.130282e+001; foe(n+1)=3.666817e+001; krok(n+1)=2.607206e-003; ng(n+1)=3.824104e+002;
n=33; farx(n+1)=1.189460e+001; foe(n+1)=3.611557e+001; krok(n+1)=1.647425e-002; ng(n+1)=4.293347e+002;
n=34; farx(n+1)=1.181049e+001; foe(n+1)=3.527374e+001; krok(n+1)=1.778431e-001; ng(n+1)=1.971891e+002;
n=35; farx(n+1)=9.268467e+000; foe(n+1)=3.366983e+001; krok(n+1)=1.937164e-001; ng(n+1)=3.136136e+002;
n=36; farx(n+1)=9.494669e+000; foe(n+1)=3.248230e+001; krok(n+1)=2.429329e-001; ng(n+1)=5.714416e+002;
n=37; farx(n+1)=9.406027e+000; foe(n+1)=3.066219e+001; krok(n+1)=1.625559e+000; ng(n+1)=1.180916e+002;
n=38; farx(n+1)=8.468830e+000; foe(n+1)=3.002839e+001; krok(n+1)=7.310195e-001; ng(n+1)=1.752939e+002;
n=39; farx(n+1)=7.469183e+000; foe(n+1)=2.949644e+001; krok(n+1)=6.449478e-001; ng(n+1)=2.769816e+002;
n=40; farx(n+1)=6.623419e+000; foe(n+1)=2.910902e+001; krok(n+1)=1.386016e+000; ng(n+1)=1.837915e+002;
n=41; farx(n+1)=6.399627e+000; foe(n+1)=2.872513e+001; krok(n+1)=1.216368e+000; ng(n+1)=1.223855e+002;
n=42; farx(n+1)=6.269420e+000; foe(n+1)=2.861210e+001; krok(n+1)=2.343012e-001; ng(n+1)=7.437244e+001;
n=43; farx(n+1)=5.918571e+000; foe(n+1)=2.838485e+001; krok(n+1)=6.577988e-001; ng(n+1)=2.145090e+002;
n=44; farx(n+1)=5.987882e+000; foe(n+1)=2.823715e+001; krok(n+1)=4.353621e-001; ng(n+1)=1.689940e+002;
n=45; farx(n+1)=5.850281e+000; foe(n+1)=2.808560e+001; krok(n+1)=9.145402e-001; ng(n+1)=2.809319e+002;
n=46; farx(n+1)=5.275094e+000; foe(n+1)=2.780127e+001; krok(n+1)=1.024434e+000; ng(n+1)=3.318316e+001;
n=47; farx(n+1)=5.141803e+000; foe(n+1)=2.763887e+001; krok(n+1)=9.110982e-001; ng(n+1)=1.535152e+002;
n=48; farx(n+1)=5.167460e+000; foe(n+1)=2.755945e+001; krok(n+1)=3.839848e-001; ng(n+1)=3.051108e+002;
n=49; farx(n+1)=5.001153e+000; foe(n+1)=2.739872e+001; krok(n+1)=5.242150e-001; ng(n+1)=2.555592e+002;
n=50; farx(n+1)=4.746144e+000; foe(n+1)=2.733480e+001; krok(n+1)=4.602673e-001; ng(n+1)=6.454107e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.747349e+000; foe(n+1)=2.732860e+001; krok(n+1)=2.077776e-006; ng(n+1)=1.478542e+002;
n=52; farx(n+1)=4.734162e+000; foe(n+1)=2.731919e+001; krok(n+1)=1.924408e-005; ng(n+1)=5.233725e+001;
n=53; farx(n+1)=4.730626e+000; foe(n+1)=2.731850e+001; krok(n+1)=8.233132e-005; ng(n+1)=8.296690e+000;
n=54; farx(n+1)=4.802603e+000; foe(n+1)=2.728934e+001; krok(n+1)=1.775201e-003; ng(n+1)=1.124348e+001;
n=55; farx(n+1)=4.751436e+000; foe(n+1)=2.724593e+001; krok(n+1)=5.322828e-004; ng(n+1)=3.261860e+001;
n=56; farx(n+1)=4.681198e+000; foe(n+1)=2.714642e+001; krok(n+1)=3.141811e-003; ng(n+1)=8.574984e+001;
n=57; farx(n+1)=4.651764e+000; foe(n+1)=2.713851e+001; krok(n+1)=2.243330e-002; ng(n+1)=2.574920e+002;
n=58; farx(n+1)=4.677554e+000; foe(n+1)=2.713301e+001; krok(n+1)=5.893163e-002; ng(n+1)=2.875829e+002;
n=59; farx(n+1)=4.515701e+000; foe(n+1)=2.708023e+001; krok(n+1)=2.320583e-001; ng(n+1)=2.294294e+002;
n=60; farx(n+1)=4.507187e+000; foe(n+1)=2.706808e+001; krok(n+1)=3.497807e-002; ng(n+1)=4.120146e+001;
n=61; farx(n+1)=4.290349e+000; foe(n+1)=2.701115e+001; krok(n+1)=4.452012e-001; ng(n+1)=1.259113e+002;
n=62; farx(n+1)=4.073915e+000; foe(n+1)=2.687814e+001; krok(n+1)=1.814761e+000; ng(n+1)=2.021643e+002;
n=63; farx(n+1)=3.870007e+000; foe(n+1)=2.675965e+001; krok(n+1)=1.120145e+000; ng(n+1)=2.906434e+002;
n=64; farx(n+1)=3.556017e+000; foe(n+1)=2.659780e+001; krok(n+1)=2.295125e-001; ng(n+1)=1.434932e+002;
n=65; farx(n+1)=3.385674e+000; foe(n+1)=2.652246e+001; krok(n+1)=3.311156e-001; ng(n+1)=4.712220e+002;
n=66; farx(n+1)=3.312682e+000; foe(n+1)=2.636173e+001; krok(n+1)=7.486426e-001; ng(n+1)=3.258347e+002;
n=67; farx(n+1)=2.882959e+000; foe(n+1)=2.613416e+001; krok(n+1)=2.845490e+000; ng(n+1)=2.626090e+002;
n=68; farx(n+1)=2.768746e+000; foe(n+1)=2.590009e+001; krok(n+1)=1.902702e-001; ng(n+1)=1.104399e+003;
n=69; farx(n+1)=2.828740e+000; foe(n+1)=2.567691e+001; krok(n+1)=2.301336e-001; ng(n+1)=1.207035e+003;
n=70; farx(n+1)=2.810712e+000; foe(n+1)=2.547407e+001; krok(n+1)=4.819709e-001; ng(n+1)=9.857149e+002;
n=71; farx(n+1)=2.667021e+000; foe(n+1)=2.539238e+001; krok(n+1)=8.707243e-001; ng(n+1)=1.921391e+002;
n=72; farx(n+1)=2.684793e+000; foe(n+1)=2.534791e+001; krok(n+1)=1.494130e+000; ng(n+1)=1.535474e+002;
n=73; farx(n+1)=2.478025e+000; foe(n+1)=2.510298e+001; krok(n+1)=2.184510e+000; ng(n+1)=8.103350e+001;
n=74; farx(n+1)=2.342609e+000; foe(n+1)=2.498483e+001; krok(n+1)=6.639102e-001; ng(n+1)=1.466049e+002;
n=75; farx(n+1)=2.405655e+000; foe(n+1)=2.492941e+001; krok(n+1)=7.536472e-001; ng(n+1)=1.216435e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.409976e+000; foe(n+1)=2.492404e+001; krok(n+1)=5.530601e-006; ng(n+1)=7.657744e+001;
n=77; farx(n+1)=2.410910e+000; foe(n+1)=2.492273e+001; krok(n+1)=6.432245e-007; ng(n+1)=1.152527e+002;
n=78; farx(n+1)=2.411649e+000; foe(n+1)=2.492252e+001; krok(n+1)=1.018462e-005; ng(n+1)=1.127706e+001;
n=79; farx(n+1)=2.395801e+000; foe(n+1)=2.491748e+001; krok(n+1)=1.284763e-003; ng(n+1)=5.754551e+000;
n=80; farx(n+1)=2.398518e+000; foe(n+1)=2.491669e+001; krok(n+1)=1.519651e-004; ng(n+1)=5.079326e+000;
n=81; farx(n+1)=2.391286e+000; foe(n+1)=2.491142e+001; krok(n+1)=1.619829e-002; ng(n+1)=2.905701e+000;
n=82; farx(n+1)=2.450601e+000; foe(n+1)=2.490194e+001; krok(n+1)=1.388291e-002; ng(n+1)=4.734801e+000;
n=83; farx(n+1)=2.487751e+000; foe(n+1)=2.489632e+001; krok(n+1)=1.296098e-002; ng(n+1)=2.788078e+001;
n=84; farx(n+1)=2.483033e+000; foe(n+1)=2.489455e+001; krok(n+1)=2.598758e-002; ng(n+1)=6.441716e+001;
n=85; farx(n+1)=2.500286e+000; foe(n+1)=2.488997e+001; krok(n+1)=1.261335e-001; ng(n+1)=8.986292e+001;
n=86; farx(n+1)=2.518719e+000; foe(n+1)=2.487361e+001; krok(n+1)=9.606268e-001; ng(n+1)=9.916914e+001;
n=87; farx(n+1)=2.591584e+000; foe(n+1)=2.485511e+001; krok(n+1)=1.896768e+000; ng(n+1)=1.321940e+002;
n=88; farx(n+1)=2.571255e+000; foe(n+1)=2.484403e+001; krok(n+1)=1.236406e+000; ng(n+1)=3.849129e+001;
n=89; farx(n+1)=2.599040e+000; foe(n+1)=2.483487e+001; krok(n+1)=7.734497e-001; ng(n+1)=1.113136e+002;
n=90; farx(n+1)=2.702026e+000; foe(n+1)=2.481172e+001; krok(n+1)=2.886327e+000; ng(n+1)=6.695710e+001;
n=91; farx(n+1)=2.793808e+000; foe(n+1)=2.477135e+001; krok(n+1)=4.951781e-001; ng(n+1)=5.118041e+001;
n=92; farx(n+1)=2.816998e+000; foe(n+1)=2.472531e+001; krok(n+1)=4.044487e-001; ng(n+1)=9.400643e+001;
n=93; farx(n+1)=2.746071e+000; foe(n+1)=2.462243e+001; krok(n+1)=1.651241e+000; ng(n+1)=1.712398e+002;
n=94; farx(n+1)=2.714389e+000; foe(n+1)=2.459166e+001; krok(n+1)=6.744582e-001; ng(n+1)=1.682312e+002;
n=95; farx(n+1)=2.711402e+000; foe(n+1)=2.454680e+001; krok(n+1)=1.531110e+000; ng(n+1)=2.365087e+002;
n=96; farx(n+1)=2.667063e+000; foe(n+1)=2.450167e+001; krok(n+1)=1.196555e+000; ng(n+1)=2.039445e+002;
n=97; farx(n+1)=2.613674e+000; foe(n+1)=2.446387e+001; krok(n+1)=1.814761e+000; ng(n+1)=5.638072e+001;
n=98; farx(n+1)=2.551601e+000; foe(n+1)=2.444290e+001; krok(n+1)=2.723893e+000; ng(n+1)=4.104227e+001;
n=99; farx(n+1)=2.515017e+000; foe(n+1)=2.443483e+001; krok(n+1)=8.649503e-001; ng(n+1)=2.264323e+001;
n=100; farx(n+1)=2.443959e+000; foe(n+1)=2.441009e+001; krok(n+1)=1.374295e+000; ng(n+1)=9.009289e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
