%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.214473e+003; foe(n+1)=4.523437e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.650136e+003; foe(n+1)=2.777231e+003; krok(n+1)=4.740993e-004; ng(n+1)=5.453219e+003;
n=2; farx(n+1)=9.987891e+002; foe(n+1)=1.126151e+003; krok(n+1)=1.532691e-003; ng(n+1)=3.629178e+003;
n=3; farx(n+1)=1.182075e+003; foe(n+1)=6.699196e+002; krok(n+1)=1.505759e-004; ng(n+1)=1.108377e+004;
n=4; farx(n+1)=1.605178e+003; foe(n+1)=5.659123e+002; krok(n+1)=4.325549e-004; ng(n+1)=8.260298e+003;
n=5; farx(n+1)=1.218940e+003; foe(n+1)=4.979692e+002; krok(n+1)=6.607631e-003; ng(n+1)=9.944252e+002;
n=6; farx(n+1)=1.121461e+003; foe(n+1)=4.830209e+002; krok(n+1)=4.395065e-004; ng(n+1)=2.541142e+003;
n=7; farx(n+1)=9.576501e+002; foe(n+1)=4.691506e+002; krok(n+1)=6.019342e-004; ng(n+1)=2.611725e+003;
n=8; farx(n+1)=3.887033e+002; foe(n+1)=3.663589e+002; krok(n+1)=2.983603e-003; ng(n+1)=6.134544e+003;
n=9; farx(n+1)=2.869045e+002; foe(n+1)=3.410944e+002; krok(n+1)=1.915864e-004; ng(n+1)=5.252698e+003;
n=10; farx(n+1)=2.345068e+002; foe(n+1)=3.286636e+002; krok(n+1)=8.921492e-004; ng(n+1)=4.612222e+003;
n=11; farx(n+1)=1.434007e+002; foe(n+1)=2.855060e+002; krok(n+1)=1.906683e-002; ng(n+1)=3.354917e+003;
n=12; farx(n+1)=1.418501e+002; foe(n+1)=2.843846e+002; krok(n+1)=5.561724e-005; ng(n+1)=1.059889e+003;
n=13; farx(n+1)=1.280775e+002; foe(n+1)=2.805221e+002; krok(n+1)=3.018569e-004; ng(n+1)=1.214333e+003;
n=14; farx(n+1)=1.129768e+002; foe(n+1)=2.504547e+002; krok(n+1)=2.742688e-003; ng(n+1)=1.633333e+003;
n=15; farx(n+1)=1.036475e+002; foe(n+1)=2.297096e+002; krok(n+1)=2.069346e-003; ng(n+1)=1.888608e+003;
n=16; farx(n+1)=1.053186e+002; foe(n+1)=2.267802e+002; krok(n+1)=5.873414e-004; ng(n+1)=1.222989e+003;
n=17; farx(n+1)=1.006606e+002; foe(n+1)=2.157102e+002; krok(n+1)=1.127002e-002; ng(n+1)=1.444705e+003;
n=18; farx(n+1)=1.048334e+002; foe(n+1)=2.054121e+002; krok(n+1)=2.282102e-003; ng(n+1)=2.104053e+003;
n=19; farx(n+1)=6.354939e+001; foe(n+1)=1.866639e+002; krok(n+1)=5.557598e-003; ng(n+1)=1.316437e+003;
n=20; farx(n+1)=6.502787e+001; foe(n+1)=1.742710e+002; krok(n+1)=3.677109e-003; ng(n+1)=2.148521e+003;
n=21; farx(n+1)=8.950942e+001; foe(n+1)=1.624816e+002; krok(n+1)=8.259539e-004; ng(n+1)=2.610616e+003;
n=22; farx(n+1)=8.679537e+001; foe(n+1)=1.506921e+002; krok(n+1)=3.419137e-003; ng(n+1)=1.024137e+003;
n=23; farx(n+1)=8.451979e+001; foe(n+1)=1.470604e+002; krok(n+1)=1.813010e-004; ng(n+1)=2.219018e+003;
n=24; farx(n+1)=6.712610e+001; foe(n+1)=1.196930e+002; krok(n+1)=1.950271e-003; ng(n+1)=3.653357e+003;
n=25; farx(n+1)=6.615245e+001; foe(n+1)=1.191404e+002; krok(n+1)=1.300621e-004; ng(n+1)=1.532102e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.901150e+001; foe(n+1)=1.143630e+002; krok(n+1)=4.381503e-005; ng(n+1)=1.539224e+003;
n=27; farx(n+1)=4.704904e+001; foe(n+1)=1.070225e+002; krok(n+1)=2.617217e-005; ng(n+1)=2.708195e+003;
n=28; farx(n+1)=3.639970e+001; foe(n+1)=8.741034e+001; krok(n+1)=2.714211e-004; ng(n+1)=1.307361e+003;
n=29; farx(n+1)=3.558309e+001; foe(n+1)=8.340491e+001; krok(n+1)=8.459568e-005; ng(n+1)=1.358826e+003;
n=30; farx(n+1)=3.724176e+001; foe(n+1)=6.928045e+001; krok(n+1)=3.395966e-004; ng(n+1)=4.695918e+003;
n=31; farx(n+1)=2.743033e+001; foe(n+1)=4.852863e+001; krok(n+1)=9.497806e-004; ng(n+1)=5.131990e+003;
n=32; farx(n+1)=2.598081e+001; foe(n+1)=3.866931e+001; krok(n+1)=7.286945e-004; ng(n+1)=4.955124e+003;
n=33; farx(n+1)=2.503467e+001; foe(n+1)=3.591044e+001; krok(n+1)=3.831728e-004; ng(n+1)=1.107255e+003;
n=34; farx(n+1)=2.444822e+001; foe(n+1)=3.116033e+001; krok(n+1)=6.328553e-004; ng(n+1)=4.084601e+003;
n=35; farx(n+1)=2.168067e+001; foe(n+1)=2.912397e+001; krok(n+1)=2.105249e-003; ng(n+1)=1.107298e+003;
n=36; farx(n+1)=1.639230e+001; foe(n+1)=2.641624e+001; krok(n+1)=1.713514e-003; ng(n+1)=1.187533e+003;
n=37; farx(n+1)=1.376115e+001; foe(n+1)=2.454724e+001; krok(n+1)=2.815703e-003; ng(n+1)=6.624364e+002;
n=38; farx(n+1)=1.186165e+001; foe(n+1)=2.246557e+001; krok(n+1)=2.926191e-003; ng(n+1)=1.336467e+003;
n=39; farx(n+1)=1.075924e+001; foe(n+1)=2.146656e+001; krok(n+1)=1.828656e-003; ng(n+1)=6.506817e+002;
n=40; farx(n+1)=7.945434e+000; foe(n+1)=1.818599e+001; krok(n+1)=5.294040e-003; ng(n+1)=2.432282e+003;
n=41; farx(n+1)=6.660995e+000; foe(n+1)=1.648200e+001; krok(n+1)=5.038654e-003; ng(n+1)=9.600648e+002;
n=42; farx(n+1)=6.261291e+000; foe(n+1)=1.528143e+001; krok(n+1)=6.607631e-003; ng(n+1)=4.785313e+002;
n=43; farx(n+1)=5.800732e+000; foe(n+1)=1.456456e+001; krok(n+1)=6.450159e-003; ng(n+1)=8.557928e+002;
n=44; farx(n+1)=5.298696e+000; foe(n+1)=1.277994e+001; krok(n+1)=3.928808e-003; ng(n+1)=1.404745e+003;
n=45; farx(n+1)=4.982519e+000; foe(n+1)=1.130017e+001; krok(n+1)=1.199493e-002; ng(n+1)=5.948396e+002;
n=46; farx(n+1)=5.083090e+000; foe(n+1)=1.074282e+001; krok(n+1)=8.031637e-004; ng(n+1)=1.798765e+003;
n=47; farx(n+1)=4.975962e+000; foe(n+1)=1.020997e+001; krok(n+1)=2.973498e-003; ng(n+1)=1.014484e+003;
n=48; farx(n+1)=4.741914e+000; foe(n+1)=9.529145e+000; krok(n+1)=5.433546e-003; ng(n+1)=4.730150e+002;
n=49; farx(n+1)=4.573451e+000; foe(n+1)=9.346848e+000; krok(n+1)=1.463096e-003; ng(n+1)=5.132699e+002;
n=50; farx(n+1)=4.308647e+000; foe(n+1)=8.589718e+000; krok(n+1)=7.613202e-003; ng(n+1)=7.302084e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.299478e+000; foe(n+1)=8.444381e+000; krok(n+1)=3.779992e-006; ng(n+1)=9.248023e+002;
n=52; farx(n+1)=4.266104e+000; foe(n+1)=8.399709e+000; krok(n+1)=2.092658e-005; ng(n+1)=2.473166e+002;
n=53; farx(n+1)=4.252346e+000; foe(n+1)=8.317985e+000; krok(n+1)=8.763006e-005; ng(n+1)=1.651896e+002;
n=54; farx(n+1)=4.320843e+000; foe(n+1)=7.988457e+000; krok(n+1)=4.957630e-004; ng(n+1)=1.506060e+002;
n=55; farx(n+1)=4.216640e+000; foe(n+1)=7.341334e+000; krok(n+1)=8.229017e-004; ng(n+1)=1.728213e+002;
n=56; farx(n+1)=4.052099e+000; foe(n+1)=7.000349e+000; krok(n+1)=2.604174e-003; ng(n+1)=2.659360e+002;
n=57; farx(n+1)=4.042592e+000; foe(n+1)=6.821378e+000; krok(n+1)=1.704775e-003; ng(n+1)=1.133432e+002;
n=58; farx(n+1)=3.858146e+000; foe(n+1)=6.530697e+000; krok(n+1)=1.797919e-003; ng(n+1)=2.322363e+002;
n=59; farx(n+1)=3.464135e+000; foe(n+1)=5.991388e+000; krok(n+1)=5.320104e-003; ng(n+1)=6.690281e+002;
n=60; farx(n+1)=3.238421e+000; foe(n+1)=5.513172e+000; krok(n+1)=7.626318e-003; ng(n+1)=5.816179e+002;
n=61; farx(n+1)=3.174406e+000; foe(n+1)=5.317440e+000; krok(n+1)=3.801047e-003; ng(n+1)=7.710475e+002;
n=62; farx(n+1)=3.163976e+000; foe(n+1)=5.245440e+000; krok(n+1)=5.027940e-003; ng(n+1)=3.375083e+002;
n=63; farx(n+1)=3.111517e+000; foe(n+1)=5.020297e+000; krok(n+1)=1.308935e-002; ng(n+1)=3.062903e+002;
n=64; farx(n+1)=3.025309e+000; foe(n+1)=4.876716e+000; krok(n+1)=1.262969e-002; ng(n+1)=4.635966e+002;
n=65; farx(n+1)=2.918311e+000; foe(n+1)=4.694549e+000; krok(n+1)=2.643052e-002; ng(n+1)=4.043818e+002;
n=66; farx(n+1)=2.871532e+000; foe(n+1)=4.421731e+000; krok(n+1)=1.142218e-002; ng(n+1)=3.080773e+002;
n=67; farx(n+1)=2.804229e+000; foe(n+1)=4.272735e+000; krok(n+1)=1.561084e-002; ng(n+1)=3.597118e+002;
n=68; farx(n+1)=2.694999e+000; foe(n+1)=4.138558e+000; krok(n+1)=1.139839e-002; ng(n+1)=3.231475e+002;
n=69; farx(n+1)=2.467363e+000; foe(n+1)=3.871140e+000; krok(n+1)=4.614317e-002; ng(n+1)=7.894856e+001;
n=70; farx(n+1)=2.345791e+000; foe(n+1)=3.743938e+000; krok(n+1)=1.095618e-002; ng(n+1)=4.451262e+002;
n=71; farx(n+1)=2.202231e+000; foe(n+1)=3.559543e+000; krok(n+1)=2.316852e-002; ng(n+1)=2.144357e+002;
n=72; farx(n+1)=2.179583e+000; foe(n+1)=3.459155e+000; krok(n+1)=1.355378e-002; ng(n+1)=3.118801e+002;
n=73; farx(n+1)=2.167072e+000; foe(n+1)=3.341688e+000; krok(n+1)=1.688698e-002; ng(n+1)=2.535474e+002;
n=74; farx(n+1)=1.958149e+000; foe(n+1)=3.087105e+000; krok(n+1)=3.620221e-002; ng(n+1)=1.715255e+002;
n=75; farx(n+1)=1.898921e+000; foe(n+1)=2.991250e+000; krok(n+1)=2.991958e-002; ng(n+1)=3.059928e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.901550e+000; foe(n+1)=2.986523e+000; krok(n+1)=1.621284e-005; ng(n+1)=9.010394e+001;
n=77; farx(n+1)=1.901127e+000; foe(n+1)=2.984936e+000; krok(n+1)=1.197415e-005; ng(n+1)=5.643774e+001;
n=78; farx(n+1)=1.897622e+000; foe(n+1)=2.975886e+000; krok(n+1)=6.309391e-005; ng(n+1)=5.818387e+001;
n=79; farx(n+1)=1.887373e+000; foe(n+1)=2.952441e+000; krok(n+1)=4.723973e-004; ng(n+1)=3.893604e+001;
n=80; farx(n+1)=1.866397e+000; foe(n+1)=2.919445e+000; krok(n+1)=2.269576e-003; ng(n+1)=2.150657e+001;
n=81; farx(n+1)=1.852910e+000; foe(n+1)=2.884804e+000; krok(n+1)=3.163070e-004; ng(n+1)=6.742114e+001;
n=82; farx(n+1)=1.836944e+000; foe(n+1)=2.825083e+000; krok(n+1)=2.407737e-003; ng(n+1)=7.043852e+001;
n=83; farx(n+1)=1.828122e+000; foe(n+1)=2.754212e+000; krok(n+1)=8.442897e-003; ng(n+1)=1.088115e+002;
n=84; farx(n+1)=1.789156e+000; foe(n+1)=2.727545e+000; krok(n+1)=8.085176e-003; ng(n+1)=2.778424e+002;
n=85; farx(n+1)=1.755829e+000; foe(n+1)=2.691701e+000; krok(n+1)=4.174641e-003; ng(n+1)=3.216778e+002;
n=86; farx(n+1)=1.702265e+000; foe(n+1)=2.557752e+000; krok(n+1)=9.576149e-003; ng(n+1)=2.418006e+002;
n=87; farx(n+1)=1.699790e+000; foe(n+1)=2.487671e+000; krok(n+1)=1.846372e-002; ng(n+1)=1.449600e+002;
n=88; farx(n+1)=1.696312e+000; foe(n+1)=2.473668e+000; krok(n+1)=2.716773e-003; ng(n+1)=1.195601e+002;
n=89; farx(n+1)=1.684061e+000; foe(n+1)=2.447447e+000; krok(n+1)=1.226153e-002; ng(n+1)=1.438413e+002;
n=90; farx(n+1)=1.645299e+000; foe(n+1)=2.383628e+000; krok(n+1)=6.403944e-002; ng(n+1)=5.840972e+001;
n=91; farx(n+1)=1.628456e+000; foe(n+1)=2.327377e+000; krok(n+1)=1.438335e-002; ng(n+1)=1.204481e+002;
n=92; farx(n+1)=1.606239e+000; foe(n+1)=2.245845e+000; krok(n+1)=3.050997e-002; ng(n+1)=1.238046e+002;
n=93; farx(n+1)=1.527766e+000; foe(n+1)=2.069290e+000; krok(n+1)=3.550149e-002; ng(n+1)=2.701948e+002;
n=94; farx(n+1)=1.502203e+000; foe(n+1)=2.019518e+000; krok(n+1)=7.990988e-003; ng(n+1)=2.756828e+002;
n=95; farx(n+1)=1.486340e+000; foe(n+1)=1.980551e+000; krok(n+1)=7.702766e-003; ng(n+1)=2.871480e+002;
n=96; farx(n+1)=1.470591e+000; foe(n+1)=1.934146e+000; krok(n+1)=4.331299e-002; ng(n+1)=6.797261e+001;
n=97; farx(n+1)=1.437650e+000; foe(n+1)=1.882339e+000; krok(n+1)=2.721013e-002; ng(n+1)=1.193217e+002;
n=98; farx(n+1)=1.385827e+000; foe(n+1)=1.825380e+000; krok(n+1)=3.965402e-002; ng(n+1)=8.949684e+001;
n=99; farx(n+1)=1.377839e+000; foe(n+1)=1.808242e+000; krok(n+1)=1.763378e-002; ng(n+1)=1.454083e+002;
n=100; farx(n+1)=1.363715e+000; foe(n+1)=1.779596e+000; krok(n+1)=3.153338e-002; ng(n+1)=1.056787e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
