%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.835755e+003; foe(n+1)=4.614508e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.006965e+003; foe(n+1)=2.841269e+003; krok(n+1)=5.292541e-004; ng(n+1)=5.596720e+003;
n=2; farx(n+1)=1.221870e+003; foe(n+1)=9.485361e+002; krok(n+1)=2.261309e-003; ng(n+1)=2.739753e+003;
n=3; farx(n+1)=1.391967e+003; foe(n+1)=5.783144e+002; krok(n+1)=2.578918e-004; ng(n+1)=6.398122e+003;
n=4; farx(n+1)=1.664672e+003; foe(n+1)=5.544185e+002; krok(n+1)=7.209870e-004; ng(n+1)=2.845247e+003;
n=5; farx(n+1)=1.223068e+003; foe(n+1)=4.679745e+002; krok(n+1)=9.135629e-003; ng(n+1)=6.950113e+002;
n=6; farx(n+1)=1.183680e+003; foe(n+1)=4.649363e+002; krok(n+1)=2.151397e-004; ng(n+1)=1.855216e+003;
n=7; farx(n+1)=3.214541e+002; foe(n+1)=3.445093e+002; krok(n+1)=2.339183e-003; ng(n+1)=1.944533e+003;
n=8; farx(n+1)=2.578486e+002; foe(n+1)=3.369740e+002; krok(n+1)=5.017715e-005; ng(n+1)=3.657198e+003;
n=9; farx(n+1)=2.442594e+002; foe(n+1)=3.338879e+002; krok(n+1)=5.718892e-004; ng(n+1)=3.510138e+003;
n=10; farx(n+1)=2.464170e+002; foe(n+1)=3.256680e+002; krok(n+1)=5.654998e-003; ng(n+1)=3.886315e+003;
n=11; farx(n+1)=2.279587e+002; foe(n+1)=3.131551e+002; krok(n+1)=1.869974e-003; ng(n+1)=3.469818e+003;
n=12; farx(n+1)=2.306491e+002; foe(n+1)=3.079379e+002; krok(n+1)=2.063134e-003; ng(n+1)=2.104975e+003;
n=13; farx(n+1)=2.306053e+002; foe(n+1)=3.031247e+002; krok(n+1)=1.869974e-003; ng(n+1)=1.719010e+003;
n=14; farx(n+1)=2.280998e+002; foe(n+1)=2.964691e+002; krok(n+1)=3.576264e-003; ng(n+1)=1.896876e+003;
n=15; farx(n+1)=2.308493e+002; foe(n+1)=2.875208e+002; krok(n+1)=1.038427e-003; ng(n+1)=7.108260e+003;
n=16; farx(n+1)=2.730042e+002; foe(n+1)=2.684486e+002; krok(n+1)=7.627492e-003; ng(n+1)=2.140971e+003;
n=17; farx(n+1)=2.594405e+002; foe(n+1)=2.588723e+002; krok(n+1)=2.804195e-003; ng(n+1)=1.807089e+003;
n=18; farx(n+1)=2.332769e+002; foe(n+1)=2.438973e+002; krok(n+1)=3.816075e-003; ng(n+1)=8.405090e+002;
n=19; farx(n+1)=2.093533e+002; foe(n+1)=2.241061e+002; krok(n+1)=2.176307e-003; ng(n+1)=1.186674e+003;
n=20; farx(n+1)=1.280200e+002; foe(n+1)=1.260981e+002; krok(n+1)=2.179192e-003; ng(n+1)=1.693700e+003;
n=21; farx(n+1)=1.247016e+002; foe(n+1)=1.254901e+002; krok(n+1)=2.067984e-005; ng(n+1)=2.303004e+003;
n=22; farx(n+1)=1.108561e+002; foe(n+1)=1.225205e+002; krok(n+1)=5.080539e-004; ng(n+1)=3.019082e+003;
n=23; farx(n+1)=9.884248e+001; foe(n+1)=1.163970e+002; krok(n+1)=6.946998e-004; ng(n+1)=2.804137e+003;
n=24; farx(n+1)=7.242726e+001; foe(n+1)=1.061832e+002; krok(n+1)=5.478088e-003; ng(n+1)=1.641378e+003;
n=25; farx(n+1)=4.318940e+001; foe(n+1)=8.957379e+001; krok(n+1)=5.631405e-003; ng(n+1)=1.232885e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.367768e+001; foe(n+1)=8.229548e+001; krok(n+1)=2.803760e-006; ng(n+1)=8.687933e+003;
n=27; farx(n+1)=4.406158e+001; foe(n+1)=7.932043e+001; krok(n+1)=9.012338e-005; ng(n+1)=1.005587e+003;
n=28; farx(n+1)=3.878864e+001; foe(n+1)=7.115670e+001; krok(n+1)=2.842659e-004; ng(n+1)=1.055061e+003;
n=29; farx(n+1)=3.215738e+001; foe(n+1)=6.670807e+001; krok(n+1)=5.840350e-004; ng(n+1)=1.478704e+003;
n=30; farx(n+1)=2.662981e+001; foe(n+1)=5.670060e+001; krok(n+1)=2.129131e-003; ng(n+1)=2.808155e+003;
n=31; farx(n+1)=2.094261e+001; foe(n+1)=4.783092e+001; krok(n+1)=4.586643e-003; ng(n+1)=3.500481e+003;
n=32; farx(n+1)=1.699721e+001; foe(n+1)=3.592363e+001; krok(n+1)=1.495556e-003; ng(n+1)=1.446683e+003;
n=33; farx(n+1)=1.499694e+001; foe(n+1)=3.250204e+001; krok(n+1)=1.020148e-003; ng(n+1)=1.068672e+003;
n=34; farx(n+1)=1.383829e+001; foe(n+1)=2.563960e+001; krok(n+1)=1.779489e-003; ng(n+1)=1.718933e+003;
n=35; farx(n+1)=1.189919e+001; foe(n+1)=2.322098e+001; krok(n+1)=4.938447e-003; ng(n+1)=8.291998e+002;
n=36; farx(n+1)=1.049568e+001; foe(n+1)=2.063783e+001; krok(n+1)=3.248447e-003; ng(n+1)=1.828594e+003;
n=37; farx(n+1)=9.903354e+000; foe(n+1)=1.920192e+001; krok(n+1)=1.291963e-003; ng(n+1)=2.189748e+003;
n=38; farx(n+1)=7.872866e+000; foe(n+1)=1.139887e+001; krok(n+1)=6.853004e-003; ng(n+1)=1.823422e+003;
n=39; farx(n+1)=5.944534e+000; foe(n+1)=8.091385e+000; krok(n+1)=1.251384e-002; ng(n+1)=4.803835e+002;
n=40; farx(n+1)=5.725982e+000; foe(n+1)=7.773239e+000; krok(n+1)=1.674853e-003; ng(n+1)=8.756575e+002;
n=41; farx(n+1)=5.584757e+000; foe(n+1)=7.421463e+000; krok(n+1)=2.063028e-003; ng(n+1)=3.951661e+002;
n=42; farx(n+1)=4.095102e+000; foe(n+1)=6.519673e+000; krok(n+1)=1.450364e-002; ng(n+1)=4.009333e+002;
n=43; farx(n+1)=3.621904e+000; foe(n+1)=6.114055e+000; krok(n+1)=4.900827e-003; ng(n+1)=8.600916e+002;
n=44; farx(n+1)=3.478275e+000; foe(n+1)=5.819179e+000; krok(n+1)=1.308315e-003; ng(n+1)=1.340420e+003;
n=45; farx(n+1)=3.162982e+000; foe(n+1)=5.344088e+000; krok(n+1)=1.321526e-002; ng(n+1)=9.146991e+002;
n=46; farx(n+1)=3.004378e+000; foe(n+1)=5.093147e+000; krok(n+1)=1.619829e-002; ng(n+1)=3.392090e+002;
n=47; farx(n+1)=2.479760e+000; foe(n+1)=4.551672e+000; krok(n+1)=1.333847e-002; ng(n+1)=2.624237e+002;
n=48; farx(n+1)=2.167361e+000; foe(n+1)=4.259779e+000; krok(n+1)=1.626130e-002; ng(n+1)=2.893574e+002;
n=49; farx(n+1)=2.086376e+000; foe(n+1)=3.982219e+000; krok(n+1)=2.378798e-002; ng(n+1)=5.405922e+002;
n=50; farx(n+1)=2.026249e+000; foe(n+1)=3.727128e+000; krok(n+1)=3.126305e-002; ng(n+1)=3.777838e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.024952e+000; foe(n+1)=3.717377e+000; krok(n+1)=4.702611e-006; ng(n+1)=2.052320e+002;
n=52; farx(n+1)=1.994516e+000; foe(n+1)=3.612012e+000; krok(n+1)=1.784716e-004; ng(n+1)=1.129201e+002;
n=53; farx(n+1)=1.973554e+000; foe(n+1)=3.467868e+000; krok(n+1)=4.820713e-004; ng(n+1)=1.016608e+002;
n=54; farx(n+1)=1.958867e+000; foe(n+1)=3.418852e+000; krok(n+1)=2.030432e-005; ng(n+1)=2.354372e+002;
n=55; farx(n+1)=1.948303e+000; foe(n+1)=3.382287e+000; krok(n+1)=4.283785e-004; ng(n+1)=6.501616e+001;
n=56; farx(n+1)=1.916441e+000; foe(n+1)=3.291101e+000; krok(n+1)=5.763985e-004; ng(n+1)=8.784961e+001;
n=57; farx(n+1)=1.908967e+000; foe(n+1)=3.214644e+000; krok(n+1)=1.908037e-003; ng(n+1)=8.933663e+001;
n=58; farx(n+1)=1.916679e+000; foe(n+1)=3.093869e+000; krok(n+1)=1.500979e-002; ng(n+1)=7.446749e+001;
n=59; farx(n+1)=1.939618e+000; foe(n+1)=3.035335e+000; krok(n+1)=8.130648e-003; ng(n+1)=1.249828e+002;
n=60; farx(n+1)=1.793457e+000; foe(n+1)=2.796794e+000; krok(n+1)=2.024365e-002; ng(n+1)=3.621114e+002;
n=61; farx(n+1)=1.733316e+000; foe(n+1)=2.667267e+000; krok(n+1)=1.019133e-002; ng(n+1)=2.192642e+002;
n=62; farx(n+1)=1.677627e+000; foe(n+1)=2.569832e+000; krok(n+1)=1.809047e-002; ng(n+1)=1.848472e+002;
n=63; farx(n+1)=1.673517e+000; foe(n+1)=2.550893e+000; krok(n+1)=2.990450e-003; ng(n+1)=7.640667e+001;
n=64; farx(n+1)=1.608446e+000; foe(n+1)=2.468142e+000; krok(n+1)=1.340015e-002; ng(n+1)=2.633178e+002;
n=65; farx(n+1)=1.534553e+000; foe(n+1)=2.385137e+000; krok(n+1)=1.975828e-002; ng(n+1)=2.511023e+002;
n=66; farx(n+1)=1.488813e+000; foe(n+1)=2.295155e+000; krok(n+1)=2.079162e-002; ng(n+1)=4.472344e+002;
n=67; farx(n+1)=1.402277e+000; foe(n+1)=2.077290e+000; krok(n+1)=6.552688e-002; ng(n+1)=2.639788e+002;
n=68; farx(n+1)=1.383420e+000; foe(n+1)=2.030962e+000; krok(n+1)=6.130766e-003; ng(n+1)=3.535211e+002;
n=69; farx(n+1)=1.366856e+000; foe(n+1)=1.989733e+000; krok(n+1)=1.632237e-002; ng(n+1)=1.234963e+002;
n=70; farx(n+1)=1.327635e+000; foe(n+1)=1.922061e+000; krok(n+1)=3.264474e-002; ng(n+1)=7.126562e+001;
n=71; farx(n+1)=1.298630e+000; foe(n+1)=1.854094e+000; krok(n+1)=3.050527e-002; ng(n+1)=1.759308e+002;
n=72; farx(n+1)=1.259538e+000; foe(n+1)=1.770186e+000; krok(n+1)=4.486659e-002; ng(n+1)=1.505687e+002;
n=73; farx(n+1)=1.246594e+000; foe(n+1)=1.705954e+000; krok(n+1)=2.768235e-002; ng(n+1)=2.063411e+002;
n=74; farx(n+1)=1.240847e+000; foe(n+1)=1.599971e+000; krok(n+1)=4.732423e-002; ng(n+1)=1.264030e+002;
n=75; farx(n+1)=1.250623e+000; foe(n+1)=1.568244e+000; krok(n+1)=1.948770e-002; ng(n+1)=3.414305e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.250339e+000; foe(n+1)=1.562047e+000; krok(n+1)=2.327886e-006; ng(n+1)=2.252608e+002;
n=77; farx(n+1)=1.246690e+000; foe(n+1)=1.556930e+000; krok(n+1)=8.669030e-005; ng(n+1)=3.624525e+001;
n=78; farx(n+1)=1.245538e+000; foe(n+1)=1.555110e+000; krok(n+1)=1.430061e-005; ng(n+1)=5.525432e+001;
n=79; farx(n+1)=1.245670e+000; foe(n+1)=1.553199e+000; krok(n+1)=7.583697e-005; ng(n+1)=2.762507e+001;
n=80; farx(n+1)=1.235636e+000; foe(n+1)=1.539031e+000; krok(n+1)=1.184603e-003; ng(n+1)=1.813418e+001;
n=81; farx(n+1)=1.224098e+000; foe(n+1)=1.519154e+000; krok(n+1)=1.184603e-003; ng(n+1)=2.261333e+001;
n=82; farx(n+1)=1.219140e+000; foe(n+1)=1.504568e+000; krok(n+1)=2.586254e-003; ng(n+1)=3.019020e+001;
n=83; farx(n+1)=1.193306e+000; foe(n+1)=1.458719e+000; krok(n+1)=3.870712e-003; ng(n+1)=4.943991e+001;
n=84; farx(n+1)=1.182507e+000; foe(n+1)=1.434098e+000; krok(n+1)=4.201093e-003; ng(n+1)=1.650276e+002;
n=85; farx(n+1)=1.157800e+000; foe(n+1)=1.419827e+000; krok(n+1)=6.669234e-003; ng(n+1)=1.598326e+002;
n=86; farx(n+1)=1.139082e+000; foe(n+1)=1.402077e+000; krok(n+1)=2.521242e-002; ng(n+1)=1.798572e+002;
n=87; farx(n+1)=1.106703e+000; foe(n+1)=1.363834e+000; krok(n+1)=2.121282e-002; ng(n+1)=2.101862e+002;
n=88; farx(n+1)=1.093221e+000; foe(n+1)=1.338332e+000; krok(n+1)=2.340953e-002; ng(n+1)=1.630098e+002;
n=89; farx(n+1)=1.087043e+000; foe(n+1)=1.317032e+000; krok(n+1)=2.617870e-002; ng(n+1)=1.783022e+002;
n=90; farx(n+1)=1.076160e+000; foe(n+1)=1.275324e+000; krok(n+1)=1.736512e-002; ng(n+1)=3.380954e+002;
n=91; farx(n+1)=1.080616e+000; foe(n+1)=1.205392e+000; krok(n+1)=4.857442e-002; ng(n+1)=4.166421e+002;
n=92; farx(n+1)=1.077813e+000; foe(n+1)=1.163115e+000; krok(n+1)=8.973423e-002; ng(n+1)=2.343039e+002;
n=93; farx(n+1)=1.080330e+000; foe(n+1)=1.136165e+000; krok(n+1)=2.447549e-002; ng(n+1)=3.601223e+002;
n=94; farx(n+1)=1.096655e+000; foe(n+1)=1.103869e+000; krok(n+1)=2.339865e-002; ng(n+1)=1.515580e+002;
n=95; farx(n+1)=1.090172e+000; foe(n+1)=1.086836e+000; krok(n+1)=3.413625e-002; ng(n+1)=1.506290e+002;
n=96; farx(n+1)=1.082172e+000; foe(n+1)=1.066225e+000; krok(n+1)=1.571994e-002; ng(n+1)=1.817817e+002;
n=97; farx(n+1)=1.066958e+000; foe(n+1)=1.043732e+000; krok(n+1)=4.366353e-002; ng(n+1)=1.277402e+002;
n=98; farx(n+1)=1.052974e+000; foe(n+1)=1.012034e+000; krok(n+1)=1.028912e-001; ng(n+1)=1.165523e+002;
n=99; farx(n+1)=1.049693e+000; foe(n+1)=1.000187e+000; krok(n+1)=3.350022e-002; ng(n+1)=1.227268e+002;
n=100; farx(n+1)=1.037329e+000; foe(n+1)=9.806960e-001; krok(n+1)=5.205007e-002; ng(n+1)=2.073883e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
