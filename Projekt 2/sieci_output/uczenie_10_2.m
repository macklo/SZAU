%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.840023e+003; foe(n+1)=4.807347e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.662524e+003; foe(n+1)=3.568643e+003; krok(n+1)=3.643472e-004; ng(n+1)=6.502341e+003;
n=2; farx(n+1)=1.104509e+003; foe(n+1)=9.835989e+002; krok(n+1)=1.157298e-003; ng(n+1)=4.765558e+003;
n=3; farx(n+1)=1.258836e+003; foe(n+1)=7.969088e+002; krok(n+1)=1.993791e-004; ng(n+1)=5.360111e+003;
n=4; farx(n+1)=3.674376e+002; foe(n+1)=4.896939e+002; krok(n+1)=7.702766e-003; ng(n+1)=9.417648e+002;
n=5; farx(n+1)=2.995059e+002; foe(n+1)=4.168426e+002; krok(n+1)=5.018139e-004; ng(n+1)=4.381183e+003;
n=6; farx(n+1)=2.274655e+002; foe(n+1)=3.727463e+002; krok(n+1)=3.125285e-004; ng(n+1)=2.582843e+003;
n=7; farx(n+1)=2.280513e+002; foe(n+1)=3.607834e+002; krok(n+1)=3.559503e-003; ng(n+1)=1.259548e+003;
n=8; farx(n+1)=2.058612e+002; foe(n+1)=3.346437e+002; krok(n+1)=1.079728e-003; ng(n+1)=2.205597e+003;
n=9; farx(n+1)=1.957232e+002; foe(n+1)=3.313411e+002; krok(n+1)=5.524716e-004; ng(n+1)=1.174403e+003;
n=10; farx(n+1)=1.886214e+002; foe(n+1)=3.283514e+002; krok(n+1)=1.691914e-004; ng(n+1)=1.468838e+003;
n=11; farx(n+1)=1.517665e+002; foe(n+1)=3.014927e+002; krok(n+1)=8.072124e-003; ng(n+1)=1.148690e+003;
n=12; farx(n+1)=1.493395e+002; foe(n+1)=2.991827e+002; krok(n+1)=1.935115e-004; ng(n+1)=2.529973e+003;
n=13; farx(n+1)=1.536835e+002; foe(n+1)=2.711102e+002; krok(n+1)=2.121656e-003; ng(n+1)=2.487284e+003;
n=14; farx(n+1)=1.585339e+002; foe(n+1)=2.641056e+002; krok(n+1)=2.914486e-004; ng(n+1)=1.517791e+003;
n=15; farx(n+1)=1.300415e+002; foe(n+1)=2.516321e+002; krok(n+1)=7.088910e-003; ng(n+1)=1.950810e+003;
n=16; farx(n+1)=1.228032e+002; foe(n+1)=2.453155e+002; krok(n+1)=6.126034e-004; ng(n+1)=2.639635e+003;
n=17; farx(n+1)=6.043611e+001; foe(n+1)=2.201240e+002; krok(n+1)=4.586643e-003; ng(n+1)=1.611872e+003;
n=18; farx(n+1)=3.499959e+001; foe(n+1)=1.951946e+002; krok(n+1)=7.589753e-004; ng(n+1)=4.399161e+003;
n=19; farx(n+1)=3.080180e+001; foe(n+1)=1.909539e+002; krok(n+1)=1.377639e-004; ng(n+1)=6.767024e+003;
n=20; farx(n+1)=2.752722e+001; foe(n+1)=1.743135e+002; krok(n+1)=1.389400e-003; ng(n+1)=8.040758e+003;
n=21; farx(n+1)=2.666303e+001; foe(n+1)=1.710160e+002; krok(n+1)=1.168734e-004; ng(n+1)=1.054976e+004;
n=22; farx(n+1)=2.608472e+001; foe(n+1)=1.691859e+002; krok(n+1)=2.178264e-004; ng(n+1)=1.240320e+004;
n=23; farx(n+1)=2.799438e+001; foe(n+1)=1.613643e+002; krok(n+1)=2.607264e-003; ng(n+1)=1.043862e+004;
n=24; farx(n+1)=3.062345e+001; foe(n+1)=1.570515e+002; krok(n+1)=2.929807e-004; ng(n+1)=9.021450e+003;
n=25; farx(n+1)=3.343647e+001; foe(n+1)=1.538969e+002; krok(n+1)=2.844031e-004; ng(n+1)=1.800401e+004;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.331050e+001; foe(n+1)=1.531505e+002; krok(n+1)=6.973711e-007; ng(n+1)=5.359567e+003;
n=27; farx(n+1)=3.446842e+001; foe(n+1)=1.393345e+002; krok(n+1)=2.692622e-005; ng(n+1)=3.625077e+003;
n=28; farx(n+1)=2.841650e+001; foe(n+1)=1.040080e+002; krok(n+1)=2.632539e-004; ng(n+1)=2.729298e+003;
n=29; farx(n+1)=1.848464e+001; foe(n+1)=6.153305e+001; krok(n+1)=1.530291e-004; ng(n+1)=2.680671e+003;
n=30; farx(n+1)=1.652714e+001; foe(n+1)=4.922789e+001; krok(n+1)=3.309440e-004; ng(n+1)=1.900241e+003;
n=31; farx(n+1)=1.490528e+001; foe(n+1)=4.400451e+001; krok(n+1)=4.465528e-004; ng(n+1)=1.416322e+003;
n=32; farx(n+1)=1.378290e+001; foe(n+1)=4.110563e+001; krok(n+1)=3.229906e-004; ng(n+1)=2.238575e+003;
n=33; farx(n+1)=1.150029e+001; foe(n+1)=3.364421e+001; krok(n+1)=1.222281e-003; ng(n+1)=1.060940e+003;
n=34; farx(n+1)=1.044298e+001; foe(n+1)=2.837096e+001; krok(n+1)=3.388445e-003; ng(n+1)=1.688751e+003;
n=35; farx(n+1)=9.257458e+000; foe(n+1)=2.523342e+001; krok(n+1)=2.063028e-003; ng(n+1)=1.891614e+003;
n=36; farx(n+1)=8.426163e+000; foe(n+1)=2.195303e+001; krok(n+1)=1.202286e-003; ng(n+1)=1.633589e+003;
n=37; farx(n+1)=7.937864e+000; foe(n+1)=1.943461e+001; krok(n+1)=3.427028e-003; ng(n+1)=1.939585e+003;
n=38; farx(n+1)=7.469568e+000; foe(n+1)=1.706379e+001; krok(n+1)=5.711090e-003; ng(n+1)=6.540354e+002;
n=39; farx(n+1)=7.443035e+000; foe(n+1)=1.668004e+001; krok(n+1)=8.931057e-004; ng(n+1)=9.013155e+002;
n=40; farx(n+1)=7.108223e+000; foe(n+1)=1.621533e+001; krok(n+1)=5.233259e-003; ng(n+1)=5.045388e+002;
n=41; farx(n+1)=6.236256e+000; foe(n+1)=1.460509e+001; krok(n+1)=8.180929e-003; ng(n+1)=7.843421e+002;
n=42; farx(n+1)=5.737567e+000; foe(n+1)=1.358683e+001; krok(n+1)=9.041785e-003; ng(n+1)=1.052030e+003;
n=43; farx(n+1)=5.391094e+000; foe(n+1)=1.308200e+001; krok(n+1)=3.918749e-003; ng(n+1)=5.208371e+002;
n=44; farx(n+1)=4.521232e+000; foe(n+1)=1.162357e+001; krok(n+1)=9.584210e-003; ng(n+1)=9.278453e+002;
n=45; farx(n+1)=4.079571e+000; foe(n+1)=1.105316e+001; krok(n+1)=1.797919e-003; ng(n+1)=8.209832e+002;
n=46; farx(n+1)=3.460639e+000; foe(n+1)=1.018373e+001; krok(n+1)=4.051549e-003; ng(n+1)=1.191748e+003;
n=47; farx(n+1)=3.014271e+000; foe(n+1)=9.500550e+000; krok(n+1)=3.621201e-003; ng(n+1)=9.184709e+002;
n=48; farx(n+1)=2.742960e+000; foe(n+1)=9.024119e+000; krok(n+1)=3.349706e-003; ng(n+1)=1.074871e+003;
n=49; farx(n+1)=2.272587e+000; foe(n+1)=8.097462e+000; krok(n+1)=1.617035e-002; ng(n+1)=8.996541e+002;
n=50; farx(n+1)=2.213949e+000; foe(n+1)=7.516373e+000; krok(n+1)=6.193383e-003; ng(n+1)=8.845814e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.208674e+000; foe(n+1)=7.448816e+000; krok(n+1)=4.717423e-006; ng(n+1)=5.002740e+002;
n=52; farx(n+1)=2.176746e+000; foe(n+1)=7.377008e+000; krok(n+1)=4.980227e-005; ng(n+1)=1.984490e+002;
n=53; farx(n+1)=2.175174e+000; foe(n+1)=7.335592e+000; krok(n+1)=1.954543e-005; ng(n+1)=2.420738e+002;
n=54; farx(n+1)=2.172823e+000; foe(n+1)=7.141919e+000; krok(n+1)=1.340733e-004; ng(n+1)=1.891859e+002;
n=55; farx(n+1)=2.147227e+000; foe(n+1)=6.822778e+000; krok(n+1)=6.847610e-004; ng(n+1)=1.074637e+002;
n=56; farx(n+1)=2.114899e+000; foe(n+1)=6.142689e+000; krok(n+1)=2.286608e-003; ng(n+1)=1.092615e+002;
n=57; farx(n+1)=2.133852e+000; foe(n+1)=5.748288e+000; krok(n+1)=4.830641e-003; ng(n+1)=9.474853e+001;
n=58; farx(n+1)=2.123962e+000; foe(n+1)=5.677211e+000; krok(n+1)=9.824964e-004; ng(n+1)=2.642824e+002;
n=59; farx(n+1)=1.905120e+000; foe(n+1)=5.246915e+000; krok(n+1)=2.939560e-003; ng(n+1)=2.671313e+002;
n=60; farx(n+1)=1.823415e+000; foe(n+1)=4.980091e+000; krok(n+1)=3.722051e-003; ng(n+1)=7.730880e+002;
n=61; farx(n+1)=1.780926e+000; foe(n+1)=4.648709e+000; krok(n+1)=1.183052e-002; ng(n+1)=3.033570e+002;
n=62; farx(n+1)=1.710293e+000; foe(n+1)=4.406912e+000; krok(n+1)=9.100900e-003; ng(n+1)=5.818999e+002;
n=63; farx(n+1)=1.687202e+000; foe(n+1)=4.301113e+000; krok(n+1)=3.151553e-003; ng(n+1)=6.163382e+002;
n=64; farx(n+1)=1.623837e+000; foe(n+1)=4.050182e+000; krok(n+1)=2.387143e-002; ng(n+1)=3.960793e+002;
n=65; farx(n+1)=1.532418e+000; foe(n+1)=3.842335e+000; krok(n+1)=9.824309e-003; ng(n+1)=4.870938e+002;
n=66; farx(n+1)=1.491379e+000; foe(n+1)=3.754087e+000; krok(n+1)=5.997467e-003; ng(n+1)=4.862249e+002;
n=67; farx(n+1)=1.450185e+000; foe(n+1)=3.661853e+000; krok(n+1)=5.887869e-003; ng(n+1)=1.877065e+002;
n=68; farx(n+1)=1.402171e+000; foe(n+1)=3.592728e+000; krok(n+1)=1.131031e-002; ng(n+1)=2.170192e+002;
n=69; farx(n+1)=1.261278e+000; foe(n+1)=3.415374e+000; krok(n+1)=1.069268e-002; ng(n+1)=5.440717e+002;
n=70; farx(n+1)=1.169620e+000; foe(n+1)=3.289010e+000; krok(n+1)=1.165911e-002; ng(n+1)=4.329394e+002;
n=71; farx(n+1)=1.082268e+000; foe(n+1)=3.113762e+000; krok(n+1)=1.308616e-002; ng(n+1)=6.731261e+002;
n=72; farx(n+1)=1.026878e+000; foe(n+1)=2.971839e+000; krok(n+1)=5.655154e-003; ng(n+1)=8.360150e+002;
n=73; farx(n+1)=9.796187e-001; foe(n+1)=2.800126e+000; krok(n+1)=2.191235e-002; ng(n+1)=4.845781e+002;
n=74; farx(n+1)=9.806321e-001; foe(n+1)=2.691091e+000; krok(n+1)=3.369650e-002; ng(n+1)=1.989939e+002;
n=75; farx(n+1)=9.798090e-001; foe(n+1)=2.556469e+000; krok(n+1)=1.614645e-002; ng(n+1)=4.911786e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.781540e-001; foe(n+1)=2.519535e+000; krok(n+1)=3.908657e-006; ng(n+1)=3.870304e+002;
n=77; farx(n+1)=9.783237e-001; foe(n+1)=2.515267e+000; krok(n+1)=5.997350e-006; ng(n+1)=1.274187e+002;
n=78; farx(n+1)=9.784933e-001; foe(n+1)=2.495701e+000; krok(n+1)=2.406525e-004; ng(n+1)=4.810041e+001;
n=79; farx(n+1)=9.821331e-001; foe(n+1)=2.488344e+000; krok(n+1)=5.314479e-005; ng(n+1)=5.662068e+001;
n=80; farx(n+1)=9.912330e-001; foe(n+1)=2.390972e+000; krok(n+1)=7.663457e-004; ng(n+1)=5.057325e+001;
n=81; farx(n+1)=9.918201e-001; foe(n+1)=2.349199e+000; krok(n+1)=6.038301e-004; ng(n+1)=6.930124e+001;
n=82; farx(n+1)=9.934988e-001; foe(n+1)=2.319035e+000; krok(n+1)=4.770094e-004; ng(n+1)=1.437975e+002;
n=83; farx(n+1)=9.859849e-001; foe(n+1)=2.288474e+000; krok(n+1)=5.400718e-003; ng(n+1)=2.212480e+002;
n=84; farx(n+1)=9.350563e-001; foe(n+1)=2.158280e+000; krok(n+1)=1.226153e-002; ng(n+1)=3.377743e+002;
n=85; farx(n+1)=9.001029e-001; foe(n+1)=2.089088e+000; krok(n+1)=8.839546e-003; ng(n+1)=1.223919e+002;
n=86; farx(n+1)=8.902867e-001; foe(n+1)=2.009932e+000; krok(n+1)=7.517453e-003; ng(n+1)=5.297278e+002;
n=87; farx(n+1)=8.727846e-001; foe(n+1)=1.963420e+000; krok(n+1)=4.126056e-003; ng(n+1)=3.504305e+002;
n=88; farx(n+1)=8.552552e-001; foe(n+1)=1.889337e+000; krok(n+1)=9.513276e-003; ng(n+1)=4.965292e+002;
n=89; farx(n+1)=8.344760e-001; foe(n+1)=1.829125e+000; krok(n+1)=1.251384e-002; ng(n+1)=2.379479e+002;
n=90; farx(n+1)=8.277414e-001; foe(n+1)=1.767357e+000; krok(n+1)=1.536047e-002; ng(n+1)=3.652892e+002;
n=91; farx(n+1)=8.195833e-001; foe(n+1)=1.726350e+000; krok(n+1)=5.139053e-003; ng(n+1)=2.439208e+002;
n=92; farx(n+1)=8.030508e-001; foe(n+1)=1.684044e+000; krok(n+1)=1.664795e-002; ng(n+1)=3.525691e+002;
n=93; farx(n+1)=7.765975e-001; foe(n+1)=1.601485e+000; krok(n+1)=7.242402e-003; ng(n+1)=8.174939e+002;
n=94; farx(n+1)=7.732524e-001; foe(n+1)=1.552612e+000; krok(n+1)=5.894618e-003; ng(n+1)=4.691669e+002;
n=95; farx(n+1)=7.526264e-001; foe(n+1)=1.527874e+000; krok(n+1)=1.430505e-002; ng(n+1)=2.024985e+002;
n=96; farx(n+1)=6.916625e-001; foe(n+1)=1.472313e+000; krok(n+1)=4.034388e-002; ng(n+1)=5.027350e+001;
n=97; farx(n+1)=6.077189e-001; foe(n+1)=1.381004e+000; krok(n+1)=4.017797e-002; ng(n+1)=3.023357e+002;
n=98; farx(n+1)=5.433496e-001; foe(n+1)=1.291120e+000; krok(n+1)=1.495979e-002; ng(n+1)=1.901359e+002;
n=99; farx(n+1)=5.287341e-001; foe(n+1)=1.265151e+000; krok(n+1)=5.186798e-003; ng(n+1)=3.532040e+002;
n=100; farx(n+1)=5.286767e-001; foe(n+1)=1.241553e+000; krok(n+1)=9.358895e-003; ng(n+1)=2.248857e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
