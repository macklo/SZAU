%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.051225e+003; foe(n+1)=4.016095e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.967101e+003; foe(n+1)=2.928476e+003; krok(n+1)=5.157570e-004; ng(n+1)=2.885515e+003;
n=2; farx(n+1)=1.050248e+003; foe(n+1)=9.811304e+002; krok(n+1)=3.187345e-003; ng(n+1)=1.497672e+003;
n=3; farx(n+1)=1.158341e+003; foe(n+1)=7.540232e+002; krok(n+1)=1.347782e-004; ng(n+1)=5.226385e+003;
n=4; farx(n+1)=1.726121e+003; foe(n+1)=5.714986e+002; krok(n+1)=8.259539e-004; ng(n+1)=5.739938e+003;
n=5; farx(n+1)=1.624168e+003; foe(n+1)=5.461478e+002; krok(n+1)=2.660052e-003; ng(n+1)=7.495031e+002;
n=6; farx(n+1)=9.006454e+002; foe(n+1)=4.399059e+002; krok(n+1)=3.223873e-003; ng(n+1)=7.389848e+002;
n=7; farx(n+1)=8.472385e+002; foe(n+1)=4.362569e+002; krok(n+1)=6.831655e-005; ng(n+1)=1.642170e+003;
n=8; farx(n+1)=3.423584e+002; foe(n+1)=3.651578e+002; krok(n+1)=4.476652e-004; ng(n+1)=2.361436e+003;
n=9; farx(n+1)=1.656499e+002; foe(n+1)=3.255376e+002; krok(n+1)=7.240164e-004; ng(n+1)=5.131644e+003;
n=10; farx(n+1)=1.415451e+002; foe(n+1)=3.163508e+002; krok(n+1)=1.935115e-004; ng(n+1)=6.205843e+003;
n=11; farx(n+1)=1.342566e+002; foe(n+1)=3.076438e+002; krok(n+1)=2.488900e-003; ng(n+1)=4.537606e+003;
n=12; farx(n+1)=1.004171e+002; foe(n+1)=2.859711e+002; krok(n+1)=1.112427e-003; ng(n+1)=2.029903e+003;
n=13; farx(n+1)=7.824950e+001; foe(n+1)=2.721844e+002; krok(n+1)=1.006540e-003; ng(n+1)=3.096623e+003;
n=14; farx(n+1)=7.444396e+001; foe(n+1)=2.696194e+002; krok(n+1)=8.178849e-004; ng(n+1)=3.474105e+003;
n=15; farx(n+1)=7.057148e+001; foe(n+1)=2.655067e+002; krok(n+1)=1.216602e-003; ng(n+1)=3.428472e+003;
n=16; farx(n+1)=6.776299e+001; foe(n+1)=2.628996e+002; krok(n+1)=1.279942e-003; ng(n+1)=3.656108e+003;
n=17; farx(n+1)=6.231482e+001; foe(n+1)=2.559535e+002; krok(n+1)=6.023109e-003; ng(n+1)=6.498450e+003;
n=18; farx(n+1)=6.677234e+001; foe(n+1)=2.314124e+002; krok(n+1)=2.316852e-002; ng(n+1)=4.410786e+003;
n=19; farx(n+1)=6.773205e+001; foe(n+1)=2.272920e+002; krok(n+1)=4.393293e-004; ng(n+1)=3.870318e+003;
n=20; farx(n+1)=6.561925e+001; foe(n+1)=2.220135e+002; krok(n+1)=5.139053e-003; ng(n+1)=3.372153e+003;
n=21; farx(n+1)=5.781491e+001; foe(n+1)=2.129252e+002; krok(n+1)=7.980009e-003; ng(n+1)=2.838954e+003;
n=22; farx(n+1)=5.090827e+001; foe(n+1)=1.954339e+002; krok(n+1)=2.741202e-002; ng(n+1)=4.070639e+003;
n=23; farx(n+1)=4.345852e+001; foe(n+1)=1.804081e+002; krok(n+1)=3.816957e-002; ng(n+1)=9.317381e+003;
n=24; farx(n+1)=4.813514e+001; foe(n+1)=1.729566e+002; krok(n+1)=5.730115e-002; ng(n+1)=4.015033e+003;
n=25; farx(n+1)=5.133043e+001; foe(n+1)=1.670571e+002; krok(n+1)=6.118871e-003; ng(n+1)=2.082371e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=4.542527e+001; foe(n+1)=1.464289e+002; krok(n+1)=1.131625e-004; ng(n+1)=1.441063e+003;
n=27; farx(n+1)=3.986331e+001; foe(n+1)=1.148431e+002; krok(n+1)=1.182351e-005; ng(n+1)=5.181735e+003;
n=28; farx(n+1)=3.819752e+001; foe(n+1)=1.090669e+002; krok(n+1)=1.736749e-004; ng(n+1)=5.308467e+003;
n=29; farx(n+1)=3.626462e+001; foe(n+1)=1.017032e+002; krok(n+1)=1.383684e-004; ng(n+1)=7.259946e+003;
n=30; farx(n+1)=3.748061e+001; foe(n+1)=9.870694e+001; krok(n+1)=7.679143e-005; ng(n+1)=5.531558e+003;
n=31; farx(n+1)=3.576349e+001; foe(n+1)=8.748296e+001; krok(n+1)=6.650130e-004; ng(n+1)=1.522874e+003;
n=32; farx(n+1)=3.175283e+001; foe(n+1)=8.248551e+001; krok(n+1)=4.995913e-004; ng(n+1)=3.422503e+003;
n=33; farx(n+1)=2.060953e+001; foe(n+1)=6.448709e+001; krok(n+1)=2.914397e-003; ng(n+1)=5.683445e+003;
n=34; farx(n+1)=2.052890e+001; foe(n+1)=6.275100e+001; krok(n+1)=6.046162e-005; ng(n+1)=3.009465e+003;
n=35; farx(n+1)=2.048963e+001; foe(n+1)=6.232205e+001; krok(n+1)=2.746916e-005; ng(n+1)=4.574335e+005;
n=36; farx(n+1)=2.048449e+001; foe(n+1)=6.231286e+001; krok(n+1)=1.985021e-006; ng(n+1)=1.253486e+005;
n=37; farx(n+1)=2.048449e+001; foe(n+1)=6.231286e+001; krok(n+1)=1.847350e-014; ng(n+1)=5.971352e+005;
n=38; farx(n+1)=2.048449e+001; foe(n+1)=6.231286e+001; krok(n+1)=1.992917e-014; ng(n+1)=5.971352e+005;
n=39; farx(n+1)=2.048449e+001; foe(n+1)=6.231286e+001; krok(n+1)=1.601891e-014; ng(n+1)=5.971352e+005;
n=40; farx(n+1)=2.048446e+001; foe(n+1)=6.231128e+001; krok(n+1)=9.671965e-006; ng(n+1)=5.971352e+005;
n=41; farx(n+1)=2.048446e+001; foe(n+1)=6.231128e+001; krok(n+1)=6.367285e-014; ng(n+1)=3.026893e+005;
n=42; farx(n+1)=2.048269e+001; foe(n+1)=6.230978e+001; krok(n+1)=1.286427e-006; ng(n+1)=3.026893e+005;
n=43; farx(n+1)=2.048269e+001; foe(n+1)=6.230978e+001; krok(n+1)=8.073663e-014; ng(n+1)=6.655497e+005;
n=44; farx(n+1)=2.048269e+001; foe(n+1)=6.230978e+001; krok(n+1)=1.136050e-016; ng(n+1)=6.655497e+005;
 % z³y kierunek w metodzie zm - odnowa 
n=45; farx(n+1)=2.048269e+001; foe(n+1)=6.230489e+001; krok(n+1)=1.626076e-013; ng(n+1)=6.655497e+005;
n=46; farx(n+1)=2.042468e+001; foe(n+1)=6.192356e+001; krok(n+1)=5.356812e-006; ng(n+1)=8.763922e+002;
n=47; farx(n+1)=2.041841e+001; foe(n+1)=6.174300e+001; krok(n+1)=8.263013e-008; ng(n+1)=8.096954e+005;
n=48; farx(n+1)=2.033322e+001; foe(n+1)=6.027516e+001; krok(n+1)=1.555969e-005; ng(n+1)=9.417660e+004;
n=49; farx(n+1)=2.019176e+001; foe(n+1)=5.987099e+001; krok(n+1)=6.731556e-006; ng(n+1)=5.217231e+005;
n=50; farx(n+1)=2.018988e+001; foe(n+1)=5.986508e+001; krok(n+1)=5.801107e-008; ng(n+1)=1.805735e+005;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.018988e+001; foe(n+1)=5.986257e+001; krok(n+1)=2.130053e-013; ng(n+1)=4.089153e+005;
n=52; farx(n+1)=2.018977e+001; foe(n+1)=5.949990e+001; krok(n+1)=3.055406e-010; ng(n+1)=8.137488e+004;
n=53; farx(n+1)=2.017582e+001; foe(n+1)=5.943693e+001; krok(n+1)=6.108716e-006; ng(n+1)=1.041205e+005;
n=54; farx(n+1)=2.013688e+001; foe(n+1)=5.931061e+001; krok(n+1)=1.251494e-006; ng(n+1)=1.305699e+006;
n=55; farx(n+1)=2.004193e+001; foe(n+1)=5.904446e+001; krok(n+1)=4.064623e-006; ng(n+1)=6.371092e+005;
n=56; farx(n+1)=1.992756e+001; foe(n+1)=5.888353e+001; krok(n+1)=2.036925e-005; ng(n+1)=4.856124e+005;
n=57; farx(n+1)=1.973830e+001; foe(n+1)=5.804683e+001; krok(n+1)=1.847442e-005; ng(n+1)=9.271447e+005;
n=58; farx(n+1)=1.961288e+001; foe(n+1)=5.752388e+001; krok(n+1)=4.705554e-005; ng(n+1)=2.484387e+005;
n=59; farx(n+1)=1.960860e+001; foe(n+1)=5.751357e+001; krok(n+1)=4.536859e-007; ng(n+1)=4.288596e+005;
n=60; farx(n+1)=1.795468e+001; foe(n+1)=5.304945e+001; krok(n+1)=8.861138e-004; ng(n+1)=2.367417e+005;
n=61; farx(n+1)=1.585381e+001; foe(n+1)=4.606520e+001; krok(n+1)=2.973498e-003; ng(n+1)=3.284803e+003;
n=62; farx(n+1)=1.548966e+001; foe(n+1)=4.419139e+001; krok(n+1)=1.158499e-003; ng(n+1)=1.522158e+003;
n=63; farx(n+1)=1.523077e+001; foe(n+1)=4.393419e+001; krok(n+1)=1.120408e-003; ng(n+1)=1.431884e+003;
n=64; farx(n+1)=1.459743e+001; foe(n+1)=4.354618e+001; krok(n+1)=3.990929e-003; ng(n+1)=1.876722e+003;
n=65; farx(n+1)=1.328395e+001; foe(n+1)=4.166630e+001; krok(n+1)=8.516524e-003; ng(n+1)=2.693551e+003;
n=66; farx(n+1)=1.333719e+001; foe(n+1)=4.025565e+001; krok(n+1)=1.109636e-002; ng(n+1)=1.268580e+003;
n=67; farx(n+1)=1.265759e+001; foe(n+1)=3.931597e+001; krok(n+1)=1.333847e-002; ng(n+1)=1.654360e+003;
n=68; farx(n+1)=1.196380e+001; foe(n+1)=3.802883e+001; krok(n+1)=1.043894e-002; ng(n+1)=1.186777e+003;
n=69; farx(n+1)=1.203162e+001; foe(n+1)=3.495343e+001; krok(n+1)=1.939776e-002; ng(n+1)=1.954062e+003;
n=70; farx(n+1)=1.078683e+001; foe(n+1)=3.155072e+001; krok(n+1)=1.545508e-001; ng(n+1)=1.795598e+003;
n=71; farx(n+1)=1.027023e+001; foe(n+1)=2.869042e+001; krok(n+1)=1.277097e-001; ng(n+1)=1.902946e+003;
n=72; farx(n+1)=1.051992e+001; foe(n+1)=2.565443e+001; krok(n+1)=3.650930e-002; ng(n+1)=8.078451e+002;
n=73; farx(n+1)=1.027958e+001; foe(n+1)=2.331282e+001; krok(n+1)=1.392689e-001; ng(n+1)=8.454508e+002;
n=74; farx(n+1)=1.024389e+001; foe(n+1)=2.182288e+001; krok(n+1)=1.506669e-001; ng(n+1)=1.769384e+003;
n=75; farx(n+1)=1.088843e+001; foe(n+1)=1.981621e+001; krok(n+1)=6.710813e-001; ng(n+1)=5.844408e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.082944e+001; foe(n+1)=1.951932e+001; krok(n+1)=8.488840e-006; ng(n+1)=6.949488e+002;
n=77; farx(n+1)=1.072860e+001; foe(n+1)=1.899936e+001; krok(n+1)=1.749394e-005; ng(n+1)=5.644864e+002;
n=78; farx(n+1)=1.070018e+001; foe(n+1)=1.859423e+001; krok(n+1)=2.661414e-004; ng(n+1)=1.333373e+002;
n=79; farx(n+1)=1.057889e+001; foe(n+1)=1.761923e+001; krok(n+1)=2.652070e-004; ng(n+1)=2.230764e+002;
n=80; farx(n+1)=9.990033e+000; foe(n+1)=1.698793e+001; krok(n+1)=1.945210e-003; ng(n+1)=1.097585e+002;
n=81; farx(n+1)=9.047267e+000; foe(n+1)=1.590807e+001; krok(n+1)=2.187783e-003; ng(n+1)=2.467414e+002;
n=82; farx(n+1)=8.655518e+000; foe(n+1)=1.515902e+001; krok(n+1)=3.442371e-003; ng(n+1)=1.836482e+002;
n=83; farx(n+1)=7.685041e+000; foe(n+1)=1.423610e+001; krok(n+1)=7.323184e-004; ng(n+1)=3.126266e+002;
n=84; farx(n+1)=7.495646e+000; foe(n+1)=1.408613e+001; krok(n+1)=2.043687e-003; ng(n+1)=2.281188e+002;
n=85; farx(n+1)=6.780480e+000; foe(n+1)=1.366070e+001; krok(n+1)=1.417782e-002; ng(n+1)=4.578291e+002;
n=86; farx(n+1)=6.649054e+000; foe(n+1)=1.356326e+001; krok(n+1)=5.711090e-003; ng(n+1)=4.388427e+002;
n=87; farx(n+1)=5.996435e+000; foe(n+1)=1.308444e+001; krok(n+1)=1.046652e-002; ng(n+1)=5.093432e+002;
n=88; farx(n+1)=5.439137e+000; foe(n+1)=1.257286e+001; krok(n+1)=1.849615e-002; ng(n+1)=4.905234e+002;
n=89; farx(n+1)=5.236676e+000; foe(n+1)=1.230609e+001; krok(n+1)=1.680437e-002; ng(n+1)=3.720058e+002;
n=90; farx(n+1)=5.060012e+000; foe(n+1)=1.213108e+001; krok(n+1)=1.121665e-002; ng(n+1)=4.309972e+002;
n=91; farx(n+1)=4.839374e+000; foe(n+1)=1.168562e+001; krok(n+1)=4.836969e-002; ng(n+1)=7.088909e+002;
n=92; farx(n+1)=4.707582e+000; foe(n+1)=1.132723e+001; krok(n+1)=1.977848e-002; ng(n+1)=6.300446e+002;
n=93; farx(n+1)=4.536770e+000; foe(n+1)=1.088117e+001; krok(n+1)=2.147336e-002; ng(n+1)=1.649715e+002;
n=94; farx(n+1)=4.187975e+000; foe(n+1)=9.920810e+000; krok(n+1)=5.507577e-002; ng(n+1)=1.917053e+002;
n=95; farx(n+1)=3.993788e+000; foe(n+1)=9.268301e+000; krok(n+1)=1.344556e-001; ng(n+1)=2.766227e+002;
n=96; farx(n+1)=4.111091e+000; foe(n+1)=8.670575e+000; krok(n+1)=1.096649e-001; ng(n+1)=2.454329e+002;
n=97; farx(n+1)=3.833009e+000; foe(n+1)=7.856156e+000; krok(n+1)=3.288994e-001; ng(n+1)=8.771302e+002;
n=98; farx(n+1)=3.420765e+000; foe(n+1)=7.034810e+000; krok(n+1)=1.564519e-001; ng(n+1)=2.194040e+002;
n=99; farx(n+1)=3.150727e+000; foe(n+1)=6.531960e+000; krok(n+1)=2.962682e-001; ng(n+1)=5.921300e+002;
n=100; farx(n+1)=3.051511e+000; foe(n+1)=6.278903e+000; krok(n+1)=2.010759e-001; ng(n+1)=7.518853e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
