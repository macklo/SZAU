%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.054741e+003; foe(n+1)=4.051787e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.029146e+003; foe(n+1)=3.035485e+003; krok(n+1)=5.005982e-004; ng(n+1)=1.670280e+003;
n=2; farx(n+1)=7.519105e+002; foe(n+1)=7.651518e+002; krok(n+1)=1.763378e-002; ng(n+1)=2.344385e+002;
n=3; farx(n+1)=7.583653e+002; foe(n+1)=7.327425e+002; krok(n+1)=3.242569e-005; ng(n+1)=2.353549e+003;
n=4; farx(n+1)=9.375989e+002; foe(n+1)=6.392703e+002; krok(n+1)=5.214412e-003; ng(n+1)=2.420050e+003;
n=5; farx(n+1)=4.339020e+002; foe(n+1)=5.659847e+002; krok(n+1)=8.090126e-001; ng(n+1)=1.352668e+003;
n=6; farx(n+1)=3.427099e+002; foe(n+1)=4.356246e+002; krok(n+1)=4.438543e-002; ng(n+1)=1.136799e+003;
n=7; farx(n+1)=3.421874e+002; foe(n+1)=4.309072e+002; krok(n+1)=2.499424e-003; ng(n+1)=8.110145e+002;
n=8; farx(n+1)=3.414085e+002; foe(n+1)=4.304628e+002; krok(n+1)=4.949772e-003; ng(n+1)=5.605629e+002;
n=9; farx(n+1)=3.247976e+002; foe(n+1)=4.166724e+002; krok(n+1)=2.900728e-002; ng(n+1)=6.420732e+003;
n=10; farx(n+1)=2.614478e+002; foe(n+1)=3.428716e+002; krok(n+1)=1.953752e-001; ng(n+1)=7.847598e+002;
n=11; farx(n+1)=2.571921e+002; foe(n+1)=3.376284e+002; krok(n+1)=1.297328e-001; ng(n+1)=3.211118e+003;
n=12; farx(n+1)=2.380922e+002; foe(n+1)=3.264662e+002; krok(n+1)=7.101669e-001; ng(n+1)=7.434158e+003;
n=13; farx(n+1)=2.357242e+002; foe(n+1)=3.231182e+002; krok(n+1)=2.023747e-001; ng(n+1)=4.598184e+003;
n=14; farx(n+1)=2.357242e+002; foe(n+1)=3.231182e+002; krok(n+1)=1.181561e-014; ng(n+1)=1.334511e+003;
 % z³y kierunek w metodzie zm - odnowa 
n=15; farx(n+1)=2.357229e+002; foe(n+1)=3.230983e+002; krok(n+1)=3.887684e-008; ng(n+1)=1.334511e+003;
n=16; farx(n+1)=2.185491e+002; foe(n+1)=3.128115e+002; krok(n+1)=7.102557e-004; ng(n+1)=3.186448e+002;
n=17; farx(n+1)=2.140566e+002; foe(n+1)=3.069267e+002; krok(n+1)=1.231621e-003; ng(n+1)=3.267848e+003;
n=18; farx(n+1)=2.135489e+002; foe(n+1)=3.065618e+002; krok(n+1)=1.848518e-004; ng(n+1)=5.647743e+002;
n=19; farx(n+1)=2.044493e+002; foe(n+1)=3.013816e+002; krok(n+1)=1.742611e-003; ng(n+1)=7.526685e+003;
n=20; farx(n+1)=1.438354e+002; foe(n+1)=2.809862e+002; krok(n+1)=1.021537e-002; ng(n+1)=6.988540e+003;
n=21; farx(n+1)=1.447635e+002; foe(n+1)=2.804559e+002; krok(n+1)=6.095154e-002; ng(n+1)=3.764552e+002;
n=22; farx(n+1)=1.412852e+002; foe(n+1)=2.786865e+002; krok(n+1)=1.442898e+000; ng(n+1)=3.777864e+003;
n=23; farx(n+1)=1.475629e+002; foe(n+1)=2.769314e+002; krok(n+1)=7.631010e-001; ng(n+1)=3.378871e+003;
n=24; farx(n+1)=1.444811e+002; foe(n+1)=2.747034e+002; krok(n+1)=5.219391e-001; ng(n+1)=1.334728e+003;
n=25; farx(n+1)=1.356984e+002; foe(n+1)=2.678335e+002; krok(n+1)=5.520515e-001; ng(n+1)=8.314921e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.357154e+002; foe(n+1)=2.676962e+002; krok(n+1)=7.894412e-008; ng(n+1)=2.567432e+003;
n=27; farx(n+1)=1.194011e+002; foe(n+1)=2.579199e+002; krok(n+1)=1.310706e-003; ng(n+1)=2.315735e+002;
n=28; farx(n+1)=1.033540e+002; foe(n+1)=2.514049e+002; krok(n+1)=1.094437e-003; ng(n+1)=3.573764e+002;
n=29; farx(n+1)=1.031000e+002; foe(n+1)=2.510632e+002; krok(n+1)=2.581106e-005; ng(n+1)=6.869261e+002;
n=30; farx(n+1)=7.196644e+001; foe(n+1)=1.948281e+002; krok(n+1)=8.235795e-003; ng(n+1)=5.642218e+002;
n=31; farx(n+1)=6.956076e+001; foe(n+1)=1.922936e+002; krok(n+1)=5.985093e-004; ng(n+1)=5.929384e+002;
n=32; farx(n+1)=4.499586e+001; foe(n+1)=1.607710e+002; krok(n+1)=7.310195e-001; ng(n+1)=7.863256e+002;
n=33; farx(n+1)=4.282058e+001; foe(n+1)=1.568717e+002; krok(n+1)=1.015974e-001; ng(n+1)=6.719778e+002;
n=34; farx(n+1)=3.948385e+001; foe(n+1)=1.475525e+002; krok(n+1)=3.119789e-001; ng(n+1)=2.033027e+003;
n=35; farx(n+1)=3.300021e+001; foe(n+1)=1.411831e+002; krok(n+1)=4.004429e-001; ng(n+1)=1.384488e+003;
n=36; farx(n+1)=2.514888e+001; foe(n+1)=1.348365e+002; krok(n+1)=1.854055e+000; ng(n+1)=4.393944e+002;
n=37; farx(n+1)=2.439147e+001; foe(n+1)=1.343129e+002; krok(n+1)=4.536903e-001; ng(n+1)=1.070739e+003;
n=38; farx(n+1)=2.359534e+001; foe(n+1)=1.316690e+002; krok(n+1)=2.125050e+000; ng(n+1)=9.962000e+002;
n=39; farx(n+1)=2.391065e+001; foe(n+1)=1.308310e+002; krok(n+1)=3.912500e-001; ng(n+1)=8.575379e+002;
n=40; farx(n+1)=2.193544e+001; foe(n+1)=1.287081e+002; krok(n+1)=7.011953e-001; ng(n+1)=8.611862e+002;
n=41; farx(n+1)=2.198999e+001; foe(n+1)=1.286327e+002; krok(n+1)=3.070634e-002; ng(n+1)=8.094045e+002;
n=42; farx(n+1)=2.219052e+001; foe(n+1)=1.282969e+002; krok(n+1)=3.881913e-002; ng(n+1)=9.516982e+002;
n=43; farx(n+1)=2.265290e+001; foe(n+1)=1.267097e+002; krok(n+1)=7.470650e-001; ng(n+1)=1.056651e+003;
n=44; farx(n+1)=2.270058e+001; foe(n+1)=1.264321e+002; krok(n+1)=1.158784e-001; ng(n+1)=1.229650e+003;
n=45; farx(n+1)=2.298894e+001; foe(n+1)=1.258340e+002; krok(n+1)=8.773192e-001; ng(n+1)=1.357162e+003;
n=46; farx(n+1)=2.284699e+001; foe(n+1)=1.252130e+002; krok(n+1)=9.270274e-001; ng(n+1)=1.027535e+003;
n=47; farx(n+1)=2.248837e+001; foe(n+1)=1.248173e+002; krok(n+1)=6.653319e-001; ng(n+1)=1.028045e+003;
n=48; farx(n+1)=2.249119e+001; foe(n+1)=1.247788e+002; krok(n+1)=8.973318e-002; ng(n+1)=1.045579e+003;
n=49; farx(n+1)=2.273280e+001; foe(n+1)=1.245272e+002; krok(n+1)=1.348916e+000; ng(n+1)=1.033236e+003;
n=50; farx(n+1)=2.277693e+001; foe(n+1)=1.243498e+002; krok(n+1)=4.763389e-001; ng(n+1)=9.193867e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.267086e+001; foe(n+1)=1.240562e+002; krok(n+1)=8.237036e-007; ng(n+1)=1.361083e+003;
n=52; farx(n+1)=2.115214e+001; foe(n+1)=1.210028e+002; krok(n+1)=9.237209e-006; ng(n+1)=1.189030e+003;
n=53; farx(n+1)=1.534722e+001; foe(n+1)=1.135127e+002; krok(n+1)=3.773212e-005; ng(n+1)=1.972624e+003;
n=54; farx(n+1)=1.242400e+001; foe(n+1)=1.022520e+002; krok(n+1)=1.651654e-003; ng(n+1)=6.564051e+002;
n=55; farx(n+1)=1.235054e+001; foe(n+1)=9.802276e+001; krok(n+1)=5.428245e-004; ng(n+1)=7.368936e+002;
n=56; farx(n+1)=1.224810e+001; foe(n+1)=9.742917e+001; krok(n+1)=3.210907e-004; ng(n+1)=7.301254e+002;
n=57; farx(n+1)=1.201760e+001; foe(n+1)=9.517885e+001; krok(n+1)=5.510555e-004; ng(n+1)=7.519923e+002;
n=58; farx(n+1)=1.044682e+001; foe(n+1)=8.910668e+001; krok(n+1)=1.996683e+000; ng(n+1)=5.119907e+002;
n=59; farx(n+1)=1.009017e+001; foe(n+1)=8.627438e+001; krok(n+1)=9.574267e-001; ng(n+1)=8.387554e+002;
n=60; farx(n+1)=9.750172e+000; foe(n+1)=8.539932e+001; krok(n+1)=5.563246e-001; ng(n+1)=6.555250e+002;
n=61; farx(n+1)=9.795824e+000; foe(n+1)=8.364939e+001; krok(n+1)=4.819709e-001; ng(n+1)=7.333915e+002;
n=62; farx(n+1)=1.002570e+001; foe(n+1)=8.327401e+001; krok(n+1)=1.715049e+000; ng(n+1)=1.962923e+002;
n=63; farx(n+1)=9.956494e+000; foe(n+1)=8.310588e+001; krok(n+1)=5.312625e-001; ng(n+1)=2.978241e+002;
n=64; farx(n+1)=9.946137e+000; foe(n+1)=8.309017e+001; krok(n+1)=8.658973e-001; ng(n+1)=3.651468e+001;
n=65; farx(n+1)=9.958743e+000; foe(n+1)=8.308048e+001; krok(n+1)=5.936463e-001; ng(n+1)=5.093624e+001;
n=66; farx(n+1)=9.989766e+000; foe(n+1)=8.306792e+001; krok(n+1)=1.216368e+000; ng(n+1)=9.315003e+001;
n=67; farx(n+1)=9.933213e+000; foe(n+1)=8.305770e+001; krok(n+1)=2.315580e+000; ng(n+1)=3.371348e+001;
n=68; farx(n+1)=9.939069e+000; foe(n+1)=8.305630e+001; krok(n+1)=1.885812e+000; ng(n+1)=1.716415e+001;
n=69; farx(n+1)=9.979388e+000; foe(n+1)=8.304992e+001; krok(n+1)=1.138196e+001; ng(n+1)=6.341921e+000;
n=70; farx(n+1)=1.000926e+001; foe(n+1)=8.304704e+001; krok(n+1)=1.065517e+000; ng(n+1)=3.624975e+001;
n=71; farx(n+1)=1.000554e+001; foe(n+1)=8.304664e+001; krok(n+1)=6.639102e-001; ng(n+1)=1.132712e+001;
n=72; farx(n+1)=1.000693e+001; foe(n+1)=8.304663e+001; krok(n+1)=9.908265e-001; ng(n+1)=1.274591e+000;
n=73; farx(n+1)=1.000698e+001; foe(n+1)=8.304663e+001; krok(n+1)=7.659414e+000; ng(n+1)=1.402853e+000;
n=74; farx(n+1)=1.000543e+001; foe(n+1)=8.304647e+001; krok(n+1)=1.077496e+002; ng(n+1)=1.871842e+000;
n=75; farx(n+1)=1.000509e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.022846e+000; ng(n+1)=8.253206e-001;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.000509e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.165470e-005; ng(n+1)=1.409967e-002;
n=77; farx(n+1)=1.000509e+001; foe(n+1)=8.304646e+001; krok(n+1)=9.586893e-006; ng(n+1)=1.823984e-002;
n=78; farx(n+1)=1.000508e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.858107e-004; ng(n+1)=8.048401e-003;
n=79; farx(n+1)=1.000508e+001; foe(n+1)=8.304646e+001; krok(n+1)=5.521334e-004; ng(n+1)=2.926022e-003;
n=80; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.534472e-004; ng(n+1)=3.681650e-003;
n=81; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.651638e-002; ng(n+1)=3.099290e-004;
n=82; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=5.945944e-003; ng(n+1)=3.998173e-004;
n=83; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=4.287960e-006; ng(n+1)=9.958812e-005;
n=84; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.761882e-006; ng(n+1)=9.958768e-005;
n=85; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.887684e-008; ng(n+1)=9.958729e-005;
n=86; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=6.815949e-007; ng(n+1)=9.958728e-005;
n=87; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.621811e-007; ng(n+1)=9.958601e-005;
n=88; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=6.760525e-009; ng(n+1)=9.958599e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=89; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=2.182100e-010; ng(n+1)=9.958598e-005;
n=90; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.606794e-005; ng(n+1)=9.958017e-005;
n=91; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=8.913402e-006; ng(n+1)=1.182589e-004;
n=92; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.664367e-007; ng(n+1)=1.182254e-004;
n=93; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.718967e-010; ng(n+1)=1.182258e-004;
n=94; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.428156e-009; ng(n+1)=1.182258e-004;
n=95; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.629360e-009; ng(n+1)=1.182258e-004;
n=96; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.002327e-009; ng(n+1)=1.182258e-004;
n=97; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=1.889761e-007; ng(n+1)=1.182258e-004;
n=98; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=3.398314e-008; ng(n+1)=1.182257e-004;
n=99; farx(n+1)=1.000505e+001; foe(n+1)=8.304646e+001; krok(n+1)=7.590611e-009; ng(n+1)=1.182257e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
