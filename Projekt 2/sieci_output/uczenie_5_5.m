%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.028643e+003; foe(n+1)=4.008790e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.941497e+003; foe(n+1)=2.922710e+003; krok(n+1)=5.081655e-004; ng(n+1)=3.274218e+003;
n=2; farx(n+1)=1.053022e+003; foe(n+1)=9.118155e+002; krok(n+1)=3.416071e-003; ng(n+1)=1.640544e+003;
n=3; farx(n+1)=1.131251e+003; foe(n+1)=6.420709e+002; krok(n+1)=2.501060e-004; ng(n+1)=5.230884e+003;
n=4; farx(n+1)=1.531117e+003; foe(n+1)=5.189011e+002; krok(n+1)=1.413750e-003; ng(n+1)=4.551336e+003;
n=5; farx(n+1)=9.873774e+002; foe(n+1)=4.550215e+002; krok(n+1)=5.548179e-003; ng(n+1)=5.709601e+002;
n=6; farx(n+1)=4.341673e+002; foe(n+1)=3.433837e+002; krok(n+1)=5.548179e-003; ng(n+1)=1.113646e+003;
n=7; farx(n+1)=3.795582e+002; foe(n+1)=3.328011e+002; krok(n+1)=1.353531e-003; ng(n+1)=6.714223e+002;
n=8; farx(n+1)=3.592962e+002; foe(n+1)=3.279190e+002; krok(n+1)=1.457389e-003; ng(n+1)=2.927322e+002;
n=9; farx(n+1)=2.928293e+002; foe(n+1)=3.166519e+002; krok(n+1)=9.533414e-003; ng(n+1)=2.585974e+002;
n=10; farx(n+1)=2.107049e+002; foe(n+1)=2.990048e+002; krok(n+1)=6.525058e-003; ng(n+1)=2.697386e+002;
n=11; farx(n+1)=9.838089e+001; foe(n+1)=2.710938e+002; krok(n+1)=4.706747e-004; ng(n+1)=9.844346e+002;
n=12; farx(n+1)=9.080602e+001; foe(n+1)=2.685461e+002; krok(n+1)=7.103937e-005; ng(n+1)=2.329615e+003;
n=13; farx(n+1)=7.279527e+001; foe(n+1)=2.622269e+002; krok(n+1)=1.323510e-003; ng(n+1)=2.009048e+003;
n=14; farx(n+1)=5.982633e+001; foe(n+1)=2.537676e+002; krok(n+1)=4.706747e-004; ng(n+1)=2.221968e+003;
n=15; farx(n+1)=5.632861e+001; foe(n+1)=2.301041e+002; krok(n+1)=8.726203e-004; ng(n+1)=1.927669e+003;
n=16; farx(n+1)=5.765900e+001; foe(n+1)=2.290208e+002; krok(n+1)=2.732662e-004; ng(n+1)=2.108943e+003;
n=17; farx(n+1)=6.030197e+001; foe(n+1)=2.266379e+002; krok(n+1)=1.022616e-003; ng(n+1)=2.060643e+003;
n=18; farx(n+1)=2.089780e+001; foe(n+1)=1.706013e+002; krok(n+1)=5.753341e-002; ng(n+1)=2.107546e+003;
n=19; farx(n+1)=1.949821e+001; foe(n+1)=1.679579e+002; krok(n+1)=2.127259e-005; ng(n+1)=4.693084e+003;
n=20; farx(n+1)=2.106648e+001; foe(n+1)=1.620550e+002; krok(n+1)=6.425309e-003; ng(n+1)=4.777249e+003;
n=21; farx(n+1)=2.891523e+001; foe(n+1)=1.565277e+002; krok(n+1)=8.744518e-003; ng(n+1)=3.171116e+003;
n=22; farx(n+1)=2.672749e+001; foe(n+1)=1.461200e+002; krok(n+1)=3.052860e-002; ng(n+1)=1.964989e+003;
n=23; farx(n+1)=2.584182e+001; foe(n+1)=1.256555e+002; krok(n+1)=1.419977e-002; ng(n+1)=2.122297e+003;
n=24; farx(n+1)=2.449227e+001; foe(n+1)=1.202385e+002; krok(n+1)=3.595477e-002; ng(n+1)=1.448132e+003;
n=25; farx(n+1)=2.452525e+001; foe(n+1)=1.169771e+002; krok(n+1)=1.171151e-002; ng(n+1)=1.965851e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.227607e+001; foe(n+1)=1.136442e+002; krok(n+1)=1.523649e-005; ng(n+1)=1.714316e+003;
n=27; farx(n+1)=2.210174e+001; foe(n+1)=1.048848e+002; krok(n+1)=6.140602e-005; ng(n+1)=1.485107e+003;
n=28; farx(n+1)=1.712045e+001; foe(n+1)=9.948101e+001; krok(n+1)=2.749912e-004; ng(n+1)=6.644896e+002;
n=29; farx(n+1)=1.322810e+001; foe(n+1)=7.139987e+001; krok(n+1)=4.526501e-004; ng(n+1)=1.725860e+003;
n=30; farx(n+1)=1.141449e+001; foe(n+1)=6.621669e+001; krok(n+1)=2.493753e-004; ng(n+1)=1.212854e+003;
n=31; farx(n+1)=1.086135e+001; foe(n+1)=6.218090e+001; krok(n+1)=2.796501e-004; ng(n+1)=7.615458e+002;
n=32; farx(n+1)=1.010670e+001; foe(n+1)=4.668410e+001; krok(n+1)=8.898758e-004; ng(n+1)=1.361548e+003;
n=33; farx(n+1)=8.986859e+000; foe(n+1)=4.124642e+001; krok(n+1)=5.034661e-004; ng(n+1)=1.604641e+003;
n=34; farx(n+1)=8.077109e+000; foe(n+1)=3.390267e+001; krok(n+1)=2.530456e-003; ng(n+1)=1.640894e+003;
n=35; farx(n+1)=5.996701e+000; foe(n+1)=2.166709e+001; krok(n+1)=6.255325e-003; ng(n+1)=1.380197e+003;
n=36; farx(n+1)=5.746645e+000; foe(n+1)=1.852565e+001; krok(n+1)=4.762275e-003; ng(n+1)=1.915321e+003;
n=37; farx(n+1)=4.885481e+000; foe(n+1)=1.587505e+001; krok(n+1)=7.007869e-003; ng(n+1)=6.581015e+002;
n=38; farx(n+1)=4.709653e+000; foe(n+1)=1.405588e+001; krok(n+1)=1.923079e-003; ng(n+1)=5.238446e+002;
n=39; farx(n+1)=4.551188e+000; foe(n+1)=1.356838e+001; krok(n+1)=3.174920e-003; ng(n+1)=6.173444e+002;
n=40; farx(n+1)=4.391903e+000; foe(n+1)=1.299638e+001; krok(n+1)=6.956269e-003; ng(n+1)=4.674005e+002;
n=41; farx(n+1)=4.285169e+000; foe(n+1)=1.277936e+001; krok(n+1)=6.853004e-003; ng(n+1)=4.490928e+002;
n=42; farx(n+1)=4.156221e+000; foe(n+1)=1.221004e+001; krok(n+1)=8.565378e-003; ng(n+1)=7.569360e+002;
n=43; farx(n+1)=3.976260e+000; foe(n+1)=1.056986e+001; krok(n+1)=7.262643e-002; ng(n+1)=3.631309e+002;
n=44; farx(n+1)=3.844013e+000; foe(n+1)=1.023657e+001; krok(n+1)=6.460817e-002; ng(n+1)=3.805745e+002;
n=45; farx(n+1)=3.466593e+000; foe(n+1)=9.214161e+000; krok(n+1)=9.233170e-002; ng(n+1)=2.064807e+002;
n=46; farx(n+1)=3.306582e+000; foe(n+1)=8.276792e+000; krok(n+1)=2.230542e-001; ng(n+1)=4.332448e+002;
n=47; farx(n+1)=3.228539e+000; foe(n+1)=8.049970e+000; krok(n+1)=2.741202e-002; ng(n+1)=5.759772e+002;
n=48; farx(n+1)=3.177359e+000; foe(n+1)=7.862693e+000; krok(n+1)=2.440235e-002; ng(n+1)=6.885462e+002;
n=49; farx(n+1)=3.171869e+000; foe(n+1)=7.390819e+000; krok(n+1)=1.067078e-001; ng(n+1)=2.843983e+002;
n=50; farx(n+1)=3.116692e+000; foe(n+1)=7.058288e+000; krok(n+1)=1.032026e-001; ng(n+1)=2.109550e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=3.105236e+000; foe(n+1)=6.997447e+000; krok(n+1)=2.616958e-005; ng(n+1)=1.568552e+002;
n=52; farx(n+1)=3.103653e+000; foe(n+1)=6.932816e+000; krok(n+1)=1.438760e-005; ng(n+1)=2.610844e+002;
n=53; farx(n+1)=3.105489e+000; foe(n+1)=6.919182e+000; krok(n+1)=4.621295e-005; ng(n+1)=6.947423e+001;
n=54; farx(n+1)=3.117559e+000; foe(n+1)=6.849617e+000; krok(n+1)=1.802468e-004; ng(n+1)=7.555206e+001;
n=55; farx(n+1)=3.185543e+000; foe(n+1)=6.640603e+000; krok(n+1)=1.002892e-003; ng(n+1)=1.082407e+002;
n=56; farx(n+1)=3.151381e+000; foe(n+1)=6.580144e+000; krok(n+1)=1.223482e-003; ng(n+1)=1.169916e+002;
n=57; farx(n+1)=3.078176e+000; foe(n+1)=6.315277e+000; krok(n+1)=3.349706e-003; ng(n+1)=1.716325e+002;
n=58; farx(n+1)=3.000896e+000; foe(n+1)=6.151954e+000; krok(n+1)=1.423801e-002; ng(n+1)=1.590509e+002;
n=59; farx(n+1)=2.939955e+000; foe(n+1)=6.020033e+000; krok(n+1)=8.894860e-003; ng(n+1)=1.564878e+002;
n=60; farx(n+1)=2.918094e+000; foe(n+1)=5.967043e+000; krok(n+1)=5.946996e-003; ng(n+1)=2.539236e+002;
n=61; farx(n+1)=2.810674e+000; foe(n+1)=5.855572e+000; krok(n+1)=2.598758e-002; ng(n+1)=3.288308e+002;
n=62; farx(n+1)=2.780858e+000; foe(n+1)=5.795775e+000; krok(n+1)=9.335866e-003; ng(n+1)=4.458846e+002;
n=63; farx(n+1)=2.683156e+000; foe(n+1)=5.686159e+000; krok(n+1)=3.897540e-002; ng(n+1)=3.840362e+002;
n=64; farx(n+1)=2.675905e+000; foe(n+1)=5.523286e+000; krok(n+1)=8.097460e-002; ng(n+1)=3.104772e+002;
n=65; farx(n+1)=2.567949e+000; foe(n+1)=4.979965e+000; krok(n+1)=9.809225e-002; ng(n+1)=3.253588e+002;
n=66; farx(n+1)=2.519692e+000; foe(n+1)=4.870691e+000; krok(n+1)=6.003917e-002; ng(n+1)=2.423781e+002;
n=67; farx(n+1)=2.452500e+000; foe(n+1)=4.658487e+000; krok(n+1)=1.961666e-002; ng(n+1)=4.282580e+002;
n=68; farx(n+1)=2.416763e+000; foe(n+1)=4.415446e+000; krok(n+1)=1.237945e-001; ng(n+1)=1.175785e+002;
n=69; farx(n+1)=2.291540e+000; foe(n+1)=4.144005e+000; krok(n+1)=1.584655e-001; ng(n+1)=1.185386e+002;
n=70; farx(n+1)=2.276195e+000; foe(n+1)=4.075086e+000; krok(n+1)=5.570844e-002; ng(n+1)=1.158373e+002;
n=71; farx(n+1)=2.190280e+000; foe(n+1)=3.905126e+000; krok(n+1)=1.809599e-001; ng(n+1)=1.489075e+002;
n=72; farx(n+1)=2.149314e+000; foe(n+1)=3.761167e+000; krok(n+1)=1.686145e-001; ng(n+1)=3.103048e+002;
n=73; farx(n+1)=2.052262e+000; foe(n+1)=3.572956e+000; krok(n+1)=8.551844e-001; ng(n+1)=1.036631e+002;
n=74; farx(n+1)=2.017883e+000; foe(n+1)=3.438603e+000; krok(n+1)=4.536903e-001; ng(n+1)=2.871095e+002;
n=75; farx(n+1)=1.892100e+000; foe(n+1)=3.277721e+000; krok(n+1)=8.922169e-001; ng(n+1)=1.617366e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.892734e+000; foe(n+1)=3.268582e+000; krok(n+1)=7.821846e-006; ng(n+1)=1.258288e+002;
n=77; farx(n+1)=1.892378e+000; foe(n+1)=3.259342e+000; krok(n+1)=2.230894e-005; ng(n+1)=6.119061e+001;
n=78; farx(n+1)=1.889166e+000; foe(n+1)=3.254844e+000; krok(n+1)=4.933474e-005; ng(n+1)=3.379608e+001;
n=79; farx(n+1)=1.902030e+000; foe(n+1)=3.222953e+000; krok(n+1)=2.383354e-003; ng(n+1)=1.402455e+001;
n=80; farx(n+1)=1.910315e+000; foe(n+1)=3.195729e+000; krok(n+1)=5.362933e-004; ng(n+1)=2.439669e+001;
n=81; farx(n+1)=1.870025e+000; foe(n+1)=3.146288e+000; krok(n+1)=1.058808e-002; ng(n+1)=1.623085e+001;
n=82; farx(n+1)=1.802841e+000; foe(n+1)=3.039306e+000; krok(n+1)=8.300976e-003; ng(n+1)=1.791714e+001;
n=83; farx(n+1)=1.731098e+000; foe(n+1)=2.973517e+000; krok(n+1)=2.398987e-002; ng(n+1)=1.051863e+002;
n=84; farx(n+1)=1.646352e+000; foe(n+1)=2.910509e+000; krok(n+1)=1.417782e-002; ng(n+1)=1.333938e+002;
n=85; farx(n+1)=1.631386e+000; foe(n+1)=2.883982e+000; krok(n+1)=1.854407e-002; ng(n+1)=1.350961e+002;
n=86; farx(n+1)=1.546152e+000; foe(n+1)=2.780864e+000; krok(n+1)=6.813219e-002; ng(n+1)=1.033187e+002;
n=87; farx(n+1)=1.497065e+000; foe(n+1)=2.739293e+000; krok(n+1)=7.883344e-003; ng(n+1)=2.111006e+002;
n=88; farx(n+1)=1.453373e+000; foe(n+1)=2.691199e+000; krok(n+1)=1.477175e-002; ng(n+1)=2.051514e+002;
n=89; farx(n+1)=1.412238e+000; foe(n+1)=2.636668e+000; krok(n+1)=6.385486e-002; ng(n+1)=1.153627e+002;
n=90; farx(n+1)=1.383680e+000; foe(n+1)=2.609034e+000; krok(n+1)=2.067140e-002; ng(n+1)=1.334883e+002;
n=91; farx(n+1)=1.366333e+000; foe(n+1)=2.590116e+000; krok(n+1)=1.432736e-002; ng(n+1)=6.562361e+001;
n=92; farx(n+1)=1.293684e+000; foe(n+1)=2.532754e+000; krok(n+1)=4.194258e-002; ng(n+1)=1.763093e+002;
n=93; farx(n+1)=1.280850e+000; foe(n+1)=2.504248e+000; krok(n+1)=7.923274e-002; ng(n+1)=1.248085e+002;
n=94; farx(n+1)=1.192388e+000; foe(n+1)=2.292893e+000; krok(n+1)=3.963116e-001; ng(n+1)=2.475209e+002;
n=95; farx(n+1)=1.157384e+000; foe(n+1)=2.248073e+000; krok(n+1)=7.224063e-002; ng(n+1)=1.445698e+002;
n=96; farx(n+1)=1.124756e+000; foe(n+1)=2.155451e+000; krok(n+1)=3.903951e-001; ng(n+1)=1.878212e+002;
n=97; farx(n+1)=1.086523e+000; foe(n+1)=2.033623e+000; krok(n+1)=5.930463e-001; ng(n+1)=1.181229e+002;
n=98; farx(n+1)=1.091829e+000; foe(n+1)=1.965370e+000; krok(n+1)=2.554195e-001; ng(n+1)=2.995160e+002;
n=99; farx(n+1)=1.118800e+000; foe(n+1)=1.856073e+000; krok(n+1)=2.935451e-001; ng(n+1)=1.762250e+002;
n=100; farx(n+1)=1.123720e+000; foe(n+1)=1.801700e+000; krok(n+1)=1.690558e-001; ng(n+1)=2.761349e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
