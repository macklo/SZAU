%uczenie predyktora oe
clear all;
n=0; farx(n+1)=4.046654e+003; foe(n+1)=4.050884e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.915423e+003; foe(n+1)=2.979641e+003; krok(n+1)=5.011162e-004; ng(n+1)=2.451402e+003;
n=2; farx(n+1)=9.046164e+002; foe(n+1)=9.097805e+002; krok(n+1)=4.679447e-003; ng(n+1)=1.039780e+003;
n=3; farx(n+1)=9.439152e+002; foe(n+1)=7.967066e+002; krok(n+1)=6.975159e-005; ng(n+1)=4.750857e+003;
n=4; farx(n+1)=1.536995e+003; foe(n+1)=5.938670e+002; krok(n+1)=1.888129e-003; ng(n+1)=5.314538e+003;
n=5; farx(n+1)=1.212521e+003; foe(n+1)=5.300837e+002; krok(n+1)=7.119007e-003; ng(n+1)=9.842334e+002;
n=6; farx(n+1)=6.207395e+002; foe(n+1)=4.092485e+002; krok(n+1)=3.426502e-003; ng(n+1)=1.091640e+003;
n=7; farx(n+1)=5.057270e+002; foe(n+1)=3.661807e+002; krok(n+1)=1.204607e-003; ng(n+1)=1.263035e+003;
n=8; farx(n+1)=4.107304e+002; foe(n+1)=3.466284e+002; krok(n+1)=5.967206e-003; ng(n+1)=5.728862e+002;
n=9; farx(n+1)=3.937421e+002; foe(n+1)=3.367059e+002; krok(n+1)=5.172508e-003; ng(n+1)=2.068873e+002;
n=10; farx(n+1)=4.126701e+002; foe(n+1)=3.296238e+002; krok(n+1)=2.138537e-002; ng(n+1)=1.956939e+002;
n=11; farx(n+1)=3.814275e+002; foe(n+1)=3.254516e+002; krok(n+1)=1.846372e-002; ng(n+1)=2.316920e+002;
n=12; farx(n+1)=3.785428e+002; foe(n+1)=3.124528e+002; krok(n+1)=5.954236e-002; ng(n+1)=3.918382e+002;
n=13; farx(n+1)=3.598028e+002; foe(n+1)=3.083547e+002; krok(n+1)=5.003902e-002; ng(n+1)=1.587956e+002;
n=14; farx(n+1)=3.163983e+002; foe(n+1)=3.042874e+002; krok(n+1)=4.663645e-002; ng(n+1)=1.571027e+002;
n=15; farx(n+1)=2.767254e+002; foe(n+1)=2.989363e+002; krok(n+1)=1.453256e-001; ng(n+1)=3.094261e+002;
n=16; farx(n+1)=2.152284e+002; foe(n+1)=2.761708e+002; krok(n+1)=2.268451e-001; ng(n+1)=3.108345e+002;
n=17; farx(n+1)=2.059358e+002; foe(n+1)=2.748036e+002; krok(n+1)=1.209587e-002; ng(n+1)=4.718209e+002;
n=18; farx(n+1)=1.682471e+002; foe(n+1)=2.655773e+002; krok(n+1)=5.079872e-002; ng(n+1)=7.348414e+002;
n=19; farx(n+1)=8.456984e+001; foe(n+1)=2.040299e+002; krok(n+1)=2.601236e-001; ng(n+1)=1.297305e+003;
n=20; farx(n+1)=8.392845e+001; foe(n+1)=2.036832e+002; krok(n+1)=2.621411e-003; ng(n+1)=5.511151e+003;
n=21; farx(n+1)=8.403815e+001; foe(n+1)=2.018551e+002; krok(n+1)=2.914778e-003; ng(n+1)=4.119391e+003;
n=22; farx(n+1)=4.606397e+001; foe(n+1)=1.583189e+002; krok(n+1)=3.141433e-001; ng(n+1)=1.404546e+003;
n=23; farx(n+1)=3.988869e+001; foe(n+1)=1.490649e+002; krok(n+1)=3.001959e-002; ng(n+1)=1.144876e+003;
n=24; farx(n+1)=1.833893e+001; foe(n+1)=1.056385e+002; krok(n+1)=2.058095e-001; ng(n+1)=1.110853e+003;
n=25; farx(n+1)=1.599764e+001; foe(n+1)=9.801629e+001; krok(n+1)=1.348916e+000; ng(n+1)=4.771821e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.646416e+001; foe(n+1)=9.304664e+001; krok(n+1)=1.589768e-004; ng(n+1)=4.710461e+002;
n=27; farx(n+1)=1.669296e+001; foe(n+1)=9.214263e+001; krok(n+1)=5.873010e-005; ng(n+1)=3.619996e+002;
n=28; farx(n+1)=1.597685e+001; foe(n+1)=8.726643e+001; krok(n+1)=2.666638e-004; ng(n+1)=3.474609e+002;
n=29; farx(n+1)=1.346879e+001; foe(n+1)=8.158929e+001; krok(n+1)=1.495556e-003; ng(n+1)=2.219236e+002;
n=30; farx(n+1)=1.323452e+001; foe(n+1)=7.618609e+001; krok(n+1)=3.831728e-004; ng(n+1)=5.566261e+002;
n=31; farx(n+1)=1.273357e+001; foe(n+1)=7.361338e+001; krok(n+1)=1.229105e-003; ng(n+1)=4.449355e+002;
n=32; farx(n+1)=1.300913e+001; foe(n+1)=7.261490e+001; krok(n+1)=3.890421e-003; ng(n+1)=6.422523e+002;
n=33; farx(n+1)=1.306821e+001; foe(n+1)=7.206838e+001; krok(n+1)=3.490481e-003; ng(n+1)=8.525941e+002;
n=34; farx(n+1)=1.373983e+001; foe(n+1)=7.057590e+001; krok(n+1)=2.142359e-002; ng(n+1)=6.091275e+002;
n=35; farx(n+1)=1.484438e+001; foe(n+1)=6.956117e+001; krok(n+1)=1.406421e-002; ng(n+1)=6.073018e+002;
n=36; farx(n+1)=1.500497e+001; foe(n+1)=6.222538e+001; krok(n+1)=2.727111e-002; ng(n+1)=5.035219e+002;
n=37; farx(n+1)=1.512130e+001; foe(n+1)=5.893505e+001; krok(n+1)=1.505454e-002; ng(n+1)=1.746811e+003;
n=38; farx(n+1)=1.015307e+001; foe(n+1)=5.170002e+001; krok(n+1)=1.216335e-001; ng(n+1)=2.752013e+003;
n=39; farx(n+1)=9.558656e+000; foe(n+1)=4.865520e+001; krok(n+1)=1.625772e-002; ng(n+1)=3.171825e+003;
n=40; farx(n+1)=1.049261e+001; foe(n+1)=4.398840e+001; krok(n+1)=1.220399e-001; ng(n+1)=3.096822e+003;
n=41; farx(n+1)=6.804570e+000; foe(n+1)=3.107603e+001; krok(n+1)=2.223238e-001; ng(n+1)=1.996034e+003;
n=42; farx(n+1)=5.859052e+000; foe(n+1)=2.782806e+001; krok(n+1)=2.233908e-001; ng(n+1)=3.313454e+002;
n=43; farx(n+1)=4.898341e+000; foe(n+1)=2.308655e+001; krok(n+1)=3.743784e-001; ng(n+1)=3.635949e+002;
n=44; farx(n+1)=4.855613e+000; foe(n+1)=2.137003e+001; krok(n+1)=1.463429e-001; ng(n+1)=4.116546e+002;
n=45; farx(n+1)=4.809432e+000; foe(n+1)=2.090824e+001; krok(n+1)=3.031633e-001; ng(n+1)=3.135767e+002;
n=46; farx(n+1)=4.990514e+000; foe(n+1)=1.936037e+001; krok(n+1)=5.988308e-001; ng(n+1)=2.581889e+002;
n=47; farx(n+1)=4.571061e+000; foe(n+1)=1.720797e+001; krok(n+1)=6.305900e-001; ng(n+1)=1.482025e+002;
n=48; farx(n+1)=3.863368e+000; foe(n+1)=1.344956e+001; krok(n+1)=7.310195e-001; ng(n+1)=6.118936e+002;
n=49; farx(n+1)=3.720016e+000; foe(n+1)=1.192045e+001; krok(n+1)=3.505976e-001; ng(n+1)=5.682136e+002;
n=50; farx(n+1)=3.881208e+000; foe(n+1)=1.118128e+001; krok(n+1)=5.520515e-001; ng(n+1)=6.345652e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=3.833971e+000; foe(n+1)=1.092769e+001; krok(n+1)=8.191911e-005; ng(n+1)=1.541119e+002;
n=52; farx(n+1)=3.839961e+000; foe(n+1)=1.088983e+001; krok(n+1)=1.171380e-005; ng(n+1)=1.851550e+002;
n=53; farx(n+1)=3.830213e+000; foe(n+1)=1.077826e+001; krok(n+1)=1.582138e-004; ng(n+1)=8.316393e+001;
n=54; farx(n+1)=3.623473e+000; foe(n+1)=1.013160e+001; krok(n+1)=3.270787e-004; ng(n+1)=1.401732e+002;
n=55; farx(n+1)=3.599187e+000; foe(n+1)=1.006859e+001; krok(n+1)=7.839040e-004; ng(n+1)=6.802566e+001;
n=56; farx(n+1)=3.566021e+000; foe(n+1)=9.522079e+000; krok(n+1)=8.966852e-003; ng(n+1)=5.385233e+001;
n=57; farx(n+1)=3.545327e+000; foe(n+1)=9.359735e+000; krok(n+1)=6.699412e-003; ng(n+1)=4.040639e+002;
n=58; farx(n+1)=3.373220e+000; foe(n+1)=8.649583e+000; krok(n+1)=6.073322e-002; ng(n+1)=5.298458e+002;
n=59; farx(n+1)=3.345554e+000; foe(n+1)=8.358425e+000; krok(n+1)=6.130766e-003; ng(n+1)=5.924247e+002;
n=60; farx(n+1)=3.345941e+000; foe(n+1)=8.321595e+000; krok(n+1)=6.271232e-003; ng(n+1)=3.711369e+002;
n=61; farx(n+1)=3.330604e+000; foe(n+1)=8.212663e+000; krok(n+1)=1.214360e-002; ng(n+1)=3.473089e+002;
n=62; farx(n+1)=3.456479e+000; foe(n+1)=8.025484e+000; krok(n+1)=4.161404e-002; ng(n+1)=4.548992e+002;
n=63; farx(n+1)=3.609401e+000; foe(n+1)=7.454789e+000; krok(n+1)=1.824037e-001; ng(n+1)=3.422072e+002;
n=64; farx(n+1)=3.334093e+000; foe(n+1)=6.896926e+000; krok(n+1)=7.414397e-002; ng(n+1)=2.598929e+002;
n=65; farx(n+1)=3.242521e+000; foe(n+1)=6.739312e+000; krok(n+1)=1.269153e-001; ng(n+1)=2.936635e+002;
n=66; farx(n+1)=2.724508e+000; foe(n+1)=6.005544e+000; krok(n+1)=8.922169e-001; ng(n+1)=2.259687e+002;
n=67; farx(n+1)=2.586820e+000; foe(n+1)=5.690226e+000; krok(n+1)=4.865340e-001; ng(n+1)=1.445937e+002;
n=68; farx(n+1)=2.257211e+000; foe(n+1)=5.009852e+000; krok(n+1)=9.453922e-001; ng(n+1)=3.113402e+002;
n=69; farx(n+1)=2.216973e+000; foe(n+1)=4.857346e+000; krok(n+1)=2.292046e-001; ng(n+1)=3.470374e+002;
n=70; farx(n+1)=2.147120e+000; foe(n+1)=4.690432e+000; krok(n+1)=3.465039e-001; ng(n+1)=3.353115e+002;
n=71; farx(n+1)=2.087434e+000; foe(n+1)=4.543676e+000; krok(n+1)=7.832156e-001; ng(n+1)=1.279945e+002;
n=72; farx(n+1)=1.974502e+000; foe(n+1)=4.415834e+000; krok(n+1)=7.734497e-001; ng(n+1)=5.426418e+001;
n=73; farx(n+1)=1.880205e+000; foe(n+1)=4.333981e+000; krok(n+1)=5.030381e-001; ng(n+1)=1.259330e+002;
n=74; farx(n+1)=1.785998e+000; foe(n+1)=4.210677e+000; krok(n+1)=9.512526e-001; ng(n+1)=1.935527e+002;
n=75; farx(n+1)=1.694551e+000; foe(n+1)=4.083964e+000; krok(n+1)=8.008859e-001; ng(n+1)=1.142137e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.695131e+000; foe(n+1)=4.070851e+000; krok(n+1)=5.705403e-006; ng(n+1)=1.544569e+002;
n=77; farx(n+1)=1.695480e+000; foe(n+1)=4.051438e+000; krok(n+1)=3.039896e-005; ng(n+1)=6.850492e+001;
n=78; farx(n+1)=1.695744e+000; foe(n+1)=4.037145e+000; krok(n+1)=3.400119e-005; ng(n+1)=6.510465e+001;
n=79; farx(n+1)=1.687258e+000; foe(n+1)=3.995038e+000; krok(n+1)=5.934596e-004; ng(n+1)=2.626215e+001;
n=80; farx(n+1)=1.666242e+000; foe(n+1)=3.906068e+000; krok(n+1)=3.891067e-003; ng(n+1)=1.921671e+001;
n=81; farx(n+1)=1.614441e+000; foe(n+1)=3.761687e+000; krok(n+1)=1.046652e-002; ng(n+1)=6.642671e+001;
n=82; farx(n+1)=1.587672e+000; foe(n+1)=3.709445e+000; krok(n+1)=1.586441e-002; ng(n+1)=3.048816e+002;
n=83; farx(n+1)=1.560885e+000; foe(n+1)=3.660179e+000; krok(n+1)=7.772060e-003; ng(n+1)=2.594051e+002;
n=84; farx(n+1)=1.480713e+000; foe(n+1)=3.443940e+000; krok(n+1)=1.218112e-001; ng(n+1)=1.462697e+002;
n=85; farx(n+1)=1.464448e+000; foe(n+1)=3.337608e+000; krok(n+1)=1.650423e-002; ng(n+1)=5.907131e+002;
n=86; farx(n+1)=1.470325e+000; foe(n+1)=3.246495e+000; krok(n+1)=1.350413e-002; ng(n+1)=8.567990e+002;
n=87; farx(n+1)=1.478594e+000; foe(n+1)=3.221388e+000; krok(n+1)=1.136199e-002; ng(n+1)=8.728551e+002;
n=88; farx(n+1)=1.493830e+000; foe(n+1)=3.135574e+000; krok(n+1)=7.780615e-002; ng(n+1)=8.873341e+002;
n=89; farx(n+1)=1.549439e+000; foe(n+1)=2.768367e+000; krok(n+1)=2.155114e-001; ng(n+1)=8.889775e+002;
n=90; farx(n+1)=1.580441e+000; foe(n+1)=2.676828e+000; krok(n+1)=4.446078e-002; ng(n+1)=2.651826e+002;
n=91; farx(n+1)=1.571870e+000; foe(n+1)=2.575700e+000; krok(n+1)=3.963765e-001; ng(n+1)=1.720266e+002;
n=92; farx(n+1)=1.495775e+000; foe(n+1)=2.291466e+000; krok(n+1)=3.224739e-001; ng(n+1)=1.646024e+002;
n=93; farx(n+1)=1.352179e+000; foe(n+1)=2.035812e+000; krok(n+1)=4.810883e-001; ng(n+1)=1.347120e+002;
n=94; farx(n+1)=1.325808e+000; foe(n+1)=1.902403e+000; krok(n+1)=4.567804e-001; ng(n+1)=4.782991e+002;
n=95; farx(n+1)=1.351957e+000; foe(n+1)=1.846307e+000; krok(n+1)=2.340680e-001; ng(n+1)=8.075613e+001;
n=96; farx(n+1)=1.388776e+000; foe(n+1)=1.772483e+000; krok(n+1)=3.276650e-001; ng(n+1)=1.239443e+002;
n=97; farx(n+1)=1.395302e+000; foe(n+1)=1.749688e+000; krok(n+1)=9.137743e-002; ng(n+1)=2.642062e+002;
n=98; farx(n+1)=1.378444e+000; foe(n+1)=1.691641e+000; krok(n+1)=4.268310e-001; ng(n+1)=3.448412e+002;
n=99; farx(n+1)=1.382181e+000; foe(n+1)=1.670766e+000; krok(n+1)=5.667570e-001; ng(n+1)=2.048400e+002;
n=100; farx(n+1)=1.363246e+000; foe(n+1)=1.654694e+000; krok(n+1)=7.011953e-001; ng(n+1)=3.378396e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
