%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.872765e+003; foe(n+1)=4.846389e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.812761e+003; foe(n+1)=3.798252e+003; krok(n+1)=3.369218e-004; ng(n+1)=1.227930e+004;
n=2; farx(n+1)=1.218826e+003; foe(n+1)=1.126511e+004; krok(n+1)=1.997041e-004; ng(n+1)=1.180317e+004;
n=3; farx(n+1)=4.964389e+002; foe(n+1)=1.448033e+004; krok(n+1)=2.770473e-004; ng(n+1)=7.072420e+003;
n=4; farx(n+1)=3.541389e+002; foe(n+1)=1.307860e+004; krok(n+1)=2.513970e-003; ng(n+1)=4.885882e+003;
n=5; farx(n+1)=2.534782e+002; foe(n+1)=1.119569e+004; krok(n+1)=1.561071e-003; ng(n+1)=3.622899e+003;
n=6; farx(n+1)=1.652936e+002; foe(n+1)=1.129060e+004; krok(n+1)=2.090702e-003; ng(n+1)=1.496296e+003;
n=7; farx(n+1)=1.226726e+002; foe(n+1)=1.318638e+004; krok(n+1)=1.812955e-003; ng(n+1)=1.056480e+003;
n=8; farx(n+1)=8.872149e+001; foe(n+1)=1.163144e+004; krok(n+1)=9.382450e-004; ng(n+1)=2.112573e+003;
n=9; farx(n+1)=2.751075e+001; foe(n+1)=5.043443e+003; krok(n+1)=2.827499e-003; ng(n+1)=1.722009e+003;
n=10; farx(n+1)=2.233717e+001; foe(n+1)=4.374133e+003; krok(n+1)=1.667309e-003; ng(n+1)=5.328122e+002;
n=11; farx(n+1)=1.025196e+001; foe(n+1)=1.957912e+003; krok(n+1)=4.312903e-003; ng(n+1)=8.015271e+002;
n=12; farx(n+1)=6.176449e+000; foe(n+1)=5.939877e+002; krok(n+1)=6.047937e-003; ng(n+1)=3.835657e+002;
n=13; farx(n+1)=5.214352e+000; foe(n+1)=3.535780e+002; krok(n+1)=3.411474e-003; ng(n+1)=1.758080e+002;
n=14; farx(n+1)=4.054869e+000; foe(n+1)=2.261702e+002; krok(n+1)=1.776017e-002; ng(n+1)=1.561682e+002;
n=15; farx(n+1)=2.484151e+000; foe(n+1)=9.735089e+001; krok(n+1)=3.482091e-002; ng(n+1)=1.142091e+002;
n=16; farx(n+1)=2.322010e+000; foe(n+1)=9.548365e+001; krok(n+1)=6.700076e-003; ng(n+1)=1.522308e+002;
n=17; farx(n+1)=1.828172e+000; foe(n+1)=7.744091e+001; krok(n+1)=1.495694e-001; ng(n+1)=6.478145e+001;
n=18; farx(n+1)=1.533445e+000; foe(n+1)=9.064433e+001; krok(n+1)=5.908701e-002; ng(n+1)=1.175623e+002;
n=19; farx(n+1)=1.114563e+000; foe(n+1)=1.370104e+002; krok(n+1)=3.477470e-001; ng(n+1)=9.286751e+001;
n=20; farx(n+1)=1.005119e+000; foe(n+1)=1.492196e+002; krok(n+1)=5.213103e-002; ng(n+1)=1.883903e+002;
n=21; farx(n+1)=8.094414e-001; foe(n+1)=8.013316e+001; krok(n+1)=1.269153e-001; ng(n+1)=1.306050e+002;
n=22; farx(n+1)=6.736828e-001; foe(n+1)=7.692400e+001; krok(n+1)=1.400181e-001; ng(n+1)=8.227628e+001;
n=23; farx(n+1)=6.371453e-001; foe(n+1)=6.732559e+001; krok(n+1)=2.114117e-001; ng(n+1)=8.571624e+001;
n=24; farx(n+1)=6.170785e-001; foe(n+1)=5.782410e+001; krok(n+1)=1.295863e-001; ng(n+1)=4.265199e+001;
n=25; farx(n+1)=5.720607e-001; foe(n+1)=5.517516e+001; krok(n+1)=4.915350e-001; ng(n+1)=2.361760e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.704018e-001; foe(n+1)=5.696283e+001; krok(n+1)=8.669030e-005; ng(n+1)=1.734012e+001;
n=27; farx(n+1)=5.699193e-001; foe(n+1)=5.746575e+001; krok(n+1)=1.333319e-004; ng(n+1)=7.889510e+000;
n=28; farx(n+1)=5.650973e-001; foe(n+1)=6.018598e+001; krok(n+1)=4.014511e-003; ng(n+1)=5.064741e+000;
n=29; farx(n+1)=5.598798e-001; foe(n+1)=6.648571e+001; krok(n+1)=5.137451e-003; ng(n+1)=4.394935e+000;
n=30; farx(n+1)=5.536888e-001; foe(n+1)=6.549935e+001; krok(n+1)=9.231023e-003; ng(n+1)=3.623329e+000;
n=31; farx(n+1)=5.258174e-001; foe(n+1)=6.470749e+001; krok(n+1)=1.506743e-001; ng(n+1)=3.107820e+000;
n=32; farx(n+1)=5.114744e-001; foe(n+1)=6.299351e+001; krok(n+1)=1.619492e-001; ng(n+1)=2.047457e+001;
n=33; farx(n+1)=5.015034e-001; foe(n+1)=5.258681e+001; krok(n+1)=5.286105e-002; ng(n+1)=3.893428e+001;
n=34; farx(n+1)=4.724128e-001; foe(n+1)=4.350968e+001; krok(n+1)=6.269998e-002; ng(n+1)=3.925663e+001;
n=35; farx(n+1)=4.668394e-001; foe(n+1)=4.025555e+001; krok(n+1)=6.690246e-002; ng(n+1)=1.455515e+001;
n=36; farx(n+1)=4.612663e-001; foe(n+1)=3.563339e+001; krok(n+1)=3.230410e-002; ng(n+1)=2.062305e+001;
n=37; farx(n+1)=4.518381e-001; foe(n+1)=3.601440e+001; krok(n+1)=1.465272e-001; ng(n+1)=1.022402e+001;
n=38; farx(n+1)=4.434203e-001; foe(n+1)=3.259469e+001; krok(n+1)=1.701816e-001; ng(n+1)=2.313850e+001;
n=39; farx(n+1)=4.281364e-001; foe(n+1)=2.605255e+001; krok(n+1)=2.301315e-001; ng(n+1)=2.186269e+001;
n=40; farx(n+1)=4.041442e-001; foe(n+1)=1.984485e+001; krok(n+1)=3.711420e-001; ng(n+1)=6.054173e+000;
n=41; farx(n+1)=3.969700e-001; foe(n+1)=1.856381e+001; krok(n+1)=1.096481e-001; ng(n+1)=1.485718e+001;
n=42; farx(n+1)=3.849370e-001; foe(n+1)=1.781482e+001; krok(n+1)=7.301859e-002; ng(n+1)=2.262205e+001;
n=43; farx(n+1)=3.740229e-001; foe(n+1)=1.578190e+001; krok(n+1)=1.732520e-001; ng(n+1)=6.588719e+000;
n=44; farx(n+1)=3.624350e-001; foe(n+1)=1.377231e+001; krok(n+1)=8.973423e-002; ng(n+1)=3.359146e+001;
n=45; farx(n+1)=3.482764e-001; foe(n+1)=1.049976e+001; krok(n+1)=1.981558e-001; ng(n+1)=1.105055e+001;
n=46; farx(n+1)=3.271798e-001; foe(n+1)=8.857496e+000; krok(n+1)=2.496347e-001; ng(n+1)=2.214296e+001;
n=47; farx(n+1)=3.200634e-001; foe(n+1)=1.018903e+001; krok(n+1)=1.686145e-001; ng(n+1)=8.675045e+000;
n=48; farx(n+1)=3.108346e-001; foe(n+1)=9.429363e+000; krok(n+1)=2.498965e-001; ng(n+1)=9.030134e+000;
n=49; farx(n+1)=3.056860e-001; foe(n+1)=7.643843e+000; krok(n+1)=5.801457e-002; ng(n+1)=1.403406e+001;
n=50; farx(n+1)=2.979634e-001; foe(n+1)=7.017157e+000; krok(n+1)=3.310405e-001; ng(n+1)=1.457973e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.974322e-001; foe(n+1)=7.016563e+000; krok(n+1)=6.503398e-005; ng(n+1)=1.096973e+001;
n=52; farx(n+1)=2.973575e-001; foe(n+1)=7.086401e+000; krok(n+1)=1.963632e-004; ng(n+1)=2.637173e+000;
n=53; farx(n+1)=2.969498e-001; foe(n+1)=7.219831e+000; krok(n+1)=1.303603e-003; ng(n+1)=2.345594e+000;
n=54; farx(n+1)=2.961011e-001; foe(n+1)=8.120119e+000; krok(n+1)=3.032635e-003; ng(n+1)=2.284243e+000;
n=55; farx(n+1)=2.950095e-001; foe(n+1)=7.840971e+000; krok(n+1)=5.219470e-003; ng(n+1)=1.988599e+000;
n=56; farx(n+1)=2.925595e-001; foe(n+1)=8.751094e+000; krok(n+1)=7.863442e-002; ng(n+1)=8.187902e-001;
n=57; farx(n+1)=2.899366e-001; foe(n+1)=7.476537e+000; krok(n+1)=3.826493e-002; ng(n+1)=2.723669e+000;
n=58; farx(n+1)=2.875869e-001; foe(n+1)=7.151470e+000; krok(n+1)=1.540084e-001; ng(n+1)=1.088772e+001;
n=59; farx(n+1)=2.841431e-001; foe(n+1)=5.887581e+000; krok(n+1)=1.611570e-001; ng(n+1)=1.336529e+001;
n=60; farx(n+1)=2.807692e-001; foe(n+1)=5.879427e+000; krok(n+1)=1.428513e-001; ng(n+1)=1.859394e+001;
n=61; farx(n+1)=2.792379e-001; foe(n+1)=6.734117e+000; krok(n+1)=9.373676e-002; ng(n+1)=1.349851e+001;
n=62; farx(n+1)=2.724905e-001; foe(n+1)=6.636233e+000; krok(n+1)=7.847380e-001; ng(n+1)=9.566665e+000;
n=63; farx(n+1)=2.687901e-001; foe(n+1)=9.121545e+000; krok(n+1)=2.893371e-001; ng(n+1)=1.264402e+001;
n=64; farx(n+1)=2.671237e-001; foe(n+1)=7.346578e+000; krok(n+1)=6.561970e-002; ng(n+1)=1.261669e+001;
n=65; farx(n+1)=2.647042e-001; foe(n+1)=5.377117e+000; krok(n+1)=8.097460e-002; ng(n+1)=8.401929e+000;
n=66; farx(n+1)=2.626201e-001; foe(n+1)=5.050130e+000; krok(n+1)=8.589342e-002; ng(n+1)=1.297044e+001;
n=67; farx(n+1)=2.586270e-001; foe(n+1)=5.141680e+000; krok(n+1)=5.899217e-001; ng(n+1)=6.696256e+000;
n=68; farx(n+1)=2.573356e-001; foe(n+1)=4.875309e+000; krok(n+1)=1.845727e-001; ng(n+1)=5.581402e+000;
n=69; farx(n+1)=2.538042e-001; foe(n+1)=5.234835e+000; krok(n+1)=2.836964e-001; ng(n+1)=1.416288e+001;
n=70; farx(n+1)=2.515606e-001; foe(n+1)=4.606604e+000; krok(n+1)=5.076342e-001; ng(n+1)=2.271048e+000;
n=71; farx(n+1)=2.500457e-001; foe(n+1)=4.465467e+000; krok(n+1)=2.224108e-001; ng(n+1)=9.930678e+000;
n=72; farx(n+1)=2.489901e-001; foe(n+1)=3.943713e+000; krok(n+1)=2.464282e-001; ng(n+1)=7.711387e+000;
n=73; farx(n+1)=2.478875e-001; foe(n+1)=3.819193e+000; krok(n+1)=4.735540e-001; ng(n+1)=4.486181e+000;
n=74; farx(n+1)=2.469332e-001; foe(n+1)=3.526864e+000; krok(n+1)=5.690454e-001; ng(n+1)=4.328932e+000;
n=75; farx(n+1)=2.464658e-001; foe(n+1)=3.632670e+000; krok(n+1)=6.163806e-001; ng(n+1)=2.269719e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.464265e-001; foe(n+1)=3.601209e+000; krok(n+1)=1.019782e-004; ng(n+1)=2.747678e+000;
n=77; farx(n+1)=2.464250e-001; foe(n+1)=3.596679e+000; krok(n+1)=7.844920e-005; ng(n+1)=5.600580e-001;
n=78; farx(n+1)=2.464167e-001; foe(n+1)=3.573174e+000; krok(n+1)=3.835857e-003; ng(n+1)=2.238500e-001;
n=79; farx(n+1)=2.464033e-001; foe(n+1)=3.557309e+000; krok(n+1)=3.855507e-003; ng(n+1)=2.392854e-001;
n=80; farx(n+1)=2.463892e-001; foe(n+1)=3.564059e+000; krok(n+1)=3.452691e-003; ng(n+1)=2.775708e-001;
n=81; farx(n+1)=2.462945e-001; foe(n+1)=3.549632e+000; krok(n+1)=9.716385e-002; ng(n+1)=1.485646e-001;
n=82; farx(n+1)=2.459633e-001; foe(n+1)=3.390297e+000; krok(n+1)=1.794664e-001; ng(n+1)=2.131827e-001;
n=83; farx(n+1)=2.454703e-001; foe(n+1)=3.387545e+000; krok(n+1)=1.630613e-001; ng(n+1)=7.433746e-001;
n=84; farx(n+1)=2.450093e-001; foe(n+1)=3.709903e+000; krok(n+1)=6.690246e-002; ng(n+1)=1.381492e+000;
n=85; farx(n+1)=2.441815e-001; foe(n+1)=3.465269e+000; krok(n+1)=1.027628e-001; ng(n+1)=3.053121e+000;
n=86; farx(n+1)=2.433651e-001; foe(n+1)=3.317743e+000; krok(n+1)=4.079802e-001; ng(n+1)=8.651448e+000;
n=87; farx(n+1)=2.427377e-001; foe(n+1)=3.224446e+000; krok(n+1)=1.221144e-001; ng(n+1)=6.741767e+000;
n=88; farx(n+1)=2.424152e-001; foe(n+1)=3.206759e+000; krok(n+1)=2.193298e-001; ng(n+1)=5.496432e+000;
n=89; farx(n+1)=2.414249e-001; foe(n+1)=3.074086e+000; krok(n+1)=3.505976e-001; ng(n+1)=8.264166e+000;
n=90; farx(n+1)=2.406576e-001; foe(n+1)=3.067162e+000; krok(n+1)=1.015323e+000; ng(n+1)=3.130188e+000;
n=91; farx(n+1)=2.402173e-001; foe(n+1)=2.882843e+000; krok(n+1)=7.382907e-001; ng(n+1)=2.252001e+000;
n=92; farx(n+1)=2.400828e-001; foe(n+1)=2.876964e+000; krok(n+1)=2.393567e-001; ng(n+1)=3.450164e+000;
n=93; farx(n+1)=2.398547e-001; foe(n+1)=2.854255e+000; krok(n+1)=3.550835e-001; ng(n+1)=2.062941e+000;
n=94; farx(n+1)=2.395402e-001; foe(n+1)=2.809427e+000; krok(n+1)=5.005775e-001; ng(n+1)=3.183413e+000;
n=95; farx(n+1)=2.388649e-001; foe(n+1)=2.731589e+000; krok(n+1)=8.559000e-001; ng(n+1)=2.668066e+000;
n=96; farx(n+1)=2.380921e-001; foe(n+1)=2.848530e+000; krok(n+1)=7.289469e-001; ng(n+1)=5.743480e+000;
n=97; farx(n+1)=2.372244e-001; foe(n+1)=2.892835e+000; krok(n+1)=5.970321e-001; ng(n+1)=4.850135e+000;
n=98; farx(n+1)=2.364576e-001; foe(n+1)=2.900656e+000; krok(n+1)=6.564205e-001; ng(n+1)=2.861681e+000;
n=99; farx(n+1)=2.359819e-001; foe(n+1)=2.880517e+000; krok(n+1)=2.910883e-001; ng(n+1)=5.037911e+000;
n=100; farx(n+1)=2.355291e-001; foe(n+1)=2.754653e+000; krok(n+1)=4.884576e-001; ng(n+1)=3.430847e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
