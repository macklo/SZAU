%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.233191e+003; foe(n+1)=4.253875e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.860802e+003; foe(n+1)=3.072593e+003; krok(n+1)=5.266656e-004; ng(n+1)=2.322940e+003;
n=2; farx(n+1)=1.264226e+003; foe(n+1)=8.083896e+003; krok(n+1)=1.797903e-003; ng(n+1)=1.733536e+003;
n=3; farx(n+1)=9.595510e+002; foe(n+1)=1.093715e+004; krok(n+1)=4.129769e-004; ng(n+1)=2.625313e+003;
n=4; farx(n+1)=9.146693e+002; foe(n+1)=9.501352e+003; krok(n+1)=4.375565e-003; ng(n+1)=2.157982e+003;
n=5; farx(n+1)=8.766470e+002; foe(n+1)=1.009452e+004; krok(n+1)=9.385969e-003; ng(n+1)=1.665392e+003;
n=6; farx(n+1)=2.696807e+002; foe(n+1)=6.722401e+003; krok(n+1)=1.561580e+000; ng(n+1)=1.689614e+003;
n=7; farx(n+1)=1.238145e+002; foe(n+1)=2.609714e+003; krok(n+1)=8.773192e-001; ng(n+1)=5.285447e+002;
n=8; farx(n+1)=9.834362e+001; foe(n+1)=4.707442e+002; krok(n+1)=1.428513e-001; ng(n+1)=6.901959e+002;
n=9; farx(n+1)=5.270656e+001; foe(n+1)=2.357290e+003; krok(n+1)=3.091015e-001; ng(n+1)=6.552022e+002;
n=10; farx(n+1)=2.920140e+001; foe(n+1)=9.244077e+003; krok(n+1)=7.273018e-001; ng(n+1)=4.023471e+002;
n=11; farx(n+1)=1.603413e+001; foe(n+1)=6.274086e+002; krok(n+1)=1.722419e+000; ng(n+1)=1.181120e+002;
n=12; farx(n+1)=1.166430e+001; foe(n+1)=2.151643e+002; krok(n+1)=2.393567e-001; ng(n+1)=2.968900e+002;
n=13; farx(n+1)=9.158040e+000; foe(n+1)=4.270236e+002; krok(n+1)=4.641165e-001; ng(n+1)=2.231233e+002;
n=14; farx(n+1)=8.614555e+000; foe(n+1)=2.213435e+002; krok(n+1)=9.574267e-001; ng(n+1)=3.783404e+001;
n=15; farx(n+1)=8.103403e+000; foe(n+1)=2.561585e+002; krok(n+1)=2.645939e+000; ng(n+1)=2.477249e+001;
n=16; farx(n+1)=7.807371e+000; foe(n+1)=1.556596e+002; krok(n+1)=1.856466e+000; ng(n+1)=3.689015e+001;
n=17; farx(n+1)=7.332042e+000; foe(n+1)=1.703085e+002; krok(n+1)=3.252744e+000; ng(n+1)=3.285098e+001;
n=18; farx(n+1)=6.069146e+000; foe(n+1)=2.579949e+002; krok(n+1)=1.236644e+000; ng(n+1)=8.724745e+001;
n=19; farx(n+1)=5.561994e+000; foe(n+1)=1.762521e+002; krok(n+1)=5.030621e-001; ng(n+1)=1.078235e+002;
n=20; farx(n+1)=5.169947e+000; foe(n+1)=1.655666e+002; krok(n+1)=5.989693e-001; ng(n+1)=1.282996e+002;
n=21; farx(n+1)=4.619745e+000; foe(n+1)=1.479733e+002; krok(n+1)=1.371110e+000; ng(n+1)=6.328503e+001;
n=22; farx(n+1)=4.073811e+000; foe(n+1)=1.540905e+002; krok(n+1)=1.030870e+000; ng(n+1)=5.829493e+001;
n=23; farx(n+1)=3.913299e+000; foe(n+1)=1.926463e+002; krok(n+1)=4.881595e-001; ng(n+1)=5.508189e+001;
n=24; farx(n+1)=3.785015e+000; foe(n+1)=2.259297e+002; krok(n+1)=6.930078e-001; ng(n+1)=6.188281e+001;
n=25; farx(n+1)=3.680782e+000; foe(n+1)=1.909493e+002; krok(n+1)=7.271671e-001; ng(n+1)=1.676870e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.641422e+000; foe(n+1)=2.060911e+002; krok(n+1)=1.209505e-004; ng(n+1)=4.498109e+001;
n=27; farx(n+1)=3.620881e+000; foe(n+1)=1.946856e+002; krok(n+1)=9.487191e-005; ng(n+1)=3.442447e+001;
n=28; farx(n+1)=3.573145e+000; foe(n+1)=2.282405e+002; krok(n+1)=5.894618e-003; ng(n+1)=5.582114e+000;
n=29; farx(n+1)=3.406746e+000; foe(n+1)=1.493284e+002; krok(n+1)=8.929289e-003; ng(n+1)=9.900161e+000;
n=30; farx(n+1)=3.320815e+000; foe(n+1)=1.451924e+002; krok(n+1)=5.157588e-002; ng(n+1)=5.106287e+001;
n=31; farx(n+1)=3.229210e+000; foe(n+1)=1.410457e+002; krok(n+1)=7.807902e-001; ng(n+1)=1.046884e+002;
n=32; farx(n+1)=3.176378e+000; foe(n+1)=1.471477e+002; krok(n+1)=8.430727e-002; ng(n+1)=6.949335e+001;
n=33; farx(n+1)=3.131152e+000; foe(n+1)=1.639066e+002; krok(n+1)=3.307424e-001; ng(n+1)=3.575369e+001;
n=34; farx(n+1)=3.005557e+000; foe(n+1)=1.403222e+002; krok(n+1)=4.909897e-001; ng(n+1)=3.090634e+001;
n=35; farx(n+1)=2.963250e+000; foe(n+1)=1.310832e+002; krok(n+1)=3.903951e-001; ng(n+1)=1.862728e+001;
n=36; farx(n+1)=2.903338e+000; foe(n+1)=1.363856e+002; krok(n+1)=7.847380e-001; ng(n+1)=7.259042e+001;
n=37; farx(n+1)=2.841790e+000; foe(n+1)=1.355030e+002; krok(n+1)=1.927884e+000; ng(n+1)=5.151243e+001;
n=38; farx(n+1)=2.789066e+000; foe(n+1)=1.198631e+002; krok(n+1)=5.024146e-001; ng(n+1)=4.160370e+001;
n=39; farx(n+1)=2.770615e+000; foe(n+1)=1.242879e+002; krok(n+1)=8.356823e-001; ng(n+1)=2.955618e+001;
n=40; farx(n+1)=2.751899e+000; foe(n+1)=1.355092e+002; krok(n+1)=1.056325e+000; ng(n+1)=5.202253e+001;
n=41; farx(n+1)=2.722807e+000; foe(n+1)=1.238884e+002; krok(n+1)=9.397835e-001; ng(n+1)=4.241986e+000;
n=42; farx(n+1)=2.708519e+000; foe(n+1)=1.149363e+002; krok(n+1)=4.467816e-001; ng(n+1)=2.750563e+001;
n=43; farx(n+1)=2.692616e+000; foe(n+1)=1.194546e+002; krok(n+1)=1.422745e+000; ng(n+1)=3.678202e+001;
n=44; farx(n+1)=2.675352e+000; foe(n+1)=1.176064e+002; krok(n+1)=5.481842e-001; ng(n+1)=1.404158e+001;
n=45; farx(n+1)=2.668058e+000; foe(n+1)=1.169506e+002; krok(n+1)=8.256204e-001; ng(n+1)=1.712725e+001;
n=46; farx(n+1)=2.661814e+000; foe(n+1)=1.206604e+002; krok(n+1)=9.469203e-001; ng(n+1)=2.984445e+001;
n=47; farx(n+1)=2.649765e+000; foe(n+1)=1.162530e+002; krok(n+1)=1.104103e+000; ng(n+1)=8.395952e+000;
n=48; farx(n+1)=2.644612e+000; foe(n+1)=1.136852e+002; krok(n+1)=1.569476e+000; ng(n+1)=1.950982e+001;
n=49; farx(n+1)=2.637996e+000; foe(n+1)=1.128148e+002; krok(n+1)=1.371110e+000; ng(n+1)=8.251821e+000;
n=50; farx(n+1)=2.635528e+000; foe(n+1)=1.145713e+002; krok(n+1)=7.709580e-001; ng(n+1)=1.155800e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.634754e+000; foe(n+1)=1.154938e+002; krok(n+1)=1.470858e-005; ng(n+1)=1.471666e+001;
n=52; farx(n+1)=2.634335e+000; foe(n+1)=1.157352e+002; krok(n+1)=7.657542e-005; ng(n+1)=4.431581e+000;
n=53; farx(n+1)=2.634301e+000; foe(n+1)=1.149513e+002; krok(n+1)=9.289576e-004; ng(n+1)=3.472421e-001;
n=54; farx(n+1)=2.634036e+000; foe(n+1)=1.151723e+002; krok(n+1)=1.378623e-002; ng(n+1)=2.631556e-001;
n=55; farx(n+1)=2.633087e+000; foe(n+1)=1.134265e+002; krok(n+1)=8.823184e-001; ng(n+1)=7.733647e-002;
n=56; farx(n+1)=2.631979e+000; foe(n+1)=1.122405e+002; krok(n+1)=9.267410e-002; ng(n+1)=2.814674e+000;
n=57; farx(n+1)=2.631549e+000; foe(n+1)=1.121456e+002; krok(n+1)=1.884118e-001; ng(n+1)=1.272100e+001;
n=58; farx(n+1)=2.630450e+000; foe(n+1)=1.136195e+002; krok(n+1)=9.808063e-001; ng(n+1)=1.258304e+001;
n=59; farx(n+1)=2.629638e+000; foe(n+1)=1.121229e+002; krok(n+1)=1.361453e+000; ng(n+1)=1.633822e+000;
n=60; farx(n+1)=2.629189e+000; foe(n+1)=1.122541e+002; krok(n+1)=1.191322e+000; ng(n+1)=8.263037e+000;
n=61; farx(n+1)=2.628978e+000; foe(n+1)=1.117180e+002; krok(n+1)=9.372047e-001; ng(n+1)=1.998582e+000;
n=62; farx(n+1)=2.628839e+000; foe(n+1)=1.120283e+002; krok(n+1)=1.133514e+000; ng(n+1)=3.777930e+000;
n=63; farx(n+1)=2.628795e+000; foe(n+1)=1.116586e+002; krok(n+1)=1.435731e+000; ng(n+1)=7.608873e-001;
n=64; farx(n+1)=2.628783e+000; foe(n+1)=1.117440e+002; krok(n+1)=6.553300e-001; ng(n+1)=1.807717e+000;
n=65; farx(n+1)=2.628781e+000; foe(n+1)=1.117430e+002; krok(n+1)=1.213034e+000; ng(n+1)=1.477282e-001;
n=66; farx(n+1)=2.628781e+000; foe(n+1)=1.117321e+002; krok(n+1)=6.449478e-001; ng(n+1)=7.018997e-002;
n=67; farx(n+1)=2.628781e+000; foe(n+1)=1.117323e+002; krok(n+1)=1.505055e+000; ng(n+1)=2.014695e-002;
n=68; farx(n+1)=2.628781e+000; foe(n+1)=1.117340e+002; krok(n+1)=1.689622e+000; ng(n+1)=2.809618e-002;
n=69; farx(n+1)=2.628781e+000; foe(n+1)=1.117340e+002; krok(n+1)=3.315272e-005; ng(n+1)=2.210177e-003;
n=70; farx(n+1)=2.628781e+000; foe(n+1)=1.117340e+002; krok(n+1)=1.626093e-005; ng(n+1)=2.210099e-003;
n=71; farx(n+1)=2.628781e+000; foe(n+1)=1.117340e+002; krok(n+1)=1.869282e-005; ng(n+1)=2.210064e-003;
n=72; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=9.953222e-001; ng(n+1)=2.210022e-003;
n=73; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.430061e-005; ng(n+1)=9.639731e-006;
n=74; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.077084e-006; ng(n+1)=9.639596e-006;
n=75; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.467941e-006; ng(n+1)=9.639584e-006;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.343560e-007; ng(n+1)=9.639531e-006;
n=77; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=8.226987e-006; ng(n+1)=9.329135e-006;
n=78; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=8.584111e-007; ng(n+1)=9.399827e-006;
n=79; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.777520e-005; ng(n+1)=9.400463e-006;
n=80; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.337424e-006; ng(n+1)=9.400128e-006;
n=81; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.241785e-005; ng(n+1)=9.400116e-006;
n=82; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.719098e-005; ng(n+1)=9.399691e-006;
n=83; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.069939e-005; ng(n+1)=9.398836e-006;
n=84; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.484034e-007; ng(n+1)=9.398723e-006;
n=85; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.477810e-008; ng(n+1)=9.398724e-006;
n=86; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.276200e-008; ng(n+1)=9.398723e-006;
n=87; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.136623e-007; ng(n+1)=9.398726e-006;
n=88; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=5.586175e-008; ng(n+1)=9.398737e-006;
n=89; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=9.758225e-008; ng(n+1)=9.398738e-006;
 % z³y kierunek w metodzie zm - odnowa 
n=90; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.322278e-012; ng(n+1)=9.398741e-006;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
