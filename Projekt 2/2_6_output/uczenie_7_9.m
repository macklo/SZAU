%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.776854e+003; foe(n+1)=4.841342e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.449949e+003; foe(n+1)=4.146365e+003; krok(n+1)=4.012417e-004; ng(n+1)=8.944993e+003;
n=2; farx(n+1)=1.242356e+003; foe(n+1)=1.205962e+004; krok(n+1)=1.331533e-004; ng(n+1)=1.435398e+004;
n=3; farx(n+1)=3.916147e+002; foe(n+1)=7.890487e+003; krok(n+1)=2.197532e-004; ng(n+1)=8.382078e+003;
n=4; farx(n+1)=2.471721e+002; foe(n+1)=1.106905e+004; krok(n+1)=9.751354e-004; ng(n+1)=8.585852e+003;
n=5; farx(n+1)=1.709172e+002; foe(n+1)=1.286865e+004; krok(n+1)=1.517951e-003; ng(n+1)=3.489339e+003;
n=6; farx(n+1)=1.230267e+002; foe(n+1)=2.119194e+004; krok(n+1)=3.756098e-003; ng(n+1)=1.419983e+003;
n=7; farx(n+1)=7.510888e+001; foe(n+1)=2.079215e+004; krok(n+1)=1.025308e-003; ng(n+1)=2.296067e+003;
n=8; farx(n+1)=5.837450e+001; foe(n+1)=2.296689e+004; krok(n+1)=8.500296e-004; ng(n+1)=1.759200e+003;
n=9; farx(n+1)=2.047527e+001; foe(n+1)=4.742519e+003; krok(n+1)=6.480489e-003; ng(n+1)=1.577834e+003;
n=10; farx(n+1)=1.141622e+001; foe(n+1)=3.741185e+003; krok(n+1)=2.598953e-003; ng(n+1)=1.332040e+003;
n=11; farx(n+1)=8.114787e+000; foe(n+1)=1.443056e+003; krok(n+1)=1.881817e-003; ng(n+1)=5.025769e+002;
n=12; farx(n+1)=5.439934e+000; foe(n+1)=4.379630e+002; krok(n+1)=9.466059e-003; ng(n+1)=2.870133e+002;
n=13; farx(n+1)=3.710276e+000; foe(n+1)=4.674147e+002; krok(n+1)=1.041486e-002; ng(n+1)=2.804453e+002;
n=14; farx(n+1)=2.019095e+000; foe(n+1)=1.325821e+002; krok(n+1)=3.542231e-002; ng(n+1)=3.098080e+002;
n=15; farx(n+1)=1.776544e+000; foe(n+1)=9.127455e+001; krok(n+1)=1.871779e-002; ng(n+1)=1.098665e+002;
n=16; farx(n+1)=1.301883e+000; foe(n+1)=7.056343e+001; krok(n+1)=1.282857e-001; ng(n+1)=1.506864e+002;
n=17; farx(n+1)=1.210659e+000; foe(n+1)=7.018939e+001; krok(n+1)=6.504518e-002; ng(n+1)=8.459979e+001;
n=18; farx(n+1)=8.918220e-001; foe(n+1)=7.209714e+001; krok(n+1)=1.178633e-001; ng(n+1)=9.106516e+001;
n=19; farx(n+1)=7.441678e-001; foe(n+1)=6.033211e+001; krok(n+1)=1.638325e-001; ng(n+1)=6.431831e+001;
n=20; farx(n+1)=7.086348e-001; foe(n+1)=5.320767e+001; krok(n+1)=6.442938e-002; ng(n+1)=7.887468e+001;
n=21; farx(n+1)=6.724356e-001; foe(n+1)=5.442805e+001; krok(n+1)=7.431643e-002; ng(n+1)=5.027506e+001;
n=22; farx(n+1)=6.047644e-001; foe(n+1)=5.418736e+001; krok(n+1)=3.380830e-001; ng(n+1)=4.581345e+001;
n=23; farx(n+1)=5.700065e-001; foe(n+1)=6.091012e+001; krok(n+1)=9.570725e-002; ng(n+1)=3.137023e+001;
n=24; farx(n+1)=5.393736e-001; foe(n+1)=4.527278e+001; krok(n+1)=4.063898e-001; ng(n+1)=2.527932e+001;
n=25; farx(n+1)=5.261579e-001; foe(n+1)=3.905325e+001; krok(n+1)=2.465387e-001; ng(n+1)=2.086250e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.234891e-001; foe(n+1)=3.749073e+001; krok(n+1)=9.675577e-005; ng(n+1)=2.322557e+001;
n=27; farx(n+1)=5.227836e-001; foe(n+1)=3.789308e+001; krok(n+1)=1.198705e-004; ng(n+1)=1.064247e+001;
n=28; farx(n+1)=5.189919e-001; foe(n+1)=3.798072e+001; krok(n+1)=3.195265e-003; ng(n+1)=4.881562e+000;
n=29; farx(n+1)=5.172632e-001; foe(n+1)=3.738987e+001; krok(n+1)=1.289397e-002; ng(n+1)=1.730756e+000;
n=30; farx(n+1)=5.103395e-001; foe(n+1)=4.321050e+001; krok(n+1)=2.476948e-002; ng(n+1)=2.904340e+000;
n=31; farx(n+1)=5.049757e-001; foe(n+1)=4.244686e+001; krok(n+1)=2.679765e-002; ng(n+1)=1.080111e+001;
n=32; farx(n+1)=4.926479e-001; foe(n+1)=3.384756e+001; krok(n+1)=1.160291e-001; ng(n+1)=2.089232e+001;
n=33; farx(n+1)=4.826672e-001; foe(n+1)=3.135427e+001; krok(n+1)=1.563188e-001; ng(n+1)=3.441550e+001;
n=34; farx(n+1)=4.751079e-001; foe(n+1)=3.020478e+001; krok(n+1)=1.933624e-001; ng(n+1)=1.042765e+001;
n=35; farx(n+1)=4.677525e-001; foe(n+1)=2.869883e+001; krok(n+1)=8.000730e-002; ng(n+1)=2.019136e+001;
n=36; farx(n+1)=4.596345e-001; foe(n+1)=2.509080e+001; krok(n+1)=9.118713e-002; ng(n+1)=2.633736e+001;
n=37; farx(n+1)=4.532472e-001; foe(n+1)=2.442617e+001; krok(n+1)=2.094296e-001; ng(n+1)=6.807308e+000;
n=38; farx(n+1)=4.412180e-001; foe(n+1)=2.254338e+001; krok(n+1)=1.998171e-001; ng(n+1)=2.245149e+001;
n=39; farx(n+1)=4.328783e-001; foe(n+1)=2.223458e+001; krok(n+1)=5.945329e-002; ng(n+1)=2.191831e+001;
n=40; farx(n+1)=4.107143e-001; foe(n+1)=1.888806e+001; krok(n+1)=1.638325e-001; ng(n+1)=3.948285e+001;
n=41; farx(n+1)=4.019827e-001; foe(n+1)=1.724151e+001; krok(n+1)=2.351765e-002; ng(n+1)=4.278867e+001;
n=42; farx(n+1)=3.933714e-001; foe(n+1)=1.747358e+001; krok(n+1)=1.655202e-001; ng(n+1)=1.996236e+001;
n=43; farx(n+1)=3.807383e-001; foe(n+1)=1.573529e+001; krok(n+1)=2.726979e-001; ng(n+1)=2.840969e+001;
n=44; farx(n+1)=3.735795e-001; foe(n+1)=1.351280e+001; krok(n+1)=3.310405e-001; ng(n+1)=3.970461e+000;
n=45; farx(n+1)=3.468236e-001; foe(n+1)=9.200997e+000; krok(n+1)=1.065517e+000; ng(n+1)=1.531501e+001;
n=46; farx(n+1)=3.392830e-001; foe(n+1)=7.870270e+000; krok(n+1)=5.955282e-002; ng(n+1)=1.641805e+001;
n=47; farx(n+1)=3.361694e-001; foe(n+1)=7.232461e+000; krok(n+1)=5.382558e-002; ng(n+1)=8.019207e+000;
n=48; farx(n+1)=3.261138e-001; foe(n+1)=6.738555e+000; krok(n+1)=1.028050e-001; ng(n+1)=8.842048e+000;
n=49; farx(n+1)=3.192087e-001; foe(n+1)=7.112222e+000; krok(n+1)=2.292378e-001; ng(n+1)=4.168506e+000;
n=50; farx(n+1)=3.159302e-001; foe(n+1)=7.024431e+000; krok(n+1)=2.064051e-001; ng(n+1)=9.044984e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=3.158498e-001; foe(n+1)=7.092618e+000; krok(n+1)=1.016603e-004; ng(n+1)=4.281621e+000;
n=52; farx(n+1)=3.157214e-001; foe(n+1)=7.165876e+000; krok(n+1)=3.716215e-004; ng(n+1)=2.600021e+000;
n=53; farx(n+1)=3.154319e-001; foe(n+1)=7.279586e+000; krok(n+1)=3.680286e-004; ng(n+1)=4.012427e+000;
n=54; farx(n+1)=3.151026e-001; foe(n+1)=7.575247e+000; krok(n+1)=6.130766e-003; ng(n+1)=9.517157e-001;
n=55; farx(n+1)=3.141790e-001; foe(n+1)=6.783753e+000; krok(n+1)=5.711898e-003; ng(n+1)=1.820194e+000;
n=56; farx(n+1)=3.127311e-001; foe(n+1)=5.849587e+000; krok(n+1)=3.598781e-002; ng(n+1)=9.603831e-001;
n=57; farx(n+1)=3.109418e-001; foe(n+1)=6.078040e+000; krok(n+1)=9.636975e-002; ng(n+1)=7.592200e-001;
n=58; farx(n+1)=3.073802e-001; foe(n+1)=6.873700e+000; krok(n+1)=2.064051e-001; ng(n+1)=4.580119e+000;
n=59; farx(n+1)=3.003612e-001; foe(n+1)=6.048347e+000; krok(n+1)=1.562861e-001; ng(n+1)=8.448735e+000;
n=60; farx(n+1)=2.922055e-001; foe(n+1)=6.072432e+000; krok(n+1)=1.107341e-001; ng(n+1)=1.305548e+001;
n=61; farx(n+1)=2.852924e-001; foe(n+1)=5.352842e+000; krok(n+1)=6.105720e-002; ng(n+1)=1.964438e+001;
n=62; farx(n+1)=2.811572e-001; foe(n+1)=4.978955e+000; krok(n+1)=4.331299e-002; ng(n+1)=1.628647e+001;
n=63; farx(n+1)=2.775616e-001; foe(n+1)=4.784094e+000; krok(n+1)=6.694845e-002; ng(n+1)=1.420189e+001;
n=64; farx(n+1)=2.729792e-001; foe(n+1)=4.163601e+000; krok(n+1)=1.913888e-001; ng(n+1)=6.436646e+000;
n=65; farx(n+1)=2.685485e-001; foe(n+1)=3.627403e+000; krok(n+1)=2.158836e-001; ng(n+1)=9.537369e+000;
n=66; farx(n+1)=2.648837e-001; foe(n+1)=3.328586e+000; krok(n+1)=3.119600e-001; ng(n+1)=1.112853e+001;
n=67; farx(n+1)=2.632140e-001; foe(n+1)=3.218098e+000; krok(n+1)=2.230542e-001; ng(n+1)=8.128420e+000;
n=68; farx(n+1)=2.609600e-001; foe(n+1)=3.216633e+000; krok(n+1)=5.341966e-001; ng(n+1)=6.543269e+000;
n=69; farx(n+1)=2.592120e-001; foe(n+1)=3.435873e+000; krok(n+1)=5.962886e-001; ng(n+1)=4.396855e+000;
n=70; farx(n+1)=2.576282e-001; foe(n+1)=3.310131e+000; krok(n+1)=3.091015e-001; ng(n+1)=7.587736e+000;
n=71; farx(n+1)=2.553088e-001; foe(n+1)=2.970236e+000; krok(n+1)=3.354651e-001; ng(n+1)=9.277290e+000;
n=72; farx(n+1)=2.502083e-001; foe(n+1)=2.684237e+000; krok(n+1)=1.158471e+000; ng(n+1)=8.175567e+000;
n=73; farx(n+1)=2.482531e-001; foe(n+1)=2.703651e+000; krok(n+1)=2.475890e-001; ng(n+1)=1.196212e+001;
n=74; farx(n+1)=2.468584e-001; foe(n+1)=2.607677e+000; krok(n+1)=2.672252e-001; ng(n+1)=7.096791e+000;
n=75; farx(n+1)=2.461333e-001; foe(n+1)=2.631890e+000; krok(n+1)=5.108389e-001; ng(n+1)=2.529191e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.460388e-001; foe(n+1)=2.655997e+000; krok(n+1)=7.999634e-005; ng(n+1)=4.978027e+000;
n=77; farx(n+1)=2.458311e-001; foe(n+1)=2.582951e+000; krok(n+1)=9.534365e-004; ng(n+1)=2.286736e+000;
n=78; farx(n+1)=2.457944e-001; foe(n+1)=2.559046e+000; krok(n+1)=1.419195e-004; ng(n+1)=2.467587e+000;
n=79; farx(n+1)=2.457634e-001; foe(n+1)=2.542503e+000; krok(n+1)=8.565378e-003; ng(n+1)=2.804789e-001;
n=80; farx(n+1)=2.456939e-001; foe(n+1)=2.521294e+000; krok(n+1)=8.346822e-003; ng(n+1)=4.592435e-001;
n=81; farx(n+1)=2.455586e-001; foe(n+1)=2.540764e+000; krok(n+1)=4.284718e-002; ng(n+1)=2.801821e-001;
n=82; farx(n+1)=2.449852e-001; foe(n+1)=2.480199e+000; krok(n+1)=1.072012e-001; ng(n+1)=4.455118e-001;
n=83; farx(n+1)=2.443729e-001; foe(n+1)=2.482096e+000; krok(n+1)=1.027179e-001; ng(n+1)=1.815473e+000;
n=84; farx(n+1)=2.434560e-001; foe(n+1)=2.406966e+000; krok(n+1)=1.251841e-001; ng(n+1)=3.134218e+000;
n=85; farx(n+1)=2.426355e-001; foe(n+1)=2.465008e+000; krok(n+1)=2.906512e-001; ng(n+1)=3.170437e+000;
n=86; farx(n+1)=2.419066e-001; foe(n+1)=2.454071e+000; krok(n+1)=9.809225e-002; ng(n+1)=7.527734e+000;
n=87; farx(n+1)=2.410678e-001; foe(n+1)=2.400648e+000; krok(n+1)=1.006999e-001; ng(n+1)=6.803692e+000;
n=88; farx(n+1)=2.402301e-001; foe(n+1)=2.313099e+000; krok(n+1)=4.884576e-001; ng(n+1)=3.438999e+000;
n=89; farx(n+1)=2.392682e-001; foe(n+1)=2.468435e+000; krok(n+1)=5.491644e-001; ng(n+1)=3.535887e+000;
n=90; farx(n+1)=2.379162e-001; foe(n+1)=2.439562e+000; krok(n+1)=8.375141e-001; ng(n+1)=5.809112e+000;
n=91; farx(n+1)=2.359159e-001; foe(n+1)=2.410689e+000; krok(n+1)=5.461800e-001; ng(n+1)=6.153905e+000;
n=92; farx(n+1)=2.347187e-001; foe(n+1)=2.479941e+000; krok(n+1)=3.161324e-001; ng(n+1)=4.123487e+000;
n=93; farx(n+1)=2.336331e-001; foe(n+1)=2.587708e+000; krok(n+1)=2.079006e-001; ng(n+1)=9.961719e+000;
n=94; farx(n+1)=2.326604e-001; foe(n+1)=2.662046e+000; krok(n+1)=2.625380e-001; ng(n+1)=4.481550e+000;
n=95; farx(n+1)=2.313855e-001; foe(n+1)=2.457886e+000; krok(n+1)=2.682636e-001; ng(n+1)=9.226234e+000;
n=96; farx(n+1)=2.305117e-001; foe(n+1)=2.450466e+000; krok(n+1)=2.818076e-001; ng(n+1)=8.450699e+000;
n=97; farx(n+1)=2.293331e-001; foe(n+1)=2.550703e+000; krok(n+1)=5.690454e-001; ng(n+1)=6.272821e+000;
n=98; farx(n+1)=2.285837e-001; foe(n+1)=2.486043e+000; krok(n+1)=3.963116e-001; ng(n+1)=3.078263e+000;
n=99; farx(n+1)=2.277544e-001; foe(n+1)=2.586937e+000; krok(n+1)=4.385923e-001; ng(n+1)=2.243545e+000;
n=100; farx(n+1)=2.264723e-001; foe(n+1)=2.617487e+000; krok(n+1)=6.428475e-001; ng(n+1)=4.983048e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
