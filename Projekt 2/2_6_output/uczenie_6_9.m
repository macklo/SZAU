%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.278549e+003; foe(n+1)=4.259906e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.058106e+003; foe(n+1)=3.035173e+003; krok(n+1)=4.698128e-004; ng(n+1)=2.353120e+003;
n=2; farx(n+1)=2.631879e+003; foe(n+1)=3.212693e+003; krok(n+1)=4.957630e-004; ng(n+1)=1.804184e+003;
n=3; farx(n+1)=1.709634e+003; foe(n+1)=7.943207e+003; krok(n+1)=5.623096e-004; ng(n+1)=2.430793e+003;
n=4; farx(n+1)=1.395334e+003; foe(n+1)=1.048896e+004; krok(n+1)=1.016331e-003; ng(n+1)=2.892093e+003;
n=5; farx(n+1)=1.340998e+003; foe(n+1)=1.111930e+004; krok(n+1)=1.818608e-002; ng(n+1)=2.465169e+003;
n=6; farx(n+1)=2.539581e+002; foe(n+1)=6.132033e+003; krok(n+1)=1.549732e+000; ng(n+1)=2.236468e+003;
n=7; farx(n+1)=2.097530e+002; foe(n+1)=8.554156e+003; krok(n+1)=1.285695e+000; ng(n+1)=4.357222e+002;
n=8; farx(n+1)=1.358565e+002; foe(n+1)=6.381826e+003; krok(n+1)=4.005890e+000; ng(n+1)=2.660116e+002;
n=9; farx(n+1)=9.353072e+001; foe(n+1)=8.499360e+003; krok(n+1)=1.492366e+000; ng(n+1)=4.719079e+002;
n=10; farx(n+1)=7.534877e+001; foe(n+1)=1.185994e+004; krok(n+1)=7.487569e-001; ng(n+1)=2.301960e+002;
n=11; farx(n+1)=7.078150e+001; foe(n+1)=9.486339e+003; krok(n+1)=7.739919e+000; ng(n+1)=4.389674e+001;
n=12; farx(n+1)=6.549729e+001; foe(n+1)=6.847376e+003; krok(n+1)=9.001093e-001; ng(n+1)=1.348715e+002;
n=13; farx(n+1)=5.871798e+001; foe(n+1)=5.897940e+003; krok(n+1)=1.402391e+000; ng(n+1)=1.558379e+002;
n=14; farx(n+1)=5.784046e+001; foe(n+1)=6.091341e+003; krok(n+1)=6.970601e-001; ng(n+1)=7.417940e+001;
n=15; farx(n+1)=4.698323e+001; foe(n+1)=2.573456e+002; krok(n+1)=3.805011e+000; ng(n+1)=5.686343e+001;
n=16; farx(n+1)=3.978264e+001; foe(n+1)=1.942469e+002; krok(n+1)=4.555491e-001; ng(n+1)=1.585457e+002;
n=17; farx(n+1)=3.000146e+001; foe(n+1)=6.768170e+003; krok(n+1)=6.653319e-001; ng(n+1)=1.998576e+002;
n=18; farx(n+1)=2.154883e+001; foe(n+1)=2.485570e+002; krok(n+1)=8.922169e-001; ng(n+1)=1.635698e+002;
n=19; farx(n+1)=1.515980e+001; foe(n+1)=1.150923e+003; krok(n+1)=4.097091e-001; ng(n+1)=2.384552e+002;
n=20; farx(n+1)=1.328911e+001; foe(n+1)=2.276950e+003; krok(n+1)=1.992696e-001; ng(n+1)=6.334316e+001;
n=21; farx(n+1)=1.177279e+001; foe(n+1)=8.049800e+002; krok(n+1)=7.847380e-001; ng(n+1)=7.368654e+001;
n=22; farx(n+1)=9.886749e+000; foe(n+1)=1.769180e+002; krok(n+1)=6.622313e-001; ng(n+1)=8.452738e+001;
n=23; farx(n+1)=8.179917e+000; foe(n+1)=1.985549e+002; krok(n+1)=1.026961e+000; ng(n+1)=1.186526e+002;
n=24; farx(n+1)=6.680006e+000; foe(n+1)=2.082152e+002; krok(n+1)=5.995370e-001; ng(n+1)=4.730922e+001;
n=25; farx(n+1)=6.189518e+000; foe(n+1)=2.253198e+002; krok(n+1)=4.188592e-001; ng(n+1)=6.645095e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.924796e+000; foe(n+1)=3.454426e+002; krok(n+1)=1.596151e-004; ng(n+1)=9.548040e+001;
n=27; farx(n+1)=5.810022e+000; foe(n+1)=2.682728e+002; krok(n+1)=2.337468e-004; ng(n+1)=5.090712e+001;
n=28; farx(n+1)=5.082524e+000; foe(n+1)=3.683749e+002; krok(n+1)=1.839173e-002; ng(n+1)=1.321382e+001;
n=29; farx(n+1)=4.968642e+000; foe(n+1)=1.619458e+002; krok(n+1)=4.408444e-003; ng(n+1)=9.399555e+001;
n=30; farx(n+1)=4.845632e+000; foe(n+1)=1.722141e+002; krok(n+1)=7.530795e-003; ng(n+1)=1.195810e+002;
n=31; farx(n+1)=4.631660e+000; foe(n+1)=1.524423e+002; krok(n+1)=2.981443e-001; ng(n+1)=1.323215e+002;
n=32; farx(n+1)=4.451079e+000; foe(n+1)=1.520509e+002; krok(n+1)=2.725288e-001; ng(n+1)=1.066919e+002;
n=33; farx(n+1)=4.173706e+000; foe(n+1)=1.989150e+002; krok(n+1)=4.287623e-001; ng(n+1)=4.936240e+001;
n=34; farx(n+1)=3.756508e+000; foe(n+1)=1.556670e+002; krok(n+1)=8.635342e-001; ng(n+1)=6.458392e+001;
n=35; farx(n+1)=3.595663e+000; foe(n+1)=1.561849e+002; krok(n+1)=9.853052e-001; ng(n+1)=7.236494e+001;
n=36; farx(n+1)=3.356508e+000; foe(n+1)=1.380756e+002; krok(n+1)=7.612154e-001; ng(n+1)=6.092152e+001;
n=37; farx(n+1)=3.275599e+000; foe(n+1)=1.538061e+002; krok(n+1)=4.228884e-001; ng(n+1)=8.283121e+001;
n=38; farx(n+1)=3.112947e+000; foe(n+1)=1.308184e+002; krok(n+1)=1.787126e+000; ng(n+1)=3.138022e+001;
n=39; farx(n+1)=3.029202e+000; foe(n+1)=1.374382e+002; krok(n+1)=7.215816e-001; ng(n+1)=5.047689e+001;
n=40; farx(n+1)=2.960787e+000; foe(n+1)=1.402264e+002; krok(n+1)=3.785765e-001; ng(n+1)=2.460967e+001;
n=41; farx(n+1)=2.907934e+000; foe(n+1)=1.353450e+002; krok(n+1)=7.382907e-001; ng(n+1)=6.270480e+001;
n=42; farx(n+1)=2.847167e+000; foe(n+1)=1.299262e+002; krok(n+1)=1.831047e+000; ng(n+1)=4.525269e+001;
n=43; farx(n+1)=2.813533e+000; foe(n+1)=1.206057e+002; krok(n+1)=4.178411e-001; ng(n+1)=2.956163e+001;
n=44; farx(n+1)=2.781409e+000; foe(n+1)=1.285910e+002; krok(n+1)=7.926233e-001; ng(n+1)=2.915758e+001;
n=45; farx(n+1)=2.759742e+000; foe(n+1)=1.322635e+002; krok(n+1)=8.008859e-001; ng(n+1)=4.806332e+001;
n=46; farx(n+1)=2.728547e+000; foe(n+1)=1.202517e+002; krok(n+1)=1.485218e+000; ng(n+1)=2.307450e+001;
n=47; farx(n+1)=2.708566e+000; foe(n+1)=1.254609e+002; krok(n+1)=6.744582e-001; ng(n+1)=3.269383e+001;
n=48; farx(n+1)=2.694904e+000; foe(n+1)=1.185039e+002; krok(n+1)=8.166569e-001; ng(n+1)=1.223191e+001;
n=49; farx(n+1)=2.682946e+000; foe(n+1)=1.188486e+002; krok(n+1)=5.403454e-001; ng(n+1)=3.776063e+001;
n=50; farx(n+1)=2.670334e+000; foe(n+1)=1.160938e+002; krok(n+1)=5.738785e-001; ng(n+1)=1.238936e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.668169e+000; foe(n+1)=1.178222e+002; krok(n+1)=1.870342e-005; ng(n+1)=2.187698e+001;
n=52; farx(n+1)=2.666922e+000; foe(n+1)=1.183890e+002; krok(n+1)=9.290537e-005; ng(n+1)=6.157880e+000;
n=53; farx(n+1)=2.666682e+000; foe(n+1)=1.202585e+002; krok(n+1)=1.052624e-003; ng(n+1)=8.640956e-001;
n=54; farx(n+1)=2.664230e+000; foe(n+1)=1.202175e+002; krok(n+1)=2.390821e-002; ng(n+1)=6.368385e-001;
n=55; farx(n+1)=2.661622e+000; foe(n+1)=1.217574e+002; krok(n+1)=1.171506e-001; ng(n+1)=3.443699e-001;
n=56; farx(n+1)=2.655467e+000; foe(n+1)=1.206298e+002; krok(n+1)=2.193298e-001; ng(n+1)=1.092754e+000;
n=57; farx(n+1)=2.652832e+000; foe(n+1)=1.167623e+002; krok(n+1)=1.204927e-001; ng(n+1)=1.366843e+001;
n=58; farx(n+1)=2.645738e+000; foe(n+1)=1.153737e+002; krok(n+1)=1.605435e+000; ng(n+1)=2.548286e+001;
n=59; farx(n+1)=2.641196e+000; foe(n+1)=1.139711e+002; krok(n+1)=9.282331e-001; ng(n+1)=1.211146e+001;
n=60; farx(n+1)=2.637472e+000; foe(n+1)=1.166151e+002; krok(n+1)=1.181678e+000; ng(n+1)=1.696909e+001;
n=61; farx(n+1)=2.635524e+000; foe(n+1)=1.142723e+002; krok(n+1)=6.614848e-001; ng(n+1)=7.498232e+000;
n=62; farx(n+1)=2.633449e+000; foe(n+1)=1.138928e+002; krok(n+1)=1.046368e+000; ng(n+1)=1.345423e+001;
n=63; farx(n+1)=2.632096e+000; foe(n+1)=1.122639e+002; krok(n+1)=5.419562e-001; ng(n+1)=9.955972e+000;
n=64; farx(n+1)=2.631013e+000; foe(n+1)=1.134090e+002; krok(n+1)=1.168436e+000; ng(n+1)=1.249303e+001;
n=65; farx(n+1)=2.630149e+000; foe(n+1)=1.125412e+002; krok(n+1)=9.471081e-001; ng(n+1)=4.523774e+000;
n=66; farx(n+1)=2.629662e+000; foe(n+1)=1.129899e+002; krok(n+1)=7.101669e-001; ng(n+1)=8.353928e+000;
n=67; farx(n+1)=2.629142e+000; foe(n+1)=1.116385e+002; krok(n+1)=1.352447e+000; ng(n+1)=4.262510e+000;
n=68; farx(n+1)=2.628952e+000; foe(n+1)=1.120948e+002; krok(n+1)=1.003200e+000; ng(n+1)=6.681310e+000;
n=69; farx(n+1)=2.628829e+000; foe(n+1)=1.118464e+002; krok(n+1)=1.273593e+000; ng(n+1)=1.191267e+000;
n=70; farx(n+1)=2.628797e+000; foe(n+1)=1.118992e+002; krok(n+1)=7.771907e-001; ng(n+1)=2.318683e+000;
n=71; farx(n+1)=2.628784e+000; foe(n+1)=1.116704e+002; krok(n+1)=1.390988e+000; ng(n+1)=1.189137e+000;
n=72; farx(n+1)=2.628783e+000; foe(n+1)=1.117881e+002; krok(n+1)=9.639418e-001; ng(n+1)=4.103996e-001;
n=73; farx(n+1)=2.628782e+000; foe(n+1)=1.117348e+002; krok(n+1)=3.252744e+000; ng(n+1)=1.244286e-001;
n=74; farx(n+1)=2.628781e+000; foe(n+1)=1.117229e+002; krok(n+1)=2.648925e+000; ng(n+1)=1.673924e-001;
n=75; farx(n+1)=2.628781e+000; foe(n+1)=1.117342e+002; krok(n+1)=8.892951e-001; ng(n+1)=1.450760e-001;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.165273e-005; ng(n+1)=7.531741e-003;
n=77; farx(n+1)=2.628781e+000; foe(n+1)=1.117344e+002; krok(n+1)=2.773752e-005; ng(n+1)=8.384468e-003;
n=78; farx(n+1)=2.628781e+000; foe(n+1)=1.117327e+002; krok(n+1)=4.981850e-004; ng(n+1)=1.265222e-003;
n=79; farx(n+1)=2.628781e+000; foe(n+1)=1.117327e+002; krok(n+1)=4.472088e-002; ng(n+1)=8.372704e-005;
n=80; farx(n+1)=2.628781e+000; foe(n+1)=1.117327e+002; krok(n+1)=5.322406e-002; ng(n+1)=8.471762e-005;
n=81; farx(n+1)=2.628781e+000; foe(n+1)=1.117325e+002; krok(n+1)=1.259999e-001; ng(n+1)=5.882955e-005;
n=82; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.213631e+000; ng(n+1)=4.913050e-005;
n=83; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=8.300484e-006; ng(n+1)=2.566908e-004;
n=84; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.279983e-005; ng(n+1)=2.566887e-004;
n=85; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.225170e-007; ng(n+1)=2.566803e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=86; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=9.757658e-006; ng(n+1)=2.566802e-004;
n=87; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.539060e-005; ng(n+1)=4.358830e-005;
n=88; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.423748e-004; ng(n+1)=4.399988e-005;
n=89; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.214206e-005; ng(n+1)=7.099046e-005;
n=90; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.685516e-006; ng(n+1)=7.098943e-005;
n=91; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.524780e-008; ng(n+1)=7.098923e-005;
n=92; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.840320e-009; ng(n+1)=7.098923e-005;
n=93; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.244059e-006; ng(n+1)=7.098923e-005;
n=94; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.404344e-008; ng(n+1)=7.098914e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=95; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.955346e-005; ng(n+1)=7.098914e-005;
n=96; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.122749e-005; ng(n+1)=7.791120e-005;
n=97; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.858453e-012; ng(n+1)=2.687483e-005;
n=98; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=5.408409e-008; ng(n+1)=2.687483e-005;
n=99; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.430061e-005; ng(n+1)=2.687269e-005;
n=100; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.430061e-005; ng(n+1)=2.687079e-005;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
