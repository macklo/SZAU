%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.910592e+003; foe(n+1)=4.768854e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.293833e+003; foe(n+1)=3.954207e+003; krok(n+1)=2.900037e-004; ng(n+1)=1.014110e+004;
n=2; farx(n+1)=1.299086e+003; foe(n+1)=1.103293e+004; krok(n+1)=3.325065e-004; ng(n+1)=1.027546e+004;
n=3; farx(n+1)=6.524352e+002; foe(n+1)=1.579175e+004; krok(n+1)=1.828869e-004; ng(n+1)=7.130916e+003;
n=4; farx(n+1)=4.152903e+002; foe(n+1)=1.142346e+004; krok(n+1)=1.265228e-003; ng(n+1)=5.640446e+003;
n=5; farx(n+1)=2.463395e+002; foe(n+1)=6.723377e+003; krok(n+1)=3.625910e-003; ng(n+1)=1.864117e+003;
n=6; farx(n+1)=2.054226e+002; foe(n+1)=7.157783e+003; krok(n+1)=7.878882e-004; ng(n+1)=1.394333e+003;
n=7; farx(n+1)=1.783767e+002; foe(n+1)=6.070276e+003; krok(n+1)=1.163400e-003; ng(n+1)=8.467424e+002;
n=8; farx(n+1)=9.195746e+001; foe(n+1)=2.815401e+003; krok(n+1)=2.700359e-003; ng(n+1)=1.412278e+003;
n=9; farx(n+1)=8.495355e+001; foe(n+1)=2.023410e+003; krok(n+1)=1.810600e-003; ng(n+1)=5.813827e+002;
n=10; farx(n+1)=6.520526e+001; foe(n+1)=1.309721e+003; krok(n+1)=2.634602e-003; ng(n+1)=8.027893e+002;
n=11; farx(n+1)=5.574540e+001; foe(n+1)=9.001429e+002; krok(n+1)=6.543079e-003; ng(n+1)=7.126068e+002;
n=12; farx(n+1)=4.707368e+001; foe(n+1)=9.172569e+002; krok(n+1)=5.320104e-003; ng(n+1)=5.570274e+002;
n=13; farx(n+1)=2.686929e+001; foe(n+1)=1.217216e+003; krok(n+1)=1.095618e-002; ng(n+1)=8.041715e+002;
n=14; farx(n+1)=2.211561e+001; foe(n+1)=1.205633e+003; krok(n+1)=2.173143e-003; ng(n+1)=8.061689e+002;
n=15; farx(n+1)=1.621202e+001; foe(n+1)=6.931259e+002; krok(n+1)=1.203868e-003; ng(n+1)=6.646477e+002;
n=16; farx(n+1)=1.082238e+001; foe(n+1)=2.261099e+002; krok(n+1)=1.626130e-002; ng(n+1)=6.121778e+002;
n=17; farx(n+1)=9.201422e+000; foe(n+1)=1.473380e+002; krok(n+1)=7.763326e-003; ng(n+1)=5.612874e+002;
n=18; farx(n+1)=7.182146e+000; foe(n+1)=1.587736e+002; krok(n+1)=4.857442e-002; ng(n+1)=1.528055e+002;
n=19; farx(n+1)=5.694334e+000; foe(n+1)=1.550190e+002; krok(n+1)=1.473291e-002; ng(n+1)=2.532714e+002;
n=20; farx(n+1)=4.002211e+000; foe(n+1)=9.552871e+001; krok(n+1)=6.278363e-002; ng(n+1)=2.774044e+002;
n=21; farx(n+1)=3.791210e+000; foe(n+1)=9.465301e+001; krok(n+1)=4.083230e-003; ng(n+1)=3.337969e+002;
n=22; farx(n+1)=3.183312e+000; foe(n+1)=9.747975e+001; krok(n+1)=1.321323e-002; ng(n+1)=3.136637e+002;
n=23; farx(n+1)=2.825525e+000; foe(n+1)=9.356038e+001; krok(n+1)=2.191235e-002; ng(n+1)=2.081531e+002;
n=24; farx(n+1)=2.454576e+000; foe(n+1)=8.501843e+001; krok(n+1)=6.137372e-002; ng(n+1)=5.622178e+001;
n=25; farx(n+1)=2.170400e+000; foe(n+1)=8.846412e+001; krok(n+1)=2.865057e-002; ng(n+1)=1.602814e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.921491e+000; foe(n+1)=9.554573e+001; krok(n+1)=6.888194e-005; ng(n+1)=2.757613e+002;
n=27; farx(n+1)=1.910540e+000; foe(n+1)=9.796398e+001; krok(n+1)=9.290537e-005; ng(n+1)=5.615916e+001;
n=28; farx(n+1)=1.865907e+000; foe(n+1)=1.095293e+002; krok(n+1)=1.050273e-003; ng(n+1)=3.116673e+001;
n=29; farx(n+1)=1.759513e+000; foe(n+1)=1.573849e+002; krok(n+1)=4.474093e-003; ng(n+1)=2.580234e+001;
n=30; farx(n+1)=1.567389e+000; foe(n+1)=8.866315e+001; krok(n+1)=7.883344e-003; ng(n+1)=2.273505e+001;
n=31; farx(n+1)=1.420575e+000; foe(n+1)=7.731896e+001; krok(n+1)=1.889482e-002; ng(n+1)=2.079339e+001;
n=32; farx(n+1)=1.018858e+000; foe(n+1)=9.468311e+001; krok(n+1)=1.420813e-001; ng(n+1)=2.148506e+001;
n=33; farx(n+1)=8.618775e-001; foe(n+1)=8.002978e+001; krok(n+1)=7.964480e-002; ng(n+1)=6.946883e+001;
n=34; farx(n+1)=7.653950e-001; foe(n+1)=9.667556e+001; krok(n+1)=8.343059e-002; ng(n+1)=8.367880e+001;
n=35; farx(n+1)=7.207653e-001; foe(n+1)=8.180383e+001; krok(n+1)=1.088405e-001; ng(n+1)=3.907652e+001;
n=36; farx(n+1)=7.014796e-001; foe(n+1)=7.309412e+001; krok(n+1)=3.762076e-002; ng(n+1)=3.141569e+001;
n=37; farx(n+1)=6.808015e-001; foe(n+1)=8.003569e+001; krok(n+1)=5.730115e-002; ng(n+1)=3.531234e+001;
n=38; farx(n+1)=6.591779e-001; foe(n+1)=7.691341e+001; krok(n+1)=8.061847e-002; ng(n+1)=3.093963e+001;
n=39; farx(n+1)=6.345649e-001; foe(n+1)=8.859073e+001; krok(n+1)=1.221144e-001; ng(n+1)=5.071005e+001;
n=40; farx(n+1)=5.952856e-001; foe(n+1)=8.851437e+001; krok(n+1)=1.822367e-001; ng(n+1)=5.767790e+001;
n=41; farx(n+1)=5.826224e-001; foe(n+1)=2.587239e+002; krok(n+1)=1.865458e-001; ng(n+1)=4.818469e+001;
n=42; farx(n+1)=5.705939e-001; foe(n+1)=3.253498e+002; krok(n+1)=1.441658e-001; ng(n+1)=4.245066e+001;
n=43; farx(n+1)=5.634897e-001; foe(n+1)=3.252508e+002; krok(n+1)=1.755320e-001; ng(n+1)=1.359522e+001;
n=44; farx(n+1)=5.488642e-001; foe(n+1)=2.536223e+002; krok(n+1)=1.216335e-001; ng(n+1)=3.974067e+001;
n=45; farx(n+1)=5.328047e-001; foe(n+1)=1.630726e+002; krok(n+1)=2.577175e-001; ng(n+1)=2.745433e+001;
n=46; farx(n+1)=5.228746e-001; foe(n+1)=6.649664e+001; krok(n+1)=1.800875e-001; ng(n+1)=2.944406e+001;
n=47; farx(n+1)=5.196174e-001; foe(n+1)=6.399299e+001; krok(n+1)=2.002215e-001; ng(n+1)=1.698186e+001;
n=48; farx(n+1)=5.146961e-001; foe(n+1)=6.180832e+001; krok(n+1)=4.213257e-001; ng(n+1)=7.428167e+000;
n=49; farx(n+1)=5.123040e-001; foe(n+1)=6.014770e+001; krok(n+1)=2.545463e-001; ng(n+1)=6.570239e+000;
n=50; farx(n+1)=5.041282e-001; foe(n+1)=1.430066e+002; krok(n+1)=8.179879e-001; ng(n+1)=1.473549e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=5.037859e-001; foe(n+1)=1.432720e+002; krok(n+1)=6.667236e-005; ng(n+1)=1.113252e+001;
n=52; farx(n+1)=5.037510e-001; foe(n+1)=1.430743e+002; krok(n+1)=2.523757e-004; ng(n+1)=2.055773e+000;
n=53; farx(n+1)=5.031550e-001; foe(n+1)=1.260246e+002; krok(n+1)=1.970836e-003; ng(n+1)=2.756912e+000;
n=54; farx(n+1)=5.026959e-001; foe(n+1)=8.108520e+001; krok(n+1)=2.081087e-003; ng(n+1)=2.532479e+000;
n=55; farx(n+1)=5.021318e-001; foe(n+1)=7.197751e+001; krok(n+1)=2.530456e-003; ng(n+1)=2.348354e+000;
n=56; farx(n+1)=5.013340e-001; foe(n+1)=1.286757e+002; krok(n+1)=5.623415e-002; ng(n+1)=6.954791e-001;
n=57; farx(n+1)=4.990947e-001; foe(n+1)=6.466541e+001; krok(n+1)=7.508776e-002; ng(n+1)=1.035662e+000;
n=58; farx(n+1)=4.970057e-001; foe(n+1)=1.259181e+002; krok(n+1)=2.134155e-001; ng(n+1)=3.002145e+000;
n=59; farx(n+1)=4.960361e-001; foe(n+1)=1.258774e+002; krok(n+1)=1.516292e-001; ng(n+1)=2.277151e+000;
n=60; farx(n+1)=4.946089e-001; foe(n+1)=1.181697e+002; krok(n+1)=1.902702e-001; ng(n+1)=1.192313e+001;
n=61; farx(n+1)=4.929431e-001; foe(n+1)=1.086198e+002; krok(n+1)=2.715651e-001; ng(n+1)=6.277545e+000;
n=62; farx(n+1)=4.898276e-001; foe(n+1)=5.133965e+001; krok(n+1)=3.745525e-001; ng(n+1)=8.320522e+000;
n=63; farx(n+1)=4.863167e-001; foe(n+1)=4.626864e+001; krok(n+1)=3.223140e-001; ng(n+1)=2.051832e+001;
n=64; farx(n+1)=4.819101e-001; foe(n+1)=4.160498e+001; krok(n+1)=2.730638e-001; ng(n+1)=1.040392e+001;
n=65; farx(n+1)=4.757281e-001; foe(n+1)=4.179280e+001; krok(n+1)=3.261226e-001; ng(n+1)=1.974049e+001;
n=66; farx(n+1)=4.726998e-001; foe(n+1)=4.163493e+001; krok(n+1)=1.452529e-001; ng(n+1)=9.229806e+000;
n=67; farx(n+1)=4.711969e-001; foe(n+1)=3.784310e+001; krok(n+1)=4.524124e-002; ng(n+1)=1.761083e+001;
n=68; farx(n+1)=4.631101e-001; foe(n+1)=3.240990e+001; krok(n+1)=2.200070e-001; ng(n+1)=2.553136e+001;
n=69; farx(n+1)=4.529281e-001; foe(n+1)=2.870874e+001; krok(n+1)=4.803134e-001; ng(n+1)=1.174773e+001;
n=70; farx(n+1)=4.454348e-001; foe(n+1)=2.636650e+001; krok(n+1)=8.892157e-002; ng(n+1)=1.915877e+001;
n=71; farx(n+1)=4.328722e-001; foe(n+1)=2.228349e+001; krok(n+1)=2.583432e-001; ng(n+1)=1.958228e+001;
n=72; farx(n+1)=4.285771e-001; foe(n+1)=2.163438e+001; krok(n+1)=2.007487e-001; ng(n+1)=9.471144e+000;
n=73; farx(n+1)=4.185605e-001; foe(n+1)=1.965050e+001; krok(n+1)=2.965759e-001; ng(n+1)=2.448367e+001;
n=74; farx(n+1)=4.122637e-001; foe(n+1)=1.849654e+001; krok(n+1)=1.495129e-001; ng(n+1)=2.506762e+001;
n=75; farx(n+1)=3.988224e-001; foe(n+1)=1.537978e+001; krok(n+1)=2.981475e-001; ng(n+1)=2.464031e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=3.927961e-001; foe(n+1)=1.512699e+001; krok(n+1)=6.564208e-005; ng(n+1)=4.433917e+001;
n=77; farx(n+1)=3.923917e-001; foe(n+1)=1.490517e+001; krok(n+1)=9.985203e-005; ng(n+1)=8.750929e+000;
n=78; farx(n+1)=3.915145e-001; foe(n+1)=1.460656e+001; krok(n+1)=8.178849e-004; ng(n+1)=5.497896e+000;
n=79; farx(n+1)=3.869501e-001; foe(n+1)=1.559862e+001; krok(n+1)=1.825682e-002; ng(n+1)=2.549240e+000;
n=80; farx(n+1)=3.866039e-001; foe(n+1)=1.546932e+001; krok(n+1)=4.372259e-003; ng(n+1)=1.382708e+000;
n=81; farx(n+1)=3.816572e-001; foe(n+1)=1.484010e+001; krok(n+1)=6.935426e-002; ng(n+1)=1.541530e+000;
n=82; farx(n+1)=3.777078e-001; foe(n+1)=1.230030e+001; krok(n+1)=1.220211e-001; ng(n+1)=6.113044e+000;
n=83; farx(n+1)=3.726981e-001; foe(n+1)=1.193177e+001; krok(n+1)=7.959957e-002; ng(n+1)=1.742643e+001;
n=84; farx(n+1)=3.672919e-001; foe(n+1)=1.046083e+001; krok(n+1)=1.039503e-001; ng(n+1)=2.882600e+001;
n=85; farx(n+1)=3.592852e-001; foe(n+1)=1.022540e+001; krok(n+1)=1.414327e-001; ng(n+1)=2.047257e+001;
n=86; farx(n+1)=3.506891e-001; foe(n+1)=8.777657e+000; krok(n+1)=1.687274e-001; ng(n+1)=1.482539e+001;
n=87; farx(n+1)=3.476111e-001; foe(n+1)=8.087156e+000; krok(n+1)=5.055608e-002; ng(n+1)=1.614044e+001;
n=88; farx(n+1)=3.359882e-001; foe(n+1)=5.150856e+000; krok(n+1)=1.872762e-001; ng(n+1)=2.278722e+001;
n=89; farx(n+1)=3.320104e-001; foe(n+1)=4.441777e+000; krok(n+1)=7.551359e-002; ng(n+1)=7.250165e+000;
n=90; farx(n+1)=3.241655e-001; foe(n+1)=4.516231e+000; krok(n+1)=1.160291e-001; ng(n+1)=1.726815e+001;
n=91; farx(n+1)=3.140792e-001; foe(n+1)=4.151388e+000; krok(n+1)=1.296496e-001; ng(n+1)=2.935525e+001;
n=92; farx(n+1)=3.025800e-001; foe(n+1)=5.766160e+000; krok(n+1)=1.478545e-001; ng(n+1)=1.976712e+001;
n=93; farx(n+1)=2.928186e-001; foe(n+1)=4.858080e+000; krok(n+1)=3.724184e-001; ng(n+1)=2.026625e+001;
n=94; farx(n+1)=2.833553e-001; foe(n+1)=4.544165e+000; krok(n+1)=3.805404e-001; ng(n+1)=1.804381e+001;
n=95; farx(n+1)=2.782382e-001; foe(n+1)=4.622953e+000; krok(n+1)=2.268451e-001; ng(n+1)=2.000719e+001;
n=96; farx(n+1)=2.733665e-001; foe(n+1)=4.211316e+000; krok(n+1)=4.337210e-001; ng(n+1)=6.595451e+000;
n=97; farx(n+1)=2.691558e-001; foe(n+1)=4.028849e+000; krok(n+1)=1.111619e-001; ng(n+1)=1.864855e+001;
n=98; farx(n+1)=2.662802e-001; foe(n+1)=4.248990e+000; krok(n+1)=1.942977e-001; ng(n+1)=1.904945e+001;
n=99; farx(n+1)=2.631832e-001; foe(n+1)=4.914643e+000; krok(n+1)=3.805404e-001; ng(n+1)=1.164958e+001;
n=100; farx(n+1)=2.591854e-001; foe(n+1)=4.914408e+000; krok(n+1)=8.726755e-001; ng(n+1)=7.634803e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
