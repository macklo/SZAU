%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.313876e+003; foe(n+1)=4.210478e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.114157e+003; foe(n+1)=3.077595e+003; krok(n+1)=4.449379e-004; ng(n+1)=3.128584e+003;
n=2; farx(n+1)=2.706044e+003; foe(n+1)=3.230045e+003; krok(n+1)=5.127695e-004; ng(n+1)=1.217962e+003;
n=3; farx(n+1)=1.815781e+003; foe(n+1)=8.981590e+003; krok(n+1)=7.315478e-004; ng(n+1)=2.829288e+003;
n=4; farx(n+1)=1.535587e+003; foe(n+1)=1.296314e+004; krok(n+1)=5.053235e-004; ng(n+1)=3.474240e+003;
n=5; farx(n+1)=1.494598e+003; foe(n+1)=1.342512e+004; krok(n+1)=7.599313e-003; ng(n+1)=2.867193e+003;
n=6; farx(n+1)=1.318924e+002; foe(n+1)=1.423643e+003; krok(n+1)=1.905690e+000; ng(n+1)=2.826227e+003;
n=7; farx(n+1)=8.315446e+001; foe(n+1)=5.184251e+002; krok(n+1)=1.056270e+000; ng(n+1)=4.365153e+002;
n=8; farx(n+1)=3.467813e+001; foe(n+1)=5.576770e+003; krok(n+1)=2.862909e-001; ng(n+1)=1.504810e+002;
n=9; farx(n+1)=2.208764e+001; foe(n+1)=2.541968e+002; krok(n+1)=1.147298e+000; ng(n+1)=3.202928e+002;
n=10; farx(n+1)=2.064302e+001; foe(n+1)=3.429273e+002; krok(n+1)=7.310195e-001; ng(n+1)=1.046210e+002;
n=11; farx(n+1)=2.016489e+001; foe(n+1)=2.648589e+002; krok(n+1)=8.300996e-001; ng(n+1)=6.585471e+001;
n=12; farx(n+1)=1.903731e+001; foe(n+1)=3.532285e+002; krok(n+1)=1.966140e+000; ng(n+1)=6.140380e+001;
n=13; farx(n+1)=1.791572e+001; foe(n+1)=4.961103e+002; krok(n+1)=2.772031e+000; ng(n+1)=4.200018e+001;
n=14; farx(n+1)=1.517570e+001; foe(n+1)=4.292116e+002; krok(n+1)=2.421479e+000; ng(n+1)=8.658333e+001;
n=15; farx(n+1)=1.227141e+001; foe(n+1)=1.829491e+002; krok(n+1)=1.210739e+000; ng(n+1)=6.922300e+001;
n=16; farx(n+1)=1.067742e+001; foe(n+1)=1.675873e+002; krok(n+1)=4.536903e-001; ng(n+1)=1.762507e+002;
n=17; farx(n+1)=8.273894e+000; foe(n+1)=1.584908e+002; krok(n+1)=1.729901e+000; ng(n+1)=1.120054e+002;
n=18; farx(n+1)=6.915006e+000; foe(n+1)=1.721074e+002; krok(n+1)=5.888949e-001; ng(n+1)=3.665811e+001;
n=19; farx(n+1)=6.333732e+000; foe(n+1)=2.402495e+002; krok(n+1)=4.114269e-001; ng(n+1)=1.040318e+002;
n=20; farx(n+1)=5.570628e+000; foe(n+1)=2.481716e+002; krok(n+1)=2.192737e+000; ng(n+1)=5.688273e+001;
n=21; farx(n+1)=5.058307e+000; foe(n+1)=3.040133e+002; krok(n+1)=5.352197e-001; ng(n+1)=3.361568e+001;
n=22; farx(n+1)=4.805503e+000; foe(n+1)=3.397480e+002; krok(n+1)=7.832156e-001; ng(n+1)=8.598041e+001;
n=23; farx(n+1)=4.510029e+000; foe(n+1)=2.007500e+002; krok(n+1)=1.322970e+000; ng(n+1)=5.042419e+001;
n=24; farx(n+1)=4.025812e+000; foe(n+1)=2.999268e+002; krok(n+1)=1.147757e+000; ng(n+1)=4.283890e+001;
n=25; farx(n+1)=3.873404e+000; foe(n+1)=4.904179e+002; krok(n+1)=3.435737e-001; ng(n+1)=6.409574e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.864710e+000; foe(n+1)=6.289177e+002; krok(n+1)=1.440576e-004; ng(n+1)=1.590451e+001;
n=27; farx(n+1)=3.850946e+000; foe(n+1)=4.103871e+002; krok(n+1)=2.034749e-004; ng(n+1)=1.542706e+001;
n=28; farx(n+1)=3.791167e+000; foe(n+1)=2.088129e+002; krok(n+1)=1.548092e-003; ng(n+1)=1.358987e+001;
n=29; farx(n+1)=3.552824e+000; foe(n+1)=1.576750e+002; krok(n+1)=1.308616e-002; ng(n+1)=1.023146e+001;
n=30; farx(n+1)=3.443389e+000; foe(n+1)=1.481339e+002; krok(n+1)=5.983917e-002; ng(n+1)=5.731262e+001;
n=31; farx(n+1)=3.394554e+000; foe(n+1)=1.439796e+002; krok(n+1)=2.320583e-001; ng(n+1)=1.168706e+002;
n=32; farx(n+1)=3.335298e+000; foe(n+1)=1.405166e+002; krok(n+1)=1.619492e-001; ng(n+1)=8.220453e+001;
n=33; farx(n+1)=3.236982e+000; foe(n+1)=1.696188e+002; krok(n+1)=2.250273e-001; ng(n+1)=7.549977e+001;
n=34; farx(n+1)=3.058850e+000; foe(n+1)=1.528322e+002; krok(n+1)=1.507294e+000; ng(n+1)=4.834074e+001;
n=35; farx(n+1)=3.006426e+000; foe(n+1)=1.371777e+002; krok(n+1)=4.128102e-001; ng(n+1)=1.112559e+001;
n=36; farx(n+1)=2.943024e+000; foe(n+1)=1.303378e+002; krok(n+1)=7.238598e-001; ng(n+1)=6.934763e+001;
n=37; farx(n+1)=2.891778e+000; foe(n+1)=1.307739e+002; krok(n+1)=1.273593e+000; ng(n+1)=5.265676e+001;
n=38; farx(n+1)=2.839779e+000; foe(n+1)=1.254991e+002; krok(n+1)=8.375141e-001; ng(n+1)=1.356581e+001;
n=39; farx(n+1)=2.804900e+000; foe(n+1)=1.292553e+002; krok(n+1)=8.295027e-001; ng(n+1)=4.670349e+001;
n=40; farx(n+1)=2.778769e+000; foe(n+1)=1.267143e+002; krok(n+1)=1.022846e+000; ng(n+1)=4.078862e+001;
n=41; farx(n+1)=2.749845e+000; foe(n+1)=1.165704e+002; krok(n+1)=7.709580e-001; ng(n+1)=6.747279e+000;
n=42; farx(n+1)=2.728393e+000; foe(n+1)=1.201624e+002; krok(n+1)=5.249576e-001; ng(n+1)=4.702496e+001;
n=43; farx(n+1)=2.705748e+000; foe(n+1)=1.298694e+002; krok(n+1)=2.016487e+000; ng(n+1)=2.882200e+001;
n=44; farx(n+1)=2.689173e+000; foe(n+1)=1.231296e+002; krok(n+1)=4.112198e-001; ng(n+1)=9.118718e+000;
n=45; farx(n+1)=2.678345e+000; foe(n+1)=1.143317e+002; krok(n+1)=5.378226e-001; ng(n+1)=3.439291e+001;
n=46; farx(n+1)=2.670646e+000; foe(n+1)=1.160846e+002; krok(n+1)=1.404256e+000; ng(n+1)=2.655033e+001;
n=47; farx(n+1)=2.657049e+000; foe(n+1)=1.142782e+002; krok(n+1)=8.812470e-001; ng(n+1)=1.265217e+001;
n=48; farx(n+1)=2.649681e+000; foe(n+1)=1.187921e+002; krok(n+1)=1.746675e+000; ng(n+1)=2.060528e+001;
n=49; farx(n+1)=2.645187e+000; foe(n+1)=1.197696e+002; krok(n+1)=6.954939e-001; ng(n+1)=2.251507e+001;
n=50; farx(n+1)=2.639207e+000; foe(n+1)=1.120713e+002; krok(n+1)=7.101669e-001; ng(n+1)=2.974065e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.638271e+000; foe(n+1)=1.129749e+002; krok(n+1)=1.393983e-005; ng(n+1)=1.626973e+001;
n=52; farx(n+1)=2.638101e+000; foe(n+1)=1.135318e+002; krok(n+1)=1.062896e-004; ng(n+1)=2.466429e+000;
n=53; farx(n+1)=2.637944e+000; foe(n+1)=1.150389e+002; krok(n+1)=5.276810e-004; ng(n+1)=1.098505e+000;
n=54; farx(n+1)=2.637473e+000; foe(n+1)=1.154017e+002; krok(n+1)=4.797973e-002; ng(n+1)=2.546984e-001;
n=55; farx(n+1)=2.636828e+000; foe(n+1)=1.162813e+002; krok(n+1)=7.170614e-002; ng(n+1)=1.922023e-001;
n=56; farx(n+1)=2.636275e+000; foe(n+1)=1.161650e+002; krok(n+1)=1.381465e-001; ng(n+1)=4.142607e-001;
n=57; farx(n+1)=2.633894e+000; foe(n+1)=1.136744e+002; krok(n+1)=4.770341e-001; ng(n+1)=1.135374e+000;
n=58; farx(n+1)=2.632094e+000; foe(n+1)=1.126478e+002; krok(n+1)=1.390988e+000; ng(n+1)=1.199925e+001;
n=59; farx(n+1)=2.630558e+000; foe(n+1)=1.138909e+002; krok(n+1)=1.561751e+000; ng(n+1)=1.460517e+001;
n=60; farx(n+1)=2.629941e+000; foe(n+1)=1.127560e+002; krok(n+1)=3.556863e-001; ng(n+1)=6.798471e+000;
n=61; farx(n+1)=2.629493e+000; foe(n+1)=1.118330e+002; krok(n+1)=9.606268e-001; ng(n+1)=3.168875e+000;
n=62; farx(n+1)=2.629192e+000; foe(n+1)=1.123714e+002; krok(n+1)=1.212653e+000; ng(n+1)=7.303698e+000;
n=63; farx(n+1)=2.628889e+000; foe(n+1)=1.118275e+002; krok(n+1)=1.252500e+000; ng(n+1)=2.782572e+000;
n=64; farx(n+1)=2.628803e+000; foe(n+1)=1.120100e+002; krok(n+1)=2.127187e+000; ng(n+1)=2.742388e+000;
n=65; farx(n+1)=2.628787e+000; foe(n+1)=1.117764e+002; krok(n+1)=5.821767e-001; ng(n+1)=7.372509e-001;
n=66; farx(n+1)=2.628783e+000; foe(n+1)=1.117633e+002; krok(n+1)=1.179204e+000; ng(n+1)=8.468674e-001;
n=67; farx(n+1)=2.628781e+000; foe(n+1)=1.117441e+002; krok(n+1)=2.277084e+000; ng(n+1)=3.447495e-001;
n=68; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.953830e+000; ng(n+1)=5.673706e-002;
n=69; farx(n+1)=2.628781e+000; foe(n+1)=1.117333e+002; krok(n+1)=8.957909e-001; ng(n+1)=6.637935e-002;
n=70; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=7.491049e-001; ng(n+1)=8.293377e-003;
n=71; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.032295e-005; ng(n+1)=3.461758e-004;
n=72; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.715184e-005; ng(n+1)=3.461717e-004;
n=73; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=5.224312e-009; ng(n+1)=3.461658e-004;
n=74; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.944642e-006; ng(n+1)=3.461658e-004;
n=75; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.820315e-006; ng(n+1)=3.461646e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.159995e-005; ng(n+1)=3.461634e-004;
n=77; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.474731e-005; ng(n+1)=3.144037e-004;
n=78; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=6.553529e-004; ng(n+1)=6.585703e-005;
n=79; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=3.692745e-002; ng(n+1)=4.322045e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
