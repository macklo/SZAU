%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.852567e+003; foe(n+1)=4.813525e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.538065e+003; foe(n+1)=4.006949e+003; krok(n+1)=3.147597e-004; ng(n+1)=7.869378e+003;
n=2; farx(n+1)=1.990279e+003; foe(n+1)=9.408122e+003; krok(n+1)=3.268048e-004; ng(n+1)=8.978986e+003;
n=3; farx(n+1)=1.266494e+003; foe(n+1)=1.793259e+004; krok(n+1)=1.599927e-004; ng(n+1)=9.686112e+003;
n=4; farx(n+1)=6.485372e+002; foe(n+1)=1.084597e+004; krok(n+1)=1.830478e-003; ng(n+1)=7.880351e+003;
n=5; farx(n+1)=4.747280e+002; foe(n+1)=8.509241e+003; krok(n+1)=4.644788e-004; ng(n+1)=3.483767e+003;
n=6; farx(n+1)=3.192253e+002; foe(n+1)=1.067869e+004; krok(n+1)=1.575776e-003; ng(n+1)=1.699054e+003;
n=7; farx(n+1)=1.513913e+002; foe(n+1)=6.671398e+003; krok(n+1)=6.552053e-004; ng(n+1)=2.905679e+003;
n=8; farx(n+1)=7.665573e+001; foe(n+1)=6.107635e+003; krok(n+1)=2.300371e-003; ng(n+1)=1.094521e+003;
n=9; farx(n+1)=3.393434e+001; foe(n+1)=9.229367e+002; krok(n+1)=2.840497e-003; ng(n+1)=1.419262e+003;
n=10; farx(n+1)=2.522233e+001; foe(n+1)=8.802541e+002; krok(n+1)=4.399860e-003; ng(n+1)=3.362337e+002;
n=11; farx(n+1)=1.428670e+001; foe(n+1)=3.601264e+002; krok(n+1)=3.891067e-003; ng(n+1)=7.593479e+002;
n=12; farx(n+1)=8.135049e+000; foe(n+1)=3.598786e+002; krok(n+1)=2.240817e-003; ng(n+1)=1.018477e+003;
n=13; farx(n+1)=6.976154e+000; foe(n+1)=7.765548e+002; krok(n+1)=5.548179e-003; ng(n+1)=3.259658e+002;
n=14; farx(n+1)=6.432957e+000; foe(n+1)=7.366647e+002; krok(n+1)=6.607631e-003; ng(n+1)=3.146093e+002;
n=15; farx(n+1)=4.198278e+000; foe(n+1)=1.057164e+002; krok(n+1)=2.243330e-002; ng(n+1)=3.312128e+002;
n=16; farx(n+1)=3.236427e+000; foe(n+1)=8.529439e+001; krok(n+1)=6.900644e-002; ng(n+1)=1.454739e+002;
n=17; farx(n+1)=2.386304e+000; foe(n+1)=1.047241e+002; krok(n+1)=2.705929e-002; ng(n+1)=2.784584e+002;
n=18; farx(n+1)=1.871312e+000; foe(n+1)=7.716417e+001; krok(n+1)=2.113019e-002; ng(n+1)=2.069522e+002;
n=19; farx(n+1)=1.492872e+000; foe(n+1)=7.434854e+001; krok(n+1)=4.294671e-002; ng(n+1)=1.578687e+002;
n=20; farx(n+1)=1.387352e+000; foe(n+1)=7.166690e+001; krok(n+1)=3.012318e-002; ng(n+1)=1.025127e+002;
n=21; farx(n+1)=1.165271e+000; foe(n+1)=7.178756e+001; krok(n+1)=9.907791e-002; ng(n+1)=4.692461e+001;
n=22; farx(n+1)=9.464512e-001; foe(n+1)=9.815392e+001; krok(n+1)=2.869393e-001; ng(n+1)=7.153635e+001;
n=23; farx(n+1)=8.985207e-001; foe(n+1)=9.055165e+001; krok(n+1)=7.841683e-002; ng(n+1)=6.054965e+001;
n=24; farx(n+1)=8.280226e-001; foe(n+1)=7.426382e+001; krok(n+1)=2.317569e-001; ng(n+1)=6.101777e+001;
n=25; farx(n+1)=7.710346e-001; foe(n+1)=7.934023e+001; krok(n+1)=2.701727e-001; ng(n+1)=2.665166e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.663631e-001; foe(n+1)=8.486258e+001; krok(n+1)=1.022675e-004; ng(n+1)=2.515677e+001;
n=27; farx(n+1)=7.659186e-001; foe(n+1)=8.713819e+001; krok(n+1)=2.516773e-004; ng(n+1)=5.165708e+000;
n=28; farx(n+1)=7.560125e-001; foe(n+1)=1.024929e+002; krok(n+1)=1.688447e-003; ng(n+1)=1.030745e+001;
n=29; farx(n+1)=7.360819e-001; foe(n+1)=9.533774e+001; krok(n+1)=9.213222e-003; ng(n+1)=5.826130e+000;
n=30; farx(n+1)=7.185794e-001; foe(n+1)=8.707585e+001; krok(n+1)=2.896961e-002; ng(n+1)=6.927115e+000;
n=31; farx(n+1)=7.154675e-001; foe(n+1)=8.518304e+001; krok(n+1)=1.109636e-002; ng(n+1)=1.152354e+001;
n=32; farx(n+1)=7.001369e-001; foe(n+1)=7.859578e+001; krok(n+1)=2.279678e-002; ng(n+1)=1.446579e+001;
n=33; farx(n+1)=6.513460e-001; foe(n+1)=7.333715e+001; krok(n+1)=2.640676e-001; ng(n+1)=4.943494e+001;
n=34; farx(n+1)=6.386799e-001; foe(n+1)=8.774064e+001; krok(n+1)=3.497807e-002; ng(n+1)=4.238300e+001;
n=35; farx(n+1)=6.090957e-001; foe(n+1)=1.061253e+002; krok(n+1)=1.048915e-001; ng(n+1)=3.106967e+001;
n=36; farx(n+1)=5.970534e-001; foe(n+1)=8.929816e+001; krok(n+1)=6.964181e-002; ng(n+1)=4.291639e+001;
n=37; farx(n+1)=5.894747e-001; foe(n+1)=7.605766e+001; krok(n+1)=3.616714e-002; ng(n+1)=1.777975e+001;
n=38; farx(n+1)=5.772104e-001; foe(n+1)=8.065179e+001; krok(n+1)=1.238533e-001; ng(n+1)=2.239143e+001;
n=39; farx(n+1)=5.589714e-001; foe(n+1)=6.024874e+001; krok(n+1)=1.991516e-001; ng(n+1)=3.190529e+001;
n=40; farx(n+1)=5.508777e-001; foe(n+1)=5.570050e+001; krok(n+1)=3.377395e-002; ng(n+1)=4.830592e+001;
n=41; farx(n+1)=5.402648e-001; foe(n+1)=5.739037e+001; krok(n+1)=1.046893e-001; ng(n+1)=3.499176e+001;
n=42; farx(n+1)=5.355199e-001; foe(n+1)=5.168606e+001; krok(n+1)=1.115271e-001; ng(n+1)=1.384202e+001;
n=43; farx(n+1)=5.227838e-001; foe(n+1)=7.211894e+001; krok(n+1)=3.691454e-001; ng(n+1)=8.870683e+000;
n=44; farx(n+1)=5.101350e-001; foe(n+1)=5.452283e+001; krok(n+1)=4.641165e-001; ng(n+1)=2.659004e+001;
n=45; farx(n+1)=5.040192e-001; foe(n+1)=5.076502e+001; krok(n+1)=1.653712e-001; ng(n+1)=3.645431e+001;
n=46; farx(n+1)=4.984185e-001; foe(n+1)=4.644899e+001; krok(n+1)=1.668649e-001; ng(n+1)=3.546912e+001;
n=47; farx(n+1)=4.892047e-001; foe(n+1)=4.934137e+001; krok(n+1)=5.191100e-001; ng(n+1)=8.542584e+000;
n=48; farx(n+1)=4.736129e-001; foe(n+1)=3.639439e+001; krok(n+1)=6.202698e-001; ng(n+1)=1.681922e+001;
n=49; farx(n+1)=4.689542e-001; foe(n+1)=3.712799e+001; krok(n+1)=2.729349e-001; ng(n+1)=3.181711e+001;
n=50; farx(n+1)=4.597024e-001; foe(n+1)=3.239032e+001; krok(n+1)=3.745525e-001; ng(n+1)=6.882248e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.581360e-001; foe(n+1)=3.421276e+001; krok(n+1)=8.876552e-005; ng(n+1)=1.664355e+001;
n=52; farx(n+1)=4.578069e-001; foe(n+1)=3.294774e+001; krok(n+1)=2.247173e-003; ng(n+1)=1.654422e+000;
n=53; farx(n+1)=4.577352e-001; foe(n+1)=3.278873e+001; krok(n+1)=5.312685e-005; ng(n+1)=5.093203e+000;
n=54; farx(n+1)=4.558561e-001; foe(n+1)=3.166919e+001; krok(n+1)=1.254679e-002; ng(n+1)=1.518475e+000;
n=55; farx(n+1)=4.554819e-001; foe(n+1)=3.165892e+001; krok(n+1)=3.677109e-003; ng(n+1)=1.712794e+000;
n=56; farx(n+1)=4.531566e-001; foe(n+1)=3.191270e+001; krok(n+1)=2.173419e-002; ng(n+1)=2.056710e+000;
n=57; farx(n+1)=4.514738e-001; foe(n+1)=3.098981e+001; krok(n+1)=5.234463e-002; ng(n+1)=5.315993e+000;
n=58; farx(n+1)=4.469540e-001; foe(n+1)=2.957653e+001; krok(n+1)=1.992696e-001; ng(n+1)=1.234647e+001;
n=59; farx(n+1)=4.412330e-001; foe(n+1)=2.941559e+001; krok(n+1)=2.994846e-001; ng(n+1)=2.453093e+001;
n=60; farx(n+1)=4.333130e-001; foe(n+1)=2.559838e+001; krok(n+1)=3.064368e-001; ng(n+1)=1.608084e+001;
n=61; farx(n+1)=4.300584e-001; foe(n+1)=2.483278e+001; krok(n+1)=1.171506e-001; ng(n+1)=1.592003e+001;
n=62; farx(n+1)=4.276364e-001; foe(n+1)=2.464067e+001; krok(n+1)=5.954236e-002; ng(n+1)=8.081868e+000;
n=63; farx(n+1)=4.208135e-001; foe(n+1)=2.417354e+001; krok(n+1)=1.584655e-001; ng(n+1)=1.137919e+001;
n=64; farx(n+1)=4.134884e-001; foe(n+1)=2.421428e+001; krok(n+1)=9.118713e-002; ng(n+1)=1.629395e+001;
n=65; farx(n+1)=4.051813e-001; foe(n+1)=2.678980e+001; krok(n+1)=1.890204e-001; ng(n+1)=1.914783e+001;
n=66; farx(n+1)=3.954117e-001; foe(n+1)=2.802592e+001; krok(n+1)=1.620110e-001; ng(n+1)=7.124361e+000;
n=67; farx(n+1)=3.882454e-001; foe(n+1)=2.799426e+001; krok(n+1)=1.297328e-001; ng(n+1)=2.525478e+001;
n=68; farx(n+1)=3.744042e-001; foe(n+1)=2.453038e+001; krok(n+1)=3.307424e-001; ng(n+1)=2.610313e+001;
n=69; farx(n+1)=3.518562e-001; foe(n+1)=1.938358e+001; krok(n+1)=3.886554e-001; ng(n+1)=1.585043e+001;
n=70; farx(n+1)=3.467763e-001; foe(n+1)=1.748188e+001; krok(n+1)=9.358032e-002; ng(n+1)=1.111911e+001;
n=71; farx(n+1)=3.282617e-001; foe(n+1)=1.471809e+001; krok(n+1)=3.025841e-001; ng(n+1)=2.570654e+001;
n=72; farx(n+1)=3.193861e-001; foe(n+1)=1.534413e+001; krok(n+1)=1.015974e-001; ng(n+1)=4.102787e+001;
n=73; farx(n+1)=3.126795e-001; foe(n+1)=1.345697e+001; krok(n+1)=1.548452e-001; ng(n+1)=1.665890e+001;
n=74; farx(n+1)=3.046219e-001; foe(n+1)=1.264288e+001; krok(n+1)=2.320583e-001; ng(n+1)=2.977399e+001;
n=75; farx(n+1)=2.980014e-001; foe(n+1)=1.076427e+001; krok(n+1)=3.380830e-001; ng(n+1)=8.550333e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.969142e-001; foe(n+1)=1.016611e+001; krok(n+1)=9.065052e-005; ng(n+1)=1.490154e+001;
n=77; farx(n+1)=2.967589e-001; foe(n+1)=1.021508e+001; krok(n+1)=1.118324e-003; ng(n+1)=1.733418e+000;
n=78; farx(n+1)=2.964205e-001; foe(n+1)=1.027910e+001; krok(n+1)=1.574580e-004; ng(n+1)=6.024108e+000;
n=79; farx(n+1)=2.950220e-001; foe(n+1)=9.559737e+000; krok(n+1)=1.859840e-002; ng(n+1)=1.222392e+000;
n=80; farx(n+1)=2.943210e-001; foe(n+1)=9.556390e+000; krok(n+1)=1.269968e-002; ng(n+1)=1.319532e+000;
n=81; farx(n+1)=2.926412e-001; foe(n+1)=1.002394e+001; krok(n+1)=7.883344e-003; ng(n+1)=2.271782e+000;
n=82; farx(n+1)=2.909646e-001; foe(n+1)=9.388300e+000; krok(n+1)=8.569436e-002; ng(n+1)=1.686050e+000;
n=83; farx(n+1)=2.878185e-001; foe(n+1)=7.921522e+000; krok(n+1)=1.320338e-001; ng(n+1)=3.551355e+000;
n=84; farx(n+1)=2.864490e-001; foe(n+1)=7.658007e+000; krok(n+1)=9.759878e-002; ng(n+1)=1.501448e+001;
n=85; farx(n+1)=2.824645e-001; foe(n+1)=5.579405e+000; krok(n+1)=2.635881e-001; ng(n+1)=1.694841e+001;
n=86; farx(n+1)=2.801194e-001; foe(n+1)=5.313252e+000; krok(n+1)=5.907855e-001; ng(n+1)=5.187479e+000;
n=87; farx(n+1)=2.788243e-001; foe(n+1)=5.009008e+000; krok(n+1)=1.032026e-001; ng(n+1)=6.065439e+000;
n=88; farx(n+1)=2.772624e-001; foe(n+1)=4.835806e+000; krok(n+1)=1.280543e-001; ng(n+1)=1.261938e+001;
n=89; farx(n+1)=2.753920e-001; foe(n+1)=4.497919e+000; krok(n+1)=1.872762e-001; ng(n+1)=1.695573e+001;
n=90; farx(n+1)=2.731185e-001; foe(n+1)=4.866699e+000; krok(n+1)=4.112198e-001; ng(n+1)=4.021906e+000;
n=91; farx(n+1)=2.715394e-001; foe(n+1)=4.862893e+000; krok(n+1)=1.722157e-001; ng(n+1)=9.681549e+000;
n=92; farx(n+1)=2.690538e-001; foe(n+1)=4.850518e+000; krok(n+1)=4.536903e-001; ng(n+1)=1.303459e+001;
n=93; farx(n+1)=2.667741e-001; foe(n+1)=4.896757e+000; krok(n+1)=7.525649e-001; ng(n+1)=8.854135e+000;
n=94; farx(n+1)=2.635297e-001; foe(n+1)=4.834198e+000; krok(n+1)=5.079754e-001; ng(n+1)=9.580550e+000;
n=95; farx(n+1)=2.594976e-001; foe(n+1)=4.072122e+000; krok(n+1)=3.160606e-001; ng(n+1)=1.489768e+001;
n=96; farx(n+1)=2.567314e-001; foe(n+1)=4.065012e+000; krok(n+1)=6.477968e-001; ng(n+1)=5.756971e+000;
n=97; farx(n+1)=2.545923e-001; foe(n+1)=4.161720e+000; krok(n+1)=3.310405e-001; ng(n+1)=1.440460e+001;
n=98; farx(n+1)=2.537900e-001; foe(n+1)=3.945699e+000; krok(n+1)=7.119534e-002; ng(n+1)=1.217086e+001;
n=99; farx(n+1)=2.523092e-001; foe(n+1)=2.906150e+000; krok(n+1)=2.373843e-001; ng(n+1)=6.824757e+000;
n=100; farx(n+1)=2.508357e-001; foe(n+1)=2.403956e+000; krok(n+1)=4.787134e-001; ng(n+1)=8.195715e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
