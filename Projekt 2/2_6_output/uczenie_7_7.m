%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.783430e+003; foe(n+1)=4.748149e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.803642e+003; foe(n+1)=3.885133e+003; krok(n+1)=3.933588e-004; ng(n+1)=1.015861e+004;
n=2; farx(n+1)=1.482055e+003; foe(n+1)=1.138729e+004; krok(n+1)=1.780999e-004; ng(n+1)=1.236847e+004;
n=3; farx(n+1)=6.238010e+002; foe(n+1)=1.587640e+004; krok(n+1)=2.594055e-004; ng(n+1)=8.290054e+003;
n=4; farx(n+1)=3.344932e+002; foe(n+1)=1.104565e+004; krok(n+1)=2.547833e-003; ng(n+1)=7.069064e+003;
n=5; farx(n+1)=2.217655e+002; foe(n+1)=1.131328e+004; krok(n+1)=2.424720e-003; ng(n+1)=2.385242e+003;
n=6; farx(n+1)=1.597405e+002; foe(n+1)=1.148619e+004; krok(n+1)=1.310411e-003; ng(n+1)=1.498619e+003;
n=7; farx(n+1)=1.247291e+002; foe(n+1)=9.951733e+003; krok(n+1)=2.110872e-003; ng(n+1)=7.125718e+002;
n=8; farx(n+1)=4.638102e+001; foe(n+1)=6.927795e+003; krok(n+1)=1.564230e-003; ng(n+1)=1.877414e+003;
n=9; farx(n+1)=2.973016e+001; foe(n+1)=5.861585e+003; krok(n+1)=1.532691e-003; ng(n+1)=1.404425e+003;
n=10; farx(n+1)=1.779990e+001; foe(n+1)=2.796079e+003; krok(n+1)=1.587460e-003; ng(n+1)=1.188552e+003;
n=11; farx(n+1)=1.053451e+001; foe(n+1)=6.175721e+002; krok(n+1)=6.912131e-003; ng(n+1)=2.980970e+002;
n=12; farx(n+1)=6.448127e+000; foe(n+1)=2.521461e+002; krok(n+1)=1.269968e-002; ng(n+1)=4.566079e+002;
n=13; farx(n+1)=4.727810e+000; foe(n+1)=1.110560e+002; krok(n+1)=1.638666e-002; ng(n+1)=1.740585e+002;
n=14; farx(n+1)=3.613896e+000; foe(n+1)=1.101139e+002; krok(n+1)=3.006802e-002; ng(n+1)=2.695739e+002;
n=15; farx(n+1)=3.281480e+000; foe(n+1)=9.695067e+001; krok(n+1)=7.990988e-003; ng(n+1)=2.375595e+002;
n=16; farx(n+1)=2.696807e+000; foe(n+1)=8.067315e+001; krok(n+1)=1.750226e-002; ng(n+1)=1.811995e+002;
n=17; farx(n+1)=2.067700e+000; foe(n+1)=2.447016e+002; krok(n+1)=3.789541e-002; ng(n+1)=6.635318e+001;
n=18; farx(n+1)=1.930980e+000; foe(n+1)=1.526684e+002; krok(n+1)=7.517970e-002; ng(n+1)=1.237901e+002;
n=19; farx(n+1)=1.786562e+000; foe(n+1)=1.227353e+002; krok(n+1)=1.041001e-001; ng(n+1)=6.059374e+001;
n=20; farx(n+1)=1.634510e+000; foe(n+1)=9.837834e+001; krok(n+1)=7.853583e-002; ng(n+1)=5.666094e+001;
n=21; farx(n+1)=1.439885e+000; foe(n+1)=9.104033e+001; krok(n+1)=1.111619e-001; ng(n+1)=6.564604e+001;
n=22; farx(n+1)=1.275567e+000; foe(n+1)=7.411725e+001; krok(n+1)=1.288873e-001; ng(n+1)=1.275173e+002;
n=23; farx(n+1)=1.090227e+000; foe(n+1)=9.513654e+001; krok(n+1)=1.892883e-001; ng(n+1)=1.126389e+002;
n=24; farx(n+1)=1.003118e+000; foe(n+1)=1.100743e+002; krok(n+1)=2.656312e-001; ng(n+1)=4.310022e+001;
n=25; farx(n+1)=8.939340e-001; foe(n+1)=2.143949e+002; krok(n+1)=4.884576e-001; ng(n+1)=6.383043e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=8.853551e-001; foe(n+1)=1.944380e+002; krok(n+1)=8.440914e-005; ng(n+1)=4.011449e+001;
n=27; farx(n+1)=8.827261e-001; foe(n+1)=1.788867e+002; krok(n+1)=2.215284e-004; ng(n+1)=1.212793e+001;
n=28; farx(n+1)=8.508569e-001; foe(n+1)=1.654318e+002; krok(n+1)=2.583925e-003; ng(n+1)=1.159793e+001;
n=29; farx(n+1)=8.108701e-001; foe(n+1)=2.032752e+002; krok(n+1)=1.033570e-002; ng(n+1)=1.030288e+001;
n=30; farx(n+1)=7.655014e-001; foe(n+1)=2.767812e+002; krok(n+1)=1.297031e-002; ng(n+1)=2.108074e+001;
n=31; farx(n+1)=7.175222e-001; foe(n+1)=8.685242e+001; krok(n+1)=1.345640e-002; ng(n+1)=6.566502e+001;
n=32; farx(n+1)=6.931930e-001; foe(n+1)=6.074900e+001; krok(n+1)=4.905012e-002; ng(n+1)=1.064288e+002;
n=33; farx(n+1)=5.977150e-001; foe(n+1)=3.941967e+001; krok(n+1)=1.380129e-001; ng(n+1)=7.886568e+001;
n=34; farx(n+1)=5.648576e-001; foe(n+1)=3.297565e+001; krok(n+1)=3.618094e-002; ng(n+1)=4.928920e+001;
n=35; farx(n+1)=5.368214e-001; foe(n+1)=2.995350e+001; krok(n+1)=1.150668e-001; ng(n+1)=2.223320e+001;
n=36; farx(n+1)=4.800707e-001; foe(n+1)=2.357138e+001; krok(n+1)=2.730638e-001; ng(n+1)=4.889439e+001;
n=37; farx(n+1)=4.408242e-001; foe(n+1)=1.935550e+001; krok(n+1)=2.320583e-001; ng(n+1)=3.788021e+001;
n=38; farx(n+1)=4.064184e-001; foe(n+1)=1.537991e+001; krok(n+1)=2.624788e-001; ng(n+1)=1.656945e+001;
n=39; farx(n+1)=3.852683e-001; foe(n+1)=1.233677e+001; krok(n+1)=6.444366e-002; ng(n+1)=3.171714e+001;
n=40; farx(n+1)=3.749175e-001; foe(n+1)=1.178062e+001; krok(n+1)=1.244935e-001; ng(n+1)=5.211020e+000;
n=41; farx(n+1)=3.712612e-001; foe(n+1)=1.149475e+001; krok(n+1)=3.320390e-002; ng(n+1)=3.391468e+001;
n=42; farx(n+1)=3.637651e-001; foe(n+1)=1.164098e+001; krok(n+1)=9.010248e-002; ng(n+1)=3.613786e+001;
n=43; farx(n+1)=3.571994e-001; foe(n+1)=1.186587e+001; krok(n+1)=8.892157e-002; ng(n+1)=1.373696e+001;
n=44; farx(n+1)=3.487624e-001; foe(n+1)=1.076847e+001; krok(n+1)=4.372988e-001; ng(n+1)=1.742581e+001;
n=45; farx(n+1)=3.434240e-001; foe(n+1)=9.571897e+000; krok(n+1)=2.088513e-001; ng(n+1)=2.074180e+001;
n=46; farx(n+1)=3.332078e-001; foe(n+1)=8.659786e+000; krok(n+1)=4.128102e-001; ng(n+1)=1.596195e+001;
n=47; farx(n+1)=3.254773e-001; foe(n+1)=8.694129e+000; krok(n+1)=3.240219e-001; ng(n+1)=1.865799e+001;
n=48; farx(n+1)=3.143426e-001; foe(n+1)=6.891728e+000; krok(n+1)=9.362720e-001; ng(n+1)=1.487765e+001;
n=49; farx(n+1)=3.044376e-001; foe(n+1)=7.270582e+000; krok(n+1)=3.619299e-001; ng(n+1)=7.064320e+000;
n=50; farx(n+1)=2.954627e-001; foe(n+1)=9.988004e+000; krok(n+1)=2.385171e-001; ng(n+1)=1.908621e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.944019e-001; foe(n+1)=9.555748e+000; krok(n+1)=1.297027e-004; ng(n+1)=1.360281e+001;
n=52; farx(n+1)=2.931440e-001; foe(n+1)=1.007301e+001; krok(n+1)=8.566255e-004; ng(n+1)=5.491797e+000;
n=53; farx(n+1)=2.924528e-001; foe(n+1)=1.089744e+001; krok(n+1)=1.046887e-004; ng(n+1)=1.028073e+001;
n=54; farx(n+1)=2.909258e-001; foe(n+1)=8.952188e+000; krok(n+1)=2.679765e-002; ng(n+1)=9.511942e-001;
n=55; farx(n+1)=2.895988e-001; foe(n+1)=7.207725e+000; krok(n+1)=3.722882e-002; ng(n+1)=8.654436e-001;
n=56; farx(n+1)=2.869306e-001; foe(n+1)=7.042279e+000; krok(n+1)=1.109636e-002; ng(n+1)=2.515187e+000;
n=57; farx(n+1)=2.855574e-001; foe(n+1)=8.744574e+000; krok(n+1)=1.174729e-001; ng(n+1)=1.040266e+000;
n=58; farx(n+1)=2.836749e-001; foe(n+1)=8.398371e+000; krok(n+1)=8.155575e-002; ng(n+1)=2.265803e+000;
n=59; farx(n+1)=2.808948e-001; foe(n+1)=6.580450e+000; krok(n+1)=1.420813e-001; ng(n+1)=6.935866e+000;
n=60; farx(n+1)=2.763607e-001; foe(n+1)=5.045173e+000; krok(n+1)=2.134155e-001; ng(n+1)=1.753062e+001;
n=61; farx(n+1)=2.716330e-001; foe(n+1)=4.487131e+000; krok(n+1)=2.144024e-001; ng(n+1)=1.948851e+001;
n=62; farx(n+1)=2.671230e-001; foe(n+1)=4.254011e+000; krok(n+1)=3.614383e-001; ng(n+1)=7.201828e+000;
n=63; farx(n+1)=2.634258e-001; foe(n+1)=4.187833e+000; krok(n+1)=5.188122e-002; ng(n+1)=1.725973e+001;
n=64; farx(n+1)=2.575933e-001; foe(n+1)=3.936926e+000; krok(n+1)=5.596492e-001; ng(n+1)=9.082747e+000;
n=65; farx(n+1)=2.527679e-001; foe(n+1)=3.587215e+000; krok(n+1)=4.923082e-001; ng(n+1)=1.404620e+001;
n=66; farx(n+1)=2.500202e-001; foe(n+1)=3.417010e+000; krok(n+1)=1.714306e-001; ng(n+1)=1.240316e+001;
n=67; farx(n+1)=2.474146e-001; foe(n+1)=3.678538e+000; krok(n+1)=3.261226e-001; ng(n+1)=5.022510e+000;
n=68; farx(n+1)=2.458034e-001; foe(n+1)=3.725114e+000; krok(n+1)=1.961845e-001; ng(n+1)=9.252383e+000;
n=69; farx(n+1)=2.435651e-001; foe(n+1)=3.713174e+000; krok(n+1)=6.022096e-001; ng(n+1)=3.889065e+000;
n=70; farx(n+1)=2.403387e-001; foe(n+1)=3.406334e+000; krok(n+1)=6.435764e-001; ng(n+1)=8.648954e+000;
n=71; farx(n+1)=2.386669e-001; foe(n+1)=3.352236e+000; krok(n+1)=1.612369e-001; ng(n+1)=9.069825e+000;
n=72; farx(n+1)=2.365706e-001; foe(n+1)=3.075362e+000; krok(n+1)=2.730638e-001; ng(n+1)=7.922843e+000;
n=73; farx(n+1)=2.350055e-001; foe(n+1)=3.121519e+000; krok(n+1)=5.039997e-001; ng(n+1)=9.960771e+000;
n=74; farx(n+1)=2.338265e-001; foe(n+1)=3.103148e+000; krok(n+1)=7.101669e-001; ng(n+1)=4.978491e+000;
n=75; farx(n+1)=2.328603e-001; foe(n+1)=3.062388e+000; krok(n+1)=9.512526e-001; ng(n+1)=5.089257e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.327567e-001; foe(n+1)=3.073098e+000; krok(n+1)=9.144347e-005; ng(n+1)=4.269371e+000;
n=77; farx(n+1)=2.327493e-001; foe(n+1)=3.074281e+000; krok(n+1)=1.078966e-004; ng(n+1)=1.259454e+000;
n=78; farx(n+1)=2.326593e-001; foe(n+1)=3.081369e+000; krok(n+1)=6.446985e-003; ng(n+1)=5.685329e-001;
n=79; farx(n+1)=2.325733e-001; foe(n+1)=3.057130e+000; krok(n+1)=4.126056e-003; ng(n+1)=7.211262e-001;
n=80; farx(n+1)=2.324834e-001; foe(n+1)=3.064022e+000; krok(n+1)=4.505183e-003; ng(n+1)=6.494434e-001;
n=81; farx(n+1)=2.323405e-001; foe(n+1)=3.078807e+000; krok(n+1)=7.142563e-002; ng(n+1)=1.996801e-001;
n=82; farx(n+1)=2.322016e-001; foe(n+1)=3.075391e+000; krok(n+1)=8.877087e-002; ng(n+1)=2.263035e-001;
n=83; farx(n+1)=2.319680e-001; foe(n+1)=3.058498e+000; krok(n+1)=8.260442e-002; ng(n+1)=5.608001e-001;
n=84; farx(n+1)=2.317349e-001; foe(n+1)=3.058359e+000; krok(n+1)=9.228634e-002; ng(n+1)=2.003654e+000;
n=85; farx(n+1)=2.313622e-001; foe(n+1)=3.071983e+000; krok(n+1)=4.144507e-001; ng(n+1)=4.140780e+000;
n=86; farx(n+1)=2.306187e-001; foe(n+1)=2.937297e+000; krok(n+1)=6.857223e-001; ng(n+1)=6.369246e+000;
n=87; farx(n+1)=2.300252e-001; foe(n+1)=2.820731e+000; krok(n+1)=5.758050e-001; ng(n+1)=6.106183e+000;
n=88; farx(n+1)=2.293520e-001; foe(n+1)=2.683375e+000; krok(n+1)=4.909897e-001; ng(n+1)=4.621156e+000;
n=89; farx(n+1)=2.283651e-001; foe(n+1)=2.600845e+000; krok(n+1)=5.841487e-001; ng(n+1)=6.286670e+000;
n=90; farx(n+1)=2.280501e-001; foe(n+1)=2.666196e+000; krok(n+1)=2.663792e-001; ng(n+1)=3.610107e+000;
n=91; farx(n+1)=2.272019e-001; foe(n+1)=2.707117e+000; krok(n+1)=7.310195e-001; ng(n+1)=3.929805e+000;
n=92; farx(n+1)=2.264284e-001; foe(n+1)=2.759833e+000; krok(n+1)=8.885059e-001; ng(n+1)=3.838039e+000;
n=93; farx(n+1)=2.257906e-001; foe(n+1)=2.703625e+000; krok(n+1)=5.122170e-001; ng(n+1)=4.677812e+000;
n=94; farx(n+1)=2.251090e-001; foe(n+1)=2.577686e+000; krok(n+1)=4.967261e-001; ng(n+1)=4.270143e+000;
n=95; farx(n+1)=2.242000e-001; foe(n+1)=2.594613e+000; krok(n+1)=1.056325e+000; ng(n+1)=4.993211e+000;
n=96; farx(n+1)=2.234148e-001; foe(n+1)=2.637693e+000; krok(n+1)=4.089939e-001; ng(n+1)=5.788454e+000;
n=97; farx(n+1)=2.227734e-001; foe(n+1)=2.654122e+000; krok(n+1)=4.063898e-001; ng(n+1)=3.729099e+000;
n=98; farx(n+1)=2.218726e-001; foe(n+1)=2.547657e+000; krok(n+1)=4.187571e-001; ng(n+1)=8.384817e+000;
n=99; farx(n+1)=2.207892e-001; foe(n+1)=2.508017e+000; krok(n+1)=2.461541e-001; ng(n+1)=1.001563e+001;
n=100; farx(n+1)=2.199658e-001; foe(n+1)=2.375271e+000; krok(n+1)=4.787134e-001; ng(n+1)=2.848047e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
