%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.261007e+003; foe(n+1)=4.241616e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.997128e+003; foe(n+1)=3.034926e+003; krok(n+1)=4.987505e-004; ng(n+1)=2.370083e+003;
n=2; farx(n+1)=2.146294e+003; foe(n+1)=4.984444e+003; krok(n+1)=1.291963e-003; ng(n+1)=8.982448e+002;
n=3; farx(n+1)=1.650645e+003; foe(n+1)=1.098628e+004; krok(n+1)=1.858436e-004; ng(n+1)=4.301660e+003;
n=4; farx(n+1)=1.686885e+002; foe(n+1)=2.593150e+003; krok(n+1)=2.240989e-003; ng(n+1)=3.587280e+003;
n=5; farx(n+1)=1.655910e+002; foe(n+1)=3.178310e+003; krok(n+1)=5.219242e-004; ng(n+1)=1.985018e+003;
n=6; farx(n+1)=8.554839e+001; foe(n+1)=2.272121e+004; krok(n+1)=1.418482e-001; ng(n+1)=1.559226e+003;
n=7; farx(n+1)=5.800358e+001; foe(n+1)=1.234278e+004; krok(n+1)=1.527341e-001; ng(n+1)=1.260851e+003;
n=8; farx(n+1)=3.824420e+001; foe(n+1)=2.980762e+003; krok(n+1)=2.975933e-001; ng(n+1)=3.922610e+002;
n=9; farx(n+1)=3.215006e+001; foe(n+1)=2.156659e+003; krok(n+1)=6.826594e-002; ng(n+1)=4.372904e+002;
n=10; farx(n+1)=1.805461e+001; foe(n+1)=3.500141e+002; krok(n+1)=8.698323e+000; ng(n+1)=1.381361e+002;
n=11; farx(n+1)=1.184305e+001; foe(n+1)=3.115872e+002; krok(n+1)=7.460858e-001; ng(n+1)=2.053283e+002;
n=12; farx(n+1)=9.391148e+000; foe(n+1)=8.925087e+002; krok(n+1)=6.480438e-001; ng(n+1)=2.519999e+002;
n=13; farx(n+1)=6.047915e+000; foe(n+1)=2.023979e+002; krok(n+1)=1.650428e+000; ng(n+1)=1.043057e+002;
n=14; farx(n+1)=4.789124e+000; foe(n+1)=3.269381e+002; krok(n+1)=1.157790e+000; ng(n+1)=2.720035e+002;
n=15; farx(n+1)=3.692219e+000; foe(n+1)=1.887498e+002; krok(n+1)=1.157790e+000; ng(n+1)=6.973329e+001;
n=16; farx(n+1)=3.461192e+000; foe(n+1)=1.328159e+002; krok(n+1)=3.711420e-001; ng(n+1)=1.002765e+002;
n=17; farx(n+1)=3.068380e+000; foe(n+1)=1.575219e+002; krok(n+1)=1.162605e+000; ng(n+1)=1.122063e+002;
n=18; farx(n+1)=2.875731e+000; foe(n+1)=1.134907e+002; krok(n+1)=1.492366e+000; ng(n+1)=7.586299e+001;
n=19; farx(n+1)=2.758307e+000; foe(n+1)=1.229287e+002; krok(n+1)=1.263598e+000; ng(n+1)=7.325546e+001;
n=20; farx(n+1)=2.720682e+000; foe(n+1)=1.172769e+002; krok(n+1)=4.498732e-001; ng(n+1)=3.461599e+001;
n=21; farx(n+1)=2.691617e+000; foe(n+1)=1.196097e+002; krok(n+1)=1.334889e+000; ng(n+1)=3.828543e+001;
n=22; farx(n+1)=2.682983e+000; foe(n+1)=1.279885e+002; krok(n+1)=1.174181e+000; ng(n+1)=2.092825e+001;
n=23; farx(n+1)=2.679328e+000; foe(n+1)=1.242242e+002; krok(n+1)=1.150553e+000; ng(n+1)=1.112873e+001;
n=24; farx(n+1)=2.679016e+000; foe(n+1)=1.256149e+002; krok(n+1)=6.287558e-001; ng(n+1)=2.981532e+000;
n=25; farx(n+1)=2.678907e+000; foe(n+1)=1.265545e+002; krok(n+1)=1.001473e+000; ng(n+1)=2.338611e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.678889e+000; foe(n+1)=1.264840e+002; krok(n+1)=1.582138e-004; ng(n+1)=6.676655e-001;
n=27; farx(n+1)=2.678884e+000; foe(n+1)=1.263428e+002; krok(n+1)=7.184271e-005; ng(n+1)=6.236410e-001;
n=28; farx(n+1)=2.678324e+000; foe(n+1)=1.231548e+002; krok(n+1)=2.437335e-003; ng(n+1)=1.176045e+000;
n=29; farx(n+1)=2.673242e+000; foe(n+1)=1.215663e+002; krok(n+1)=7.931784e-003; ng(n+1)=1.799902e+000;
n=30; farx(n+1)=2.667191e+000; foe(n+1)=1.172175e+002; krok(n+1)=2.056099e-001; ng(n+1)=5.126530e+000;
n=31; farx(n+1)=2.664120e+000; foe(n+1)=1.160866e+002; krok(n+1)=6.376768e-002; ng(n+1)=2.156324e+001;
n=32; farx(n+1)=2.662382e+000; foe(n+1)=1.159886e+002; krok(n+1)=4.710295e-002; ng(n+1)=3.345592e+001;
n=33; farx(n+1)=2.654507e+000; foe(n+1)=1.202223e+002; krok(n+1)=1.045307e+000; ng(n+1)=3.978719e+001;
n=34; farx(n+1)=2.644548e+000; foe(n+1)=1.170049e+002; krok(n+1)=2.081446e+000; ng(n+1)=1.229998e+001;
n=35; farx(n+1)=2.641975e+000; foe(n+1)=1.144282e+002; krok(n+1)=3.556863e-001; ng(n+1)=1.336965e+001;
n=36; farx(n+1)=2.638534e+000; foe(n+1)=1.146018e+002; krok(n+1)=7.847380e-001; ng(n+1)=2.768856e+001;
n=37; farx(n+1)=2.634470e+000; foe(n+1)=1.162602e+002; krok(n+1)=2.840668e+000; ng(n+1)=1.407070e+001;
n=38; farx(n+1)=2.631946e+000; foe(n+1)=1.136687e+002; krok(n+1)=3.372291e-001; ng(n+1)=1.048127e+001;
n=39; farx(n+1)=2.631332e+000; foe(n+1)=1.125507e+002; krok(n+1)=7.310195e-001; ng(n+1)=1.127924e+001;
n=40; farx(n+1)=2.630693e+000; foe(n+1)=1.127110e+002; krok(n+1)=1.361453e+000; ng(n+1)=1.020977e+001;
n=41; farx(n+1)=2.629717e+000; foe(n+1)=1.112743e+002; krok(n+1)=1.120145e+000; ng(n+1)=4.774372e+000;
n=42; farx(n+1)=2.629237e+000; foe(n+1)=1.129622e+002; krok(n+1)=1.477307e+000; ng(n+1)=6.342295e+000;
n=43; farx(n+1)=2.628895e+000; foe(n+1)=1.114141e+002; krok(n+1)=1.920768e+000; ng(n+1)=3.301514e+000;
n=44; farx(n+1)=2.628859e+000; foe(n+1)=1.116381e+002; krok(n+1)=4.904031e-001; ng(n+1)=2.163969e+000;
n=45; farx(n+1)=2.628802e+000; foe(n+1)=1.116443e+002; krok(n+1)=9.205345e-001; ng(n+1)=9.823591e-001;
n=46; farx(n+1)=2.628791e+000; foe(n+1)=1.117174e+002; krok(n+1)=1.072499e+000; ng(n+1)=3.966570e-001;
n=47; farx(n+1)=2.628788e+000; foe(n+1)=1.116921e+002; krok(n+1)=1.222664e+000; ng(n+1)=2.935405e-001;
n=48; farx(n+1)=2.628786e+000; foe(n+1)=1.116282e+002; krok(n+1)=1.287153e+000; ng(n+1)=6.944320e-001;
n=49; farx(n+1)=2.628782e+000; foe(n+1)=1.117075e+002; krok(n+1)=4.262067e+000; ng(n+1)=3.740760e-001;
n=50; farx(n+1)=2.628781e+000; foe(n+1)=1.117662e+002; krok(n+1)=1.033731e+000; ng(n+1)=6.634561e-002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.628781e+000; foe(n+1)=1.117589e+002; krok(n+1)=2.518354e-005; ng(n+1)=7.866463e-002;
n=52; farx(n+1)=2.628781e+000; foe(n+1)=1.117529e+002; krok(n+1)=3.754715e-005; ng(n+1)=7.367301e-002;
n=53; farx(n+1)=2.628781e+000; foe(n+1)=1.117297e+002; krok(n+1)=4.676141e-004; ng(n+1)=1.591061e-002;
n=54; farx(n+1)=2.628781e+000; foe(n+1)=1.117300e+002; krok(n+1)=1.706649e-002; ng(n+1)=1.175269e-003;
n=55; farx(n+1)=2.628781e+000; foe(n+1)=1.117305e+002; krok(n+1)=7.157273e-002; ng(n+1)=1.882471e-004;
n=56; farx(n+1)=2.628781e+000; foe(n+1)=1.117310e+002; krok(n+1)=2.343012e-001; ng(n+1)=1.802672e-004;
n=57; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=4.428063e+000; ng(n+1)=1.393081e-004;
n=58; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=8.650711e-006; ng(n+1)=5.903111e-004;
n=59; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=1.609499e-005; ng(n+1)=5.903060e-004;
n=60; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=1.509979e-006; ng(n+1)=5.902965e-004;
n=61; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=6.685643e-010; ng(n+1)=5.902956e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=62; farx(n+1)=2.628781e+000; foe(n+1)=1.117337e+002; krok(n+1)=1.345208e-005; ng(n+1)=5.902956e-004;
n=63; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=9.130829e-005; ng(n+1)=2.723263e-004;
n=64; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.025158e-004; ng(n+1)=1.428924e-004;
n=65; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.156128e-010; ng(n+1)=1.982180e-005;
n=66; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.016512e-011; ng(n+1)=1.982180e-005;
n=67; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.921440e-009; ng(n+1)=1.982180e-005;
n=68; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=7.559044e-007; ng(n+1)=1.982179e-005;
n=69; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.858372e-006; ng(n+1)=1.982127e-005;
n=70; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.182712e-006; ng(n+1)=1.982091e-005;
n=71; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.504753e-005; ng(n+1)=1.982114e-005;
n=72; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.069939e-005; ng(n+1)=1.981973e-005;
n=73; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=9.806150e-006; ng(n+1)=1.981953e-005;
n=74; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.058231e-008; ng(n+1)=1.981931e-005;
n=75; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.295862e-008; ng(n+1)=1.981931e-005;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.575152e-006; ng(n+1)=1.981930e-005;
n=77; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.855124e-005; ng(n+1)=1.899652e-005;
n=78; farx(n+1)=2.628781e+000; foe(n+1)=1.117338e+002; krok(n+1)=8.485096e-004; ng(n+1)=7.761959e-005;
n=79; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.316587e-003; ng(n+1)=7.266285e-005;
n=80; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.452764e-006; ng(n+1)=6.273885e-005;
n=81; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=7.137811e-006; ng(n+1)=6.273841e-005;
n=82; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.069939e-005; ng(n+1)=6.273768e-005;
n=83; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.968806e-006; ng(n+1)=6.273691e-005;
n=84; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.835537e-008; ng(n+1)=6.273672e-005;
n=85; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.306258e-006; ng(n+1)=6.273672e-005;
n=86; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.204225e-009; ng(n+1)=6.273665e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
