%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.842159e+003; foe(n+1)=4.762351e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.303418e+003; foe(n+1)=3.722996e+003; krok(n+1)=3.674451e-004; ng(n+1)=7.835433e+003;
n=2; farx(n+1)=1.798998e+003; foe(n+1)=7.467643e+003; krok(n+1)=1.874926e-004; ng(n+1)=1.197963e+004;
n=3; farx(n+1)=1.039694e+003; foe(n+1)=1.589948e+004; krok(n+1)=1.858107e-004; ng(n+1)=1.188502e+004;
n=4; farx(n+1)=7.185777e+002; foe(n+1)=1.629675e+004; krok(n+1)=8.940659e-004; ng(n+1)=1.024206e+004;
n=5; farx(n+1)=1.620854e+002; foe(n+1)=8.892206e+003; krok(n+1)=1.029641e-003; ng(n+1)=9.672216e+003;
n=6; farx(n+1)=7.970476e+001; foe(n+1)=8.979878e+003; krok(n+1)=1.469853e-003; ng(n+1)=1.335604e+003;
n=7; farx(n+1)=4.910039e+001; foe(n+1)=9.417149e+003; krok(n+1)=9.933991e-004; ng(n+1)=2.093074e+003;
n=8; farx(n+1)=2.432423e+001; foe(n+1)=8.595001e+002; krok(n+1)=3.141705e-003; ng(n+1)=8.081441e+002;
n=9; farx(n+1)=1.575672e+001; foe(n+1)=7.656243e+002; krok(n+1)=1.548092e-003; ng(n+1)=1.509439e+003;
n=10; farx(n+1)=1.072855e+001; foe(n+1)=4.766757e+002; krok(n+1)=1.810600e-003; ng(n+1)=1.405837e+003;
n=11; farx(n+1)=6.526382e+000; foe(n+1)=1.070253e+002; krok(n+1)=9.348086e-003; ng(n+1)=5.442078e+002;
n=12; farx(n+1)=4.594777e+000; foe(n+1)=1.058438e+002; krok(n+1)=1.525264e-002; ng(n+1)=3.646726e+002;
n=13; farx(n+1)=3.899569e+000; foe(n+1)=9.322243e+001; krok(n+1)=6.963555e-003; ng(n+1)=2.888243e+002;
n=14; farx(n+1)=3.550411e+000; foe(n+1)=7.797067e+001; krok(n+1)=2.415320e-003; ng(n+1)=1.324044e+002;
n=15; farx(n+1)=2.097292e+000; foe(n+1)=7.342821e+001; krok(n+1)=3.052860e-002; ng(n+1)=1.644641e+002;
n=16; farx(n+1)=1.880611e+000; foe(n+1)=5.105487e+001; krok(n+1)=1.175883e-002; ng(n+1)=5.320601e+001;
n=17; farx(n+1)=1.651344e+000; foe(n+1)=4.342980e+001; krok(n+1)=2.223039e-002; ng(n+1)=1.266715e+002;
n=18; farx(n+1)=1.447216e+000; foe(n+1)=4.552937e+001; krok(n+1)=1.773103e-002; ng(n+1)=1.558994e+002;
n=19; farx(n+1)=1.217230e+000; foe(n+1)=6.608409e+001; krok(n+1)=9.716385e-002; ng(n+1)=1.180432e+002;
n=20; farx(n+1)=1.127577e+000; foe(n+1)=5.576259e+001; krok(n+1)=7.959957e-002; ng(n+1)=4.628607e+001;
n=21; farx(n+1)=1.050602e+000; foe(n+1)=6.238337e+001; krok(n+1)=3.106913e-002; ng(n+1)=6.156777e+001;
n=22; farx(n+1)=8.499635e-001; foe(n+1)=4.396335e+001; krok(n+1)=8.877087e-002; ng(n+1)=1.249752e+002;
n=23; farx(n+1)=7.641935e-001; foe(n+1)=4.840149e+001; krok(n+1)=1.016482e-001; ng(n+1)=1.335895e+002;
n=24; farx(n+1)=6.918973e-001; foe(n+1)=4.478700e+001; krok(n+1)=2.250273e-001; ng(n+1)=4.904236e+001;
n=25; farx(n+1)=6.390678e-001; foe(n+1)=5.407581e+001; krok(n+1)=1.919924e-001; ng(n+1)=7.546236e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=6.286929e-001; foe(n+1)=5.296404e+001; krok(n+1)=8.683747e-005; ng(n+1)=5.282433e+001;
n=27; farx(n+1)=6.230251e-001; foe(n+1)=5.311346e+001; krok(n+1)=1.964993e-003; ng(n+1)=8.163546e+000;
n=28; farx(n+1)=5.909486e-001; foe(n+1)=5.297762e+001; krok(n+1)=5.277180e-004; ng(n+1)=3.768633e+001;
n=29; farx(n+1)=5.829175e-001; foe(n+1)=5.646297e+001; krok(n+1)=1.721185e-003; ng(n+1)=1.439148e+001;
n=30; farx(n+1)=5.776197e-001; foe(n+1)=6.037613e+001; krok(n+1)=4.432757e-003; ng(n+1)=1.497004e+001;
n=31; farx(n+1)=5.646882e-001; foe(n+1)=6.384517e+001; krok(n+1)=2.876644e-002; ng(n+1)=1.944156e+001;
n=32; farx(n+1)=5.296413e-001; foe(n+1)=4.074729e+001; krok(n+1)=1.102898e-001; ng(n+1)=4.289756e+001;
n=33; farx(n+1)=5.040847e-001; foe(n+1)=3.575577e+001; krok(n+1)=5.466235e-002; ng(n+1)=7.192611e+001;
n=34; farx(n+1)=4.909152e-001; foe(n+1)=3.469455e+001; krok(n+1)=4.815335e-002; ng(n+1)=4.651317e+001;
n=35; farx(n+1)=4.751030e-001; foe(n+1)=3.329906e+001; krok(n+1)=4.356626e-002; ng(n+1)=1.932050e+001;
n=36; farx(n+1)=4.637831e-001; foe(n+1)=3.235686e+001; krok(n+1)=5.730115e-002; ng(n+1)=3.274104e+001;
n=37; farx(n+1)=4.418731e-001; foe(n+1)=2.578104e+001; krok(n+1)=1.902702e-001; ng(n+1)=3.500067e+001;
n=38; farx(n+1)=4.366166e-001; foe(n+1)=2.556590e+001; krok(n+1)=3.706539e-002; ng(n+1)=2.272075e+001;
n=39; farx(n+1)=4.239768e-001; foe(n+1)=2.102074e+001; krok(n+1)=8.268560e-002; ng(n+1)=2.596120e+001;
n=40; farx(n+1)=4.078972e-001; foe(n+1)=2.071056e+001; krok(n+1)=1.178633e-001; ng(n+1)=3.058486e+001;
n=41; farx(n+1)=3.933739e-001; foe(n+1)=2.108821e+001; krok(n+1)=1.032026e-001; ng(n+1)=2.508628e+001;
n=42; farx(n+1)=3.828594e-001; foe(n+1)=2.021516e+001; krok(n+1)=8.475198e-002; ng(n+1)=3.899523e+001;
n=43; farx(n+1)=3.643512e-001; foe(n+1)=2.124741e+001; krok(n+1)=2.082003e-001; ng(n+1)=1.419891e+001;
n=44; farx(n+1)=3.573596e-001; foe(n+1)=2.107810e+001; krok(n+1)=6.918375e-002; ng(n+1)=2.995253e+001;
n=45; farx(n+1)=3.456275e-001; foe(n+1)=1.885152e+001; krok(n+1)=1.919924e-001; ng(n+1)=2.527748e+001;
n=46; farx(n+1)=3.428201e-001; foe(n+1)=1.869292e+001; krok(n+1)=1.331896e-001; ng(n+1)=2.207659e+001;
n=47; farx(n+1)=3.184328e-001; foe(n+1)=9.080073e+000; krok(n+1)=2.139750e-001; ng(n+1)=7.915996e+000;
n=48; farx(n+1)=3.126006e-001; foe(n+1)=7.029593e+000; krok(n+1)=6.209076e-002; ng(n+1)=3.789876e+001;
n=49; farx(n+1)=3.060073e-001; foe(n+1)=6.023064e+000; krok(n+1)=1.545508e-001; ng(n+1)=1.093626e+001;
n=50; farx(n+1)=3.016936e-001; foe(n+1)=5.666529e+000; krok(n+1)=1.372747e-001; ng(n+1)=1.520363e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.998329e-001; foe(n+1)=5.714878e+000; krok(n+1)=5.618497e-005; ng(n+1)=2.929701e+001;
n=52; farx(n+1)=2.995739e-001; foe(n+1)=5.616839e+000; krok(n+1)=1.131625e-004; ng(n+1)=7.645045e+000;
n=53; farx(n+1)=2.971746e-001; foe(n+1)=5.216246e+000; krok(n+1)=2.257520e-003; ng(n+1)=5.766021e+000;
n=54; farx(n+1)=2.966530e-001; foe(n+1)=5.289882e+000; krok(n+1)=1.073668e-002; ng(n+1)=1.130505e+000;
n=55; farx(n+1)=2.962502e-001; foe(n+1)=5.260763e+000; krok(n+1)=2.156451e-003; ng(n+1)=2.103661e+000;
n=56; farx(n+1)=2.955663e-001; foe(n+1)=5.482193e+000; krok(n+1)=4.904612e-002; ng(n+1)=7.539567e-001;
n=57; farx(n+1)=2.931364e-001; foe(n+1)=5.577696e+000; krok(n+1)=2.442288e-001; ng(n+1)=5.537920e-001;
n=58; farx(n+1)=2.918334e-001; foe(n+1)=5.610663e+000; krok(n+1)=7.763827e-002; ng(n+1)=1.004222e+001;
n=59; farx(n+1)=2.904805e-001; foe(n+1)=5.398716e+000; krok(n+1)=8.973318e-002; ng(n+1)=1.216542e+001;
n=60; farx(n+1)=2.895411e-001; foe(n+1)=5.214060e+000; krok(n+1)=5.234463e-002; ng(n+1)=4.240725e+000;
n=61; farx(n+1)=2.884779e-001; foe(n+1)=4.713323e+000; krok(n+1)=1.961845e-001; ng(n+1)=1.010738e+001;
n=62; farx(n+1)=2.863583e-001; foe(n+1)=4.414829e+000; krok(n+1)=1.981558e-001; ng(n+1)=8.916298e+000;
n=63; farx(n+1)=2.847274e-001; foe(n+1)=4.365811e+000; krok(n+1)=1.107294e-001; ng(n+1)=1.101841e+001;
n=64; farx(n+1)=2.835813e-001; foe(n+1)=4.243037e+000; krok(n+1)=3.780408e-001; ng(n+1)=5.732553e+000;
n=65; farx(n+1)=2.812294e-001; foe(n+1)=3.911205e+000; krok(n+1)=1.845727e-001; ng(n+1)=1.755402e+001;
n=66; farx(n+1)=2.787427e-001; foe(n+1)=3.776118e+000; krok(n+1)=5.779250e-001; ng(n+1)=6.076021e+000;
n=67; farx(n+1)=2.772375e-001; foe(n+1)=3.748239e+000; krok(n+1)=2.357265e-001; ng(n+1)=1.614683e+001;
n=68; farx(n+1)=2.742699e-001; foe(n+1)=4.050172e+000; krok(n+1)=5.045340e-001; ng(n+1)=9.471858e+000;
n=69; farx(n+1)=2.720201e-001; foe(n+1)=4.003574e+000; krok(n+1)=2.134155e-001; ng(n+1)=5.278123e+000;
n=70; farx(n+1)=2.704681e-001; foe(n+1)=4.125188e+000; krok(n+1)=2.461541e-001; ng(n+1)=5.801746e+000;
n=71; farx(n+1)=2.688820e-001; foe(n+1)=4.226125e+000; krok(n+1)=2.944474e-001; ng(n+1)=1.703280e+001;
n=72; farx(n+1)=2.675653e-001; foe(n+1)=3.969607e+000; krok(n+1)=5.988308e-001; ng(n+1)=4.229936e+000;
n=73; farx(n+1)=2.664667e-001; foe(n+1)=3.987035e+000; krok(n+1)=1.569501e-001; ng(n+1)=9.705960e+000;
n=74; farx(n+1)=2.653488e-001; foe(n+1)=3.653156e+000; krok(n+1)=3.200292e-001; ng(n+1)=5.057371e+000;
n=75; farx(n+1)=2.640061e-001; foe(n+1)=3.459101e+000; krok(n+1)=2.268451e-001; ng(n+1)=1.584319e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.638853e-001; foe(n+1)=3.458458e+000; krok(n+1)=6.078783e-005; ng(n+1)=7.810222e+000;
n=77; farx(n+1)=2.638621e-001; foe(n+1)=3.452757e+000; krok(n+1)=7.005353e-005; ng(n+1)=3.103804e+000;
n=78; farx(n+1)=2.637897e-001; foe(n+1)=3.476905e+000; krok(n+1)=1.402081e-003; ng(n+1)=1.169617e+000;
n=79; farx(n+1)=2.636323e-001; foe(n+1)=3.492502e+000; krok(n+1)=1.163808e-002; ng(n+1)=5.403797e-001;
n=80; farx(n+1)=2.634532e-001; foe(n+1)=3.468373e+000; krok(n+1)=5.767896e-003; ng(n+1)=8.024957e-001;
n=81; farx(n+1)=2.632903e-001; foe(n+1)=3.541922e+000; krok(n+1)=8.172294e-002; ng(n+1)=2.251791e-001;
n=82; farx(n+1)=2.629573e-001; foe(n+1)=3.806084e+000; krok(n+1)=1.181740e-001; ng(n+1)=3.222916e-001;
n=83; farx(n+1)=2.627825e-001; foe(n+1)=3.829312e+000; krok(n+1)=3.406610e-002; ng(n+1)=6.719210e-001;
n=84; farx(n+1)=2.624758e-001; foe(n+1)=3.906617e+000; krok(n+1)=2.363480e-001; ng(n+1)=1.106975e+000;
n=85; farx(n+1)=2.622990e-001; foe(n+1)=3.849934e+000; krok(n+1)=4.235232e-002; ng(n+1)=6.035475e+000;
n=86; farx(n+1)=2.616430e-001; foe(n+1)=3.779729e+000; krok(n+1)=3.780408e-001; ng(n+1)=5.595477e+000;
n=87; farx(n+1)=2.602920e-001; foe(n+1)=3.537606e+000; krok(n+1)=6.293018e-001; ng(n+1)=9.117367e+000;
n=88; farx(n+1)=2.592632e-001; foe(n+1)=3.478009e+000; krok(n+1)=4.635137e-001; ng(n+1)=4.036928e+000;
n=89; farx(n+1)=2.588791e-001; foe(n+1)=3.466396e+000; krok(n+1)=1.328156e-001; ng(n+1)=4.601419e+000;
n=90; farx(n+1)=2.582264e-001; foe(n+1)=3.410144e+000; krok(n+1)=3.963116e-001; ng(n+1)=5.225890e+000;
n=91; farx(n+1)=2.575640e-001; foe(n+1)=3.219171e+000; krok(n+1)=4.461084e-001; ng(n+1)=1.104343e+001;
n=92; farx(n+1)=2.566054e-001; foe(n+1)=3.003136e+000; krok(n+1)=6.321212e-001; ng(n+1)=7.339060e+000;
n=93; farx(n+1)=2.554806e-001; foe(n+1)=3.041720e+000; krok(n+1)=9.282331e-001; ng(n+1)=5.399924e+000;
n=94; farx(n+1)=2.550993e-001; foe(n+1)=3.006136e+000; krok(n+1)=2.621866e-001; ng(n+1)=9.359508e+000;
n=95; farx(n+1)=2.545036e-001; foe(n+1)=2.839629e+000; krok(n+1)=4.884576e-001; ng(n+1)=5.087818e+000;
n=96; farx(n+1)=2.536492e-001; foe(n+1)=2.731654e+000; krok(n+1)=3.505976e-001; ng(n+1)=1.613405e+000;
n=97; farx(n+1)=2.533406e-001; foe(n+1)=2.675452e+000; krok(n+1)=1.607119e-001; ng(n+1)=8.365402e+000;
n=98; farx(n+1)=2.525020e-001; foe(n+1)=2.676010e+000; krok(n+1)=9.073805e-001; ng(n+1)=1.862665e+000;
n=99; farx(n+1)=2.514555e-001; foe(n+1)=2.440569e+000; krok(n+1)=4.287623e-001; ng(n+1)=9.627490e+000;
n=100; farx(n+1)=2.498792e-001; foe(n+1)=2.371479e+000; krok(n+1)=6.258076e-001; ng(n+1)=1.009889e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
