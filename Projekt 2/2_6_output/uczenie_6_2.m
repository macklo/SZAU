%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.156811e+003; foe(n+1)=4.248694e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.261214e+003; foe(n+1)=3.124396e+003; krok(n+1)=5.685319e-004; ng(n+1)=3.101914e+003;
n=2; farx(n+1)=6.618930e+002; foe(n+1)=9.103639e+003; krok(n+1)=9.232346e-004; ng(n+1)=2.683583e+003;
n=3; farx(n+1)=3.714051e+002; foe(n+1)=1.154416e+004; krok(n+1)=1.602144e-003; ng(n+1)=1.749121e+003;
n=4; farx(n+1)=3.797576e+001; foe(n+1)=3.723353e+003; krok(n+1)=1.111520e-002; ng(n+1)=1.568583e+003;
n=5; farx(n+1)=3.773547e+001; foe(n+1)=3.675849e+003; krok(n+1)=2.125792e-004; ng(n+1)=3.414728e+002;
n=6; farx(n+1)=3.658164e+001; foe(n+1)=1.279053e+003; krok(n+1)=1.263902e-002; ng(n+1)=2.636990e+002;
n=7; farx(n+1)=2.843668e+001; foe(n+1)=1.134496e+003; krok(n+1)=6.807263e-001; ng(n+1)=2.743699e+002;
n=8; farx(n+1)=2.236295e+001; foe(n+1)=3.441808e+003; krok(n+1)=6.855549e-001; ng(n+1)=9.294136e+001;
n=9; farx(n+1)=1.504800e+001; foe(n+1)=3.740701e+002; krok(n+1)=1.009068e+000; ng(n+1)=1.299054e+002;
n=10; farx(n+1)=1.194047e+001; foe(n+1)=1.340450e+002; krok(n+1)=4.083285e-001; ng(n+1)=1.985300e+002;
n=11; farx(n+1)=8.744403e+000; foe(n+1)=2.876385e+002; krok(n+1)=7.847380e-001; ng(n+1)=2.083450e+002;
n=12; farx(n+1)=6.216283e+000; foe(n+1)=3.055421e+002; krok(n+1)=8.088973e-001; ng(n+1)=8.332586e+001;
n=13; farx(n+1)=5.611653e+000; foe(n+1)=2.529681e+002; krok(n+1)=4.787134e-001; ng(n+1)=7.674540e+001;
n=14; farx(n+1)=4.348040e+000; foe(n+1)=1.118150e+002; krok(n+1)=2.180230e+000; ng(n+1)=1.103427e+002;
n=15; farx(n+1)=3.870263e+000; foe(n+1)=1.121807e+002; krok(n+1)=4.810883e-001; ng(n+1)=1.817659e+001;
n=16; farx(n+1)=3.555286e+000; foe(n+1)=1.796704e+002; krok(n+1)=4.842714e-001; ng(n+1)=6.206589e+001;
n=17; farx(n+1)=3.201615e+000; foe(n+1)=1.295154e+002; krok(n+1)=2.840668e+000; ng(n+1)=5.075067e+001;
n=18; farx(n+1)=3.053821e+000; foe(n+1)=1.218200e+002; krok(n+1)=7.310195e-001; ng(n+1)=7.637746e+001;
n=19; farx(n+1)=2.975837e+000; foe(n+1)=1.194057e+002; krok(n+1)=4.500546e-001; ng(n+1)=2.156160e+001;
n=20; farx(n+1)=2.905890e+000; foe(n+1)=1.330181e+002; krok(n+1)=9.270274e-001; ng(n+1)=4.397918e+001;
n=21; farx(n+1)=2.858261e+000; foe(n+1)=1.499050e+002; krok(n+1)=1.098329e+000; ng(n+1)=4.434645e+001;
n=22; farx(n+1)=2.810641e+000; foe(n+1)=1.344157e+002; krok(n+1)=1.199074e+000; ng(n+1)=1.969334e+001;
n=23; farx(n+1)=2.791562e+000; foe(n+1)=1.347048e+002; krok(n+1)=9.961132e-001; ng(n+1)=1.605250e+001;
n=24; farx(n+1)=2.782216e+000; foe(n+1)=1.398562e+002; krok(n+1)=5.841487e-001; ng(n+1)=7.023811e+000;
n=25; farx(n+1)=2.771893e+000; foe(n+1)=1.465248e+002; krok(n+1)=7.178655e-001; ng(n+1)=2.104879e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.769779e+000; foe(n+1)=1.494672e+002; krok(n+1)=2.253084e-005; ng(n+1)=2.250897e+001;
n=27; farx(n+1)=2.768496e+000; foe(n+1)=1.442261e+002; krok(n+1)=9.534365e-004; ng(n+1)=2.924427e+000;
n=28; farx(n+1)=2.768034e+000; foe(n+1)=1.424315e+002; krok(n+1)=2.014683e-004; ng(n+1)=3.188263e+000;
n=29; farx(n+1)=2.741653e+000; foe(n+1)=1.300162e+002; krok(n+1)=4.366353e-002; ng(n+1)=1.793927e+000;
n=30; farx(n+1)=2.732685e+000; foe(n+1)=1.249255e+002; krok(n+1)=9.563284e-002; ng(n+1)=1.000153e+001;
n=31; farx(n+1)=2.723343e+000; foe(n+1)=1.209032e+002; krok(n+1)=8.000730e-002; ng(n+1)=2.513379e+001;
n=32; farx(n+1)=2.717836e+000; foe(n+1)=1.213466e+002; krok(n+1)=1.277097e-001; ng(n+1)=4.796701e+001;
n=33; farx(n+1)=2.699467e+000; foe(n+1)=1.265673e+002; krok(n+1)=8.456470e-001; ng(n+1)=6.078207e+001;
n=34; farx(n+1)=2.680167e+000; foe(n+1)=1.252084e+002; krok(n+1)=1.495995e+000; ng(n+1)=2.493483e+001;
n=35; farx(n+1)=2.668239e+000; foe(n+1)=1.183744e+002; krok(n+1)=4.842714e-001; ng(n+1)=1.341454e+001;
n=36; farx(n+1)=2.662827e+000; foe(n+1)=1.167697e+002; krok(n+1)=7.101669e-001; ng(n+1)=3.096302e+001;
n=37; farx(n+1)=2.656771e+000; foe(n+1)=1.197577e+002; krok(n+1)=1.172469e+000; ng(n+1)=2.973554e+001;
n=38; farx(n+1)=2.647471e+000; foe(n+1)=1.145041e+002; krok(n+1)=1.280117e+000; ng(n+1)=1.189128e+001;
n=39; farx(n+1)=2.642356e+000; foe(n+1)=1.165981e+002; krok(n+1)=1.764637e+000; ng(n+1)=2.031197e+001;
n=40; farx(n+1)=2.639184e+000; foe(n+1)=1.143094e+002; krok(n+1)=4.859246e-001; ng(n+1)=1.088853e+001;
n=41; farx(n+1)=2.636353e+000; foe(n+1)=1.139949e+002; krok(n+1)=6.744582e-001; ng(n+1)=1.877829e+001;
n=42; farx(n+1)=2.634841e+000; foe(n+1)=1.123068e+002; krok(n+1)=8.892951e-001; ng(n+1)=6.570520e+000;
n=43; farx(n+1)=2.632711e+000; foe(n+1)=1.144442e+002; krok(n+1)=1.492310e+000; ng(n+1)=1.130290e+001;
n=44; farx(n+1)=2.630962e+000; foe(n+1)=1.130968e+002; krok(n+1)=4.228884e-001; ng(n+1)=5.017276e+000;
n=45; farx(n+1)=2.630321e+000; foe(n+1)=1.116905e+002; krok(n+1)=1.092255e+000; ng(n+1)=8.466542e+000;
n=46; farx(n+1)=2.629798e+000; foe(n+1)=1.122394e+002; krok(n+1)=1.049915e+000; ng(n+1)=8.166573e+000;
n=47; farx(n+1)=2.629205e+000; foe(n+1)=1.118312e+002; krok(n+1)=1.033373e+000; ng(n+1)=5.738458e+000;
n=48; farx(n+1)=2.628909e+000; foe(n+1)=1.119960e+002; krok(n+1)=1.691553e+000; ng(n+1)=4.252537e+000;
n=49; farx(n+1)=2.628823e+000; foe(n+1)=1.119710e+002; krok(n+1)=1.206842e+000; ng(n+1)=2.813242e+000;
n=50; farx(n+1)=2.628793e+000; foe(n+1)=1.116877e+002; krok(n+1)=5.683253e-001; ng(n+1)=8.979462e-001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.628791e+000; foe(n+1)=1.117353e+002; krok(n+1)=2.537849e-005; ng(n+1)=6.058132e-001;
n=52; farx(n+1)=2.628789e+000; foe(n+1)=1.117582e+002; krok(n+1)=3.395536e-005; ng(n+1)=4.962019e-001;
n=53; farx(n+1)=2.628789e+000; foe(n+1)=1.118417e+002; krok(n+1)=6.409943e-004; ng(n+1)=4.318697e-002;
n=54; farx(n+1)=2.628787e+000; foe(n+1)=1.118304e+002; krok(n+1)=1.438335e-002; ng(n+1)=2.176827e-002;
n=55; farx(n+1)=2.628787e+000; foe(n+1)=1.118368e+002; krok(n+1)=5.753341e-002; ng(n+1)=4.821336e-003;
n=56; farx(n+1)=2.628786e+000; foe(n+1)=1.118077e+002; krok(n+1)=5.930463e-001; ng(n+1)=2.503351e-003;
n=57; farx(n+1)=2.628781e+000; foe(n+1)=1.117264e+002; krok(n+1)=1.988424e+000; ng(n+1)=5.602771e-003;
n=58; farx(n+1)=2.628781e+000; foe(n+1)=1.117351e+002; krok(n+1)=1.026286e+000; ng(n+1)=1.095828e-001;
n=59; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.002692e+000; ng(n+1)=1.470782e-003;
n=60; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.404624e-005; ng(n+1)=2.158860e-004;
n=61; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.404659e-006; ng(n+1)=2.158830e-004;
n=62; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=7.029505e-006; ng(n+1)=2.158821e-004;
n=63; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.793088e-008; ng(n+1)=2.158806e-004;
n=64; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.179450e-008; ng(n+1)=2.158806e-004;
n=65; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.859605e-009; ng(n+1)=2.158806e-004;
n=66; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.270853e-009; ng(n+1)=2.158806e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=67; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.069939e-005; ng(n+1)=2.158806e-004;
n=68; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.408178e-006; ng(n+1)=1.403250e-005;
n=69; farx(n+1)=2.628781e+000; foe(n+1)=1.117340e+002; krok(n+1)=7.075767e-004; ng(n+1)=1.400845e-005;
n=70; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=8.417870e-004; ng(n+1)=4.849337e-005;
n=71; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.086355e-006; ng(n+1)=3.989794e-005;
n=72; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=5.088222e-008; ng(n+1)=3.989790e-005;
n=73; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.676308e-007; ng(n+1)=3.989790e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
