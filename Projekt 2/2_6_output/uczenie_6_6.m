%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.225205e+003; foe(n+1)=4.291560e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.698679e+003; foe(n+1)=3.081580e+003; krok(n+1)=5.469456e-004; ng(n+1)=2.602058e+003;
n=2; farx(n+1)=1.346930e+003; foe(n+1)=8.138430e+003; krok(n+1)=9.854180e-004; ng(n+1)=2.045490e+003;
n=3; farx(n+1)=9.462412e+002; foe(n+1)=1.164903e+004; krok(n+1)=4.264342e-004; ng(n+1)=3.163800e+003;
n=4; farx(n+1)=4.300295e+002; foe(n+1)=1.780657e+004; krok(n+1)=1.624327e-002; ng(n+1)=2.233164e+003;
n=5; farx(n+1)=4.292060e+002; foe(n+1)=1.781830e+004; krok(n+1)=6.579014e-006; ng(n+1)=1.993856e+003;
n=6; farx(n+1)=8.430097e+001; foe(n+1)=1.572762e+004; krok(n+1)=7.386536e-001; ng(n+1)=1.838236e+003;
n=7; farx(n+1)=5.047095e+001; foe(n+1)=7.639159e+003; krok(n+1)=1.433103e-001; ng(n+1)=7.483315e+002;
n=8; farx(n+1)=2.350499e+001; foe(n+1)=1.101886e+003; krok(n+1)=5.007363e-001; ng(n+1)=6.256520e+002;
n=9; farx(n+1)=1.574675e+001; foe(n+1)=3.360709e+002; krok(n+1)=1.179292e+000; ng(n+1)=4.448114e+002;
n=10; farx(n+1)=1.389234e+001; foe(n+1)=1.604106e+002; krok(n+1)=1.181678e+000; ng(n+1)=7.440867e+001;
n=11; farx(n+1)=1.267601e+001; foe(n+1)=2.636437e+002; krok(n+1)=8.635342e-001; ng(n+1)=1.113227e+002;
n=12; farx(n+1)=1.084471e+001; foe(n+1)=3.747988e+002; krok(n+1)=2.491529e+000; ng(n+1)=1.954744e+002;
n=13; farx(n+1)=6.652306e+000; foe(n+1)=2.453567e+002; krok(n+1)=3.266628e+000; ng(n+1)=4.770590e+001;
n=14; farx(n+1)=5.066731e+000; foe(n+1)=1.236989e+002; krok(n+1)=1.214023e+000; ng(n+1)=2.225884e+002;
n=15; farx(n+1)=4.449286e+000; foe(n+1)=1.331083e+002; krok(n+1)=5.535078e-001; ng(n+1)=1.711994e+001;
n=16; farx(n+1)=4.052021e+000; foe(n+1)=1.907493e+002; krok(n+1)=1.090364e+000; ng(n+1)=9.441050e+001;
n=17; farx(n+1)=3.705879e+000; foe(n+1)=1.500961e+002; krok(n+1)=1.397233e+000; ng(n+1)=5.056475e+001;
n=18; farx(n+1)=3.556371e+000; foe(n+1)=1.534326e+002; krok(n+1)=8.055989e-001; ng(n+1)=2.940627e+001;
n=19; farx(n+1)=3.477287e+000; foe(n+1)=1.696762e+002; krok(n+1)=1.131462e+000; ng(n+1)=4.193247e+001;
n=20; farx(n+1)=3.434296e+000; foe(n+1)=2.094957e+002; krok(n+1)=3.806077e-001; ng(n+1)=1.770914e+001;
n=21; farx(n+1)=3.415824e+000; foe(n+1)=2.241366e+002; krok(n+1)=1.454604e+000; ng(n+1)=2.218720e+001;
n=22; farx(n+1)=3.407137e+000; foe(n+1)=2.149873e+002; krok(n+1)=1.715220e+000; ng(n+1)=1.317456e+001;
n=23; farx(n+1)=3.399048e+000; foe(n+1)=2.622908e+002; krok(n+1)=1.963959e+000; ng(n+1)=9.954456e+000;
n=24; farx(n+1)=3.377146e+000; foe(n+1)=3.506880e+002; krok(n+1)=4.761189e+000; ng(n+1)=9.002241e+000;
n=25; farx(n+1)=3.326722e+000; foe(n+1)=4.193802e+002; krok(n+1)=1.522162e+000; ng(n+1)=1.579789e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.319564e+000; foe(n+1)=5.840044e+002; krok(n+1)=3.980988e-005; ng(n+1)=3.145670e+001;
n=27; farx(n+1)=3.313807e+000; foe(n+1)=4.097152e+002; krok(n+1)=5.005982e-004; ng(n+1)=8.119360e+000;
n=28; farx(n+1)=3.242296e+000; foe(n+1)=1.839977e+002; krok(n+1)=3.157424e-003; ng(n+1)=8.901060e+000;
n=29; farx(n+1)=3.061097e+000; foe(n+1)=1.521807e+002; krok(n+1)=4.674043e-003; ng(n+1)=1.574549e+001;
n=30; farx(n+1)=3.014897e+000; foe(n+1)=1.379600e+002; krok(n+1)=1.115271e-001; ng(n+1)=5.105811e+001;
n=31; farx(n+1)=3.003248e+000; foe(n+1)=1.371947e+002; krok(n+1)=1.475580e-001; ng(n+1)=8.654695e+001;
n=32; farx(n+1)=2.930385e+000; foe(n+1)=1.517825e+002; krok(n+1)=4.498732e-001; ng(n+1)=8.013669e+001;
n=33; farx(n+1)=2.899477e+000; foe(n+1)=1.582137e+002; krok(n+1)=8.693674e-002; ng(n+1)=1.244472e+001;
n=34; farx(n+1)=2.838618e+000; foe(n+1)=1.345297e+002; krok(n+1)=1.015323e+000; ng(n+1)=2.651913e+001;
n=35; farx(n+1)=2.804060e+000; foe(n+1)=1.323576e+002; krok(n+1)=1.157790e+000; ng(n+1)=6.233249e+001;
n=36; farx(n+1)=2.761223e+000; foe(n+1)=1.202220e+002; krok(n+1)=8.923142e-001; ng(n+1)=1.103490e+001;
n=37; farx(n+1)=2.735122e+000; foe(n+1)=1.285484e+002; krok(n+1)=1.462039e+000; ng(n+1)=3.478517e+001;
n=38; farx(n+1)=2.718676e+000; foe(n+1)=1.286956e+002; krok(n+1)=1.017241e+000; ng(n+1)=3.260790e+001;
n=39; farx(n+1)=2.698294e+000; foe(n+1)=1.179146e+002; krok(n+1)=6.449478e-001; ng(n+1)=4.992747e+000;
n=40; farx(n+1)=2.691072e+000; foe(n+1)=1.171518e+002; krok(n+1)=2.969638e-001; ng(n+1)=3.552416e+001;
n=41; farx(n+1)=2.677253e+000; foe(n+1)=1.140277e+002; krok(n+1)=1.741449e+000; ng(n+1)=1.765353e+001;
n=42; farx(n+1)=2.665524e+000; foe(n+1)=1.200647e+002; krok(n+1)=6.063266e-001; ng(n+1)=3.328156e+001;
n=43; farx(n+1)=2.655608e+000; foe(n+1)=1.181244e+002; krok(n+1)=8.728449e-001; ng(n+1)=4.785270e+000;
n=44; farx(n+1)=2.650177e+000; foe(n+1)=1.121579e+002; krok(n+1)=1.154449e+000; ng(n+1)=2.052770e+001;
n=45; farx(n+1)=2.646372e+000; foe(n+1)=1.131043e+002; krok(n+1)=7.386536e-001; ng(n+1)=2.097270e+001;
n=46; farx(n+1)=2.639923e+000; foe(n+1)=1.122700e+002; krok(n+1)=1.075480e+000; ng(n+1)=1.027253e+001;
n=47; farx(n+1)=2.637401e+000; foe(n+1)=1.145235e+002; krok(n+1)=7.294970e-001; ng(n+1)=2.022812e+001;
n=48; farx(n+1)=2.635175e+000; foe(n+1)=1.162261e+002; krok(n+1)=9.526777e-001; ng(n+1)=1.536613e+001;
n=49; farx(n+1)=2.632039e+000; foe(n+1)=1.122150e+002; krok(n+1)=8.456470e-001; ng(n+1)=7.214768e+000;
n=50; farx(n+1)=2.630897e+000; foe(n+1)=1.127378e+002; krok(n+1)=1.390988e+000; ng(n+1)=1.055175e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.630770e+000; foe(n+1)=1.131220e+002; krok(n+1)=1.707914e-005; ng(n+1)=6.238096e+000;
n=52; farx(n+1)=2.630632e+000; foe(n+1)=1.133462e+002; krok(n+1)=5.805985e-005; ng(n+1)=2.753992e+000;
n=53; farx(n+1)=2.630614e+000; foe(n+1)=1.139040e+002; krok(n+1)=1.104943e-003; ng(n+1)=2.780278e-001;
n=54; farx(n+1)=2.630227e+000; foe(n+1)=1.132385e+002; krok(n+1)=2.570124e-002; ng(n+1)=2.720912e-001;
n=55; farx(n+1)=2.630199e+000; foe(n+1)=1.132676e+002; krok(n+1)=6.754791e-002; ng(n+1)=4.899775e-002;
n=56; farx(n+1)=2.630052e+000; foe(n+1)=1.134939e+002; krok(n+1)=1.520877e-001; ng(n+1)=7.182033e-002;
n=57; farx(n+1)=2.629381e+000; foe(n+1)=1.121125e+002; krok(n+1)=9.072770e-001; ng(n+1)=2.477493e-001;
n=58; farx(n+1)=2.629021e+000; foe(n+1)=1.119514e+002; krok(n+1)=1.651241e+000; ng(n+1)=5.831374e+000;
n=59; farx(n+1)=2.628839e+000; foe(n+1)=1.117718e+002; krok(n+1)=1.377726e+000; ng(n+1)=4.022806e+000;
n=60; farx(n+1)=2.628810e+000; foe(n+1)=1.119710e+002; krok(n+1)=8.551844e-001; ng(n+1)=1.656304e+000;
n=61; farx(n+1)=2.628783e+000; foe(n+1)=1.117318e+002; krok(n+1)=7.113726e-001; ng(n+1)=1.469677e+000;
n=62; farx(n+1)=2.628781e+000; foe(n+1)=1.117282e+002; krok(n+1)=1.252500e+000; ng(n+1)=5.339359e-001;
n=63; farx(n+1)=2.628781e+000; foe(n+1)=1.117365e+002; krok(n+1)=9.205345e-001; ng(n+1)=7.883673e-002;
n=64; farx(n+1)=2.628781e+000; foe(n+1)=1.117341e+002; krok(n+1)=9.877389e-001; ng(n+1)=4.502481e-003;
n=65; farx(n+1)=2.628781e+000; foe(n+1)=1.117341e+002; krok(n+1)=1.404624e-005; ng(n+1)=8.325676e-003;
n=66; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.001959e+000; ng(n+1)=8.325595e-003;
n=67; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.430061e-005; ng(n+1)=2.800862e-005;
n=68; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.558727e-005; ng(n+1)=2.800828e-005;
n=69; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.266505e-007; ng(n+1)=2.800784e-005;
n=70; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.440677e-009; ng(n+1)=2.800782e-005;
n=71; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.893336e-006; ng(n+1)=2.800782e-005;
n=72; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.617655e-006; ng(n+1)=2.800742e-005;
n=73; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=5.119944e-006; ng(n+1)=2.800735e-005;
 % z造 kierunek w metodzie zm - odnowa 
n=74; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.674848e-006; ng(n+1)=2.800712e-005;
n=75; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=9.410994e-006; ng(n+1)=2.105478e-005;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.377988e-005; ng(n+1)=2.127574e-005;
n=77; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=8.600086e-006; ng(n+1)=6.844519e-006;
n=78; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.504753e-005; ng(n+1)=6.522609e-006;
n=79; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.867289e-006; ng(n+1)=6.512783e-006;
n=80; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.901019e-006; ng(n+1)=6.513231e-006;
n=81; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.642639e-005; ng(n+1)=6.513208e-006;
n=82; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.726474e-005; ng(n+1)=6.513086e-006;
n=83; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.718817e-008; ng(n+1)=6.512969e-006;
n=84; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=7.969186e-007; ng(n+1)=6.512967e-006;
 % z造 kierunek w metodzie zm - odnowa 
n=85; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.346466e-006; ng(n+1)=6.512964e-006;
 % z造 kierunek w metodzie zm - odnowa 
n=86; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=8.358899e-008; ng(n+1)=5.894049e-006;
n=87; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.077624e-006; ng(n+1)=5.860115e-006;
n=88; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.210362e-006; ng(n+1)=6.106581e-006;
n=89; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=5.476879e-006; ng(n+1)=6.104402e-006;
n=90; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.233861e-006; ng(n+1)=6.104832e-006;
n=91; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=9.386253e-006; ng(n+1)=6.104819e-006;
n=92; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.479574e-008; ng(n+1)=6.104747e-006;
 % z造 kierunek w metodzie zm - odnowa 
n=93; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.453926e-005; ng(n+1)=6.104746e-006;
n=94; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=2.162603e-005; ng(n+1)=3.560788e-006;
n=95; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.629325e-006; ng(n+1)=2.194760e-006;
 % z造 kierunek w metodzie zm - odnowa 
 % z造 kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
