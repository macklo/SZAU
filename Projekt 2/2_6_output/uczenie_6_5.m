%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.365269e+003; foe(n+1)=4.251472e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=3.270109e+003; foe(n+1)=3.196705e+003; krok(n+1)=3.643472e-004; ng(n+1)=3.245727e+003;
n=2; farx(n+1)=3.033256e+003; foe(n+1)=3.060568e+003; krok(n+1)=2.695564e-004; ng(n+1)=2.212667e+003;
n=3; farx(n+1)=9.852303e+002; foe(n+1)=7.692909e+003; krok(n+1)=7.397815e-003; ng(n+1)=6.001593e+002;
n=4; farx(n+1)=9.231156e+002; foe(n+1)=8.938638e+003; krok(n+1)=1.198093e-004; ng(n+1)=1.876786e+003;
n=5; farx(n+1)=8.997294e+002; foe(n+1)=9.289256e+003; krok(n+1)=2.047906e-002; ng(n+1)=1.793620e+003;
n=6; farx(n+1)=2.342304e+002; foe(n+1)=5.735896e+003; krok(n+1)=1.361947e+000; ng(n+1)=1.811245e+003;
n=7; farx(n+1)=1.752917e+002; foe(n+1)=1.057867e+004; krok(n+1)=1.997077e+000; ng(n+1)=4.913518e+002;
n=8; farx(n+1)=1.185353e+002; foe(n+1)=4.250427e+003; krok(n+1)=1.841069e+000; ng(n+1)=3.112375e+002;
n=9; farx(n+1)=8.763266e+001; foe(n+1)=6.602187e+003; krok(n+1)=1.613595e+000; ng(n+1)=3.298228e+002;
n=10; farx(n+1)=8.184699e+001; foe(n+1)=8.939592e+003; krok(n+1)=9.112329e-001; ng(n+1)=1.554060e+002;
n=11; farx(n+1)=8.032513e+001; foe(n+1)=7.579091e+003; krok(n+1)=4.910252e+000; ng(n+1)=5.510339e+001;
n=12; farx(n+1)=5.787591e+001; foe(n+1)=7.109733e+003; krok(n+1)=1.181265e+001; ng(n+1)=7.962693e+001;
n=13; farx(n+1)=5.393316e+001; foe(n+1)=7.145525e+003; krok(n+1)=2.846355e-001; ng(n+1)=2.392933e+002;
n=14; farx(n+1)=4.569617e+001; foe(n+1)=7.602731e+003; krok(n+1)=3.825314e-001; ng(n+1)=3.098455e+002;
n=15; farx(n+1)=3.587218e+001; foe(n+1)=7.437728e+003; krok(n+1)=1.462039e+000; ng(n+1)=1.371017e+002;
n=16; farx(n+1)=2.836141e+001; foe(n+1)=2.086177e+003; krok(n+1)=8.043035e-001; ng(n+1)=1.326695e+002;
n=17; farx(n+1)=2.684409e+001; foe(n+1)=5.134910e+002; krok(n+1)=2.385171e-001; ng(n+1)=1.017768e+002;
n=18; farx(n+1)=2.518957e+001; foe(n+1)=2.393466e+002; krok(n+1)=4.013589e-001; ng(n+1)=1.754535e+002;
n=19; farx(n+1)=2.463800e+001; foe(n+1)=2.209407e+002; krok(n+1)=1.355546e+000; ng(n+1)=5.434508e+001;
n=20; farx(n+1)=2.384422e+001; foe(n+1)=8.283470e+002; krok(n+1)=1.638167e+000; ng(n+1)=2.575544e+001;
n=21; farx(n+1)=2.368770e+001; foe(n+1)=4.345090e+002; krok(n+1)=8.536620e-001; ng(n+1)=2.974711e+001;
n=22; farx(n+1)=2.358717e+001; foe(n+1)=3.889546e+002; krok(n+1)=1.304490e+000; ng(n+1)=2.199457e+001;
n=23; farx(n+1)=2.350655e+001; foe(n+1)=7.124636e+002; krok(n+1)=1.000418e+000; ng(n+1)=1.410903e+001;
n=24; farx(n+1)=2.332520e+001; foe(n+1)=1.612308e+003; krok(n+1)=2.953163e+000; ng(n+1)=1.846153e+001;
n=25; farx(n+1)=2.307566e+001; foe(n+1)=7.576590e+002; krok(n+1)=2.494425e+000; ng(n+1)=1.131299e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.298846e+001; foe(n+1)=8.237911e+002; krok(n+1)=2.825558e-004; ng(n+1)=2.843561e+001;
n=27; farx(n+1)=2.293384e+001; foe(n+1)=7.610539e+002; krok(n+1)=5.716520e-004; ng(n+1)=2.280806e+001;
n=28; farx(n+1)=2.274960e+001; foe(n+1)=6.488246e+002; krok(n+1)=2.583925e-003; ng(n+1)=1.815672e+001;
n=29; farx(n+1)=2.274089e+001; foe(n+1)=3.958115e+002; krok(n+1)=4.629191e-003; ng(n+1)=6.290678e+000;
n=30; farx(n+1)=2.273891e+001; foe(n+1)=3.936130e+002; krok(n+1)=2.803148e-002; ng(n+1)=5.768265e+000;
n=31; farx(n+1)=2.272282e+001; foe(n+1)=3.332759e+002; krok(n+1)=1.420334e+000; ng(n+1)=4.156626e+000;
n=32; farx(n+1)=2.254326e+001; foe(n+1)=7.003892e+002; krok(n+1)=6.432154e+000; ng(n+1)=2.694988e+000;
n=33; farx(n+1)=7.542808e+000; foe(n+1)=1.889522e+002; krok(n+1)=6.471179e+000; ng(n+1)=6.783961e+001;
n=34; farx(n+1)=7.542808e+000; foe(n+1)=1.889522e+002; krok(n+1)=8.324050e-016; ng(n+1)=8.394050e+001;
n=35; farx(n+1)=7.525657e+000; foe(n+1)=1.899979e+002; krok(n+1)=3.616714e-002; ng(n+1)=8.394050e+001;
n=36; farx(n+1)=7.525657e+000; foe(n+1)=1.899979e+002; krok(n+1)=2.396157e-015; ng(n+1)=7.553742e+001;
n=37; farx(n+1)=7.525657e+000; foe(n+1)=1.899979e+002; krok(n+1)=6.551863e-015; ng(n+1)=7.553742e+001;
n=38; farx(n+1)=7.525657e+000; foe(n+1)=1.899979e+002; krok(n+1)=4.417282e-015; ng(n+1)=7.553742e+001;
n=39; farx(n+1)=7.520730e+000; foe(n+1)=1.930815e+002; krok(n+1)=4.953895e-002; ng(n+1)=7.553742e+001;
n=40; farx(n+1)=7.520730e+000; foe(n+1)=1.930815e+002; krok(n+1)=2.280147e-014; ng(n+1)=7.512535e+001;
n=41; farx(n+1)=5.965696e+000; foe(n+1)=1.770153e+002; krok(n+1)=4.187571e-001; ng(n+1)=7.512535e+001;
n=42; farx(n+1)=5.000130e+000; foe(n+1)=1.548228e+002; krok(n+1)=6.674447e-001; ng(n+1)=8.938494e+001;
n=43; farx(n+1)=4.604443e+000; foe(n+1)=1.988966e+002; krok(n+1)=8.745977e-001; ng(n+1)=4.616463e+001;
n=44; farx(n+1)=4.393690e+000; foe(n+1)=1.772493e+002; krok(n+1)=1.330664e+000; ng(n+1)=6.201604e+001;
n=45; farx(n+1)=3.808985e+000; foe(n+1)=2.145624e+002; krok(n+1)=1.659005e+000; ng(n+1)=8.272297e+001;
n=46; farx(n+1)=3.719474e+000; foe(n+1)=1.683602e+002; krok(n+1)=6.674447e-001; ng(n+1)=3.389120e+001;
n=47; farx(n+1)=3.669564e+000; foe(n+1)=1.690063e+002; krok(n+1)=1.981558e-001; ng(n+1)=5.972732e+001;
n=48; farx(n+1)=3.597404e+000; foe(n+1)=1.720031e+002; krok(n+1)=1.307567e+000; ng(n+1)=1.448179e+001;
n=49; farx(n+1)=3.506748e+000; foe(n+1)=1.843734e+002; krok(n+1)=1.280929e+000; ng(n+1)=3.962071e+001;
n=50; farx(n+1)=3.137972e+000; foe(n+1)=1.602864e+002; krok(n+1)=3.350873e+000; ng(n+1)=4.480663e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=3.075499e+000; foe(n+1)=1.447149e+002; krok(n+1)=3.473178e-005; ng(n+1)=9.367720e+001;
n=52; farx(n+1)=3.066750e+000; foe(n+1)=1.454420e+002; krok(n+1)=1.736749e-004; ng(n+1)=1.747338e+001;
n=53; farx(n+1)=3.063308e+000; foe(n+1)=1.395333e+002; krok(n+1)=3.065383e-003; ng(n+1)=2.445787e+000;
n=54; farx(n+1)=2.963847e+000; foe(n+1)=1.317422e+002; krok(n+1)=5.234463e-002; ng(n+1)=2.708399e+000;
n=55; farx(n+1)=2.951494e+000; foe(n+1)=1.343818e+002; krok(n+1)=3.497807e-002; ng(n+1)=5.365133e+001;
n=56; farx(n+1)=2.931323e+000; foe(n+1)=1.259068e+002; krok(n+1)=4.268310e-001; ng(n+1)=5.528938e+001;
n=57; farx(n+1)=2.892103e+000; foe(n+1)=1.282997e+002; krok(n+1)=2.176811e-001; ng(n+1)=6.584049e+001;
n=58; farx(n+1)=2.837447e+000; foe(n+1)=1.473993e+002; krok(n+1)=1.191056e-001; ng(n+1)=3.895649e+001;
n=59; farx(n+1)=2.801011e+000; foe(n+1)=1.387063e+002; krok(n+1)=4.635137e-001; ng(n+1)=3.179775e+001;
n=60; farx(n+1)=2.778127e+000; foe(n+1)=1.263327e+002; krok(n+1)=5.824576e-001; ng(n+1)=3.077599e+001;
n=61; farx(n+1)=2.740997e+000; foe(n+1)=1.172530e+002; krok(n+1)=1.841052e+000; ng(n+1)=4.776100e+001;
n=62; farx(n+1)=2.714427e+000; foe(n+1)=1.299605e+002; krok(n+1)=1.250551e+000; ng(n+1)=2.229031e+001;
n=63; farx(n+1)=2.696218e+000; foe(n+1)=1.307298e+002; krok(n+1)=2.378132e-001; ng(n+1)=2.086394e+001;
n=64; farx(n+1)=2.685965e+000; foe(n+1)=1.224915e+002; krok(n+1)=7.847380e-001; ng(n+1)=2.038931e+001;
n=65; farx(n+1)=2.676945e+000; foe(n+1)=1.180706e+002; krok(n+1)=9.576737e-001; ng(n+1)=3.525377e+001;
n=66; farx(n+1)=2.664111e+000; foe(n+1)=1.145579e+002; krok(n+1)=1.585247e+000; ng(n+1)=8.804677e+000;
n=67; farx(n+1)=2.653223e+000; foe(n+1)=1.248518e+002; krok(n+1)=1.625559e+000; ng(n+1)=2.585005e+001;
n=68; farx(n+1)=2.648879e+000; foe(n+1)=1.211665e+002; krok(n+1)=5.636152e-001; ng(n+1)=2.988475e+000;
n=69; farx(n+1)=2.644116e+000; foe(n+1)=1.162230e+002; krok(n+1)=8.131859e-001; ng(n+1)=2.438814e+001;
n=70; farx(n+1)=2.641802e+000; foe(n+1)=1.132757e+002; krok(n+1)=3.693268e-001; ng(n+1)=1.502359e+001;
n=71; farx(n+1)=2.636589e+000; foe(n+1)=1.132334e+002; krok(n+1)=2.240289e+000; ng(n+1)=1.322851e+001;
n=72; farx(n+1)=2.634916e+000; foe(n+1)=1.163237e+002; krok(n+1)=4.584092e-001; ng(n+1)=1.444404e+001;
n=73; farx(n+1)=2.632550e+000; foe(n+1)=1.158226e+002; krok(n+1)=7.461831e-001; ng(n+1)=4.532650e+000;
n=74; farx(n+1)=2.631147e+000; foe(n+1)=1.118213e+002; krok(n+1)=1.498210e+000; ng(n+1)=9.070026e+000;
n=75; farx(n+1)=2.630484e+000; foe(n+1)=1.120370e+002; krok(n+1)=6.788102e-001; ng(n+1)=1.387646e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.630436e+000; foe(n+1)=1.122498e+002; krok(n+1)=1.482745e-005; ng(n+1)=3.560797e+000;
n=77; farx(n+1)=2.630371e+000; foe(n+1)=1.123684e+002; krok(n+1)=1.043926e-004; ng(n+1)=1.743935e+000;
n=78; farx(n+1)=2.630287e+000; foe(n+1)=1.136095e+002; krok(n+1)=3.604935e-004; ng(n+1)=1.136121e+000;
n=79; farx(n+1)=2.630256e+000; foe(n+1)=1.135410e+002; krok(n+1)=4.756755e-002; ng(n+1)=5.827152e-002;
n=80; farx(n+1)=2.630126e+000; foe(n+1)=1.131064e+002; krok(n+1)=1.500565e-001; ng(n+1)=6.818838e-002;
n=81; farx(n+1)=2.629434e+000; foe(n+1)=1.118941e+002; krok(n+1)=1.307567e+000; ng(n+1)=3.150159e-001;
n=82; farx(n+1)=2.629367e+000; foe(n+1)=1.119056e+002; krok(n+1)=5.753341e-002; ng(n+1)=6.185773e+000;
n=83; farx(n+1)=2.628988e+000; foe(n+1)=1.124098e+002; krok(n+1)=1.715220e+000; ng(n+1)=7.085060e+000;
n=84; farx(n+1)=2.628847e+000; foe(n+1)=1.117315e+002; krok(n+1)=8.536620e-001; ng(n+1)=2.375185e+000;
n=85; farx(n+1)=2.628813e+000; foe(n+1)=1.118445e+002; krok(n+1)=5.939275e-001; ng(n+1)=2.506309e+000;
n=86; farx(n+1)=2.628782e+000; foe(n+1)=1.117150e+002; krok(n+1)=1.754638e+000; ng(n+1)=1.856150e+000;
n=87; farx(n+1)=2.628781e+000; foe(n+1)=1.117520e+002; krok(n+1)=7.926233e-001; ng(n+1)=5.149137e-001;
n=88; farx(n+1)=2.628781e+000; foe(n+1)=1.117319e+002; krok(n+1)=9.730681e-001; ng(n+1)=8.956765e-002;
n=89; farx(n+1)=2.628781e+000; foe(n+1)=1.117335e+002; krok(n+1)=1.177071e+000; ng(n+1)=1.132476e-002;
n=90; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.722419e+000; ng(n+1)=7.699980e-003;
n=91; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.328733e-007; ng(n+1)=5.132137e-004;
n=92; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=8.113656e-007; ng(n+1)=5.132136e-004;
n=93; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.461382e-006; ng(n+1)=5.132132e-004;
n=94; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=7.764215e-008; ng(n+1)=5.132114e-004;
n=95; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=4.364200e-010; ng(n+1)=5.132113e-004;
n=96; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.815918e-010; ng(n+1)=5.132113e-004;
n=97; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.160557e-010; ng(n+1)=5.132113e-004;
n=98; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=3.056338e-009; ng(n+1)=5.132113e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=99; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=1.323611e-005; ng(n+1)=5.132113e-004;
n=100; farx(n+1)=2.628781e+000; foe(n+1)=1.117339e+002; krok(n+1)=6.715949e-005; ng(n+1)=1.775298e-004;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
