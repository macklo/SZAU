%uczenie predyktora arx
clear all;
n=0; farx(n+1)=4.843035e+003; foe(n+1)=4.806131e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.638240e+003; foe(n+1)=3.649470e+003; krok(n+1)=3.910575e-004; ng(n+1)=1.075057e+004;
n=2; farx(n+1)=1.185203e+003; foe(n+1)=1.051195e+004; krok(n+1)=1.624345e-004; ng(n+1)=1.366180e+004;
n=3; farx(n+1)=4.323654e+002; foe(n+1)=1.224519e+004; krok(n+1)=2.417862e-004; ng(n+1)=8.277913e+003;
n=4; farx(n+1)=2.782264e+002; foe(n+1)=1.373615e+004; krok(n+1)=2.739044e-003; ng(n+1)=6.538968e+003;
n=5; farx(n+1)=2.134768e+002; foe(n+1)=1.214141e+004; krok(n+1)=1.494263e-003; ng(n+1)=3.812605e+003;
n=6; farx(n+1)=1.646909e+002; foe(n+1)=1.202349e+004; krok(n+1)=1.750227e-003; ng(n+1)=1.045923e+003;
n=7; farx(n+1)=1.382306e+002; foe(n+1)=1.042830e+004; krok(n+1)=5.688063e-004; ng(n+1)=1.735027e+003;
n=8; farx(n+1)=6.310477e+001; foe(n+1)=8.990923e+003; krok(n+1)=2.900817e-003; ng(n+1)=1.753868e+003;
n=9; farx(n+1)=4.007137e+001; foe(n+1)=1.710095e+003; krok(n+1)=6.767654e-004; ng(n+1)=2.214931e+003;
n=10; farx(n+1)=1.490628e+001; foe(n+1)=1.344602e+002; krok(n+1)=1.425029e-003; ng(n+1)=2.735364e+003;
n=11; farx(n+1)=1.187258e+001; foe(n+1)=1.086200e+002; krok(n+1)=3.400118e-003; ng(n+1)=1.085531e+003;
n=12; farx(n+1)=9.864858e+000; foe(n+1)=1.156481e+002; krok(n+1)=1.204622e-002; ng(n+1)=9.007762e+002;
n=13; farx(n+1)=7.743731e+000; foe(n+1)=1.201395e+002; krok(n+1)=9.248075e-003; ng(n+1)=4.068517e+002;
n=14; farx(n+1)=5.679380e+000; foe(n+1)=1.005420e+002; krok(n+1)=3.320390e-002; ng(n+1)=3.064511e+002;
n=15; farx(n+1)=4.365224e+000; foe(n+1)=8.860711e+001; krok(n+1)=6.192369e-003; ng(n+1)=2.450550e+002;
n=16; farx(n+1)=2.678920e+000; foe(n+1)=5.511899e+001; krok(n+1)=3.134015e-002; ng(n+1)=2.947858e+002;
n=17; farx(n+1)=2.109206e+000; foe(n+1)=4.053853e+001; krok(n+1)=9.082851e-003; ng(n+1)=2.955427e+002;
n=18; farx(n+1)=1.854550e+000; foe(n+1)=4.889869e+001; krok(n+1)=2.097129e-002; ng(n+1)=8.229190e+001;
n=19; farx(n+1)=1.549012e+000; foe(n+1)=5.855092e+001; krok(n+1)=4.285764e-002; ng(n+1)=9.193898e+001;
n=20; farx(n+1)=1.464080e+000; foe(n+1)=5.904287e+001; krok(n+1)=4.905012e-002; ng(n+1)=1.284077e+002;
n=21; farx(n+1)=1.218486e+000; foe(n+1)=7.076955e+001; krok(n+1)=9.810024e-002; ng(n+1)=1.311490e+002;
n=22; farx(n+1)=1.061498e+000; foe(n+1)=5.368723e+001; krok(n+1)=1.909506e-001; ng(n+1)=1.053700e+002;
n=23; farx(n+1)=9.935971e-001; foe(n+1)=4.719250e+001; krok(n+1)=5.482403e-002; ng(n+1)=1.135577e+002;
n=24; farx(n+1)=9.040865e-001; foe(n+1)=5.484649e+001; krok(n+1)=1.958016e-001; ng(n+1)=6.429515e+001;
n=25; farx(n+1)=8.432819e-001; foe(n+1)=5.133706e+001; krok(n+1)=2.093785e-001; ng(n+1)=6.539537e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=8.325758e-001; foe(n+1)=4.970279e+001; krok(n+1)=7.872898e-005; ng(n+1)=5.051630e+001;
n=27; farx(n+1)=8.105358e-001; foe(n+1)=5.165568e+001; krok(n+1)=3.870231e-004; ng(n+1)=2.989039e+001;
n=28; farx(n+1)=7.851256e-001; foe(n+1)=6.025183e+001; krok(n+1)=1.945992e-004; ng(n+1)=4.729068e+001;
n=29; farx(n+1)=7.619618e-001; foe(n+1)=6.193682e+001; krok(n+1)=1.012568e-002; ng(n+1)=7.560693e+000;
n=30; farx(n+1)=7.310692e-001; foe(n+1)=7.854853e+001; krok(n+1)=1.073668e-002; ng(n+1)=8.761264e+000;
n=31; farx(n+1)=7.056847e-001; foe(n+1)=6.201364e+001; krok(n+1)=6.563449e-002; ng(n+1)=4.371913e+001;
n=32; farx(n+1)=6.765509e-001; foe(n+1)=7.496280e+001; krok(n+1)=2.268451e-001; ng(n+1)=7.305903e+001;
n=33; farx(n+1)=5.995132e-001; foe(n+1)=7.809404e+001; krok(n+1)=7.173481e-002; ng(n+1)=6.311378e+001;
n=34; farx(n+1)=5.625376e-001; foe(n+1)=9.243922e+001; krok(n+1)=5.122362e-002; ng(n+1)=5.170336e+001;
n=35; farx(n+1)=5.422019e-001; foe(n+1)=6.446386e+001; krok(n+1)=5.893163e-002; ng(n+1)=2.020343e+001;
n=36; farx(n+1)=5.204614e-001; foe(n+1)=4.082781e+001; krok(n+1)=3.627640e-002; ng(n+1)=5.025421e+001;
n=37; farx(n+1)=4.739330e-001; foe(n+1)=3.553597e+001; krok(n+1)=2.192961e-001; ng(n+1)=2.163198e+001;
n=38; farx(n+1)=4.512238e-001; foe(n+1)=3.451276e+001; krok(n+1)=6.778645e-002; ng(n+1)=5.324702e+001;
n=39; farx(n+1)=4.262248e-001; foe(n+1)=3.369577e+001; krok(n+1)=1.653712e-001; ng(n+1)=2.988774e+001;
n=40; farx(n+1)=4.072146e-001; foe(n+1)=3.803414e+001; krok(n+1)=1.507961e-001; ng(n+1)=3.454618e+001;
n=41; farx(n+1)=3.950302e-001; foe(n+1)=4.023640e+001; krok(n+1)=1.051652e-001; ng(n+1)=4.271776e+001;
n=42; farx(n+1)=3.820871e-001; foe(n+1)=4.360653e+001; krok(n+1)=1.981883e-001; ng(n+1)=4.344100e+001;
n=43; farx(n+1)=3.783133e-001; foe(n+1)=4.145846e+001; krok(n+1)=1.714306e-001; ng(n+1)=6.732446e+000;
n=44; farx(n+1)=3.666972e-001; foe(n+1)=3.116629e+001; krok(n+1)=3.805404e-001; ng(n+1)=4.368104e+000;
n=45; farx(n+1)=3.626651e-001; foe(n+1)=3.096793e+001; krok(n+1)=9.909413e-002; ng(n+1)=1.471060e+001;
n=46; farx(n+1)=3.497961e-001; foe(n+1)=3.153412e+001; krok(n+1)=5.107206e-001; ng(n+1)=1.037483e+001;
n=47; farx(n+1)=3.420112e-001; foe(n+1)=2.598272e+001; krok(n+1)=2.611580e-001; ng(n+1)=1.497206e+001;
n=48; farx(n+1)=3.309860e-001; foe(n+1)=2.299031e+001; krok(n+1)=2.760258e-001; ng(n+1)=4.306271e+001;
n=49; farx(n+1)=3.231560e-001; foe(n+1)=2.018928e+001; krok(n+1)=4.004429e-001; ng(n+1)=2.302232e+001;
n=50; farx(n+1)=3.199683e-001; foe(n+1)=2.060432e+001; krok(n+1)=1.312394e-001; ng(n+1)=1.373614e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=3.194778e-001; foe(n+1)=2.127120e+001; krok(n+1)=1.085990e-004; ng(n+1)=7.885236e+000;
n=52; farx(n+1)=3.192097e-001; foe(n+1)=2.156268e+001; krok(n+1)=2.215284e-004; ng(n+1)=4.589117e+000;
n=53; farx(n+1)=3.181988e-001; foe(n+1)=2.388270e+001; krok(n+1)=2.799030e-004; ng(n+1)=8.803024e+000;
n=54; farx(n+1)=3.164217e-001; foe(n+1)=2.344888e+001; krok(n+1)=1.311143e-002; ng(n+1)=1.399875e+000;
n=55; farx(n+1)=3.150486e-001; foe(n+1)=2.239944e+001; krok(n+1)=1.038090e-002; ng(n+1)=1.793457e+000;
n=56; farx(n+1)=3.124368e-001; foe(n+1)=2.028603e+001; krok(n+1)=7.045190e-002; ng(n+1)=1.550932e+000;
n=57; farx(n+1)=3.105790e-001; foe(n+1)=2.153917e+001; krok(n+1)=6.900644e-002; ng(n+1)=1.390505e+001;
n=58; farx(n+1)=3.082817e-001; foe(n+1)=1.791530e+001; krok(n+1)=9.358032e-002; ng(n+1)=2.108128e+001;
n=59; farx(n+1)=3.035413e-001; foe(n+1)=1.293504e+001; krok(n+1)=2.740921e-001; ng(n+1)=2.792666e+001;
n=60; farx(n+1)=2.999096e-001; foe(n+1)=1.146661e+001; krok(n+1)=9.809225e-002; ng(n+1)=1.030145e+001;
n=61; farx(n+1)=2.970517e-001; foe(n+1)=1.020621e+001; krok(n+1)=2.962682e-001; ng(n+1)=1.137159e+001;
n=62; farx(n+1)=2.921804e-001; foe(n+1)=9.927665e+000; krok(n+1)=6.404647e-001; ng(n+1)=9.022510e+000;
n=63; farx(n+1)=2.914114e-001; foe(n+1)=9.395748e+000; krok(n+1)=4.000365e-002; ng(n+1)=9.259174e+000;
n=64; farx(n+1)=2.877189e-001; foe(n+1)=6.634015e+000; krok(n+1)=2.320583e-001; ng(n+1)=8.919702e+000;
n=65; farx(n+1)=2.861035e-001; foe(n+1)=6.177703e+000; krok(n+1)=1.655202e-001; ng(n+1)=1.862937e+001;
n=66; farx(n+1)=2.837375e-001; foe(n+1)=5.470359e+000; krok(n+1)=1.443061e-001; ng(n+1)=1.721803e+001;
n=67; farx(n+1)=2.797792e-001; foe(n+1)=4.551387e+000; krok(n+1)=2.785672e-001; ng(n+1)=1.100471e+001;
n=68; farx(n+1)=2.749411e-001; foe(n+1)=4.863648e+000; krok(n+1)=4.929770e-001; ng(n+1)=1.465155e+001;
n=69; farx(n+1)=2.724973e-001; foe(n+1)=3.912878e+000; krok(n+1)=5.076613e-001; ng(n+1)=2.026771e+001;
n=70; farx(n+1)=2.707640e-001; foe(n+1)=3.531600e+000; krok(n+1)=2.134155e-001; ng(n+1)=1.451091e+001;
n=71; farx(n+1)=2.696860e-001; foe(n+1)=3.241344e+000; krok(n+1)=3.806077e-001; ng(n+1)=1.037045e+001;
n=72; farx(n+1)=2.683115e-001; foe(n+1)=3.370094e+000; krok(n+1)=5.250759e-001; ng(n+1)=7.860587e+000;
n=73; farx(n+1)=2.666821e-001; foe(n+1)=3.251693e+000; krok(n+1)=3.762637e-001; ng(n+1)=8.885369e+000;
n=74; farx(n+1)=2.652941e-001; foe(n+1)=3.180815e+000; krok(n+1)=4.083285e-001; ng(n+1)=6.437824e+000;
n=75; farx(n+1)=2.637302e-001; foe(n+1)=3.367013e+000; krok(n+1)=3.885953e-001; ng(n+1)=9.232088e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=2.632776e-001; foe(n+1)=3.213133e+000; krok(n+1)=5.234435e-005; ng(n+1)=1.273118e+001;
n=77; farx(n+1)=2.632284e-001; foe(n+1)=3.171322e+000; krok(n+1)=1.517951e-003; ng(n+1)=8.373747e-001;
n=78; farx(n+1)=2.632266e-001; foe(n+1)=3.170482e+000; krok(n+1)=1.681794e-004; ng(n+1)=5.129299e-001;
n=79; farx(n+1)=2.631695e-001; foe(n+1)=3.185349e+000; krok(n+1)=7.314625e-003; ng(n+1)=3.974078e-001;
n=80; farx(n+1)=2.630428e-001; foe(n+1)=3.116200e+000; krok(n+1)=1.086709e-002; ng(n+1)=4.984711e-001;
n=81; farx(n+1)=2.628817e-001; foe(n+1)=3.213650e+000; krok(n+1)=3.067118e-002; ng(n+1)=4.405188e-001;
n=82; farx(n+1)=2.626475e-001; foe(n+1)=3.252719e+000; krok(n+1)=1.079418e-001; ng(n+1)=6.531516e-001;
n=83; farx(n+1)=2.620148e-001; foe(n+1)=3.129857e+000; krok(n+1)=9.809225e-002; ng(n+1)=8.634635e-001;
n=84; farx(n+1)=2.616954e-001; foe(n+1)=3.153367e+000; krok(n+1)=1.068992e-001; ng(n+1)=5.727276e+000;
n=85; farx(n+1)=2.605147e-001; foe(n+1)=3.416754e+000; krok(n+1)=4.317671e-001; ng(n+1)=8.374730e+000;
n=86; farx(n+1)=2.594669e-001; foe(n+1)=3.339423e+000; krok(n+1)=2.272257e-001; ng(n+1)=1.282490e+001;
n=87; farx(n+1)=2.589362e-001; foe(n+1)=3.315512e+000; krok(n+1)=1.827549e-001; ng(n+1)=5.936431e+000;
n=88; farx(n+1)=2.580422e-001; foe(n+1)=3.215281e+000; krok(n+1)=2.959895e-001; ng(n+1)=7.707119e+000;
n=89; farx(n+1)=2.560598e-001; foe(n+1)=3.189718e+000; krok(n+1)=4.003122e-001; ng(n+1)=1.060100e+001;
n=90; farx(n+1)=2.543272e-001; foe(n+1)=3.090593e+000; krok(n+1)=8.674420e-001; ng(n+1)=2.629197e+000;
n=91; farx(n+1)=2.521674e-001; foe(n+1)=2.634013e+000; krok(n+1)=2.857025e-001; ng(n+1)=1.293231e+001;
n=92; farx(n+1)=2.510521e-001; foe(n+1)=2.516196e+000; krok(n+1)=3.141433e-001; ng(n+1)=5.667521e+000;
n=93; farx(n+1)=2.492710e-001; foe(n+1)=2.358262e+000; krok(n+1)=2.200070e-001; ng(n+1)=9.757850e+000;
n=94; farx(n+1)=2.484682e-001; foe(n+1)=2.463440e+000; krok(n+1)=1.197092e-001; ng(n+1)=6.644791e+000;
n=95; farx(n+1)=2.470706e-001; foe(n+1)=2.415198e+000; krok(n+1)=6.809733e-001; ng(n+1)=4.601703e+000;
n=96; farx(n+1)=2.456312e-001; foe(n+1)=2.683097e+000; krok(n+1)=4.686024e-001; ng(n+1)=9.754776e+000;
n=97; farx(n+1)=2.445095e-001; foe(n+1)=2.677099e+000; krok(n+1)=2.950300e-001; ng(n+1)=7.072074e+000;
n=98; farx(n+1)=2.437400e-001; foe(n+1)=3.008683e+000; krok(n+1)=2.114442e-001; ng(n+1)=4.556018e+000;
n=99; farx(n+1)=2.428647e-001; foe(n+1)=2.946000e+000; krok(n+1)=2.857373e-001; ng(n+1)=3.225464e+000;
n=100; farx(n+1)=2.417482e-001; foe(n+1)=2.945187e+000; krok(n+1)=2.268451e-001; ng(n+1)=1.005739e+001;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
